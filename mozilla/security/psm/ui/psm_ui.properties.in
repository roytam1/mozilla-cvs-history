; -*- Mode: Text -*- 
;
; The contents of this file are subject to the Mozilla Public
; License Version 1.1 (the "License"); you may not use this file
; except in compliance with the License. You may obtain a copy of
; the License at http://www.mozilla.org/MPL/
; 
; Software distributed under the License is distributed on an "AS
; IS" basis, WITHOUT WARRANTY OF ANY KIND, either express or
; implied. See the License for the specific language governing
; rights and limitations under the License.
; 
; The Original Code is the Netscape security libraries.
; 
; The Initial Developer of the Original Code is Netscape
; Communications Corporation.  Portions created by Netscape are 
; Copyright (C) 1994-2000 Netscape Communications Corporation.  All
; Rights Reserved.
; 
; Contributor(s):
; 
; Alternatively, the contents of this file may be used under the
; terms of the GNU General Public License Version 2 or later (the
; "GPL"), in which case the provisions of the GPL are applicable 
; instead of those above.  If you wish to allow use of your 
; version of this file only under the terms of the GPL and not to
; allow others to use your version of this file under the MPL,
; indicate your decision by deleting the provisions above and
; replace them with the notice and other provisions required by
; the GPL.  If you do not delete the provisions above, a recipient
; may use your version of this file under either the MPL or the
; GPL.
;
;
; Stylesheets
;
secadvmodalstyle_type=text/css
secadvmodalstyle_content:
BODY.TOP {background-color: #9999CC;}

BODY.CONTENT{background-color: white;}

BODY.FOOT{background-color:#CCCCCC}

all.BUTTONSPACE {
		padding-left: 6px;
		padding-right: 6px;
		}

all.BUTTONSPACEHELP {
		padding-left: 24px;
		padding-right: 0px;
		}

H1	{
 	padding-top:6px;
	line-height: 100%;

	font-family: {nsm_font_verdana}; 
	font-size:16pt;
	font-weight:normal;
        color:white;
	}

A	{
	font-family: {nsm_font_verdana};
	font-size:10pt;
	color: black;
	}

BLOCKQUOTE{

 	padding-left:0px;
	line-height: 100%%;
	font-family: {nsm_font_verdana};
	font-size:10pt;
	font-weight:normal;
        color:black;
	}

all.plain{
 	padding-left:0px;
	padding-top:0px;
	font-family: {nsm_font_verdana};
	font-size:10pt;
	font-weight:normal;
        color:black;
	}

P	{
	font-family: {nsm_font_verdana};
	font-size:10pt;
	font-weight:normal;
        color:black;
	}

P.bold
	{
	font-weight: bold;
	}

P.alert	{
	font-weight: bold;
	}


P.hialert{
	font-weight: 900;
	background-color:#FF9900;
	padding-left:20px;
	}

all.Explanationbox
	{
	padding-top:6px;
	padding-bottom:12px;
	margin-bottom:6px;
 	margin-left:6px;
	margin-right: 5%;
	border-width: 1px;
	border-color: #999999;
	border-style: solid;
	}

all.PROGRESS {
	background-color:#CCCCCC;
	margin-top:5%;
 	margin-left:15%;
	margin-right:25%;
	border-width: 2px;
	border-color: #CCCCCC;
	border-style: solid;
	}


all.PLAINBOX {
	margin-left:12px;
	border-width: 1px;
	border-color: #999999;
	border-style: solid;
	}
DIV	{
	background-color:white;
	font-family: {nsm_content_font};
	font-size:10pt;
	color: black;
	}


:secadvmodalstyle_content

secadvtopstyle_type=text/css
secadvtopstyle_content:
all.standard {background-color:#CCCCCC;
           font-family: {nsm_font};
	   font-size:12pt;
           color: white;}


.TITLE  {  padding-left: 6px;
           font-family:{nsm_font_verdana};
           font-size:16pt;
           font-weight:bold;
           color:white;}

.TAB	   {
	   font-family: {nsm_content_font};
	   font-size:10pt;
	   }

A:alink {color: white; text-decoration: none;}
A:link  {color: white; text-decoration: none;}
A:vlink {color: white; text-decoration: none;}
:secadvtopstyle_content

secadvleftstyle_type=text/css
secadvleftstyle_content:
A	{
 	padding-left:6px;
	line-height: 150%;

	text-decoration: none;
	font-family: {nsm_leftpane_font}; 
	font-size:9pt;
	font-weight:bold;
	color: white;
	}
P	{
 	padding-left:6px;
	line-height: 150%;

	font-family: {nsm_leftpane_font}; 
	font-size:9pt;
	font-weight:bold;
        color:black;
	}
:secadvleftstyle_content

secadvfootstyle_type=text/css
secadvfootstyle_content:
DIV	{
	font-family: {nsm_leftpane_font};
	font-size:10pt;
	color:black;
	}

:secadvfootstyle_content

; Style sheet used for security advisor content.
secadvcontentstyle_type=text/css
secadvcontentstyle_content:
BODY	{
	background-color:white;
	}

DIV	{
	background-color:white;
	font-family: {nsm_content_font};
	font-size:10pt;
	color: black;
	}

H1	{
 	padding-left:6px;
	line-height: 150%;

	font-family: {nsm_content_font}; 
	font-size:10pt;
	font-weight:bold;
        color:black;
	}


A	{
	font-family: {nsm_content_font};
	font-size:10pt;
	color: black;
	}

BLOCKQUOTE{

 	padding-left:0px;
	line-height: 100%;

	font-family: {nsm_content_font}; 
	font-size:10pt;
	font-weight:normal;
        color:black;
	}


B	{
 	padding-left:6px;
	font-family: {nsm_content_font}; 
	font-size:10pt;
	font-weight:bold;
        color:black;
	}

BU	{
 	padding-left:6px;
	font-family: {nsm_content_font}; 
	font-size:10pt;
	font-weight:bold;
        color:black;
	}

P	{
 	padding-left:6px;
	font-family: {nsm_content_font}; 
	font-size:10pt;
	font-weight:normal;
        color:black;
	}

P.SMALL	{
	font-size:9pt;
	}

P.TOPBORDER{
	border-top-width: 3px;
	border-color: #999999;
	border-style: solid;
	}


all.Explanationbox
	{
	padding-top:6px;
	padding-bottom:12px;
	margin-bottom:6px;
 	margin-left:6px;
	margin-right: 5%;
	border-width: 1px;
	border-color: #999999;
	border-style: solid;
	}


UL	{
	font-family: {nsm_content_font}; 
	font-size:10pt;
        color:black;
	}

UL.SPACED {
	line-height: 110%;	
	}


all.INDENT {
	   padding-left:12px;
	   }
:secadvcontentstyle_content

titlestyle_type=text/css
titlestyle_content:
all.standard {background-color:#9999CC;
           font-family: {nsm_font}; 
           color: white;}
          

.spacer  {  padding-left: 6px;
           font-family:{nsm_font_verdana}; 
           font-size:12pt;
           font-weight:bold;
           color:white;}

.TITLE  {  padding-left: 6px;
           font-family:{nsm_font_verdana}; 
           font-size:16pt;
           font-weight:bold;
           color:white;}

A:alink {color: white; text-decoration: none;}
A:link  {color: white; text-decoration: none;}
A:vlink {color: white; text-decoration: none;}
:titlestyle_content

standalonefoot_type=text/css
standalonefoot_content:
BODY {
     background-color:#CCCCCC;
     }
.BUTTONSPACE {
		padding-left: 6px;
		padding-right: 6px;
		font-family: {nsm_font_verdana};
		font-size:10pt;
		}

.BUTTONSPACEHELP {
		padding-left: 24px;
		padding-right: 0px;
		font-family: {nsm_font_verdana};
		font-size:10pt;
		}
:standalonefoot_content

standalone_type=text/css
standalone_content:
BODY.TOP {background-color: #9999CC;}

BODY.CONTENT{background-color: white;}

BODY.FOOT{background-color:#CCCCCC}

all.BUTTONSPACE {
		font-family: {nsm_font_verdana};
		font-size:10pt;
		padding-left: 6px;
		padding-right: 6px;
		}

all.BUTTONSPACEHELP {
		padding-left: 24px;
		padding-right: 0px;
		font-family: {nsm_font_verdana};
		font-size:10pt;
		}

DIV	{
	background-color:white;
	font-family: {nsm_content_font};
	font-size:10pt;
	color: black;
	}

H1	{
 	padding-top:6px;
	line-height: 100%;

	font-family: {nsm_font_verdana};
	font-size:16pt;
	font-weight:normal;
        color:white;
	}

A	{
	font-family: {nsm_font_verdana};
	font-size:10pt;
	color: black;
	}

BLOCKQUOTE{

 	padding-left:0px;
	line-height: 100%;
	font-family: {nsm_font_verdana};
	font-size:10pt;
	font-weight:normal;
        color:black;
	}

all.plain{
 	padding-left:0px;
	padding-top:0px;
	font-family: {nsm_font_verdana};
	font-size:10pt;
	font-weight:normal;
        color:black;
	}

P	{
 	padding-left:12px;
	padding-top:6px;
	font-family: {nsm_font_verdana};
	font-size:10pt;
	font-weight:normal;
        color:black;
	}

P.alert	{
	font-weight: bold;
	}


P.hialert{
	font-weight: 900;
	background-color:#FF9900;
	padding-left:20px;
	}

all.Explanationbox
	{
	padding-top:6px;
	padding-bottom:12px;
	margin-bottom:6px;
 	margin-left:6px;
	margin-right: 5%;
	border-width: 1px;
	border-color: #999999;
	border-style: solid;
	}

all.PROGRESS {
	background-color:#CCCCCC;
	margin-top:5%;
 	margin-left:15%;
	margin-right:25%;
	border-width: 2px;
	border-color: #CCCCCC;
	border-style: solid;
	}


all.PLAINBOX {
	margin-left:12px;
	border-width: 1px;
	border-color: #999999;
	border-style: solid;
	}

:standalone_content


;  Basic templates for use in generating HTML.

http_error_content:
<HTML><HEAD>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<TITLE>HTTP error %1$d - %2$s</TITLE>{disable_right_click_js}</HEAD><BODY><H1>%2$s</H1>%4$s<br><hr><!---unused %3$s ----></BODY></HTML>
:http_error_content

; In the normal header: 0=additional headers, 1=content type
http_header_template="HTTP/1.0 200 OK<psm:cr><psm:lf>%1$sContent-Type: %2$s<psm:cr><psm:lf>Connection: close<psm:cr><psm:lf><psm:cr><psm:lf>"

; Standard preamble for most HTML pages
html_start=<html><head><psm:cr><psm:lf><meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">{disable_right_click_js}</head><body bgcolor=#{$1}>
html_end=</body></html>
;
;  HTTP error templates
;

; In the error templates: 0=error number, 1=error name (or OK), 
; 2=additional header content for type, 3=description
http_error_header_template:
HTTP/1.0 %1$d %2$s<psm:cr><psm:lf>%3$sConnection: close<psm:cr><psm:lf><psm:cr><psm:lf>
:http_error_header_template

; still needed?
http_error_content_type="text/html"
; error-specific text
http_error_200_hdrs="Content-type: text/html<psm:cr><psm:lf>"
http_error_204_hdrs="Content-type: No Content<psm:cr><psm:lf>"
http_error_400_hdrs="Content-type: text/html<psm:cr><psm:lf>"
http_error_401_hdrs="WWW-Authenticate: Basic realm=\"NSM\"<psm:cr><psm:lf>Content-type: text/html<psm:cr><psm:lf>"
http_error_403_hdrs="Content-type: text/html<psm:cr><psm:lf>"
http_error_404_hdrs="Content-type: text/html<psm:cr><psm:lf>"
http_error_405_hdrs="Content-type: text/html<psm:cr><psm:lf>"
http_error_501_hdrs="Content-type: text/html<psm:cr><psm:lf>"


;#ifdef DEBUG
;
; NLS/Unicode Hello World example text (for developers only)
;

; hello_type is the content type to be used when sending the canned
; HTTP headers.
;hello_type="text/html"

;
; hello_content is the HTML template for the Hello World page (the
; same page that we sent manually from the simple Hello World
; example). Note that it contains references to two more content
; strings in the same file, "hello_title" and "hello_greeting".
; Those strings, in turn, appear directly underneath hello_content.
;
; In addition, the keyword {hello} appears below. You wouldn't have any
; real way of knowing that this is attached to a keyword handler, but
; in fact the Hello World keyword handler is attached to it. The way the
; code currently works, references such as {hello}, {hello_title}, etc.
; are looked up in the keyword handler table first. If a keyword handler
; doesn't exist, then the keyword is used to look for a string resource
; in the properties file.
;
; Hello World is no longer used, so we'll comment it instead of removing 
; it for now, but leave it in so that if we ever need to revive it, 
; we can do so easily.
;hello_content="<HTML><HEAD>\r\n<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}"><TITLE>{hello_title}</TITLE></HEAD><BODY><h1>{hello_greeting}</h1><p>If keyword handlers are working correctly, you should see 'Hello, World' on the next line just above the horizontal rule.</p><br>{hello}<hr> </BODY></HTML>"
;hello_title="Hello World (command handler demo)"
;hello_greeting="Hello, World!"

;
; End Hello World example text
;


;
; Strings used to test nls stuff (mwelch)
;
;testnls="Outer string for testnls. %2$s {testwrap one,two,three} Does 0 == %1$d? {testnls1} {testnls{testnls3}}"
;testnls1="This sentence, if it appears, means that the 'testnls1' keyword was discovered and properly expanded."
;testnls2="This sentence, if it appears, means that the 'testnls2' keyword (actually a nested recursion of 'testnls' followed by 'testnls3') was discovered and properly expanded."
;testnls3=2

; A full page test.
;testpage_type="text/html"
;testpage_hdrs=""
;testpage_content:
;<html><head>
;\r\n<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
;<title>Hi, I'm Cartman</title></head>
;<body bgcolor=white><center><h1>
;<img src="http://warp/hardcore/cartman/eric.gif" align=center>
;Cartman
;<img src="http://warp/hardcore/cartman/eric.gif" align=center>
;</h1></center>
;Please choose from the following options:
;<li><a href="show_log">Show ongoing activity log</a><br>
;<li><a href="echo">Echo the request sent by your browser</a><br>
;<li><a href="authecho">Authorization test</a><br>
;</ul><br>Enjoy.<hr>
;<address>The <a href="mailto:cartman-dev@netscape.com">cartman-dev mailing list</a></address>
;</body></html>
;:testpage_content
;#endif

;
; Utility code to submit a from using framesetes
;

formsubmit:
<script language=javascript>
function submitif()
{
  if (top.dosubmit) {
    {$1}.submit();
    return;
  }
}

function submitForm() {
  setTimeout("submitif();", 1);
}

</script>
:formsubmit

formsubmit_monitor_js:
<script language=javascript>
var dosubmit=false;
var doclose=false;

function submitform()
{
  dosubmit = true;
  window.DialogContent.submitForm();
}

function closewin()
{
  doclose = true;
  setTimeout("closeif();", 1);
}

function closeif()
{
  window.close();
}


</script>
:formsubmit_monitor_js

;
; Javascript code used to submit a form containing multiple frames.
;
formsubmit_dosubmit_js_type="text/html"
formsubmit_dosubmit_js_hdrs=""
formsubmit_dosubmit_js_content:
<script language=javascript>
top.submitform();
</script>
:formsubmit_dosubmit_js_content

;
; Utility code used to close windows from within a frame thereof.
;
windowclose_monitor_js:
<script language=javascript>
var doclose;
function closewin()
{
  doclose=true;
  setTimeout("closeif()", 100);
}
function closeif()
{
  if (doclose)
    window.close();
}
doclose=false;
</script>
:windowclose_monitor_js


;
; Javascript code used to close a keygen dialog (among others).
;
windowclose_doclose_js_type="text/html"
windowclose_doclose_js_hdrs=""
windowclose_doclose_js_content:
{windowclose_monitor_js}
<script language=javascript>
top.closewin();
</script>
:windowclose_doclose_js_content

;
; Javascript to close a given window (on error)
;
;windowclose_closethis_js_type="text/html"
;windowclose_closethis_js_hdrs=""
;windowclose_closethis_js_content:
;unused
;:windowclose_closethis_js_content

;
; The top level frameset used by the keygen dialog.
;
keygen_window_type="text/html"
keygen_window_hdrs=""
keygen_window_width=500
keygen_window_height=300
keygen_window_content:
{windowclose_monitor_js}
<frameset border=0 rows=60,*,1,1>
<frame src=get?baseRef=kgtop&target=%1$d>
<frame src=get?baseRef=kgmain&target=%1$d>
<frame src=resmonitor?type=keygen&baseRef=windowclose_doclose_js&target=%1$d>
<frame src=about:blank>
</frameset>
:keygen_window_content

; Header for the keygen dialog.
kgtop_type=text/html
kgtop_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=titlestyle">
{disable_right_click_js}</head>
<body CLASS=standard alink="#FFFFFF" fgcolor=#FFFFFF bgcolor=#9999CC>
<DIV class=spacer><br></DIV>
<DIV class=TITLE>{text_keygen_title}</DIV>
</body>
</html>
:kgtop_content
; The content in the main portion of the keygen progress bar.
kgmain_type="text/html"
kgmain_hdrs=""
kgmain_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}</head>
<script>
var pos = 0;
var dir = 1;
var blue;
var trans;

function update()
{
  if (typeof(document.images[0]) != 'undefined') {
  if (dir > 0) {
    document.images[pos + 1].src = trans.src;
    document.images[pos + 5].src = blue.src;
  } else {
    document.images[pos].src = blue.src;
    document.images[pos + 4].src = trans.src;
  }
  pos += dir;
  if (pos == 16) dir = -1;
  if (pos == 0) dir = 1;
  setTimeout("update()", 150);
 }
}

blue = new Image(20, 12);
trans = new Image(20, 12);
blue.src = "get?baseRef=blue_gif";
trans.src = "get?baseRef=trans_gif";

//setTimeout("update()", 150);
</script>
<body text="#000000" bgcolor="#FFFFFF">
<table cellspacing=0 cellpadding=0 cols=2 width="100%%" hspace="0" vspace="0">
<tr>
<td width="20"></td>
<td><div><b><font face="{nsm_font}" size=+2>
</font></b></td></td>
</tr>
</table>
{text_keygen}
<center><p>
<form><div><input type='button' value=' {text_cancel} '
onclick=top.frames[2].location="shutdown?type=keygen&baseRef=windowclose_doclose_js&target=%1$d">
</div></form>
</center>
</body>
</html>
:kgmain_content

; 
; -----------------------------------------------
; HTML framework
; -----------------------------------------------

;
; Top pane of security advisor
;

; HTML skeleton for a tab.
; {toptabskel <tabname>,<pic on left side of tab>,<pic on right side of tab>,
;          <A link, if this is a link tab, empty otherwise>,
;          <"</A>" if this is a link, empty otherwise>, <background color>}
toptabskel:
<td><DIV CLASS=TAB><img SRC="get?baseRef={$2}&target=%1$d" BORDER=0 height=21 width=13></DIV></td>

<td NOWRAP BGCOLOR="#{$6}"><DIV CLASS=TAB><b><font size=-1>{$4}{$1}{$5}</font></b></div></td>

<td><img SRC="get?baseRef={$3}" BORDER=0 height=21 width=16></td>
:toptabskel
select_top_tab={toptabskel {$2},lgLeftTab,lgRightTab,,,CCCCCC}
link_top_tab={toptabskel {$2},dgLeftTab,dgRightTab,<a href="get?baseRef=top{$1}&target=%1$d" target="top">,</a>,999999}

; Each tab page has a frame number (so that the left pane can be
; synchronized), and needs to specify which of the top-level tabs
; are links, vs. which is selected.
top1_type=text/html
top1_content={topframework 1,select_top_tab,link_top_tab,link_top_tab,link_top_tab}
top2_type=text/html
top2_content={topframework 2,link_top_tab,select_top_tab,link_top_tab,link_top_tab}
top3_type=text/html
top3_content={topframework 3,link_top_tab,link_top_tab,select_top_tab,link_top_tab}
top4_type=text/html
top4_content={topframework 4,link_top_tab,link_top_tab,link_top_tab,select_top_tab}

;
; topframework <framenumber>,<tab1type>,<tab2type>,<tab3type>,<tab4type>
; The tab types can be "select_top_tab" (dark, clicked) or "link_top_tab"
; (light, with a link on the name)
;
topframework:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvtopstyle">
{disable_right_click_js}</head>
<script language=javascript>
function loadpanes()
{
    window.open('get?baseRef=left{$1}-1&target=%1$d','left');
//    window.parent.open('get?baseRef=foot&parent=%1$d&target=%1$d','foot');
}
</script>
<body CLASS=standard alink="#FFFFFF">
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" BGCOLOR="#9999CC">
<tr>
  <td><div>
     <table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" >
       <tr>
         <td><DIV CLASS=TITLE>{text_fullproductname}</DIV></td>

         <td>
           <div align=right><img SRC="get?baseRef=netscapegif" BORDER=0 height=53 width=53></div>
         </td>
       </tr>
     </table>

     <table BORDER=0 CELLSPACING=0 CELLPADDING=0 >
       <tr>
         <td><spacer type="block" width="12" height="21"></td>
           <div>{{$2} 1,{text_information}}</div>
           <div>{{$3} 2,{text_applications}}</div>
           <div>{{$4} 3,{text_certificates}}</div>
           <div>{{$5} 4,{text_advanced}}</div>
         </td>
       </tr>
     </table>
  </div></td>
</tr>
</table>
<script language=javascript>
loadpanes();
</script>
</body>
</html>
:topframework
;
; Framework for tabs on left side of security advisor.
;
leftframework:
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvleftstyle">
{disable_right_click_js}</head>
<body bgcolor="#CCCCCC" alink="#CCCCFF">
<table width="400px" cellspacing="6px">
  {{$1}}
</table></body>
<script language=javascript>
window.open('get?baseRef={$2}&target=%1$d','content');
</script>
</html>
:leftframework

; {left_tabskel <name>,<linkstart>,<linkend>,<color>}
left_tabskel=<tr><td bgcolor="#{$4}"><div>{$2}{$1}{$3}</div></td></tr>
select_left_tab={left_tabskel {$1},<p>,</p>,FFFFFF}
link_left_tab={left_tabskel {$1},<a href="get?baseRef=left{$2}-{$3}&target=%1$d" target="left">,</a>,999999}

;
; Information pane
;
left1-1tabs={select_left_tab {text_selected}} {link_left_tab {text_about},1,2}
left1-2tabs={link_left_tab {text_selected},1,1} {select_left_tab {text_about}}

left1-1_type=text/html
left1-1_content={leftframework left1-1tabs,info_selected}
left1-2_type=text/html
left1-2_content={leftframework left1-2tabs,info_about}

;
; Applications pane
;
left2-1tabs:
{select_left_tab {text_navigator}}
{link_left_tab {text_messenger},2,2}
{link_left_tab {text_javajs},2,3}
:left2-1tabs
left2-2tabs:
{link_left_tab {text_navigator},2,1}
{select_left_tab {text_messenger}}
{link_left_tab {text_javajs},2,3}
:left2-2tabs
left2-3tabs:
{link_left_tab {text_navigator},2,1}
{link_left_tab {text_messenger},2,2}
{select_left_tab {text_javajs}}
:left2-3tabs

; Top level pages
left2-1_type=text/html
left2-1_content={leftframework left2-1tabs,apps_navigator}
left2-2_type=text/html
left2-2_content={leftframework left2-2tabs,apps_messenger}
left2-3_type=text/html
left2-3_content={leftframework left2-3tabs,apps_javajs}

;
; Certificates pane
;
left3-1tabs:
{select_left_tab {text_mine},3,1}
{link_left_tab {text_others},3,2}
{link_left_tab {text_websites},3,3}
{link_left_tab {text_authorities},3,4}
:left3-1tabs
left3-2tabs:
{link_left_tab {text_mine},3,1}
{select_left_tab {text_others},3,2}
{link_left_tab {text_websites},3,3}
{link_left_tab {text_authorities},3,4}
:left3-2tabs
left3-3tabs:
{link_left_tab {text_mine},3,1}
{link_left_tab {text_others},3,2}
{select_left_tab {text_websites},3,3}
{link_left_tab {text_authorities},3,4}
:left3-3tabs
left3-4tabs:
{link_left_tab {text_mine},3,1}
{link_left_tab {text_others},3,2}
{link_left_tab {text_websites},3,3}
{select_left_tab {text_authorities},3,4}
:left3-4tabs

; Top level pages
left3-1_type=text/html
left3-1_content={leftframework left3-1tabs,cert_mine}
left3-2_type=text/html
left3-2_content={leftframework left3-2tabs,cert_others}
left3-3_type=text/html
left3-3_content={leftframework left3-3tabs,cert_websites}
left3-4_type=text/html
left3-4_content={leftframework left3-4tabs,cert_authorities}

;
; Advanced pane
;
left4-1tabs:
{select_left_tab {text_modules},4,1}
{link_left_tab {text_options},4,2}
:left4-1tabs
left4-2tabs:
{link_left_tab {text_modules},4,1}
{select_left_tab {text_options},4,2}
:left4-2tabs

left4-1_type=text/html
left4-1_content={leftframework left4-1tabs,adv_modules}
left4-2_type=text/html
left4-2_content={leftframework left4-2tabs,adv_options}

;
; Incidental frames needed by security advisor
;
blank_type=text/html
blank_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<title>{untitle_doc}</title>
{disable_right_click_js}</head>

<body bgcolor="#CCCCCC">
</body>
</html>
:blank_content

foot_type=text/html
foot_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvfootstyle">
<title>{untitle_doc}</title>
{disable_right_click_js}</head>

<body bgcolor="#CCCCCC" link="#6666CC" vlink="#6666CC" alink="#333399">
<table border="0" width="100%%" cellspacing="0" cellpadding="0">
  <tr>
    <td>
      <div align="RIGHT">
        <spacer type="block" width="12" height="12"> 
      </div>
    </td>
  </tr>
  <tr>
    <td>
    {formsubmit document.forms[0]}
      <form method="get" action="formsubmit_handler" onSubmit="return top.setPrefsBeforeSubmit(this);">
      {prefs_submit}
      <input type=hidden name="baseRef" value="free_target_page">
      <input type=hidden name="formName" value="prefs_submit_form">
      <input type=hidden name="target" value="%1$d">
        <div align="RIGHT"><input type="SUBMIT" name="OK" value="{text_close}" width="72"><spacer type="horizontal" size="9"><input type="button" name="do_help" value="{text_help}" onclick="parent.OpenHelp()" width="72"><spacer type="horizontal" size="14"></div>
      </form>
    </td>
  </tr>
</table>
</body>
</html>
:foot_content

free_target_page_type=text/html
free_target_page_content:
<html>
{free_target}
{disable_right_click_js}
<script>
top.closewin();
</script>
</html>
:free_target_page_content

;
; Preference-related javascript and stuff
;
; prefs_list_js: embedded at the top level of Security Advisor
;
prefs_list_js:
<script language=javascript>
// retrieve data from PSM
{get_pref_list}

var prefix = '<input type=hidden name="';
var suffix = '">\\n';

function writePrefInput(d, s)
{
    d.write(prefix + s + suffix);
}

// creates the hidden buttons that are used to submit pref changes
function makePrefForm(d)
{
    writePrefInput(d, 'enable_ssl2');
    writePrefInput(d, 'enable_ssl3');
    writePrefInput(d, 'client_auth_auto_select');
    writePrefInput(d, 'default_email_cert');
    writePrefInput(d, 'warn_entering_secure');
    writePrefInput(d, 'warn_leaving_secure');
    writePrefInput(d, 'warn_viewing_mixed');
    writePrefInput(d, 'warn_submit_insecure');
    writePrefInput(d, 'mail_encrypt_outgoing_mail');
    writePrefInput(d, 'mail_crypto_sign_outgoing_mail');
    writePrefInput(d, 'mail_crypto_sign_outgoing_news');
}

// creates the HTML string for client auth prefs
var autoSelectStr = {apps_personal_cert_auto};
var manualSelectStr = {apps_personal_cert_manual};
function makeClientAuthPref(d)
{
    d.write('<tr><td><div><input type=radio name="client_auth_auto_select" value="true" ');
    if (client_auth_auto_select == true) {
        d.write('checked ');
    }
    d.writeln('onClick="top.client_auth_auto_select = checked;"></td><td><p>' + autoSelectStr + '</p></td></tr>');

    d.write('<tr><td><div><input type=radio name="client_auth_auto_select" value="false" ');
    if (client_auth_auto_select == false) {
        d.write('checked ');
    }
    d.writeln('onClick="top.client_auth_auto_select = !checked;"></td><td><p>' + manualSelectStr + '</p></td></tr>');
}

// creates the HTML string for SSL cipher family prefs
var enableSSL2Str = {adv_enable_SSL2};
var enableSSL3Str = {adv_enable_SSL3};
function makeSSLCipherPref(d)
{
    d.write('<tr><td><input type=checkbox name="enable_ssl2" value="true" ');
    if (enable_ssl2 == true) {
        d.write('checked ');
    }
    d.writeln('onClick="top.enable_ssl2 = checked;"></td><td><p>' + enableSSL2Str + '</p></td></tr>');

    d.write('<tr><td><input type=checkbox name="enable_ssl3" value="true" ');
    if (enable_ssl3 == true) {
        d.write('checked ');
    }
    d.writeln('onClick="top.enable_ssl3 = checked;"></td><td><p>' + enableSSL3Str + '</p></td></tr>');
}

// these functions create the HTML strings for various navigator & messenger
// preferences
function makeBoolPrefHTML(d, nm, vrbl)
{
    d.write('<td><input type="checkbox" name="' + nm + '" value="true" ');
    if (vrbl == true) {
        d.write('checked ');
    }
    d.write('onClick="top.' + nm + ' = checked;"></td>');
}

// makes the default email cert selected
function selectDefaultEmailCert(s)
{
    s.selectedIndex = 0;
    if (s.length == 1) {
        // if there is only one cert, make sure it is the default email
	// cert and that the cache is updated
	// this partly fixes the PKCS12 import problem
        default_email_cert = new String(s.options[0].value);
    }

    for (i = 0; i < s.length; i++) {
        if (s.options[i].value == default_email_cert) {
	    s.selectedIndex = i;
	    break;
        }
    }
    if (i == s.length) {
        // for some reason if the prefs do not reflect the cert db state
	// set the first one as our default email cert
	// this fixes the cert db-prefs mismatch problem
	default_email_cert = new String(s.options[0].value);
	s.selectedIndex = 0;
    }
}

// sets the submitted values before closing the Security Advisor
function setPrefsBeforeSubmit(f)
{
    f.enable_ssl2.value = enable_ssl2;
    f.enable_ssl3.value = enable_ssl3;
    f.client_auth_auto_select.value = client_auth_auto_select;
    f.default_email_cert.value = new String(default_email_cert);
    f.warn_entering_secure.value = warn_entering_secure;
    f.warn_leaving_secure.value = warn_leaving_secure;
    f.warn_viewing_mixed.value = warn_viewing_mixed;
    f.warn_submit_insecure.value = warn_submit_insecure;
    f.mail_encrypt_outgoing_mail.value = mail_encrypt_outgoing_mail;
    f.mail_crypto_sign_outgoing_mail.value = mail_crypto_sign_outgoing_mail;
    f.mail_crypto_sign_outgoing_news.value = mail_crypto_sign_outgoing_news;

    return true; // to submit the form
}
</script>
:prefs_list_js

;
; prefs_submit: a hidden form that is submitted when the Security Advisor is
;               closed
;
prefs_submit:
<script language=javascript>
top.makePrefForm(document);
</script>
:prefs_submit

;
; ### sigh, the inclusion of an empty function of storeCertInfo() was needed 
;     to get around the problem due to cert_list_item calling storeCertInfo() 
;     regardless of cert list type
;
email_cert_list_prefix:
<script language=javascript>
function storeCertInfo(keyid, nick, email, subject, start, end, issuer)
{
    return;
}
document.write('<select name="email_cert_list" onChange="top.default_email_cert = options[selectedIndex].value;">');
:email_cert_list_prefix

email_cert_list_suffix:
document.write('</select>');
</script>
:email_cert_list_suffix

;
; Help-related javascript macros
;
; Online help popup window dimensions
help_width=600
help_height=400

;
; help_monitor_js: include this javascript macro in your top level document
;
help_monitor_js:
<script language=javascript>
var helpURL = '';
function SetHelpURL(a)
{
    helpURL = a;
}

function ResetHelpURL()
{
    SetHelpURL('help.htm#1026014');
}

function OpenHelp()
{
    window.open(helpURL,'psm_help','width={help_width},height={help_height},status=no,toolbar=no,menubar=no,scrollbars,screenX=50,screenY=100');
    return false; // don't submit any forms
}

ResetHelpURL();
</script>
:help_monitor_js

;
; sa_help_monitor_js: include this javascript macro in your top level document
;
selected_item_help_monitor_js:
<script language=javascript>

var sa_message_sign_status = 0;
var sa_message_encrypt_status = 0;
var sa_compose_sign_status = 0;
var sa_compose_encrypt_status = 0;

function SetMessageHelp()
{
	if (sa_message_encrypt_status == 2) {
		SetHelpURL('help.htm#1029380');
	} else if (sa_message_sign_status == 0 && sa_message_encrypt_status == 0) {
		SetHelpURL('help.htm#1029195');
	} else if (sa_message_sign_status == 0 && sa_message_encrypt_status == 1) {
		SetHelpURL('help.htm#1029556');
	} else if (sa_message_sign_status == 1 && sa_message_encrypt_status == 0) {
		SetHelpURL('help.htm#1031844');
	} else if (sa_message_sign_status == 1 && sa_message_encrypt_status == 1) {
		SetHelpURL('help.htm#1029556');
	} if (sa_message_sign_status == 2 && sa_message_encrypt_status == 0) {
		SetHelpURL('help.htm#1031860');
	} else if (sa_message_sign_status == 2 && sa_message_encrypt_status == 1) {
		SetHelpURL('help.htm#1032052');
	}
}

function SetComposeHelp()
{
	if (sa_compose_sign_status == 0 && sa_compose_encrypt_status == 0) {
		SetHelpURL('help.htm#1050137');
	} else if (sa_compose_sign_status == 0 && sa_compose_encrypt_status == 1) {
		SetHelpURL('help.htm#1050148');
	} else if (sa_compose_sign_status == 0 && sa_compose_encrypt_status == 2) {
		SetHelpURL('help.htm#1050175');
	} else if (sa_compose_sign_status == 1 && sa_compose_encrypt_status == 0) {
		SetHelpURL('help.htm#1050216');
	} else if (sa_compose_sign_status == 1 && sa_compose_encrypt_status == 1) {
		SetHelpURL('help.htm#1030109');
	} else if (sa_compose_sign_status == 1 && sa_compose_encrypt_status == 2) {
		SetHelpURL('help.htm#1030082');
	} if (sa_compose_sign_status == 2 && sa_compose_encrypt_status == 0) {
		SetHelpURL('help.htm#1050244');
	} else if (sa_compose_sign_status == 2 && sa_compose_encrypt_status == 1) {
		SetHelpURL('help.htm#1034785');
	} else if (sa_compose_sign_status == 2 && sa_compose_encrypt_status == 2) {
		SetHelpURL('help.htm#1030236');
	}
}
</script>
:selected_item_help_monitor_js

;
; Top level frameset for the security advisor
;

secadvisor_type=text/html
secadvisor_hdrs=
secadvisor_width=715
secadvisor_height=545
secadvisor_content:
<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
   <title>Personal Security Manager</title>
{help_monitor_js}
{selected_item_help_monitor_js}
{formsubmit_monitor_js}
{prefs_list_js}
{disable_right_click_js}
<frameset rows="95,1*,60" cols="*" border="0" frameborder="NO">
<frame src="get?baseRef=top1&target=%1$d" name="top" scrolling="NO" marginwidth="0" marginheight="0">
<frameset cols="140,1*,16" rows="*">
<frame src="get?baseRef=blank" name="left" scrolling="NO" marginwidth="0" marginheight="0">
<frame src="get?baseRef=info_noinfo&target=%1$d" name="content" scrolling="AUTO" marginwidth="12" marginheight="12">
<frame src="get?baseRef=blank" name="blank" scrolling="NO" noresize marginwidth="0" marginheight="0">
</frameset>
<frame src="get?baseRef=foot&target=%1$d" name="foot" scrolling="NO" marginwidth="0" marginheight="0">
</frameset>
<noframes>
</head>
</noframes>
</html>
:secadvisor_content

;
; Info content panes
;
info_selected_type=text/html
info_selected_content:
{sa_selected_item}
:info_selected_content

info_noinfo_type=text/html
info_noinfo_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
{disable_right_click_js}
</head>
<body bgcolor=#FFFFFF>
</body>
</html>
:info_noinfo_content

info_about_type=text/html
info_about_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetHelpURL('help.htm#1044151')">
<p>{info_about_intro}</p>

<UL CLASS=SPACED>
    <LI><B>{text_information}.</B>{info_information}</LI>
    <LI><B>{text_applications}.</B>{info_applications}</LI>
    <LI><B>{text_certificates}.</B>{info_certificates}</LI>
    <LI><B>{text_advanced}.</B>{info_advanced}</LI>
</UL>
<P>{info_about_more}</P>
</body>
</html>
:info_about_content

;
; Applications content panes
;
apps_navigator_type=text/html
apps_navigator_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>

<body bgcolor="#FFFFFF" alink="#333399" onLoad="top.SetHelpURL('help.htm#1030967')">
<FORM>
<P>{apps_nav_intro}</P>

<DIV CLASS=Explanationbox>
<p>{apps_nav_warn}</P>
<table BORDER=0 CELLSPACING=0>

<tr>
<script language=javascript>
top.makeBoolPrefHTML(document, 'warn_entering_secure', top.warn_entering_secure);
</script>
<td><p>{apps_warn_enter_secure}</p></td>
</tr>
<tr>
<script language=javascript>
top.makeBoolPrefHTML(document, 'warn_leaving_secure', top.warn_leaving_secure);
</script>
<td><p>{apps_warn_leave_secure}</p></td>
</tr>
<tr>
<script language=javascript>
top.makeBoolPrefHTML(document, 'warn_viewing_mixed', top.warn_viewing_mixed);
</script>
<td><p>{apps_warn_view_mixed}</p></td>
</tr>
<tr>
<script language=javascript>
top.makeBoolPrefHTML(document, 'warn_submit_insecure', top.warn_submit_insecure);
</script>
<td><p>{apps_warn_post_insecure}</p></td>
</tr>
</table>
</DIV>

<DIV CLASS=Explanationbox>
<p>{apps_personal_cert_select}
</p>
<DIV CLASS=INDENT>
<table BORDER=0 CELLSPACING=0>
<script language=javascript>
top.makeClientAuthPref(document);
</script>
</table>
</DIV>
</DIV>
</form>
</body>
</html>
:apps_navigator_content

apps_messenger_type=text/html
apps_messenger_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>

<body bgcolor="#FFFFFF" alink="#333399" onLoad="top.SetHelpURL('help.htm#1031452')">
<FORM>
<P>{apps_msg_intro}</P>
<DIV CLASS=Explanationbox>
<p>{apps_msg_options}</P>
<table BORDER=0 CELLSPACING=0>

<tr>
<script language=javascript>
top.makeBoolPrefHTML(document, 'mail_encrypt_outgoing_mail', top.mail_encrypt_outgoing_mail);
</script>
<td><p>{apps_msg_encrypt}</p></td>
</tr>
<tr>
<script language=javascript>
top.makeBoolPrefHTML(document, 'mail_crypto_sign_outgoing_mail', top.mail_crypto_sign_outgoing_mail);
</script>
<td><p>{apps_msg_sign}</p></td>
</tr>
<tr>
<script language=javascript>
top.makeBoolPrefHTML(document, 'mail_crypto_sign_outgoing_news', top.mail_crypto_sign_outgoing_news);
</script>
<td><p>{apps_news_sign}</p></td>
</tr>

</table>
</DIV>

<DIV CLASS=Explanationbox>
<p>{apps_set_mail_cert}</p>
<DIV CLASS=INDENT>
{_certlist nick,EmailSigner,email_cert_list_prefix,email_cert_list_suffix}
<script language=javascript>
top.selectDefaultEmailCert(document.forms[0].email_cert_list);
</script>

</DIV>
<!-- end of the list -->
<p>{apps_mail_cert_more}</P>
</DIV>
</form>
</body>
</html>
:apps_messenger_content

; principal_prefix:
; <SELECT NAME="java_principals" SIZE=8 WIDTH=400>
; :principal_prefix
; principal_wrapper:
; <OPTION VALUE="%1$s">%1$s
; :principal_wrapper
; principal_suffix="</SELECT>"

apps_javajs_type=text/html
apps_javajs_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>

<body bgcolor="#FFFFFF" alink="#333399" onLoad="parent.SetHelpURL('help.htm#1031152')">
<form>
<P>{apps_javajs_intro1}</P>
<P>{apps_javajs_intro2}</P>
<DIV CLASS=Explanationbox>
<DIV CLASS=INDENT>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%">
<tr valign=top>
<td>
<!--
{_java_principals principal_prefix,principal_wrapper,principal_suffix}
-->
<DIV><input type="button" value="{text_remove_privs}" width="150" onClick="window.open('get?baseRef=remove_privileges','popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')"></DIV>
</td>

<td>
<!-- commented out

<table COLS=1 WIDTH="100%">
<tr VALIGN="TOP">
<td ALIGN="LEFT"><input type="button" value="{text_view}" width="80" onClick=""></td>
</tr>
<tr><td align="LEFT">
<input type="button" value="{text_privileges}" width="80" onClick="">
</td></tr></table>
-->
</td></tr>

<tr>
<!--
<td><input type="button" value="  {text_delete}  " onClick=""></td>
-->

<td></td>
</tr>
</table>
</DIV>
<p CLASS=INDENT>
{apps_javajs_more}
</P>

</DIV>
</FORM>
</body>
</html>
:apps_javajs_content

remove_privileges_type="text/html"
remove_privileges_hdrs=""
remove_privileges_width=520
remove_privileges_height=350
remove_privileges_content:
{frame_set remove_privileges,windowclose}
:remove_privileges_content

remove_privileges_top_type="text/html"
remove_privileges_top_hdrs=""
remove_privileges_top_content:
{top_frame remove_privs_title,alert1gif,35,35}
:remove_privileges_top_content

remove_privileges_buttons_type="text/html"
remove_privileges_buttons_hdrs=""
remove_privileges_buttons_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body class=foot alink="#333399" onLoad="parent.SetHelpURL('help.htm#1053663')">
{ok_cancel_help remove_privileges,windowclose_doclose_js,remove_privileges}
</body>
</html>
:remove_privileges_buttons_content

remove_privileges_main_type="text/html"
remove_privileges_main_hdrs=""
remove_privileges_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
<body class=content alink="#FF0000">
<p>{remove_privs_warning}</p>
<br>
<p>{remove_privs_more_warning}</p>
</body>
</html>
:remove_privileges_main_content

;
; Certificates content panes (todo)
;
cert_directory:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
{disable_right_click_js}
</head>
<body bgcolor=#FFFFFF>
<!-- bruces: Put LDAP screens here -->
</body>
</html>
:cert_directory

;
; Advanced content panes
;
adv_modules=
adv_options_type=text/html
adv_options_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>

<body bgcolor="#FFFFFF" alink="#333399"
      onLoad="parent.SetHelpURL('help.htm#1036164');">
<FORM>
<P>{adv_options_intro}</P>
<DIV CLASS=Explanationbox>
<p>{adv_options_SSL}</p>
<table BORDER=0 CELLSPACING=0>
<script language=javascript>
top.makeSSLCipherPref(document);
</script>

<!-- not yet implemented
<tr>
<td><input type="checkbox" name="checkbox3" value="checkbox" checked></td>
<td><p>{adv_enable_TLS}</p></td>
</tr>
-->

</table>
</DIV>

<DIV CLASS=Explanationbox>
<p>{adv_options_revoke}</p>
<table BORDER=0 CELLSPACING=0>

<tr>
<td COLSPAN="3"><div><input type="button" value="{text_ocsp_settings}" onClick="window.open('get?baseRef=verification_setup&target=%1$d','popup','width=600,height=400,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')">
</div></td>
</tr>

</table>
</DIV>
</FORM>
</body>
</html>
:adv_options_content

;
; No info page
;
sa_noinfo:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetHelpURL('help.htm#1044151')">
</body>
:sa_noinfo

;
; Navigator no security pages
;
sa_navigator_no_sec:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetHelpURL('help.htm#1026171')">

<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>
<td><H1>{web_site_ident_not_verified}</H1>
<p>
{web_site_auth_not_supported}
</p>
<p>
{web_site_origin_unverified}
</p>
</td>
</tr>
</table>

<hr SIZE=3 NOSHADE WIDTH="100%%">

<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>
<td><H1>{connection_not_encrypted}</H1>

<P>
{web_site_no_encryption}
</P>
<P>
{web_site_info_can_be_seen}
</P>
</td>
</tr>
</TABLE>
</body>
</html>
:sa_navigator_no_sec

sa_navigator_ssl:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetHelpURL('help.htm#1028485')">

<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>
<td><H1>{web_site_ident_verified}</H1>
<p>
{web_site_supports_encr_verified_by}
</p>
<table border=0>
<tr valign="CENTER">
<td width="80px"><div>
<form><input type="button" value= "{text_view}" width="72" onClick="window.open('cert?baseRef=cert_action&action=cert_view&target=%3$d&certresource=%4$d&formName=selected_item','popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')">
</div></td>
<td>
<p>
{view_verifier}
</p>
</form>
</td>
</tr>
</table>
</td></tr></table>

<hr SIZE=3 NOSHADE WIDTH="100%%">

<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>
<td><H1>{connection_encrypted}</H1>

<P>
{page_encrypted_over_internet}
</p>
<p>
{encrypted_difficult_to_see}
</P>
</td>
</tr>
</TABLE>
</body>
</html>
:sa_navigator_ssl

sa_navigator_ssl_bad_issuer:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
<SCRIPT LANGUAGE="JavaScript">
{pop_up_alert}
function EditIssuer(issuer, url,popup, size) 
{
	if (issuer == 0) {
		PopUpAlert("{issuer_does_not_exist}");
	} else {
		window.open(url, popup, size);
	}
}
</SCRIPT>
</head>
<body onLoad="parent.SetHelpURL('help.htm#1029056')">
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>
<td><H1>{web_site_conditional_verify}</H1>
<p>
{web_site_auth_supported}  {pre_explanation_text}
</p>
<UL>
<LI>
{web_site_verifier_untrusted}
</LI>
</UL>

<table border=0>
<tr valign="CENTER">
<td width="80px">
<form><input type="button" value= "{text_view}" width="72" onClick="window.open('cert?baseRef=cert_action&action=cert_view&target=%3$d&certresource=%4$d&formName=selected_item','popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')">
</td>
<td>
<p>
{view_verifier_cert}
</p>
</td></tr>
<tr valign="CENTER">
<td width="80px">
<form><input type="button" value= "{text_edit}" width="72" onClick="EditIssuer(%5$d, 'cert?baseRef=cert_action&action=cert_edit&target=%3$d&certresource=%4$d&formName=selected_item','popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')">
</td>
<td>
<p>
{edit_trust_for_this_ca}
</p>
</form>
</td>
</tr>
</table>
</td></tr></table>
<hr SIZE=3 NOSHADE WIDTH="100%%">
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>
<td><H1>{conection_encrypted_2}
</H1>
<P>
{page_encrypted_before_transmission}
</p>
<p>
{encryption_makes_viewing_difficult}
</P>
</td>
</tr>
</TABLE>
</body>
</html>
:sa_navigator_ssl_bad_issuer

sa_navigator_ssl_unknown_issuer:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetHelpURL('help.htm#1029056')">
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>
<td><H1>{web_site_conditional_verify}</H1>
<p>
{web_site_auth_supported} {pre_explanation_text}
</p>

<UL>
<LI>
{web_site_verifier_untrusted}
</UL>

<table border=0>
<tr valign="CENTER">
<td width="80px">
<form><input type="button" value= "{text_view}" width="72" onClick="window.open('cert?baseRef=cert_action&action=cert_view&target=%3$d&certresource=%4$d&formName=selected_item','popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')">
</td>
<td>
<p>
{view_verifier}
</p>
</td></tr></table>
</td></tr></table>
<hr SIZE=3 NOSHADE WIDTH="100%%">
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>
<td><H1>{connection_encrypted}
</H1>
<P>
{page_encrypted_over_internet}
</p>
<p>
{encrypted_difficult_to_see}
</P>
</td>
</tr>
</TABLE>
</body>
</html>
:sa_navigator_ssl_unknown_issuer

sa_navigator_ssl_bad_cert_domain:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetHelpURL('help.htm#1029056')">
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>
<td><H1>{web_site_conditional_verify}</H1>
<p>
{web_site_auth_supported} {pre_explanation_text}
</p>

<UL>
<LI>
{mismatch_url_warning}
</LI>
</UL>
</td>
</tr>
</table>

<hr SIZE=3 NOSHADE WIDTH="100%%">
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>
<td><H1>{connection_encrypted3}
</H1>
<P>
{page_encrypted_over_internet}
</p>
<p>
{encrypted_difficult_to_see}
</P>
</td>
</tr>
</TABLE>
</body>
</html>
:sa_navigator_ssl_bad_cert_domain

sa_navigator_ssl_unknown_error:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetHelpURL('help.htm#1029056')">
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>
<td><H1>{web_site_conditional_verify}</H1>
<p>
{web_site_auth_supported} {pre_explanation_text}
</p>

<UL>
<LI>
{web_site_verifier_unknown}
</LI>
</UL>

<table border=0>
<tr valign="CENTER">
<td width="80px">
<form><input type="button" value= "{text_view}" width="72" onClick="window.open('cert?baseRef=cert_action&action=cert_view&target=%2$d&certresource=%3$d&formName=selected_item','popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')">
</td>
<td>
<p>
{view_verifier_cert}
</p>
</td></tr>
</form>
</table>
</td></tr></table>
<hr SIZE=3 NOSHADE WIDTH="100%%">
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>
<td><H1>{connection_encrypted4}
</H1>
<P>
{page_encrypted_before_transmission}
</p>
<p>
{encryption_makes_viewing_difficult}
</P>
</td>
</tr>
</TABLE>
</body>
</html>
:sa_navigator_ssl_unknown_error

sa_message_not_signed:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetMessageHelp()">
<script language=javascript>
parent.sa_message_sign_status = 0;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>
<td><H1>{message_no_signature}</H1>

<P>
{message_contains_no_sig}
</P>

<p>
{no_signature_warn}
</P>
</td>
</tr>
</TABLE>

<hr SIZE=3 NOSHADE WIDTH="100%%">
:sa_message_not_signed

sa_message_not_encrypted:
<script language=javascript>
parent.sa_message_encrypt_status = 0;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>
<td><H1>{message_not_encrypted}</H1>
<p>
{message_not_encr_before_sent}
</p>
<p>
{unencrypted_info_can_be_seen}
</p>

</td></tr></table>
</body>
</html>
:sa_message_not_encrypted

sa_message_signed:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetMessageHelp()">
<script language=javascript>
parent.sa_message_sign_status = 1;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>
<td><H1>{message_is_signed}</H1>

<P>
{message_includes_signature}
</p> 
<p>
{signer_cert_added_to_db}
</p>

<table CELLSPACING=0 CELLPADDING=2 border=0>
<tr valign="CENTER">
<td width="80px">
<form>
<input type="button" value= "{text_view}" width="72" onClick="window.open('cert?baseRef=cert_action&action=cert_view&target=%2$d&certresource=%3$d&formName=selected_item','popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')">
</td>

<td>
<p>
{view_message_validator_cert}
</p>
</td>
</tr>
<tr valign="CENTER">
<td>
<input type="button" value="{text_my_cert}" onClick="window.top.open('{get_new_cert_url}/')" width="72" >
</td>
<td><p>
{get_your_own_cert}
</p>
</form>
</td>
</tr>
</table>

</td>
</tr>
</TABLE>

<hr SIZE=3 NOSHADE WIDTH="100%%">
:sa_message_signed

sa_message_encrypted:
<script language=javascript>
parent.sa_message_encrypt_status = 1;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{message_is_encrypted}
</H1>
<p>
{message_encrypted_before_sent}
</p>
<p>
{encryption_makes_difficut_for_other_people}
</p>
</td>
</tr>
</table>
</body>
</html>
:sa_message_encrypted

sa_message_signed_bad_signature:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetMessageHelp()">
<script language=javascript>
parent.sa_message_sign_status = 2;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>
{digital_signature_not_valid}
</H1>

<P>
{invalid_digital_signature_because}
</p>
<DIV CLASS=Explanationbox>

<UL><LI>
{signature_does_not_match_content}
</LI></UL>
<BLOCKQUOTE>
{do_not_trust_until_sender_verifies}
</BLOCKQUOTE>
</DIV>
</td>
</tr>
</TABLE>

<hr SIZE=3 NOSHADE WIDTH="100%%">
:sa_message_signed_bad_signature

sa_message_signed_expired_signing_cert:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetMessageHelp()">
<script language=javascript>
parent.sa_message_sign_status = 2;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{digital_signature_not_valid}</H1>

<P>{invalid_digital_signature_because}</p>
<DIV CLASS=Explanationbox>

<UL><LI>
{signing_cert_is_expired}
</LI></UL>
<BLOCKQUOTE>
{may_be_caused_incorrect_clock}
</BLOCKQUOTE>
</DIV>
</td>
</tr>
</TABLE>

<hr SIZE=3 NOSHADE WIDTH="100%%">
:sa_message_signed_expired_signing_cert

sa_message_signed_revoked_signing_cert:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetMessageHelp()">
<script language=javascript>
parent.sa_message_sign_status = 2;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{digital_signature_not_valid}</H1>

<P>{invalid_digital_signature_because}</p>
<DIV CLASS=Explanationbox>

<UL><LI>
{signing_certificate_revoked}
</LI></UL>
<BLOCKQUOTE>
{do_not_trust_until_sender_verifies}
</BLOCKQUOTE>    
</DIV>
</td>
</tr>
</TABLE>

<hr SIZE=3 NOSHADE WIDTH="100%%">
:sa_message_signed_revoked_signing_cert

sa_message_signed_unknown_issuer:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetMessageHelp()">
<script language=javascript>
parent.sa_message_sign_status = 2;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{digital_signature_not_valid}</H1>

<P>
{invalid_digital_signature_because}</p>
<DIV CLASS=Explanationbox>

<UL><LI>
{signing_cert_issuer_unknown}
</LI></UL>

<table border=0> 
<tr valign="Top">
<td width="10%%">
</td>
<td><div>
<form><input type="button" value="{text_edit}" width="72" onClick="window.open('cert?baseRef=cert_action&action=cert_edit&target=%1$d&certresource=%2$d&formName=selected_item','popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')"></form>
</div></td>
<td>
<P>
{edit_trust_for_this_cert}
</P>
</td></tr></table>
</DIV>
</td>
</tr>
</TABLE>

<hr SIZE=3 NOSHADE WIDTH="100%%">
:sa_message_signed_unknown_issuer

sa_message_signed_untrusted_issuer:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetMessageHelp()">
<script language=javascript>
parent.sa_message_sign_status = 2;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{digital_signature_not_valid}</H1>

<P>
{invalid_digital_signature_because}</p>
<DIV CLASS=Explanationbox>

<UL><LI>
{signing_cert_issuer_not_trusted}
</LI></UL>
<BLOCKQUOTE>
{trust_this_cert_or_all_issued_by}
</BLOCKQUOTE>
<table border=0> 
<tr valign="Top">
<td width="10%%">
</td>
<td>
<form><input type="button" value="{text_edit}" width="72" onClick="window.open('cert?baseRef=cert_action&action=cert_edit&target=%1$d&certresource=%2$d&formName=selected_item','popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')"></form>
</td>
<td>
<P>
{edit_trust_for_this_cert}
</P>
</td></tr>
<tr valign="Top">
<td width="10%%">
</td>
<td>
<form><input type="button" value="{text_edit}" width="72" onClick="window.open('cert?baseRef=cert_action&action=cert_edit&target=%1$d&certresource=%3$d&formName=selected_item','popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')"></form>
</td>
<td>
<P>
{edit_trust_for_this_ca}
</P>
</td></tr></table>
</div>
</td></tr></table>

<hr SIZE=3 NOSHADE WIDTH="100%%">
:sa_message_signed_untrusted_issuer

sa_message_signed_expired_issuer_cert:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetMessageHelp()">
<script language=javascript>
parent.sa_message_sign_status = 2;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{digital_signature_not_valid}</H1>

<P>
{invalid_digital_signature_because}</p>
<DIV CLASS=Explanationbox>
<UL><LI>
{signing_cert_issuer_expired}
</LI></UL>
<BLOCKQUOTE>
{may_be_caused_incorrect_clock}
</BLOCKQUOTE>   
</DIV>
</td>
</tr>
</TABLE>
<hr SIZE=3 NOSHADE WIDTH="100%%">
:sa_message_signed_expired_issuer_cert

sa_message_signed_ocsp_error:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetMessageHelp()">
<script language=javascript>
parent.sa_message_sign_status = 2;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{digital_signature_not_valid}</H1>

<P>
{invalid_digital_signature_because}</p>
<DIV CLASS=Explanationbox>
<UL><LI>
{unkown_problems_with_signature}
</LI></UL>
<BLOCKQUOTE>
{ocsp_message_for_signature}
</BLOCKQUOTE>   
</DIV>
</td>
</tr>
</TABLE>
<hr SIZE=3 NOSHADE WIDTH="100%%">
:sa_message_signed_ocsp_error

sa_message_signed_unknown_error:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetMessageHelp()">
<script language=javascript>
parent.sa_message_sign_status = 2;
</script>

<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{digital_signature_not_valid}</H1>

<P>
{invalid_digital_signature_because}</p>
<DIV CLASS=Explanationbox>
<UL><LI>
{unkown_problems_with_signature}
</LI></UL>
</DIV>
</td>
</tr>
</TABLE>
<hr SIZE=3 NOSHADE WIDTH="100%%">
:sa_message_signed_unknown_error

sa_message_signed_addr_mismatch:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetMessageHelp()">
<script language=javascript>
parent.sa_message_sign_status = 2;
</script>

<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{digital_signature_not_valid}</H1>
<P>{invalid_digital_signature_because}</p>
<DIV CLASS=Explanationbox>
<UL><LI>
{mismatch_email_warning}
</LI></UL>

<BLOCKQUOTE>
{cert_for_included_and_signed_by}
</BLOCKQUOTE>

<table border=0> 
<tr valign="Top">
<td width="10%%">
</td>
<td><div>
<form><input type="button" value="{text_edit}" width="72" onClick="window.open('cert?baseRef=cert_action&action=cert_edit&target=%5$d&certresource=%6$d&formName=selected_item','popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')"></form>
</div></td>
<td>
<P>
{edit_trust_for_this_cert}
</P>
</td></tr></table>
</DIV>
</td>
</tr>
</table>
<hr SIZE=3 NOSHADE WIDTH="100%%">
:sa_message_signed_addr_mismatch

sa_message_encrypted_no_recipient:
<script language=javascript>
parent.sa_message_encrypt_status = 2;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{message_cannot_be_decrypted}</H1>
<P>
{message_cannot_be_decrypted_because}
</P>
<DIV CLASS=Explanationbox>

<UL><LI>
{your_encrypted_cert_not_found}
</LI></UL>
<BLOCKQUOTE>
{further_info}
</BLOCKQUOTE>
</DIV>
</td></tr></table>
</body>
</html>
:sa_message_encrypted_no_recipient

sa_message_encrypted_bad_password:
<script language=javascript>
parent.sa_message_encrypt_status = 2;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{message_cannot_be_decrypted}</H1>
<P>
{message_cannot_be_decrypted_because}
</P>
<DIV CLASS=Explanationbox>

<UL><LI>
{did_not_enter_passwd_correctly}
</LI></UL>
{further_info}
</BLOCKQUOTE>
</DIV>
</td></tr></table>
</body>
</html>
:sa_message_encrypted_bad_password

sa_message_encrypted_unknown_error:
<script language=javascript>
parent.sa_message_encrypt_status = 2;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{message_cannot_be_decrypted}</H1>
<P>
{message_cannot_be_decrypted_because}
</P>
<DIV CLASS=Explanationbox>
<UL><LI>
{unkown_probs_with_encryption}
</LI></UL>
</DIV>
</td></tr></table>
</body>
</html>
:sa_message_encrypted_unknown_error

sa_compose_not_to_be_signed:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT>
<LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetComposeHelp()">
<script language=javascript>
parent.sa_compose_sign_status = 0;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>
<td><H1>{message_not_to_be_signed}</H1>

<P>
{chosen_not_to_sign}
<p>
</td>
</tr>
</table>

<hr SIZE=3 NOSHADE WIDTH="100%%">
:sa_compose_not_to_be_signed

sa_compose_not_to_be_encrypted:
<script language=javascript>
parent.sa_compose_encrypt_status = 0;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{message_not_to_be_encrypted}
</H1>
<p>
{chosen_not_to_encrypt}
</p>
</td></tr></table>
</body>
</html>
:sa_compose_not_to_be_encrypted

sa_compose_can_be_signed:
<html>
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
{disable_right_click_js}
</head>
<body onLoad="parent.SetComposeHelp()">
<script language=javascript>
parent.sa_compose_sign_status = 1;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>
<td><H1>{message_can_be_signed}</H1>

<P>
{chosen_to_sign}
<p>
<table border=0>
<tr valign="CENTER">

<td>
<form><p>
{sign_message_with}
</p>
</td>
<td><div>
{_certlist nick,EmailSigner,email_cert_list_prefix,email_cert_list_suffix}
<script language=javascript>
top.selectDefaultEmailCert(document.forms[0].email_cert_list);
</script>
</div></td>
</form>
</td>
</tr>
</table>

<P>
{when_signing_others_can_verify}
</P>
</td>
</tr>
</TABLE>

<hr SIZE=3 NOSHADE WIDTH="100%%">
:sa_compose_can_be_signed

sa_compose_can_be_encrypted:
<script language=javascript>
parent.sa_compose_encrypt_status = 1;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%" HEIGHT="45%">
<tr VALIGN=TOP>

<td><H1>{message_can_be_decrypted}
</H1>
<p>
{chosen_to_encrypt}
</p>

<P>
{message_encrypted_before_saved}
</P>

</td></tr></table>
</body>
</html>
:sa_compose_can_be_encrypted

sa_compose_sign_no_cert:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetComposeHelp()">
<script language=javascript>
parent.sa_compose_sign_status = 2;
</script>
<form>

<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{message_cannot_be_signed}</H1>

<P>
{cannot_sign_because}
</P>

<DIV CLASS=Explanationbox>
<UL><LI>
{do_not_have_a_cert}
</LI></UL>
<table> 
<tr valign="Top">
<td width="10%%"></td>
<td><input type="button" value="{text_obtain_new}" onClick="window.top.open('{get_new_cert_url}/')" width="72" ></td>
<td><P>{obtain_cert}</P></td>
</tr></table>
</DIV>
</td>
</tr>
</TABLE>
<hr SIZE=3 NOSHADE WIDTH="100%%">
:sa_compose_sign_no_cert

sa_compose_sign_expired_cert:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetComposeHelp()">
<script language=javascript>
parent.sa_compose_sign_status = 3;
</script>
<form>

<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{message_cannot_be_signed}</H1>

<P>{cannot_sign_because}</p>

<DIV CLASS=Explanationbox>
<UL><LI>
{own_expired_cert}
</LI></UL>
<BLOCKQUOTE>
{help_for_further_assistance}
</BLOCKQUOTE>   
</DIV>
</td>
</tr>
</TABLE>
<hr SIZE=3 NOSHADE WIDTH="100%%">
:sa_compose_sign_expired_cert

sa_compose_sign_revoked_cert:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body>
<form onLoad="parent.SetComposeHelp()">
<script language=javascript>
parent.sa_compose_sign_status = 2;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{message_cannot_be_signed}</H1>

<P>{cannot_sign_because}</p>

<DIV CLASS=Explanationbox>
<UL><LI>
{your_cert_has_been_revoked}=You have a security certificate but it has been revoked.
</LI></UL>
<BLOCKQUOTE>
{help_for_further_assistance}
</BLOCKQUOTE>   
</DIV>
</td>
</tr>
</TABLE>
<hr SIZE=3 NOSHADE WIDTH="100%%">
:sa_compose_sign_revoked_cert

sa_compose_sign_invalid_cert:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetComposeHelp()">
<script language=javascript>
parent.sa_compose_sign_status = 2;
</script>
<form>

<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{message_cannot_be_signed}</H1>

<P>{cannot_sign_because}</p>

<DIV CLASS=Explanationbox>
<UL><LI>
{your_cert_cannot_be_used_for_signing}
</LI></UL>  
</DIV>
</td>
</tr>
</TABLE>
<hr SIZE=3 NOSHADE WIDTH="100%%">
:sa_compose_sign_invalid_cert

sa_compose_sign_unknown_error:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</head>
<body onLoad="parent.SetComposeHelp()">
<script language=javascript>
parent.sa_compose_sign_status = 2;
</script>
<form>

<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{message_cannot_be_signed}</H1>

<P>{cannot_sign_because}</P>

<DIV CLASS=Explanationbox>
<UL><LI>
{unknow_problems}
</LI></UL>  
</DIV>
</td>
</tr>
</TABLE>
<hr SIZE=3 NOSHADE WIDTH="100%%">
:sa_compose_sign_unknown_error

sa_compose_encrypted_no_recipients:
<script language=javascript>
parent.sa_compose_encrypt_status = 2;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{message_cannot_be_encrypted}</H1>
<P>
{cannot_encrypt_because}
</P>

<DIV CLASS=Explanationbox>

<UL><LI>
You have not entered any recipients.
</LI></UL>
</DIV>
</td></tr></table>

</form>
</body>
</html>
:sa_compose_encrypted_no_recipients

sa_compose_encrypted_no_cert:
<script language=javascript>
parent.sa_compose_encrypt_status = 2;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{message_cannot_be_encrypted}</H1>
<P>
{cannot_encrypt_because}
</P>

<DIV CLASS=Explanationbox>

<UL><LI>
{do_not_have_a_cert}
</LI></UL>
</DIV>
</td></tr></table>

</form>
</body>
</html>
:sa_compose_encrypted_no_cert

sa_compose_encrypted_bad_recipients:
<script language=javascript>
parent.sa_compose_encrypt_status = 2;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{message_cannot_be_encrypted}</H1>
<P>
This message cannot be {glossary encrypted,encryption}
 because:
</P>
<form method=get action=formsubmit_handler>
<input type=hidden name="formName" value="cert_others_form">
<input type=hidden name="target" value="%1$d">

<DIV CLASS=Explanationbox>

<UL><LI>
{no_valid_cert_for}
</LI></UL>

<table> 
<tr valign="Top">
<td width="20%%"></td>
<td>
<SELECT MULTIPLE name=emailAddresses oldSIZE="%2$d" size=5>
%3$s
</SELECT>
</td>
</tr>
</table>
<table width="100%%"> 
<tr valign="Top">
<td width="10%%"></td>
<td><div><input type="submit" value="Add..." width="72" name="ldap"></div></td>
<td><p>{add_certs_for}</p></td>
</tr>
</table>
</div>
</td></tr></table>
</form>
</body>
</html>
:sa_compose_encrypted_bad_recipients

sa_compose_encrypted_expired_cert:
<script language=javascript>
parent.sa_compose_encrypt_status = 2;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{message_cannot_be_encrypted}</H1>
<P>
This message cannot be {glossary encrypted,encryption}
 because:
</P>

<DIV CLASS=Explanationbox>

<UL><LI>
You have a security certificate but it has expired.
</LI></UL>
</DIV>
</td></tr></table>

</form>
</body>
</html>
:sa_compose_encrypted_expired_cert

sa_compose_encrypted_revoked_cert:
<script language=javascript>
parent.sa_compose_encrypt_status = 2;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{message_cannot_be_encrypted}</H1>
<P>
This message cannot be {glossary encrypted,encryption}
 because:
</P>

<DIV CLASS=Explanationbox>

<UL><LI>
You have a security certificate but it has been revoked.
</LI></UL>
</DIV>
</td></tr></table>

</form>
</body>
</html>
:sa_compose_encrypted_revoked_cert

sa_compose_encrypted_invalid_cert:
<script language=javascript>
parent.sa_compose_encrypt_status = 2;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{message_cannot_be_encrypted}</H1>
<P>
This message cannot be {glossary encrypted,encryption}
 because:
</P>

<DIV CLASS=Explanationbox>

<UL><LI>
You have a security certificate but it is invalid.
</LI></UL>
</DIV>
</td></tr></table>

</form>
</body>
</html>
:sa_compose_encrypted_invalid_cert

sa_compose_encrypted_unknown_error:
<script language=javascript>
parent.sa_compose_encrypt_status = 2;
</script>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" HEIGHT="45%%">
<tr VALIGN=TOP>

<td><H1>{message_cannot_be_encrypted}</H1>
<P>
{cannot_encrypt because}
</P>

<DIV CLASS=Explanationbox>
<UL><LI>
{unknown_probs_with_message}
</LI></UL>
</DIV>
</td></tr></table>
</body>
</html>
:sa_compose_encrypted_unknown_error

;demo_nav_sec_type=text/html
;demo_nav_sec_content:
;<html>
;<head>
;   <meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
;   <title>InfoNavSec</title>
;</head>
;<body>
;Navigator: SSL Site
;<p>Encryption
;<p>This page was encrypted. This means it was difficult for other people
;to view this page
;<br>when it was loaded.
;<p>You can examine your copy of the certificate for this page and check
;the identity of the
;<br>web site. To see the certificate for this web site, click View Certificate.
;For complete
;<br>details on all the files on this page and their certificates, click
;Open Page Info.
;<br>&nbsp;
;<br>&nbsp;
;<br>&nbsp;
;<br>&nbsp;
;<p>Verification
;<p>&nbsp;&nbsp;&nbsp;&nbsp; Take a look at the page's Certificate.
;<br>&nbsp;&nbsp;&nbsp;&nbsp; Make sure that this is the site you think
;it is. This page comes from the site:
;<br>&nbsp;&nbsp;&nbsp;&nbsp; www.dell.com
;<br>&nbsp;
;</body>
;</html>
;:demo_nav_sec_content

;demo_mess_none_type=text/html
;demo_mess_none_content:
;<html>
;<head>
;<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
;</head>
;<body>
;<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%" >
;<tr>
;<td WIDTH="10"></td>
;
;<td><b><font face="{nsm_font}"><font size=-1>Digital
;Signature:</div></font></b>
;<p><font face="{nsm_font}"><font size=-1>This message
;was not digitally signed by the sender.</font></font>
;<p><font face="{nsm_font}"><font size=-1>It is possible,
;though unlikely, that this email was sent by someone pretending to have
;this email address. It is also possible, though unlikely, that this email
;was tampered with while it was traveling across the internet.&nbsp;</font></font>
;<br>&nbsp;
;<p>&nbsp;</td>
;</tr>
;
;<tr>
;<td COLSPAN="2">
;<hr SIZE=3 NOSHADE WIDTH="100%"></td>
;
;<td></td>
;</tr>
;
;<tr>
;<td></td>
;
;<td><b><font face="{nsm_font}"><font size=-1>Encryption:</font></font></b>
;<p><font face="{nsm_font}"><font size=-1>This message
;was not encrypted when it was sent.</font></font>
;<p><font face="{nsm_font}"><font size=-1>It is possible,
;though unlikely, that other people read this message while it was traveling
;across the internet.</font></font>
;<p>&nbsp;</td>
;</tr>
;</table>
;
;</body>
;</html>
;:demo_mess_none_content
;
;demo_mess_valid_type=text/html
;demo_mess_valid_content:
;<html>
;<head>
;<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
;</head>
;<body>
;<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%" >
;<tr>
;<td WIDTH="10"></td>
;
;<td><b><font face="{nsm_font}"><font size=-1>Digital
;Signature:</font></font></b>
;<p><font face="{nsm_font}"><font size=-1>This message
;was digitally signed by the owner of the email address lord@netscape.com</font><
;/font>
;<p><font face="{nsm_font}"><font size=-1>This message
;was not tampered with while it was traveling across the internet.</font></font>
;<p><font face="{nsm_font}"><font size=-1>The security
;certificate used by the owner of lord@netscape.com to sign this message
;has been added to your store of Others' certificates, to make it possible
;for you to send secure mail to this email address.</font></font>
;<br>&nbsp;</td>
;</tr>
;
;<tr>
;<td COLSPAN="2">
;<hr SIZE=3 NOSHADE WIDTH="100%"></td>
;
;<td></td>
;</tr>
;
;<tr>
;<td></td>
;
;<td><b><font face="{nsm_font}"><font size=-1>Encryption:</font></font></b>
;<p><font face="{nsm_font}"><font size=-1>This message
;was encrypted when it was sent.</font></font>
;<p><font face="{nsm_font}"><font size=-1>It was
;extremely hard for other people to read this message while it traveling
;across the internet.</font></font>
;<p>&nbsp;</td>
;</tr>
;</table>
;
;</body>
;</html>
;:demo_mess_valid_content
;
;demo_mess_invalid_type=text/html
;demo_mess_invalid_content:
;<html>
;<head>
;<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
;</head>
;<body>
;<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%" >
;<tr>
;<td WIDTH="10"></td>
;
;<td><b><font face="{nsm_font}"><font size=-1>Invalid
;Digital Signature:</font></font></b>
;<p><font face="{nsm_font}"><font size=-1>This message
;was signed by the sender but the signature is invalid because:</font></font>
;<ul>
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>There is a mismatch between the signature
;and the message content. This message was altered after the sender signed
;it.</font></font></li>
;
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>The security certificate used to sign
;the message is not certified to sign messages.</font></font></li>
;
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>The security certificate used to sign
;the message has expired</font></font></li>
;
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>The security certificate used to sign
;the message has been revoked</font></font></li>
;
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>The security certificate used to sign
;the message is not yet valid</font></font></li>
;
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>The security certificate used to sign
;the message was issued by an unknown Certificate Authority</font></font></li>
;
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>The security certificate used to sign
;the message was issued by a Certificate Authority that you do not trust</font></
;font></li>
;
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>The security certificate used to sign
;the message was issued by a Certificate Authority whose certificate has
;expired</font></font></li>
;
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>The security certificate used to sign
;the message was issued by a Certificate Authority whose certificate has
;been revoked&nbsp;</font></font></li>
;
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>The security certificate used to sign
;the message was issued by a Certificate Authority whose certificate is
;not yet valid</font></font></li>
;</ul>
;<font face="{nsm_font_verdana}"><font size=-1>Because this signature is invalid, it
;is possible, though unlikely, that this email was sent by someone pretending
;to have this email address.</font></font></td>
;</tr>
;
;<tr>
;<td COLSPAN="2">
;<hr SIZE=3 NOSHADE WIDTH="100%"></td>
;
;<td></td>
;</tr>
;<tr>
;<td></td>
;
;<td><b><font face="{nsm_font}"><font size=-1>Encryption:</font></font></b>
;<p><font face="{nsm_font}"><font size=-1>This message
;was encrypted by the sender, but the encryption is invalid because:</font></font
;>
;<ul>
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>You have not entered the Personal Security
;Password that allows the message to be decrypted</font></font></li>
;
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>The security certificate used to encrypt
;the message is not in the current Security Certificate Wallet</font></font></li>
;
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>The security certificate used to encrypt
;the message is not certified to encrypt messages.</font></font></li>
;
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>The security certificate used to encrypt
;the message has expired</font></font></li>
;
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>The security certificate used to encrypt
;the message has been revoked</font></font></li>
;
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>The security certificate used to encrypt
;the message is not yet valid</font></font></li>
;
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>The security certificate used to encrypt
;the message was issued by an unknown Certificate Authority</font></font></li>
;
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>The security certificate used to encrypt
;the message was issued by a Certificate Authority that you do not trust</font></
;font></li>
;
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>The security certificate used to encrypt
;the message was issued by a Certificate Authority whose certificate has
;expired</font></font></li>
;
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>The security certificate used to encrypt
;the message was issued by a Certificate Authority whose certificate has
;been revoked&nbsp;</font></font></li>
;
;<li>
;<font face="{nsm_font_verdana}"><font size=-1>The security certificate used to encrypt
;the message was issued by a Certificate Authority whose certificate is
;not yet valid</font></font></li>
;</ul>
;<font face="{nsm_font_verdana}"><font size=-1>Because the encryption is invalid, it
;is possible, though unlikely that other people read this message while
;it was traveling across the internet</font></font></td>
;</tr>
;</table>
;
;<br>&nbsp;
;<br>&nbsp;
;<br>&nbsp;
;</body>
;</html>
;:demo_mess_invalid_content


;
; Javascript that makes sure a cert name is selected and '#' sign in cert nick
; is transmitted correctly.
; 
certificate_pane_javascript:
<script language=javascript>
<!-- 
{pop_up_alert}
var restore = false;
function setRestore(value)
{
  restore = value;
}
var backup = false;
function setBackup(value)
{ 
  backup = value;
}
function openIfSelected(formName,starturl,nick,popup,size)
{
  if (document.forms[0].selectCert) {
    if (document.forms[0].selectCert.selectedIndex != -1 && 
        document.forms[0].selectCert.options[document.forms[0].selectCert.selectedIndex].value != "") {
  
      var tmp = document.forms[0].selectCert.options[document.forms[0].selectCert.selectedIndex].value;
      tmp = tmp.replace(/#/g,"%%23");
      tmp = tmp.replace(/&/g,"%%7e");	

      url = starturl+'&nick=' + tmp + '&formName=' + formName;
      window.open(url,popup,size);
    }
  }
}

function beforeSubmit(formName)
{
  var noCert = false;
  var index = -1;
  if (!document.forms[0].selectCert) {
    noCert = true;
  }
  if (!noCert) {
    // if we do this w/o checking noCert, the rest of the script is pretty
    // much useless 'cause it won't recover from this error
    index = document.forms[0].selectCert.selectedIndex;	
  }

  if (!restore) {
    if (noCert) { 
      backup = false;
      return false;
    }
      
    if (!noCert) {
      if (!document.forms[0].selectCert.options[index].value) {
        backup = false;
        return false;
      }
    }
  }

  if (!noCert && index != -1) {
    var nickname = document.forms[0].selectCert.options[document.forms[0].selectCert.selectedIndex].value;
    if (nickname == ""|| nickname== "undefined")
      return false;
    var tmp = nickname.replace(/&/g,"%%7e");

    document.forms[0].selectCert.options[document.forms[0].selectCert.selectedIndex].value = escape(tmp.replace(/#/g, "%%23")); 
  }
  else if (!restore) {
    return false;
  }
  restore = false;
  return true;
}

// -->
</script>	
:certificate_pane_javascript



; Cert list utility strings -- this creates a scrolling list of certs.
cert_list_prefix:
<script language=javascript>
<!-- 
var index = 0;
var keyID = new Array();
var nickname = new Array();
var emailaddr = new Array();
var subjectname = new Array();
var validFrom = new Array();
var validTo = new Array();
var issuerorg = new Array();
var nick, email, issuer, subject;

function showCertInfo()
{
   var certSelect = document.forms[0].selectCert;
   if (certSelect.selectedIndex < index) {
      if (document.forms[0].currentnick) {
        document.forms[0].currentnick.value= certSelect.options[certSelect.selectedIndex].value;
      }
      if (document.forms[0].validfrom) { 
        document.forms[0].validfrom.value = validFrom[certSelect.selectedIndex];
      }
      if (document.forms[0].validto) {    
        document.forms[0].validto.value = validTo[certSelect.selectedIndex];
      }
      if (document.forms[0].issuername) { 
        document.forms[0].issuername.value = issuerorg[certSelect.selectedIndex];
      }
  } else {
      if (document.forms[0].currentnick) {
        document.forms[0].currentnick.value= "";
      }
      if (document.forms[0].validfrom) { 
        document.forms[0].validfrom.value = "";
      }
      if (document.forms[0].validto) {    
        document.forms[0].validto.value = "";
      }
      if (document.forms[0].issuername) { 
        document.forms[0].issuername.value = "";
      }
  }
}
function storeCertInfo(keyid, nick, email, subject, start, end, issuer)
{
keyID[index] = keyid;
nickname[index] = nick;
emailaddr[index] = email;
subjectname[index] = subject;
validFrom[index] = start;
validTo[index] = end;
issuerorg[index] = issuer;
index ++;
}
// -->
document.write('<select NAME="selectCert" SIZE="8" onChange="showCertInfo()">');
:cert_list_prefix

fix_quotes:
nick = '%2$s';
nick = nick.replace(/'/g, "&#39;");
issuer='%7$s';
email='%3$s';
email=email.replace(/'/g, "&#39;");
subject='%4$s';
subject=subject.replace(/'/g, "&#39;");
if (typeof(storeCertInfo)=="function")
  storeCertInfo('%1$s', nick, email, subject,'%5$s', '%6$s', issuer);
:fix_quotes


cert_list_item:
{fix_quotes}
document.write('<option value="' + nick + '" >' + nick.substring(0,60));
:cert_list_item

cert_list_key_item:
{fix_quotes}
document.write('<option value="' + "%1$s" + '" >' + nick.substring(0,60));
:cert_list_key_item

cert_list_email_item:
{fix_quotes}
document.write('<option value="' + email + '" >' + email.substring(0,60));
:cert_list_email_item

nbsp10=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

cert_list_suffix:
document.write('</select>');
</script>
:cert_list_suffix

list_empty=<p>{no_certs_found}</p>

textarea_current_cert_removed:
<tr valign=middle align=left>
<td colspan=3>
<br>{info_on_selected_cert}
</td>
</tr>
<tr>
<td>
<table border=0>
<tr>
<td align=left width=10%%>
<img src=get?baseRef=viewcertjpg>
</td>
<td>
<table width="70%%">
<tr>
<td colspan=2 align=right>
<input type=text name=currentnick size=46>
</td>
</tr>
<tr>
<td>
{valid_from}
</td>
<td align=right>
<input type=text name=validfrom size=16>
to <input type=text name=validto size=16> 
</td>
</tr>
<tr>
<td>
{issued_by}
</td>
<td align=right>
<input type=text name=issuername size=36>
</td>
</tr>
</table>
</td>
</tr>
</table>
</td>
</tr>
:textarea_current_cert_removed

textarea_current_cert:
<!-- need selected certificate info here -->
:textarea_current_cert

cert_authorities_type=text/html
cert_authorities_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{certificate_pane_javascript}
{disable_right_click_js}
</head>
<body alink="#333399" onLoad="parent.SetHelpURL('help.htm#1031434')">
<div><font size=-1>{text_cert_authorities_title}</font></div>
<div>
<form method=get action=formsubmit_handler name=cert_authorities onSubmit="return beforeSubmit('cert_authorities')">
<input type=hidden name="formName" value="cert_authorities_form">
<input type=hidden name="target" value="%1$d">
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" >
<tr VALIGN=TOP>
<td>
<table  border=0 CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%%" >
<tr>
<td><div>
{_certlist nick,CA,cert_list_prefix,cert_list_suffix}
</div></td>
</tr>
</table>
</td>

<td>
<table border=0 COLS=0 WIDTH="100%%" >
<tr VALIGN=TOP>
<td></td>
<td ALIGN=LEFT><div>
<input type="button" name="view" value="{text_view}" width="75" 
onClick="openIfSelected('cert_authorities', 'cert?baseRef=cert_action&action=cert_view&target=%1$d', document.cert_authorities.selectCert.options[document.cert_authorities.selectCert.selectedIndex].value,'popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')">
</div></td>
</tr>

<tr>
<td></td>
<td align=left><div><input type="button" value="{text_edit_dots}" width="75" onClick="openIfSelected('cert_authorities', 'cert?baseRef=cert_action&action=cert_edit&target=%1$d',document.cert_authorities.selectCert.options[document.cert_authorities.selectCert.selectedIndex].value,'popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')">
</div></td>
</tr>

<tr>
<td></td>
<td align=left>
<div><input type="button" value="{text_policy}" width="75" onClick="openIfSelected('cert_authorities', 'cert?baseRef=cert_action&action=ca_policy_view&target=%1$d',document.cert_authorities.selectCert.options[document.cert_authorities.selectCert.selectedIndex].value,'popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')"></div>
</td>
</tr>

</table>
<!- td>

<tr>

<td><div><input type="submit" value="{text_delete}" name="delete" width="72" >
</div></td>
</tr>
{textarea_current_cert}
</table>
</form>
</div>
</body>
</html>
:cert_authorities_content

cert_websites_type=text/html
cert_websites_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{certificate_pane_javascript}
{disable_right_click_js}
</head>
<body alink="#333399" onLoad="parent.SetHelpURL('help.htm#1031432')">
<div><font size=-1>{text_cert_websites_title}</font></div>
<div>
<form method=get action=formsubmit_handler name=cert_websites onSubmit="return beforeSubmit('cert_websites')">
<input type=hidden name="formName" value="cert_websites_form">
<input type=hidden name="target" value="%1$d">


<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" >
<tr VALIGN=TOP>
<td>
<table border=0 CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%%" >
<tr>
<td><div>
{_certlist nick,SSLServer,cert_list_prefix,cert_list_suffix}
</div></td>
</tr>
</table>
</td>

<td>
<table border=0  COLS=0 WIDTH="100%%" >
<tr VALIGN=TOP>
<td></td>
<td ALIGN=RIGHT><div align=left>
<input type="button" name="view" value="{text_view}" width="75" 
onClick="openIfSelected('cert_websites', 'cert?baseRef=cert_action&action=cert_view&target=%1$d',document.cert_websites.selectCert.options[document.cert_websites.selectCert.selectedIndex].value,'popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')">
</div></td>
</tr>

<tr>
<td></td>
<td align=left><div>
<input type="button" value="{text_edit_dots}" width="75" onClick="openIfSelected('cert_websites', 'cert?baseRef=cert_action&action=cert_edit&target=%1$d',document.cert_websites.selectCert.options[document.cert_websites.selectCert.selectedIndex].value,'popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')">
</div></td>
</tr>
</table>
</td>
</tr>
<tr>
<td>
<table>
<tr>
<td><div>
<input type="submit" value={text_delete} name="delete" width="72"> 
</div></td>
</tr>
</table>
</tr>
</table>
</td>
</tr>
{textarea_current_cert}
<tr>
<td COLSPAN="3">
<ht size=3 noshade width="100%%"> 
</td>
</tr>
</table>
</td>
</tr>
</table>
</form>
</div>
</body>
</html>
:cert_websites_content

cert_others_type=text/html
cert_others_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{certificate_pane_javascript}
{disable_right_click_js}
</head>
<body alink="#333399" onLoad="parent.SetHelpURL('help.htm#1031428')">
<div><font size=-1>{text_cert_others_title}</font></div>
<div>
<form method=get action=formsubmit_handler name=cert_others onSubmit="return beforeSubmit('cert_others')" >
<input type=hidden name="formName" value="cert_others_form">
<input type=hidden name="target" value="%1$d">
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" >
<tr VALIGN=TOP>
<td><div>
<table border=0 CELLSPACING=0 CELLPADDING=0 COLS=1 width="80%%">
<tr>
<td><div>
{_certlist nick,EmailRecipient,cert_list_prefix,cert_list_suffix}
</div></td>
</tr>
</table>
</td>
<td>
<table border=0 COLS=0 >
<tr VALIGN=TOP><td></td>
<td ALIGN=RIGHT><div align=left>
<input type="button" name="view" value="{text_view}" width="75" 
onClick="openIfSelected('cert_others', 'cert?baseRef=cert_action&action=cert_view&target=%1$d',document.cert_others.selectCert.options[document.cert_others.selectCert.selectedIndex].value,'popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')">
</div></td>
</tr>

<tr>
<td></td>
<td align=left><div>
<input type="button" value="{text_edit_dots}" width="75" onClick="openIfSelected('cert_others', 'cert?baseRef=cert_action&action=cert_edit&target=%1$d',document.cert_others.selectCert.options[document.cert_others.selectCert.selectedIndex].value,'popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')">
</div></td>
</tr>
</table>
</td>
</tr>

<tr>
<td>
<table><tr><td><div>
<input type="submit" value="{text_add_dots}" width="72" name="ldap" 
       onClick="setRestore(true)">
</div></td><td><div>
<input type="submit" value={text_delete} name="delete" width="72">
</div></td>
</tr>
</table>
</tr>
<tr>
<td></div>
{textarea_current_cert}
</table>
<p CLASS=TOPBORDER> 
{can_send_encr_if_have_cert}
<br>
{click_add_for_someone_cert}
</p>
</form>
</div>
</body>
</html>
:cert_others_content

cert_mine_type=text/html
cert_mine_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{certificate_pane_javascript}
{disable_right_click_js}
</head>
<body alink="#333399"
      onLoad="parent.SetHelpURL('help.htm#1047547')">
<DIV><font size=-1>{text_cert_mine_title}</font></DIV>
<div>
<form method=get action=formsubmit_handler name=cert_mine onSubmit="return beforeSubmit('cert_mine');">
<input type=hidden name="formName" value="cert_mine_form">
<input type=hidden name="target" value="%1$d">
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" ALIGN=LEFT>
  <tr VALIGN=TOP ALIGN=LEFT>
    <td><div>
      <table BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=0 WIDTH="100%%" >
        <tr>
          <td><div>
            {_certlist nick,AllMine,cert_list_prefix,cert_list_suffix}
          </div></td>
        </tr>
      </table>
    </div></td>
    <td><div>
      <table BORDER=0 COLS=0 WIDTH="100%%" >
        <tr VALIGN=TOP>
          <td></td>
          <td>
            <div align=left><input type="button" name="view" value="{text_view}" width="75" onClick="openIfSelected('cert_mine','cert?baseRef=cert_action&action=cert_view&target=%1$d',document.cert_mine.selectCert.options[document.cert_mine.selectCert.selectedIndex].value,'popup','width=520,height=360,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')">
            </div>
          </td>
        </tr>
        <tr>
          <td></td>
          <td>
            <div align=left><input type="submit" name="backup" onclick="setBackup(true)" value="{text_backup}" width="75">
            </div>
          </td>
        </tr>
        <tr>
          <td></td>
          <td>
            <div align=left><input type="submit" name="restore" value="{text_restore}" width="75" onclick="setRestore(true)"></div>
          </td>
        </tr>
      </table>
    </div></td>
  </tr>
  <tr>
    <td><div><input type="button" value="{text_obtain_new}" onClick="window.top.open('{get_new_cert_url}/')" width="72" >&nbsp;&nbsp;
      <input type="submit" value={text_delete} name="delete" width="72">&nbsp;&nbsp;
      <input type="submit" value="{text_backup_all}" name="backup_all" width="72" onClick="setRestore(true);">
    </div></td>
  </tr>
  {textarea_current_cert}
  <tr HEIGHT="5">
    <td COLSPAN="3">
      <hr SIZE=3 NOSHADE WIDTH="100%%">
    </td>
  </tr>
  <tr ALIGN=LEFT VALIGN=TOP>
    <td COLSPAN=3><div>
      <table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>
        <td><div>
          <input type="submit" name="password" value=" {text_passwords} " width="72" 
                 onclick="setRestore(true)">
        </div></td><td width=10></td>
        <td><div>
          <font size=-1>
            {password_protects_against_unauth_use}
          </font>
        </div></td>
      </table>
    </div></td>
  </tr>
  <tr></tr>
  <tr><div>
    <td COLSPAN="3">
      <hr SIZE=3 NOSHADE WIDTH="100%%"></td>
    <td><div></div></td>
    <td><div></div></td>
  </div></tr>
  <tr>
  </tr>
</table>
</form>
</div>
:cert_mine_content

;
; redirect final view/delete windows so they fill up the whole frameset
;
refresh_frameset_type="text/html"
refresh_frameset_hdrs=""
refresh_frameset_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
{disable_right_click_js}
</head>
<body>
<script language=javascript>

top.window.open("%1$s",'%2$s',null,true);

</script>
</body>
</html>
:refresh_frameset_content

;
; ok_help_cancel button macro
; yes, another one. I only need the buttons themselves, the rest of the
; frame is easier done separately
; OK-6px-Cancel-12px-HELP|<- end of frame
;
buttons_only:
<div align=right>
<table border=0 cellspacing=0 cellpadding=0 height=100%%>
<tr align=right valign=center>
<td width=50%%>
<div class=buttonspace>
<input type="submit" name="do_ok" value="{$1}" width="72">
</div>
</td>
<td>
<div class=buttonspace>
<input type="submit" name="do_cancel" value="{text_cancel}" width="72" >
</div>
</td>
<td width=30%%>
<div class=BUTTONSPACE>
<input type="button" name="do_help" value="{text_help}" width="72" 
	onClick="parent.OpenHelp()">
</div>
</td>
</tr>
</table>
</div>
:buttons_only


;
; Tell the window to refresh itself
;
refresh_window_type="text/html"
refresh_window_hdrs=""
refresh_window_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
{disable_right_click_js}
</head>
<body>
<script language=javascript>

window.location = "%1$s";

</script>
</body>
</html>
:refresh_window_content


;
; Security Advisor: window to choose one cert out of the few with the same 
; nickname
;
choose_cert_width=500
choose_cert_height=350
choose_cert_type="text/html"
choose_cert_hdrs=""
choose_cert_content:
{frame_set_3param choose_cert_usage,formsubmit}
:choose_cert_content

choose_cert_usage_top_type="text/html"
choose_cert_usage_top_hdrs=""
choose_cert_usage_top_content:
{top_frame_no_image choose_cert_title}
:choose_cert_usage_top_content

choose_cert_usage_main_type="text/html"
choose_cert_usage_main_hdrs=""
choose_cert_usage_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
{formsubmit document.forms[0]}
<body class=content alink="#333399">
<script language="javascript">
<!--
function fixPoundSignNick() {
  var nickname = document.forms[0].nick;
  document.forms[0].nick = nickname.replace(/#/g, "%%23");
  return true;
}
// -->
</script>
<form method="get" action="formsubmit_handler" onSubmit="fixPoundSignNick()" >
<input type=hidden name="formName" value="choose_cert_by_usage">
<input type=hidden name="target" value="%1$d">
<input type=hidden name="baseRef" value="%2$s">
<input type=hidden name="nick" value="%3$s">
<input type=hidden name="origin" value="%4$s">
<table>
<tr>
<td></td>
<td colspan=3>
<p> {cert_name_reps_many}
</td>
</tr>
<tr>
<td></td>
<td>
<hr size=3 noshade>
<div>{choose_a_cert}</div></p>
</td>
</tr>
</table>
<table>
<div>
{choose_list choose_list_item}
</div>
</table>
</form>
</body>
</html>
:choose_cert_usage_main_content

choose_list_item:
<tr>
<td></td>
<td><div>
<input type=radio name=selectItem value=%1$s:%6$s %5$s > {cert_select_info}
</div></td>
</tr>
:choose_list_item

choose_cert_usage_buttons_type="text/html"
choose_cert_usage_buttons_hdrs=""
choose_cert_usage_buttons_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body class=foot alink="#333399" 
	onLoad="parent.SetHelpURL('help.htm#Choose Security Certificate')">
<form method="get" action="check_for_cancel">
<input type=hidden name="baseRef" value="formsubmit_dosubmit_js">
<input type=hidden name=target value="%1$d">
<input type=hidden name=nick value="%2$d">
<input type=hidden name=formName value=choose_cert_by_usage>
{buttons_only {text_ok}}
</table>
</form>
</body>
</html>
:choose_cert_usage_buttons_content

ldap_server_list_prefix=<select size=1 name=ldapServer>
ldap_server_list_item=<option value=%1$s> %2$s 
ldap_server_list_suffix=</select>

ldap_request_width=500
ldap_request_height=350
ldap_request_type="text/html"
ldap_request_hdrs=""
ldap_request_content:
{frame_set_pass_var ldap_request_dialog,formsubmit,emailAddresses}
:ldap_request_content

ldap_request_dialog_top_type="text/html"
ldap_request_dialog_top_hdrs=""
ldap_request_dialog_top_content:
{top_frame_no_image ldap_request_dialog_title}
:ldap_request_dialog_top_content

ldap_request_dialog_main_type="text/html"
ldap_request_dialog_main_hdrs=""
ldap_request_dialog_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvmodalstyle">
{disable_right_click_js}
</head>
<body class=content alink="#333399">
&nbsp;
<script language=javascript>
function doNotSubmit()
{
  return false;
}
</script>
<form method="get" action="formsubmit_handler" 
      onSubmit="return doNotSubmit();"> 
<input type=hidden name="formName" value="ldap_request_others">
<input type=hidden name="target" value="%1$d">
<input type=hidden name="baseRef" value="windowclose_doclose_js">
<table BORDER=0 CELLSPACING=0>
<tr VALIGN=CENTER>
<td WIDTH="10"></td>
<td align=right>
<p>{directory_to_search}</p></div>
</td>
<td>
{ldap_server_list}
</td>
</tr>

<tr VALIGN=CENTER>
<td></td>
<td align=right>
<p>{cert_owners_email}</p>
</td>
<td><input type="text" name="emailaddress" size="30" value="{_emailAddresses}"></td>
</tr>

<tr>
<td></td>
<td></td>
<td></td>
</tr>

<tr>
<td COLSPAN="3">
<hr SIZE=3 NOSHADE WIDTH="100%%"></td>
<td COLSPAN="2"></td>
<td COLSPAN="2"></td>
</tr>

<tr>
<td></td>
<td COLSPAN="2"></form>
<p>
{enter_email_of_person}
<p>
<p>
{psm_will_search_for_persons_cert}
</p></td>
<td></td>
</tr>
</table>
</body>
</html>
:ldap_request_dialog_main_content

ldap_request_dialog_buttons_type="text/html"
ldap_request_dialog_buttons_hdrs=""
ldap_request_dialog_buttons_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body class=foot alink="#333399" 
	onLoad="parent.SetHelpURL('help.htm#1031501')">
<script language=javascript>
<!--
{pop_up_alert}
var cancel = false;
function beforeSubmit()
{
   var input = window.parent.DialogContent.document.forms[0].emailaddress.value;
   if (cancel == true) {
     return true;
   }

   if (input == "") {
     PopUpAlert('{must_supply_valid_email}');
     return false;
   }

//   if (!input.match(/^(\\w+)@((\\w+)\\.)+(\\w+)$/)) {
//     PopUpAlert('"' + input + '" is not a valid email address!');
//     window.parent.DialogContent.document.forms[0].emailaddress.value="";
//     return false;
//   }
   
   return true;
}
function setEmailAddr() 
{
  var main = window.parent.DialogContent.document.forms[0];

 document.forms[0].emailaddress.value = main.emailaddress.value;
 document.forms[0].ldapServer.value = main.ldapServer[main.ldapServer.selectedIndex].value;
}
//-->
</script>
<form method="get" action="ldap_request_others" onSubmit="return beforeSubmit();">
<input type=hidden name="baseRef" value="windowclose_doclose_js">
<input type=hidden name=target value="%1$d">
<input type=hidden name=formName value="ldap_request_others">
<div align=right>
<table border=0 cellspacing=0 cellpadding=0 height=100%%>
<tr align=right valign=center>
<td width=50%%>
<div class=buttonspace>
<input type="submit" name="do_ok" value="{text_ok}" width="72" 
       onClick="setEmailAddr()">
<input type="hidden" name="emailaddress" >
<input type="hidden" name="ldapServer"   >
</div>
</td>
<td>
<div class=buttonspace>
<input type="submit" name="do_cancel" value="{text_cancel}" width="72" 
       onClick="cancel=true;">
</div>
</td>
<td width=30%%>
<div class=BUTTONSPACE>
<input type="button" name="do_help" value="{text_help}" width="72" 
	onClick="parent.OpenHelp()">
</div>
</td>
</tr>
</table>
</div>
</form>
</body>
</html>
:ldap_request_dialog_buttons_content

cert_edit_type="text/html"
cert_edit_hdrs=""
cert_edit_content:
{frame_set cert_edit_trust,formsubmit}
:cert_edit_content

cert_edit_trust_top_type="text/html"
cert_edit_trust_top_hdrs=""
cert_edit_trust_top_content:
{top_frame_no_image edit_cert_title}
:cert_edit_trust_top_content

; Take out verify cert from the Edit box to save space.
;
;<table>
;<td width="10"></td>
;<tr></tr>
;<tr>
;<td>
;{verify_cert cert_usage_wrapper}
;</td>
;</tr>
;</table>

cert_edit_trust_main_type="text/html"
cert_edit_trust_main_hdrs=""
cert_edit_trust_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
<body bgcolor=white>
{formsubmit document.forms[0]}
<form method="get" action="formsubmit_handler" name="edit_cert">
<input type=hidden name="baseRef" value="windowclose_doclose_js">
<input type=hidden name="target" value="%1$d">
{edit_cert}
</form>
</body>
</html>
:cert_edit_trust_main_content

cert_edit_trust_buttons_type="text/html"
cert_edit_trust_buttons_hdrs=""
cert_edit_trust_buttons_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body class=foot alink="#333399" >
<form method="get" action="check_for_cancel_and_free_target">
<input type=hidden name="baseRef" value="formsubmit_dosubmit_js">
<input type=hidden name="target" value="%1$d">
<input type=hidden name="formName" value="cert_edit">
{buttons_only {text_ok}}
</form>
</body>
</html>
:cert_edit_trust_buttons_content


edit_cert_authority:
<script language=javascript>
parent.SetHelpURL('help.htm#%5$s');
</script>
<table cellspacing=0 cellpadding=0 >
<tr>
<td width="10"></td>
<td>
<table border=0 cellspacing=0>
<tr>
<td>
<p> {this_certificate} </p>
</td>
<td></td>
</tr>
<tr>
<td>
<p><strong> %4$s </strong></p>
</td>
<td> &nbsp;</td>
</tr>
<tr> 
<td colspan="3">
<p>{rep_for_ca}</p>
</td>
<td>&nbsp;</td>
</tr>
</table>
&nbsp;
<table border=0 cellspacing=0> 
<tr>
<td colspan=3>
<p>{edit_trust_settings}</p>
</td>
</tr>
<td>
<input type="checkbox" name="networksite" value="networksite" %1$s >
</td>
<td>
<p>{cert_idents_web_sites}</p>
</td>
</tr>
<tr align=top><td>
<input type="checkbox" name="emailuser" value="emailuser" %2$s ></td>
<td>
<p>{cert_idents_mail_user}</p>
</td>
</tr>
<tr align=top><td>
<input type="checkbox" name="software" value="software" %3$s ></td>
<td>
<p>{cert_idents_sftwr_makers}</p>
</td>
</tr>
</table>
<hr size=3 noshade></td>
</tr>
<td></td>
<td><p class=bold>
{help_for_ca_trust_settings}
</p>
</td>
</tr>
</table>
:edit_cert_authority

edit_cert_website:
<script language=javascript>
parent.SetHelpURL('help.htm#%6$s');
</script>
<table cellspacing=0 cellpadding=0 border=0>
<tr>
<td width="10"></td>
<td>
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td colspan=3>
<p class=bold> {cert_issued_by}
</p>
</td>
</tr>
</table>
{trust_options_list}
&nbsp;
{edit_trust_issuing_ca}
</td>
</tr>
</table>
:edit_cert_website



edit_trust_issuing_ca:
<script language=javascript>
<!-- 
{pop_up_alert}
function editTrustCA()
{
  var target = document.forms[0].target.value;
  var url='cert?baseRef=cert_action&action=cert_edit&target='+target;
  var nick='%3$s';
  url = url + '&formName=edit_cert&nick='+nick;
  var size = 'width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100';
  if (nick == 'NotInTheDatabase')
     PopUpAlert('{issuer_cert_not_in_db}');
  else 
     window.open(url, 'popup', size);
}
//-->
</script>
<div class=plainbox>
<table border=0 cellspacing=0 cellpadding=0>
<td colspan=2><div>
<input type=button name=edittrustca value='{text_edit_dots}' size='72' onClick='editTrustCA()'>
</div></td>
<td width=10></td>
<td>
<p>{edit_ca_trust}</p>
</td>
</tr>
</table>
</div>
:edit_trust_issuing_ca

trust_options_list:
<table>
<tr>
<td colspan=3>
<div class=plain><p>
{trusted_issuer_explanation}
</p> </div>
</td>
</tr>
<tr></tr>
</table>
<div class=plainbox>
<table border=0 cellspacing=1 cellpadding=0>
<tr> 
<td colspan=3>
<p>{edit_cert_trust}</p>
</td>
</tr>
<tr>
<td>
<input type='radio' name='trustoption' value='trust' %4$s > </td>
<td> <p>{trust_this_cert}</p></td>
</tr>
<tr>
<td><input type='radio' name='trustoption' value='donottrust' %5$s > </td>
<td> <p>{dont_trust_this_cert}</p></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</table>
</div>
:trust_options_list


edit_cert_others:
<script language=javascript>
parent.SetHelpURL('help.htm#%6$s');
</script>
<table cellspacing=1 cellpadding=0 border=0>
<tr>
<td width=10></td>
<td>
<table border=0 cellspacing=5 cellpadding=0>
<tr>
<td colspan=3>
<p class=bold>{this_cert_issued_by}
</p>
</td>
</tr>
</table>
{trust_options_list}
&nbsp;
{edit_trust_issuing_ca}
</td>
</tr>
</table>
:edit_cert_others

;
; Since UIEvent is called for cert_action need to set these
;
cert_action_width=520
cert_action_height=350

cert_view_width=520
cert_view_height=350
cert_view_type="text/html"
cert_view_hdrs=""
cert_view_content:
{frame_set_pass_var cert_view_detail,windowclose,windowOffset}
:cert_view_content

cert_view_detail_top_type="text/html"
cert_view_detail_top_hdrs=""
cert_view_detail_top_content:
{top_frame_no_image view_cert_title}
:cert_view_detail_top_content

showIssuerAndContents:
<script language=javascript>
<!---
var uniqueName = '{_certIssuerWindowName}';

function openIssuerWindow()
{
  var offset = {_windowOffset};
  var issuer = window.open('showIssuer?target=%1$d&windowOffset='+offset, uniqueName,'width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100');
  issuer.moveBy(offset,offset);
}

function showCertContents()
{
   window.open('get?baseRef=certPrettyPrint&target=%1$d', 'dump'+uniqueName,'width=760,height=800,scrollbars=yes,resizable=yes,toolbar=no,menubar=no');
}
//-->
</script>
:showIssuerAndContents

cert_view_detail_main_type="text/html"
cert_view_detail_main_hdrs=""
cert_view_detail_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
{showIssuerAndContents}
</head>
<body class=CONTENT onLoad="parent.SetHelpURL('help.htm#1049021')">
<p>
<table WIDTH="100%%">
<tr>
<td align=right><div><a href="javascript:showCertContents();">
{show_more_cert_info}
</a></div></td>
</tr>
<tr>
<td><div>
{verify_cert cert_usage_wrapper}
</div></td>
</tr>
</table>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" >
<tr>
<td WIDTH="10"></td>
<td>
<table BORDER=0 CELLSPACING=0 >
<tr>
<td colspan="3"> &nbsp;
<div>
{view_cert_info pretty,view_cert_wrapper,view_cert_wrapper_no_comment}
</table>
</tr>
</body>
</html>
:cert_view_detail_main_content

cert_view_detail_buttons_type="text/html"
cert_view_detail_buttons_hdrs=""
cert_view_detail_buttons_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body bgcolor="#CCCCCC" link="#6666CC" vlink="#6666CC" alink="#333399">
<form method="get" action="get">
<input type=hidden name="baseRef" value="free_target_page">
<div align=right>
<table border=0 cellspacing=0 cellpadding=0 height=100%%>
<tr align=right valign=center>
<td width=50%%>
<div class=buttonspace>
<input type="submit" name="do_ok" value="{text_ok}" width="72">
</div>
</td>
<td width=30%%>
<div class=BUTTONSPACE>
<input type="button" name="do_help" value="{text_help}" width="72" 
	onClick="parent.OpenHelp()">
</div>
</td>
</tr>
</table>
</div>
</form>
</body>
</html>
:cert_view_detail_buttons_content

delete_cert_type="text/html"
delete_cert_height=350
delete_cert_width=520
delete_cert_hdrs=""
delete_cert_content:
{frame_set delete_cert_perm,windowclose}
:delete_cert_content

delete_cert_perm_top_type="text/html"
delete_cert_perm_top_hdrs=""
delete_cert_perm_top_content:
{top_frame_no_image delete_cert_title}
:delete_cert_perm_top_content

delete_cert_perm_main_type="text/html"
delete_cert_perm_main_hdrs=""
delete_cert_perm_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
{showIssuerAndContents}
</head>
<body bgcolor="#FFFFFF" link="#6666CC" vlink="#6666CC" alink="#333399" 
	onLoad="parent.SetHelpURL('help.htm#{delete_cert_help}')">
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" >
<tr>
<td WIDTH="10"></td>
<td>
<table BORDER=0 CELLSPACING=0 >
<tr>
<td colspan="3">&nbsp;
<div class=bold>{delete_cert_question}<br>&nbsp;</div>
{view_cert_info pretty,view_cert_wrapper,view_cert_wrapper_no_comment}
</td>
</tr>
</table>
<hr size=3 noshade>
<p><b>{delete_cert_warning}</b></p>
</body>
</html>
:delete_cert_perm_main_content

delete_cert_perm_buttons_type="text/html"
delete_cert_perm_buttons_hdrs=""
delete_cert_perm_buttons_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body class=foot alink="#333399">
<form method="get" action="delete_certificate">
<input type=hidden name="baseRef" value="windowclose_doclose_js">
<input type=hidden name="target" value="%1$d">
{buttons_only {text_delete}}
</form>
</body>
</html>
:delete_cert_perm_buttons_content

;
; Set password dialog 
;
set_password_width=500
set_password_height=450
set_password_type="text/html"
set_password_hdrs=""
set_password_content:
{frame_set_param set_token_password,formsubmit}
:set_password_content

set_token_password_top_type="text/html"
set_token_password_top_hdrs=""
set_token_password_top_content:
{top_frame_no_image set_token_password_title}
:set_token_password_top_content

set_token_password_main_type="text/html"
set_token_password_main_hdrs=""
set_token_password_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvmodalstyle">
{disable_right_click_js}
</head>
<body class=content alink="#333399">
{formsubmit document.forms[0]}
<div>
<form method="get" action="formsubmit_handler" > 
<input type=hidden name="formName" value="set_db_password">
<input type=hidden name="target" value="%1$d">
<input type=hidden name="baseRef" value="windowclose_doclose_js">
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" >
<td WIDTH="10"></td>
<tr>
<td>&nbsp;
<table BORDER=0 CELLSPACING=5 >
<tr>
<td COLSPAN="3"><div>
{set_or_reset_password}
<tr VALIGN=CENTER>
<td align=right>
<p>{new_passwd}
</p>
</div></td>
<td></td>
<td><div><input type="password"  NAME="newpassword"  SIZE="16"></div></td>
</tr>
<tr VALIGN=CENTER>
<td align=right><p>
{new_passwd_again}
</p></td>
<td></td>
<td><div><input type="password" NAME="repeatpassword" SIZE="16"></div></td>
</tr>
</table>
<spacer type="vertical" size="12"></td>
<td></td>
</tr>
</table>
</td>
</tr>
</table>
{password_lifetime_pref}
<p class=alert>
{new_passwd_warning}
</p></td>
</form>
</div>
</body>
</html>
:set_token_password_main_content

curr_slot_name:
<script language=javascript>
document.write(document.forms[0].slot.value);
</script>
:curr_slot_name

password_lifetime:
<div class=plainbox>
<table border=0 cellspacing=2 cellpadding=0 width=100%%%%>
<tr valign=center>
<td></td>
<td colspan="3">
<p>{require_passwd}</p>
</td>
</tr>
<tr valign=center>
<td></td>
<td><input type="radio" name="passwordlife" value="firsttime" %1$s></td>
<td>
<p>{first_time_cert_requested}</p>
</td>
</tr>
<tr valign=center>
<td></td>
<td>
<p><input type="radio" name="passwordlife" value="everytime" %2$s></p></td>
<td>
<p>{every_time_cert_requested}
</td>
</tr>
<tr valign=center>
<td></td>
<td><input type="radio" name="passwordlife" value="expiretime" %3$s></td>
<td><div class=plain>
{passwd_timeout_entry}
</div>
</td>
</tr>
</table>
</div>
</td>
<td></td>
</tr>
:password_lifetime

select_slot_password_head=&nbsp;{please_select_token} <select name=slotname size=1>
select_slot_password_item=<!---unused %1$d %2$d %3$d---><option value="%4$s">%4$s
select_slot_password_end=</select>

internal_slot_only=<input type=hidden name=slotname value="%1$s">

set_new_password:
<input type=hidden name="slot" value="%1$s">
<div>
{choose_password_to_prevent_access}
</div>
<table BORDER=0 CELLSPACING=0 WIDTH="100%%%%" >
:set_new_password

reset_password:
<input type=hidden name="slot" value="%1$s">
<p>
{change_passwd}
</p>
<table BORDER=0 CELLSPACING=0 WIDTH="100%%%%" >
<tr VALIGN=CENTER>
<td align=right>
<p>{old_passwd}
</p>
</td>
<td></td>
<td><div><input type="password"  NAME="oldpassword"  SIZE="16"></div></td>
</tr>
<tr>
<td COLSPAN="3">
</tr>
:reset_password

set_token_password_buttons_type="text/html"
set_token_password_buttons_hdrs=""
set_token_password_buttons_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body class=foot alink="#333399" 
	onLoad="parent.SetHelpURL('help.htm#1051739')">
<script language=javascript>
{pop_up_alert}
function checknewpasswordfield()
{
  var passwordform = window.parent.DialogContent.document.forms[0];
  if (passwordform.oldpassword && passwordform.oldpassword.value == '') {
    PopUpAlert('{supply_current_password}');
    return false;
  }
  if (passwordform.newpassword.value != 
    passwordform.repeatpassword.value) {
    PopUpAlert('{invalid_new_password}');
    return false;
  }
  return true;
}
</script>
<form method="get" action="check_for_cancel" >

<input type=hidden name="baseRef" value="formsubmit_dosubmit_js">
<input type=hidden name=target value="%1$d">
<input type=hidden name=formName value="set_db_password">
{buttons_only {text_ok}}
</form>
</body>
</html>
:set_token_password_buttons_content

show_followup_width=450
show_followup_height=90
show_followup_type="text/html"
show_followup_hdrs=""
show_followup_content:
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
    <SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
  </head>
  <body>
    <center>
      <div>{show_result}</div>
    <form method=get action=get>
        <div><input type="button" name="do_ok" value="{text_ok}" width="72"
	   onClick="window.close();"></div>
        <input type=hidden name="baseRef" value="windowclose_doclose_js">
        <input type=hidden name="target" value="%1$d">
        <input type=hidden name="result" value="%2$s">
    </form>
    </center>
  </body>
</html>
:show_followup_content


;
; warning dialog that comes up when RA tries to 
; escrow the private key.
;
escrow_warning_type="text/html"
escrow_warning_hdrs=""
escrow_warning_width=520
escrow_warning_height=350
escrow_warning_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<title></title>
{disable_right_click_js}
{help_monitor_js}
{windowclose_monitor_js}
<frameset rows="50,*,40" border="0" frameborder="NO">
<frame src=get?baseRef=escrow_top&target=%1$d name="StandTop" scrolling="NO" marginwidth="0" marginheight="0">
<frame src=get?baseRef=escrow_main&target=%1$d name="StandContent" scrolling="Auto" marginwidth="0" marginheight="0">
<frame src=get?baseRef=escrow_bottom&target=%1$d name="StandFoot" scrolling="NO" marginwidth="0" marginheight="0">
</frameset>
</head>
</html>
:escrow_warning_content

escrow_top_type="text/html"
escrow_top_hdrs=""
escrow_top_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
<body CLASS=TOP alink="#333399">

<table>
<tr ALIGN="LEFT" VALIGN="TOP">
<!--- <td><img src="get?baseRef=alert1gif" width="35" height="30"></td> --->
<td><H1>{encryption_key_copy}</H1></td>
</tr>
</table>
</body>
</html>
:escrow_top_content

escrow_main_type="text/html"
escrow_main_hdrs=""
escrow_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
<body class=content>
<!---- unused %1$d  %2$s------>
<p class=alert>
{escrow_alert}
</p>

<BLOCKQUOTE>
{escrow_benefit1}
</BLOCKQUOTE>
<BLOCKQUOTE>
{escrow_alert2}
</BLOCKQUOTE>
<P class=alert>
{only_click_ok_if_trust_for_escrow}
</p>
</form>
</body>
</html>
:escrow_main_content

ok_cancel_content:
<form method="get" action="{$3}" name="ok_cancel_handler_form">
<input type=hidden name="target" value="%1$d">
<input type=hidden name="baseRef" value="{$2}">
<div align=right>
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 HEIGHT="100%%" >
<tr ALIGN=RIGHT VALIGN=CENTER>		   
<td width=50%%>
<div class=BUTTONSPACE>
<input type="submit" name="OK" value="{text_ok}" width="72">
</div>
</td>
<td>
<div class=BUTTONSPACE>
<input type="submit" name="Cancel" value="{text_cancel}" width="72">
</div>
<input type="hidden" name="formName" value="{$1}">
</td>
:ok_cancel_content

ok_cancel:
{ok_cancel_content {$1},{$2},{$3}}
</tr>
</table>
</div>
</form>
:ok_cancel

ok_cancel_help:
{ok_cancel_content {$1},{$2},{$3}}
<td width=30%%>
<div class=BUTTONSPACE>
<input CLASS=BUTTON type="button" name="Help" value="{text_help}" width="72" 
   onClick="parent.OpenHelp()">
</div>
</td>
</tr>
</table>
</div>
</form>
:ok_cancel_help

escrow_bottom_type="text/html"
escrow_bottom_hdrs=""
escrow_bottom_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body bgcolor="#CCCCCC"alink="#333399" 
      onLoad="parent.SetHelpURL('help.htm#1036310')">
{ok_cancel_help escrow_warning,windowclose_doclose_js,ok_cancel_handler}
</body>
</html>
:escrow_bottom_content

pop_up_alert:
function PopUpAlert(s)
{
    if (typeof(crypto) == "undefined" || typeof(crypto.alert) == "undefined") {
        alert(s);
    } else {
        crypto.alert(s);
    }
}
:pop_up_alert

;
;
; Select token dialog text 
;
select_token_type=text/html
select_token_width=400
select_token_height=300
select_token_content={frame_set_param kgtoken,formsubmit}
kgtoken_top_type=text/html
kgtoken_top_content={top_frame kgtoken_header,lockedgif,30,30}
kgtoken_buttons_type=text/html
kgtoken_buttons_content:
{formsubmit_buttons_frame tokenSelect,help.htm#1035650}
:kgtoken_buttons_content
kgtoken_main_type=text/html
kgtoken_main_content:
<html>
{formsubmit document.forms[0]}
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
<body class=CONTENT>
<form method=get action="tokenSelect" name="tokenSelectForm">

<p>
{psm_detects_mult_slots}
</P>
<p>
{select_slot_to_use}
</p>
<div class=indent>
<select name="token">
{tokenList kgtoken_popup_wrapper}
</select>
</div>
<input type=hidden name="baseRef" value="windowclose_doclose_js">
<input type=hidden name="target" value="%1$d">
</form>
</body>
</html>
:kgtoken_main_content
kgtoken_popup_wrapper=<!---- unused %1$d -----><option value='%3$d+%2$d'>%4$s

;select_token_bogus_content:
;<html>
;<head>
;<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
;<title>{select_token_title}</title>
;</head>
;<frameset rows="50, *, 40" border="0" frameborder="NO">
;<frame src="get?baseRef=tokenSelectTop" name="TokenSelectTop" scrolling="No" marginwidth="0" marginheight="0">
;<frame src="get?baseRef=tokenSelectContent" name="TokenSelectContent" scrolling="No" marginwidth="0" marginheight="0">
;<frame src="get?baseRef=tokenSelectButtons" name="buttons" scrolling="No" marginwidth="0" marginheight="0">
;</frameset>
;:select_token_bogus_content
;
;; top frame of the page
;tokenSelectTop_type=text/html
;tokenSelectTop_content:
;<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
;<html>
;<head>
;<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
;<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
;</head>
;{formsubmit document.forms[0]}
;<body class=top alink="#333399">
;<table>
;<tr align="left" valign="top"><
;<td></td>
;<td><h1>{choose_security_token}</h1><td>
;</tr>
;</table>
;</body>
;</html>
;:tokenSelectTop_content
;
;; middle frame of the page
;tokenSelectContent_type=text/html
;tokenSelectContent_content:
;<html>
;<head>
;<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
;<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
;</head>
;<body class=CONTENT>
;<form method=get action=tokenSelect name="tokenSelectForm">
;<p>Netscape
;Personal Security Manager has detected multiple Security
;Tokens installed on your
;computer.</P>
;<p>Please
;choose the Security Token which Netscape Personal Security Manager should use.</p>
;<div class=indent>
;<select name="token">{tokenList tokenListPopupWrapper}</select>
;</div>
;<input type=hidden name="baseRef" value="windowclose_doclose_js">
;<input type=hidden name="target" value="%1$d">
;</form>
;</body>
;</html>
;:tokenSelectContent_content
;tokenListPopupWrapper=<option>%1$d
;
;tokenSelectButtons_content:
;<html>
;<head>
;<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
;<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
;</head>
;<body onLoad="">
;<!-- hook up selectToken_help target -->
;{ok_cancel_help tokenSelectForm,formsubmit_dosubmit_js,ok_cancel_handler}
;</body>
;</html>
;:tokenSelectButtons_content

;
; can't import certificate into the DB because it's already exists
; top level frame set
;
cert_already_exists_type="text/html"
cert_already_exists_hdrs=""
cert_already_exists_width=520
cert_already_exists_height=350
cert_already_exists_content:
{frame_set cert_exists,windowclose}
:cert_already_exists_content

;
; can't import certificate into the DB because it's already exists
; top frame
;
cert_exists_top_type="text/html"
cert_exists_top_hdrs=""
cert_exists_top_content:
{top_frame cert_cannot_import_in_db,alert1gif,35,30}
:cert_exists_top_content

;
; can't import certificate into the DB because it's already exists
; middle frame
;
cert_exists_main_type="text/html"
cert_exists_main_hdrs=""
cert_exists_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
<body class=content alink="#FF0000">
<br>
<p>
{cert_already_exists_in_db_string}
</p>
</body>
</html>
:cert_exists_main_content

;
; can't import certificate into the DB because it's already exists
; buttons frame
;
cert_exists_buttons_type="text/html"
cert_exists_buttons_hdrs=""
cert_exists_buttons_content:
{windowclose_buttons_frame OKButton,help.htm}
:cert_exists_buttons_content


; 
; Import CA certificate dialog box 1, 
; top level frame set
;
import_ca_cert1_type="text/html"
import_ca_cert1_hdrs=""
import_ca_cert1_width=520
import_ca_cert1_height=350
import_ca_cert1_content:
{frame_set_param import_ca_cert_oldstyle1,windowclose}
:import_ca_cert1_content

;
; Import CA certificate dialog box 1, 
; top frame
;
import_ca_cert_oldstyle1_top_type="text/html"
import_ca_cert_oldstyle1_top_hdrs=""
import_ca_cert_oldstyle1_top_content:
{top_frame import_ca_cert_title1, alert1gif,35,35}
:import_ca_cert_oldstyle1_top_content

;
; Import CA certificate dialog box 1,
; middle frame
;
import_ca_cert_oldstyle1_main_type="text/html"
import_ca_cert_oldstyle1_main_hdrs=""
import_ca_cert_oldstyle1_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
<body class=content>
<form>
<input type=hidden name="target" value="%1$d">
<input type=hidden name="certres" value="%2$s">
<input type=hidden name="nickname" value="%3$s">
<P>
{import_ca_cert_text1}
<p>
{import_ca_cert_text2}
<p>
{import_ca_cert_text3}
</P>
<div class=Plainbox>
<TABLE>
<TR valign=top>
<TD><div>
<input type="button" value={text_view} width="105" 
onClick="window.open('get?baseRef=ca_cert_view&target=%1$d&certres=%2$s&bogus=bogus',
'popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')">
</div></TD>
<TD>
<P>{ca_cert_here_string}</P>
</TD>
</TR>
<TR valign=top>
<TD><div>
<input type="button" value={text_policy} width="105"
onClick="window.open('get?baseRef=ca_policy_view&target=%1$d&certres=%2$s&bogus=bogus','popup',
'width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')
">
</div></TD>
<TD>
<P>{policy_ca_cert_doc_here_string}
</P>
</TD>
</TR>
</TABLE>
</div>
<form>
</body>
</html>
:import_ca_cert_oldstyle1_main_content

;
; Import CA certificate dialog box 1,
; buttons frame
;
import_ca_cert_oldstyle1_buttons_type="text/html"
import_ca_cert_oldstyle1_buttons_hdrs=""
import_ca_cert_oldstyle1_buttons_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body class=foot alink="#333399" 
	onLoad="parent.SetHelpURL('help.htm#1036401')">
<form method="get" action="importCACert1">
<input type=hidden name="baseRef" value="windowclose_doclose_js">
<input type=hidden name="target" value="%1$d">
{buttons_only {text_next}}
</form>
</body>
</html>
:import_ca_cert_oldstyle1_buttons_content

;
; Import CA certificate dialog box 2,
; top level frameset
;
import_ca_cert2_type="text/html"
import_ca_cert2_hdrs=""
import_ca_cert2_width=520
import_ca_cert2_height=350
import_ca_cert2_content:
{frame_set import_ca_cert_oldstyle2,formsubmit}
:import_ca_cert2_content

;
; Import CA certificate dialog box 2
; top frame
;
import_ca_cert_oldstyle2_top_type="text/html"
import_ca_cert_oldstyle2_top_hdrs=""
import_ca_cert_oldstyle2_top_content:
{top_frame import_ca_cert_title2,alert1gif,35,35}
:import_ca_cert_oldstyle2_top_content

;
; Import CA certificate dialog box 2
; middle frame
;
import_ca_cert_oldstyle2_main_type="text/html"
import_ca_cert_oldstyle2_main_hdrs=""
import_ca_cert_oldstyle2_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
{formsubmit document.forms[0]}
<body class=content alink="#333399">

<form method="get" action="formsubmit_handler" name="trust_new_ca">
<input type=hidden name="baseRef" value="windowclose_doclose_js">
<input type=hidden name="target" value="%1$d">

<P>
{import_ca_cert_dialog2}
</P>

<div class=Plainbox>
<TABLE>
<TR valign=top>
<TD>
<input type="checkbox" name="acceptssl" value="ssl">
</TD>
<TD>
<DIV CLASS=Plain>{accept_website}</div>
</TD>
</TR>
<TR valign=top>
<TD>
<input type="checkbox" name="acceptemail" value="email" >
</TD>
<TD>
<DIV CLASS=Plain>{accept_email}</div>
</TD>
</TR>
<TR valign=top>
<TD>
<input type="checkbox" name="acceptobject" value="object">
</TD>
<TD>
<DIV CLASS=Plain>{accept_object}</div>
</TD>
</TR>
</TABLE>
</div>

</form>
</body>
</html>
:import_ca_cert_oldstyle2_main_content

;
; Import CA certificate dialog box 2,
; buttons frame
;
import_ca_cert_oldstyle2_buttons_type="text/html"
import_ca_cert_oldstyle2_buttons_hdrs=""
import_ca_cert_oldstyle2_buttons_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body class=foot alink="#333399"
	onLoad="parent.SetHelpURL('help.htm#1036401')">
<form method="get" action="check_for_cancel" >
<input type=hidden name="baseRef" value="formsubmit_dosubmit_js">
<input type=hidden name="target" value="%1$d">
<input type=hidden name="formName" value="trust_new_ca">
{buttons_only {text_finished}}
</form>
</body>
</html>
:import_ca_cert_oldstyle2_buttons_content

;
; CA certificate policy
; top level frame set
;
ca_policy_view_type="text/html"
ca_policy_view_hdrs=""
ca_policy_view_content:
{frame_set_param ca_policy,windowclose}
:ca_policy_view_content

ca_policy_top_type="text/html"
ca_policy_top_hdrs=""
ca_policy_top_content:
{top_frame view_ca_policy_title,certgif,35,30}
:ca_policy_top_content

ca_policy_main_type="text/html"
ca_policy_main_hdrs=""
ca_policy_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
<body>
<p>
<table>
<td></td>
<td><div>
{_ca_policy_info}
</div></td>
</table>
<p>
</html>
:ca_policy_main_content

ca_policy_buttons_type="text/html"
ca_policy_buttons_hdrs=""
ca_policy_buttons_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body bgcolor="#CCCCCC" link="#6666CC" vlink="#6666CC" alink="#333399">
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" HEIGHT="100%" >
<tr ALIGN=RIGHT VALIGN=center>
<td>
<form method="get" action="get">
<input type=hidden name="baseRef" value="windowclose_doclose_js">
<div class=buttonspace><input type="submit" name="do_ok"
        value="{text_ok}" width="72"></div>
</form>
</td></tr>
</table>
</body>
</html>
:ca_policy_buttons_content

ca_policy_top
;
; CA certificate info  
; top level frame set
;
ca_cert_view_type="text/html"
ca_cert_view_hdrs=""
ca_cert_view_content:
{frame_set_param view_ca_cert,windowclose}
:ca_cert_view_content

;
; CA certificate info 
; top frame
;
view_ca_cert_top_type="text/html"
view_ca_cert_top_hdrs=""
view_ca_cert_top_content:
{top_frame ca_cert_view_header,lockedgif,35,35}
:view_ca_cert_top_content

;
; CA certificate info
; middle frame
;
view_ca_cert_main_type="text/html"
view_ca_cert_main_hdrs=""
view_ca_cert_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
<body class=CONTENT>
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" >
<tr>
<td WIDTH="10"></td>

<td>
<table BORDER=0 CELLSPACING=0 >
<tr><td>&nbsp;</td></tr>
<tr><td>&nbsp;</td></tr>
<tr></tr>
{view_cert_info pretty,view_cert_wrapper,view_cert_wrapper_no_comment}
</td>
</tr>
</table>
<font face="{nsm_view_cert_font}"><font size=-1></font></font>
</body>
</html>
:view_ca_cert_main_content


view_ca_cert_buttons_type=text/html
view_ca_cert_buttons_hdrs=""
view_ca_cert_buttons_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body bgcolor="#CCCCCC" link="#6666CC" vlink="#6666CC" alink="#333399">
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" HEIGHT="100%" >
<tr ALIGN=RIGHT VALIGN=center>
<td>
<form method="get" action="get">
<input type=hidden name="baseRef" value="windowclose_doclose_js">
<div class=buttonspace><input type="submit" name="do_ok" 
	value="{text_ok}" width="72">
</form>
</td></tr>
</table>
</body>
</html>
:view_ca_cert_buttons_content


; use this macro to insert the glossary icon ("i")
;
glossary_icon:
<img SRC="get?baseRef=infojpg" ALT="Glossary Entry" ALIGN=ABSBOTTOM>
:glossary_icon

;
; client auth failure top level fram set HTML
;
bad_client_auth_type="text/html"
bad_client_auth_hdrs=""
bad_client_auth_width=520
bad_client_auth_height=350
bad_client_auth_content:
{frame_set bca,windowclose}
:bad_client_auth_content

;
; client auth failure top frame
;
bca_top_type="text/html"
bca_top_hdrs=""
bca_top_content:
{top_frame bad_client_auth_header,lockedgif,35,30}
:bca_top_content

;
; client auth failure buttons frame
;
bca_buttons_type="text/html"
bca_buttons_hdrs=""
bca_buttons_content:
{windowclose_buttons_frame BCAButton,help.htm#1036343}
:bca_buttons_content

;
; client auth failure main frame
;
bca_main_type="text/html"
bca_main_hdrs=""
bca_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
<body class=content alink="#FF0000">
<p>{client_auth_greeting_string}</p>

<table WIDTH=500px>
<tr VALIGN=CENTER>
<td ALIGN=CENTER WIDTH="90px"><img SRC="get?baseRef=certgif" height=60 width=80></td>

<td ALIGN=CENTER VALIGN=TOP>
{_server_cert_info simple,serverCert_format,serverCert_format}

</td></tr></table>

<HR WIDTH=96% ALIGN=CENTER>

<table>
<tr VALIGN=CENTER>
<td align=center width="90px"><img SRC="get?baseRef=nocertgif" height=60 width=80></td>
<td WIDTH="400">
<div class=plain>
{bad_client_auth_string}
</div>
</td></tr></table>
</body>
</html>
:bca_main_content

;
; server cert format
;
serverCert_format:
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=2>
<tr><td COLSPAN="2">
<div class=plain>
%1$s
</div>
</td><td></td></tr>

<tr><td>
<div class=plain>
{serverCert_org}
</div>
</td>

<td>
<div class=plain>
%5$s
</div>
</td></tr>

<tr><td COLSPAN="2">
<div class=plain>
{serverCert_issuer}%4$s
</div>
</td><td></td></tr></table>
<!-- %2$s %3$s unused -->
:serverCert_format

;
; -- END -- bad_client_auth
;

;
; client auth top level frame set HTML
;
client_auth_type="text/html"
client_auth_hdrs=""
client_auth_width=520
client_auth_height=350
client_auth_content:
{frame_set client_auth,formsubmit}
:client_auth_content

;
; client auth top frame
;
client_auth_top_type="text/html"
client_auth_top_hdrs=""
client_auth_top_content:
{top_frame client_auth_header,lockedgif,30,30}
:client_auth_top_content

;
; client auth buttons frame
;
client_auth_buttons_type="text/html"
client_auth_buttons_hdrs=""
client_auth_buttons_content:
{formsubmit_buttons_frame cert_selection,help.htm#1036330}
:client_auth_buttons_content

;
; client auth main frame
;
client_auth_main_type="text/html"
client_auth_main_hdrs=""
client_auth_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
{formsubmit document.forms[0]}
<body class=content alink="#FF0000">
<p>{client_auth_greeting_string}</p>

<table WIDTH=500px>
<tr VALIGN=CENTER>
<td ALIGN=CENTER WIDTH="90px"><img SRC="get?baseRef=certgif" height=60 width=80></td>

<td ALIGN=CENTER VALIGN=TOP>
{_server_cert_info simple,serverCert_format,serverCert_format}

</td></tr></table>

<HR WIDTH=96%% ALIGN=CENTER>

<form method="get" action="formsubmit_handler" name="cert_selection">
<table>
<tr VALIGN=CENTER>
<td align=center width="90px"><img SRC="get?baseRef=certgif" height=60 width=80></td>
<td WIDTH="400">
<div class=plain>
{client_auth_string}
{_client_auth_certList userCert_prefix,userCert_wrapper,userCert_suffix}
</div>
</td></tr></table>
<input type=hidden name="baseRef" value="windowclose_doclose_js">
<input type=hidden name="target" value="%1$d">
</form>
</body>
</html>
:client_auth_main_content


;
; user cert list format (parameters for "_client_auth_certList")
; userCert_wrapper: %1$s}: index of the cert nickname,
;                   %2$s: (UnicodeString) nickname
;
userCert_prefix=<select name="chosen">
userCert_wrapper=<option value=%1$d>%2$s
userCert_suffix=</select>
;
; -- END -- client_auth
;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;
; PKCS11 UI
;

adv_modules_type=text/html
adv_modules_content:
<script language="JavaScript1.2">
var modules = new Array();
var slots = new Array();

var currentModule = null;
var currentSlot = null;

function Window_parent_reload_once()
{
    // Reload once, then clear the handler.
    // Intended as a one-off reloader after module addition.
    //alert("Reloading once.");
    if (advisor != null)
        advisor.ReloadModules();
    // window.onfocus = null;
    // ReloadModules();
}

function pk11_module_add()
{
    // window.onfocus = Window_reload_once;
    var wnd = window.open('get?baseRef=pk11_module_add&target=%1$d',
                          'popup','width={pk11_module_add_width},height={pk11_module_add_height},status=no,toolbar=no,menubar=no');
    wnd.advisor = self;
    // wnd.onunload = Window_parent_reload_once;
    return false;
}

function ReloadModules()
{
    currentModule = null;
    frames[1].location = "get?baseRef=adv_modules_module_list";
}

function ClearCurrentModule()
{
    currentModule = null;
    frames[2].location = "get?baseRef=adv_modules_module_info";
    frames[3].location = "PKCS11ShowSlots?no_module=0";
}

function Module_load()
{
    currentModule = this;
    frames[2].location = "get?baseRef=adv_modules_module_info";
    frames[3].location = "PKCS11ShowSlots?module=" + this.ID;
}

function Module(ID, name, label, file, version)
{
    this.ID = ID;
    this.name = name;
    this.label = label;
    this.file = file;
    this.version = version;
}

// initialize the Module class
new Module(0, "", "", "", "");
Module.prototype.load = Module_load;

function ClearCurrentSlot()
{
    currentSlot = null;
    frames[4].location = "get?baseRef=adv_modules_blank_slot_info";
}
{pop_up_alert}

function DoSomethingToSlot(what)
{
    if (what == 'LogoutAllSlots') 
    {
        if (typeof(crypto) != "undefined" && 
            typeof (crypto.logout) != "undefined") {
            crypto.logout();
        }
        if (currentSlot != null)
        {
            var command = "PKCS11ShowSlot"
                + "?module=" + currentModule.ID 
                + "&slot=" + currentSlot.ID;
            frames[4].location = command;
        }
    }
    else if (currentSlot != null)
    {
        var command = "PKCS11" + what 
            + "?module=" + currentModule.ID 
            + "&slot=" + currentSlot.ID;
        frames[4].location = command;
    }
    else
    {
        PopUpAlert('{please_select_slot}');
    }
}

function Slot_load()
{
    currentSlot = this;
    DoSomethingToSlot("ShowSlot");
}

var bypassAssert = -999;

{pop_up_alert}

function Slot(ID, modID, name, status, serial, version)
{
    if ((currentModule == null) && (ID != bypassAssert))
        PopUpAlert({creating_slot_that_does_not_belong_to_mod});
    this.ID = ID;
    this.moduleID = modID;
    this.name = name;
    this.status = status;
    this.serial = serial;
    this.version = version;
}

// initialize the Slot class
new Slot(bypassAssert, 0, "", "", "", "");
Slot.prototype.load = Slot_load;
parent.SetHelpURL('help.htm#1036162');
</script>

<frameset rows="10%%,70%%,*" border="0" frameborder="no">
    <frame src="get?baseRef=adv_modules_supertitle" scrolling="no" marginwidth="0" marginheight="0">
    <frameset cols="1*,1*" border="0" frameborder="no">
        <frameset rows="1*,100" border="0" frameborder="no">
            <frame src="get?baseRef=adv_modules_module_list" name="modlist" scrolling="no" marginwidth="0" marginheight="0">
            <frame src="about:blank" name="modinfo" scrolling="no" marginwidth="0" marginheight="0">
        </frameset>
        <frameset rows="1*,100" border="0" frameborder="no">
            <frame src="get?baseRef=adv_modules_slot_list" name="slotlist" scrolling="no" marginwidth="0" marginheight="0">
            <frame src="about:blank" name="slotinfo" scrolling="no" marginwidth="0" marginheight="0">
        </frameset>
    </frameset>
    <frame src="get?baseRef=adv_modules_fips_pane" name="fips" scrolling="no" marginwidth="0" marginheight="0">
</frameset>
:adv_modules_content

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

adv_modules_supertitle_type=text/html
adv_modules_supertitle_content:
<HTML><HEAD>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<link REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</HEAD><BODY bgcolor=#FFFFFF>

<p>
{conifugre_and_view_pkcs11}
</p>
</BODY></HTML>
:adv_modules_supertitle_content

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

pk11_newmodulewrap=parent.modules[%1$d] = new parent.Module(%2$d, "%3$s", "%4$s", "%5$s", "%6$s");
pk11_modulelistwrap=<!----- unused %1$d %3$s ----><option value="%2$d">%4$s
adv_modules_module_list_type=text/html
adv_modules_module_list_content:
<HTML><HEAD>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<link REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</HEAD><BODY bgcolor=#FFFFFF>
<p class=bu>{select_module}</p>
<script language="JavaScript1.2">
<!-- data here comes from PSM -->
{_pk11modules pk11_newmodulewrap}
{pop_up_alert}
function DeleteModule()
{
    if (parent.currentModule != null)
    {
	pkcs11.deletemodule(parent.currentModule.label);
        location = "get?baseRef=adv_modules_module_list";
    }
    else
    {
        PopUpAlert("{select_module_to_delete}");
    }
}
<!-- end of data from NSM -->
</script>

<FORM><div class=plainbox>

<table CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%" >
<tr><td></td></tr>
<tr><td><div>
<select NAME="selectName" size="5" width="230" onChange="parent.modules[selectedIndex].load()">
{_pk11modules pk11_modulelistwrap}
</select>
</td></div></tr>
<tr><td><div>
<input type="button" value="{text_add}"width="72"  onClick="parent.pk11_module_add()">
<spacer type="horizontal" size="12">
<input type="button" value="{text_delete}" width="72" onClick="DeleteModule()">
</td></div></tr>
</table>
</div>
</FORM>
</BODY>
<script language=javascript>
parent.ClearCurrentModule();
</script>
</HTML>
:adv_modules_module_list_content

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

pk11_module_add_type=text/html
pk11_module_add_width=520
pk11_module_add_height=350
pk11_module_add_content={frame_set pk11_addmodule,formsubmit}

pk11_addmodule_top_type=text/html
pk11_addmodule_top_hdrs=""
pk11_addmodule_top_content={top_frame add_module_title,lockedgif,35,35}

pk11_addmodule_main_type=text/html
pk11_addmodule_main_hdrs=
pk11_addmodule_main_content:
<HTML>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvmodalstyle">
{disable_right_click_js}
</head>
{formsubmit document.forms[0]}
<SCRIPT LANGUAGE="JavaScript">
// Crypto Mechanism Flags 
PKCS11_MECH_RSA_FLAG           =  0x1<<0; 
PKCS11_MECH_DSA_FLAG           =  0x1<<1; 
PKCS11_MECH_RC2_FLAG           =  0x1<<2; 
PKCS11_MECH_RC4_FLAG           =  0x1<<3; 
PKCS11_MECH_DES_FLAG           =  0x1<<4; 
PKCS11_MECH_DH_FLAG            =  0x1<<5; //Diffie-Hellman 
PKCS11_MECH_SKIPJACK_FLAG      =  0x1<<6; //SKIPJACK algorithm as in Fortezza cards 
PKCS11_MECH_RC5_FLAG           =  0x1<<7; 
PKCS11_MECH_SHA1_FLAG          =  0x1<<8; 
PKCS11_MECH_MD5_FLAG           =  0x1<<9; 
PKCS11_MECH_MD2_FLAG           =  0x1<<10; 
PKCS11_MECH_RANDOM_FLAG        =  0x1<<27; //Random number generator 
PKCS11_PUB_READABLE_CERT_FLAG  =  0x1<<28; //Stored certs can be read off the token w/o logging in 
PKCS11_DISABLE_FLAG            =  0x1<<30; //tell Navigator to disable this slot by default 

// Important: 
// 0x1<<11, 0x1<<12, ... , 0x1<<26, 0x1<<29, and 0x1<<31 are reserved 
// for internal use in Navigator. 
// Therefore, these bits should always be set to 0; otherwise, 
// Navigator might exhibit unpredictable behavior. 

// These flags indicate which mechanisms should be turned on by 
pkcs11MechanismFlags = PKCS11_MECH_RANDOM_FLAG; 
  

// Ciphers that support SSL or S/MIME 
PKCS11_CIPHER_FORTEZZA_FLAG    = 0x1<<0; 

// Important: 
// 0x1<<1, 0x1<<2, ... , 0x1<<31 are reserved 
// for internal use in Navigator. 
// Therefore, these bits should ALWAYS be set to 0; otherwise, 
// Navigator might exhibit unpredictable behavior. 

// These flags indicate which SSL ciphers are supported 
pkcs11CipherFlags = PKCS11_CIPHER_FORTEZZA_FLAG; 
  

// Return values of pkcs11.addmodule() & pkcs11.delmodule() 
// success codes 
JS_OK_ADD_MODULE                 = 3 // Successfully added a module 
JS_OK_DEL_EXTERNAL_MODULE        = 2 // Successfully deleted ext. module 
JS_OK_DEL_INTERNAL_MODULE        = 1 // Successfully deleted int. module 

// failure codes 
JS_ERR_OTHER                     = -1 // Other errors than the followings 
JS_ERR_USER_CANCEL_ACTION        = -2 // User abort an action 
JS_ERR_INCORRECT_NUM_OF_ARGUMENTS= -3 // Calling a method w/ incorrect # of arguments 
JS_ERR_DEL_MODULE                = -4 // Error deleting a module 
JS_ERR_ADD_MODULE                = -5 // Error adding a module 
JS_ERR_BAD_MODULE_NAME           = -6 // The module name is invalid 
JS_ERR_BAD_DLL_NAME              = -7 // The DLL name is bad 
JS_ERR_BAD_MECHANISM_FLAGS       = -8 // The mechanism flags are invalid 
JS_ERR_BAD_CIPHER_ENABLE_FLAGS   = -9 // The SSL, S/MIME cipher flags are invalid 

var new_window;
var has_new_window = 0;

function HandleCipher(checkBox) {
	if (checkBox.checked) {
		pkcs11MechanismFlags |= checkBox.value;
	} else {
		pkcs11MechanismFlags &= ~checkBox.value;
	}
}

function HandleSSL(checkBox) {
	if (checkBox.checked) {
		pkcs11CipherFlags |= checkBox.value;
	} else {
		pkcs11CipherFlags &= ~checkBox.value;
	}
}

function colonize(string) {
	len = string.length;
	end = len -1;

	if (len == 0) return string;


	for (i=0; i < len; i++) {
	   if (string.charAt(i) == "/") {
		if (i == 0) {
		    new_string = ":" + string.substring(1,len);
		} else if (i == end) {
		    new_string = string.substring(0,i)+':';
		} else {
		    new_string = string.substring(0,i)+':'+
						string.substring(i+1,len);
		}
		string = new_string;
	   }
	}

	if (string.charAt(0) == ":") string = string.substring(1,len);
	return string;
}

{pop_up_alert}

function DoInstall(name,module) {
	if ((navigator.platform == "MacPPC") 
			|| (navigator.platform == "Mac68K")) {
	    module = colonize(module);
	}
        if (typeof(pkcs11) != "undefined") {
            result = pkcs11.addmodule(name, module, 
            pkcs11MechanismFlags, pkcs11CipherFlags); 
            if (result < 0) 
            {
                PopUpAlert("{new_mod_setup_failed}" + result); 
            }
            else
            {
                if (top.advisor != null)
                    top.advisor.ReloadModules();
                else
                    PopUpAlert("{no_sec_advisor}");
            }
        } else {
            PopUpAlert("{pkcs11_class_undefined}");
        }
	top.window.close();
}

default_name = "Netscape Module";

default_module = "D:/dogbert/ns/dist/WIN32_D.OBJ/bin/fort32.dll"
document.writeln('<body bgcolor="white">');
document.writeln("<FORM name=instform target=_self><table>");
document.writeln('<tr valign=center><td></td><td align=right><div>{mod_name}</div></td><td><div> <Input Type=Text Name=modName value='+default_name+' size=28 required></div></td></tr>');
document.writeln("<tr valign=center><td></td><td align=right><div>{mod_filename}</div></td><td><div><Input Type=FILE required Name=module></div></td></tr></table>");
document.writeln('<tr><td COLSPAN="4"><hr SIZE=3 NOSHADE WIDTH="100%"></td></tr>');
document.writeln('<tr><td colspan=2><p>{enter_info_for_mod}</p></td><td></td></tr>');
document.writeln("</FORM></body></html>");

function submitif() {
  if (top.dosubmit) {
    DoInstall(document.instform.modName.value, document.instform.module.value);
    top.closewin();
  }
  return false;
}
</SCRIPT>
:pk11_addmodule_main_content

formsubmit_buttons_close_on_cancel_frame:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body class=foot alink="#333399" onLoad="parent.SetHelpURL('{$2}')">
{ok_cancel_help {$1},formsubmit_dosubmit_js,close_if_cancel}
</body>
</html>
:formsubmit_buttons_close_on_cancel_frame

pk11_addmodule_buttons_type=text/html
pk11_addmodule_buttons_hdrs=
pk11_addmodule_buttons_content:
{formsubmit_buttons_close_on_cancel_frame pk11_addmodule,help.htm#1040860}
:pk11_addmodule_buttons_content

;pk11_module_add_unused:
;document.writeln("<hr><TABLE><TR><TD>");
;document.writeln("<Input type=Checkbox name=RSA value="+PKCS11_MECH_RSA_FLAG+" onclick=HandleCipher(document.instform.RSA)> RSA<br>");
;document.writeln("<Input type=Checkbox name=DSA value="+PKCS11_MECH_DSA_FLAG+" onclick=HandleCipher(document.instform.DSA)> DSA<br>");
;document.writeln("<Input type=Checkbox name=RC2 value="+PKCS11_MECH_RC2_FLAG+" onclick=HandleCipher(document.instform.RC2)> RC2<br>");
;document.writeln("<Input type=Checkbox name=RC4 value="+PKCS11_MECH_RC4_FLAG+" onclick=HandleCipher(document.instform.RC4)> RC4<br>");
;document.writeln("</TD><TD>");
;document.writeln("<Input type=Checkbox name=DES value="+PKCS11_MECH_DES_FLAG+" onclick=HandleCipher(document.instform.DES)> DES<br>");
;document.writeln("<Input type=Checkbox name=DH value="+PKCS11_MECH_DH_FLAG+" onclick=HandleCipher(document.instform.DH)> DH<br>");
;document.writeln("<Input type=Checkbox name=SKIPJACK value="+PKCS11_MECH_SKIPJACK_FLAG+" onclick=HandleCipher(document.instform.SKIPJACK)> SKIPJACK<br>");
;document.writeln("<Input type=Checkbox name=RC5 value="+PKCS11_MECH_RC5_FLAG+" onclick=HandleCipher(document.instform.RC5)> RC5<br>");
;document.writeln("</TD><TD>");
;document.writeln("<Input type=Checkbox name=SHA1 value="+PKCS11_MECH_SHA1_FLAG+" onclick=HandleCipher(document.instform.SHA1)> SHA1<br>");
;document.writeln("<Input type=Checkbox name=MD5 value="+PKCS11_MECH_MD5_FLAG+" onclick=HandleCipher(document.instform.MD5)> MD5<br>");
;document.writeln("<Input type=Checkbox name=MD2 value="+PKCS11_MECH_MD2_FLAG+" onclick=HandleCipher(document.instform.MD2)> MD2<br>");
;document.writeln("</TD><TD>");
;document.writeln("<Input type=Checkbox name=Random value="+PKCS11_MECH_RANDOM_FLAG+" CHECKED onclick=HandleCipher(document.instform.Random)> Random Number Generation<br>");
;document.writeln("<Input type=Checkbox name=readCert value="+PKCS11_PUB_READABLE_CERT_FLAG+" onclick=HandleCipher(document.instform.ReadCert)> Public Readable Certificates<br>");
;document.writeln("<Input type=Checkbox name=Disable value="+PKCS11_DISABLE_FLAG+" onclick=HandleCipher(document.instform.Disable)> Disable<br>");
;document.writeln("</TD></TR></TABLE>");
;document.writeln("<hr>");
;document.writeln("<Input type=Checkbox name=fortssl value="+ PKCS11_CIPHER_FORTEZZA_FLAG +" onclick=HandleSSL(document.instform.fortssl)> Enable FORTEZZA menus<br>");
;:pk11_module_add_unused
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

adv_modules_module_info_type=text/html
adv_modules_module_info_content:
<HTML><HEAD>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<link REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</HEAD><BODY bgcolor=#FFFFFF>
<script language=javascript>
var modName = '';
var modFile = '';
var modVersion = '';
if (parent.currentModule != null)
{
    with (parent.currentModule)
    {
        modName = name;
        modFile = file;
        modVersion = version;
    }
}
</script>
<table CELLSPACING=0 CELLPADDING=0>
<tr><td COLSPAN="2"><div><BR><p class=SMALL>{text_information}</p></div></td></tr>
<tr><td><div><p class=SMALL>{text_name}</p></div></td><td><div><p class=SMALL>
<script language=javascript>
document.write(modName);
</script>
</p></div></td></tr>
<tr><td><div><p class=SMALL>{module_prompt}</p></div></td><td><div><p class=SMALL>
<script language=javascript>
document.write(modFile);
</script>
</p></div></td></tr>
<tr><td><div><p class=SMALL>{version_num}</p></div></td><td><div><p class=SMALL>
<script language=javascript>
document.write(modVersion);
</script>
</p></div></td></tr>
</table>
</body></html>
:adv_modules_module_info_content

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; Note to localizers: The reason for concatenation here is not to break
; up user-visible text, but to provide for programmatic filling of the 
; slot list. User-visible (localizable) text still appears as whole
; passages within each part.

adv_modules_slotlist_type=text/html
adv_modules_slotlist_part1:
<HTML><HEAD>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<link REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
<!-- data here comes from PSM -->
<script language="JavaScript">
parent.slots = new Array();
:adv_modules_slotlist_part1

adv_modules_slotlist_js_template=parent.slots[%1$d] = new parent.Slot(%2$d, %3$d, "%4$s", "%5$s", "%6$s", "%7$s");

adv_modules_slotlist_part2:
</script>
<!-- end of data from PSM -->
</HEAD><BODY bgcolor=#FFFFFF>
<p class=bu>{sel_security_device}</p>
<FORM><div>
<table CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%%" >
<tr><td></td></tr>
<tr><td><div>
<select NAME="selectName" size="5" width="230" onChange="parent.slots[selectedIndex].load()">
:adv_modules_slotlist_part2

adv_modules_slotlist_select_template=<!---- unused %1$d %3$d ------><OPTION VALUE="%2$d">%4$s

adv_modules_slotlist_part3:
</select>
</td></div></tr>
<tr><td><div>
<input type="button" value="{text_login}"width="72"  onClick=parent.DoSomethingToSlot("LoginSlot")>
<spacer type="horizontal" size="12">
<input type="button" value="{text_logout}" width="72" onClick=parent.DoSomethingToSlot("LogoutSlot")>
<spacer type="horizontal" size="12">
<input type="button" value="{text_logout_all}" width="72" onClick=parent.DoSomethingToSlot("LogoutAllSlots")>
</td></div></tr>
</table>
</div>
</FORM>
</BODY>
<script language=javascript>
parent.ClearCurrentSlot();
</script>
</HTML>
:adv_modules_slotlist_part3

adv_modules_slot_list_type=text/html
adv_modules_slot_list_content:
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
{disable_right_click_js}
</head>
<body bgcolor=#FFFFFF></body></html>
:adv_modules_slot_list_content

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

adv_modules_slot_info_type=text/html
adv_modules_slot_info_content:
<HTML><HEAD>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<link REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</HEAD><BODY bgcolor=#FFFFFF>
<table CELLSPACING=0 CELLPADDING=0>
<!----- unused
	%1$d %2$d %3$d %4$s
 ------->
<tr><td COLSPAN="2"><div><BR><p class=SMALL>{text_information}</p></div></td></tr>
<tr><td><div><p class=SMALL>{text_status}</p></div></td><td><div><p class=SMALL>%5$s</p></div></td></tr>
<tr><td><div><p class=SMALL>{serial_num}</p></div></td><td><div><p class=SMALL>%6$s</p></div></td></tr>
<tr><td><div><p class=SMALL>{version_num}</p></div></td><td><div><p class=SMALL>%7$s</p></div></td></tr>
</table>
</body></html>
:adv_modules_slot_info_content

adv_modules_blank_slot_info_type=text/html
adv_modules_blank_slot_info_content:
<HTML><HEAD>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<link REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</HEAD><BODY bgcolor=#FFFFFF>
<table CELLSPACING=0 CELLPADDING=0>
<tr><td COLSPAN="2"><div><BR><p class=SMALL>{text_information}</p></div></td></tr>
<tr><td><div><p class=SMALL>{text_status}</p></div></td><td><div><p></p></div></td></tr>
<tr><td><div><p class=SMALL>{serial_num}</p></div></td><td><div><p></p></div></td></tr>
<tr><td><div><p class=SMALL>{version_num}</p></div></td><td><div><p></p></div></td></tr>
</table>
</body></html>
:adv_modules_blank_slot_info_content

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

adv_modules_fips_pane_type=text/html
adv_modules_fips_pane_content={adv_modules_fips_pane_template blank}
adv_modules_fips_pane_reply_type=text/html
adv_modules_fips_pane_reply_content:
{adv_modules_fips_pane_template _reloadModules}
:adv_modules_fips_pane_reply_content

_reloadModules:
<script language=javascript>
parent.ReloadModules();
</script>
:_reloadModules

adv_modules_fips_pane_template:
<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<link REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvcontentstyle">
{disable_right_click_js}
</HEAD>
<BODY bgcolor=#FFFFFF>
{{$1}}
<FORM>
<div class=plainbox>
<table CELLSPACING=0 CELLPADDING=0 width="510px">
<tr>
<td WIDTH="6%"><div><center><input type="button" value="{_fipsmode {text_disable},{text_enable}}" onClick="location = 'SetFIPSMode?fips={_fipsmode off,on}&baseRef=adv_modules_fips_pane_reply';"></center></div></td>
<td></td><td><p>{fipsmode_display}</p></td></tr>
</table>
</div>
</FORM>
</BODY></HTML>
:adv_modules_fips_pane_template
;
; End of PKCS11 UI
;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

formsubmit_monitor_with_check_js:
<script language=javascript>
var dosubmit=false;
var doclose=false;

function submitform()
{
  if ({$1}())
    dosubmit = true;
  window.frames[1].submitForm();
}

function closewin()
{
  doclose = true;
  setTimeout("closeif()", 100);	
}

function closeif()
{
  if (doclose) {
    window.close();
  }
  setTimeout("closeif()", 100);
}


</script>
:formsubmit_monitor_with_check_js

; PKCS-12 Dialogs
;
cert_backup_type="text/html"
cert_backup_hdrs=""
cert_backup_width=520
cert_backup_height=435
cert_backup_content:
<html>
{help_monitor_js}
<script language=JavaScript>
{pop_up_alert}

function submitCheck()
{
    var passwd  = CertBackupContent.document.forms[0].elements['passwd'].value;
    var confirm = CertBackupContent.document.forms[0].elements['confirmPasswd'].value;

    if (passwd == '') {
       PopUpAlert("{passwd_at_least_one_char}");
       resetPasswords=true;
    } else if (passwd == confirm) {
        return true;
    } else {
        PopUpAlert("{passwd_conf_retry}");
        resetPasswords=true;
    }
    CertBackupContent.checkForPasswordReset();
    return false;
}

</script>
{formsubmit_monitor_with_check_js submitCheck}
{help_monitor_js}
<frameset rows="50,*,40" border="0" frameborder="NO">
<frame src="get?baseRef=cert_backup_top&target=%1$d" name="CertBackupTop" scrolling="NO" marginwidth="0" marginheight="0">
<frame src="get?baseRef=cert_backup_content&target=%1$d{pass_var multipleCerts}" name="CertBackupContent" scrolling="Auto" marginwidth="0" marginheight="0">
<frame src="get?baseRef=cert_backup_bottom&target=%1$d" name="CertBackupFoot" scrolling="NO" marginwidth="0" marginheight="0">
</frameset>
</html>
:cert_backup_content

cert_backup_top_type=text/html
cert_backup_top_hdrs=
cert_backup_top_content:
{top_frame_no_image portable_password_title}
:cert_backup_top_content

cert_backup_content_type=text/html
cert_backup_content_hdrs=
cert_backup_content_content:
<html>
{formsubmit document.forms[0]}
<script language=JavaScript>
function checkForPasswordReset()
{
  document.forms[0].reset();
}
</script>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvmodalstyle">
{disable_right_click_js}
</head>
<body CLASS=CONTENT alink="#333399">
<table CELLSPACING=0 CELLPADDING=0 WIDTH="100%%" >
<tr>
<td WIDTH="10"></td>

<td>
<table BORDER=0 CELLSPACING=0 >
<tr>
<td>
&nbsp;
</td>
</tr>
<tr>
<td COLSPAN="3"><form name="passwordForm" action="formsubmit_handler"
                      method=get onSubmit="return top.submitCheck();"> 
<input type=hidden name="target" value="%1$d">
<input type=hidden name="formName" value="cert_backup_form">
<input type=hidden name="baseRef" value="windowclose_doclose_js">
<table BORDER=0 CELLSPACING=0 WIDTH="100%%" >
<tr valign=top>
<td colspan=3>
<p><div class=plain>
{portable_passwd_protects_file}
</p></div>
</td>
</tr>
<STRONG> 
{pkcs12_incompatibility_warning}
</STRONG>
<p>
<tr>
</tr>
<tr VALIGN=CENTER>
<td>
<div align=right><p>
{portable_passwd}
</p></div>
</td>

<td></td>
<td><div><input type="password"  NAME="passwd" SIZE="16">
</div></td>
</tr>

<tr VALIGN=CENTER>
<td>
<div align=right>
<p>
{portable_passwd_again}
</p></div>
</td>

<td></td>

<td><div><input type="password"

  NAME="confirmPasswd"

  SIZE="16" 

  >
</div></td>
</tr>
</table>
<spacer type="vertical" size="12"></td>

<td></td>
</tr>
</table>

<hr SIZE=3 NOSHADE WIDTH="100%%">
<p class=alert> 
{portable_passwd_alert}
</td>
</tr>
</table>
</form>
<script language=javascript>
document.forms[0].elements["passwd"].focus();
</script>
</body>
</html>
:cert_backup_content_content

blank:

:blank

js_submit:
<script language=javascript>
top.submitform();
</script>
:js_submit

cert_backup_bottom_type=text/html
cert_backup_bottom_hdrs=
cert_backup_bottom_content={cert_backup_bottom_template blank}

cert_backup_bottom_template:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
{{$1}}
<body class=foot alink="#333399" 
      onLoad="parent.SetHelpURL('help.htm#1031615')">
{ok_cancel_help cert_backup_form,pkcs12_button_reply,close_if_cancel}
</body>
</html>
:cert_backup_bottom_template

pkcs12_restore_success_new_mail:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<title></title>
{disable_right_click_js}
<script language=javascript>
{pop_up_alert}
function setNewEmailCertAndShowAlert() 
{
  top.default_email_cert = "%1$s";
  PopUpAlert("{multi_cert_backup_success}");
  window.location = "get?baseRef=cert_mine";  
}

</script>
</head>
<body onLoad="setNewEmailCertAndShowAlert();">
</body>
</html>
:pkcs12_restore_success_new_mail


pkcs12_button_reply_type=text/html
pkcs12_button_reply_hdrs=
pkcs12_button_reply_content={cert_backup_bottom_template js_submit}

pkcs12_action_followup_type=text/html
pkcs12_action_followup_hdrs=
pkcs12_action_followup_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
{disable_right_click_js}
<script language=javascript>

{pop_up_alert}

function showAlert() {
	 PopUpAlert("%1$s");
	 window.location = "get?baseRef=cert_mine";
}
</script>
</head>
<body onLoad="showAlert();">
</body>
</html>
:pkcs12_action_followup_content

bad_server_cert_expired_type="text/html"
bad_server_cert_expired_hdrs=""
bad_server_cert_expired_width=520
bad_server_cert_expired_height=350
bad_server_cert_expired_content:
{frame_set bad_server_cert_expired,formsubmit}
:bad_server_cert_expired_content


bad_server_cert_expired_top_type="text/html"
bad_server_cert_hdrs=""
bad_server_cert_expired_top_content:
{top_frame bad_server_cert_expired_title,alert1gif,35,35}
:bad_server_cert_expired_top_content

bad_server_cert_expired_buttons_type="text/html"
bad_server_cert_expired_buttons_hdrs=""
bad_server_cert_expired_buttons_content:
{formsubmit_buttons_frame bad_server_cert,help.htm#1036462}
:bad_server_cert_expired_buttons_content

bad_server_cert_expired_main_type="text/html"
bad_server_cert_expired_main_hdrs=""
bad_server_cert_expired_main_content:
{bad_server_cert_time expired}
:bad_server_cert_expired_main_content


bad_server_cert_not_yet_valid_type="text/html"
bad_server_cert_not_yet_valid_hdrs=""
bad_server_cert_not_yet_valid_width=520
bad_server_cert_not_yet_valid_height=350
bad_server_cert_not_yet_valid_content:
{frame_set bad_server_cert_not_yet_valid,formsubmit}
:bad_server_cert_not_yet_valid_content


bad_server_cert_not_yet_valid_top_type="text/html"
bad_server_cert_not_yet_valid_hdrs=""
bad_server_cert_not_yet_valid_top_content:
{top_frame bad_server_cert_not_yet_valid_title,alert1gif,35,35}
:bad_server_cert_not_yet_valid_top_content

bad_server_cert_not_yet_valid_buttons_type="text/html"
bad_server_cert_not_yet_valid_buttons_hdrs=""
bad_server_cert_not_yet_valid_buttons_content:
{formsubmit_buttons_frame bad_server_cert,help.htm#1036465}
:bad_server_cert_not_yet_valid_buttons_content

bad_server_cert_not_yet_valid_main_type="text/html"
bad_server_cert_not_yet_valid_main_hdrs=""
bad_server_cert_not_yet_valid_main_content:
{bad_server_cert_time not_yet_valid}
:bad_server_cert_not_yet_valid_main_content


;
; bad_server_cert_time: used for expired server cert and not yet valid
; server cert
; {$1}: either "expired" or "not_yet_valid"
;
bad_server_cert_time:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
{formsubmit document.forms[0]}
<body class=content>
<form method="get" action="formsubmit_handler" name="bad_server_cert">

<P>
{_server_cert_info simple,bad_server_cert_{$1}_format,bad_server_cert_{$1}_format}
</P>
<P>
{_get_current_time bad_server_cert_now_format}
</P>

<input type=hidden name="baseRef" value="windowclose_doclose_js">
<input type=hidden name="target" value="%1$d">

{accept_anyway}
<BR>
{view_server_cert}

</form>
</body>
</html>
:bad_server_cert_time

accept_anyway:
<div class=Plainbox>
<TABLE>
<TR valign=top>
<TD>
<input type=checkbox name="accept" checked value="session">
</TD>
<TD>
<DIV CLASS=Plain>
{bad_server_cert_accept_string}
</div>
</TD>
</TR>
</TABLE>
</div>
:accept_anyway

view_server_cert:
<div class=Plainbox>
<TABLE>
<TR valign=top>
<TD><div>
<input type="button" value="{text_view}" width="72" onClick="window.open('get?baseRef=server_cert_view&target=%1$d','popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')">
</div></TD>
<TD>
<div class=Plain>
{bad_server_cert_view_string}
</div>
</TD>
</TR>
</TABLE>
</div>
:view_server_cert


bad_server_cert_domain_type="text/html"
bad_server_cert_domain_hdrs=""
bad_server_cert_domain_width=520
bad_server_cert_domain_height=350
bad_server_cert_domain_content:
{frame_set bad_server_cert_domain,formsubmit}
:bad_server_cert_domain_content


bad_server_cert_domain_top_type="text/html"
bad_server_cert_hdrs=""
bad_server_cert_domain_top_content:
{top_frame bad_server_cert_domain_title,alert1gif,35,35}
:bad_server_cert_domain_top_content

bad_server_cert_domain_main_type="text/html"
bad_server_cert_domain_main_hdrs=""
bad_server_cert_domain_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
{formsubmit document.forms[0]}
<body class=content>
<form method="get" action="formsubmit_handler" name="bad_server_cert">

<P>
{_server_cert_domain_info bad_domain_wrapper}
</p>

{view_server_cert}

<input type=hidden name="baseRef" value="windowclose_doclose_js">
<input type=hidden name="target" value="%1$d">
<input type=hidden name="accept" value="session">

</form>
</body>
</html>
:bad_server_cert_domain_main_content

bad_server_cert_domain_buttons_type="text/html"
bad_server_cert_domain_buttons_hdrs=""
bad_server_cert_domain_buttons_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body alink="#333399" onLoad="parent.SetHelpURL('help.htm#1036471')">
<form method="get" action="ok_cancel_handler" name="ok_cancel_handler_form">
<input type=hidden name="target" value="%1$d">
<input type=hidden name="baseRef" value="formsubmit_dosubmit_js">
<div align=right>
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 HEIGHT="100%%">
<tr ALIGN=RIGHT VALIGN=CENTER>

<td>
<div class=BUTTONSPACE>
<input type="submit" name="OK" value="{text_url_continue}" width="72">
</div>
</td>

<td>
<div class=BUTTONSPACE>
<input type="submit" name="Cancel" value="{text_url_cancel}" width="72">
</div>
<input type=hidden name="formName" value="bad_server_cert">
</td>

<td>
<div class=BUTTONSPACEHELP>
<input type="button" name="Help" value="{text_help}" width="72" onClick="parent.OpenHelp()">
</div>
</td>

</tr>
</table>
</div>
</form>
</body>
</html>
:bad_server_cert_domain_buttons_content


bad_server_cert_unknown_issuer1_type="text/html"
bad_server_cert_unknown_issuer1_hdrs=""
bad_server_cert_unknown_issuer1_width=520
bad_server_cert_unknown_issuer1_height=350
bad_server_cert_unknown_issuer1_content:
{frame_set bad_server_cert_unknown_issuer1,windowclose}
:bad_server_cert_unknown_issuer1_content

bad_server_cert_unknown_issuer1_top_type="text/html"
bad_server_cert_unknown_issuer1_top_hdrs=""
bad_server_cert_unknown_issuer1_top_content:
{top_frame bad_server_cert_unknown_step1_title,alert1gif,35,35}
:bad_server_cert_unknown_issuer1_top_content

bad_server_cert_unknown_issuer1_main_type="text/html"
bad_server_cert_unknown_issuer1_main_hdrs=""
bad_server_cert_unknown_issuer1_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
<body class=content>
<form>
<P>
{_server_cert_domain_info unknown_issuer_domain_wrapper}
</p>

<div class=Plainbox>
<TABLE>
<TR valign=top>
<TD><div>
<input type="button" value="{text_view}" width="90" onClick="window.open('get?baseRef=server_cert_view&target=%1$d','popup','width=520,height=350,status=no,toolbar=no,menubar=no,screenX=100,screenY=100')">
</div></TD>
<TD>
<P>{examine_text}</P>
</TD>
</TR>
</TABLE>
</div>
<form>
</body>
</html>
:bad_server_cert_unknown_issuer1_main_content

bad_server_cert_unknown_issuer1_buttons_type="text/html"
bad_server_cert_unknown_issuer1_buttons_hdrs=""
bad_server_cert_unknown_issuer1_buttons_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body alink="#333399" onLoad="parent.SetHelpURL('help.htm#1036414')">
<form method="get" action="unknownIssuerStep1">
<input type=hidden name="baseRef" value="windowclose_doclose_js">
<input type=hidden name="target" value="%1$d">

<div align=right>
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 HEIGHT="100%%" >
<tr ALIGN=RIGHT VALIGN=CENTER>

<td>
<div class=BUTTONSPACE>
<input type="submit" name="do_cancel" value="{text_cancel}" width="72">
</div>
</td>

<td>
<div class=BUTTONSPACE>
<input type="submit" name="do_next" value="{text_next}" width="72">
</div>
</td>

<td>
<div class=BUTTONSPACEHELP>
<input type="button" name="do_help" value="{text_help}" width="72" onClick="parent.OpenHelp()">
</div>
</td>


</tr>
</table>
</div>
</form>
</body>
</html>
:bad_server_cert_unknown_issuer1_buttons_content



bad_server_cert_unknown_issuer2_type="text/html"
bad_server_cert_unknown_issuer2_hdrs=""
bad_server_cert_unknown_issuer2_width=520
bad_server_cert_unknown_issuer2_height=350
bad_server_cert_unknown_issuer2_content:
{frame_set bad_server_cert_unknown_issuer2,formsubmit}
:bad_server_cert_unknown_issuer2_content

bad_server_cert_unknown_issuer2_top_type="text/html"
bad_server_cert_unknown_issuer2_top_hdrs=""
bad_server_cert_unknown_issuer2_top_content:
{top_frame bad_server_cert_unknown_step2_title,alert1gif,35,35}
:bad_server_cert_unknown_issuer2_top_content

bad_server_cert_unknown_issuer2_main_type="text/html"
bad_server_cert_unknown_issuer2_main_hdrs=""
bad_server_cert_unknown_issuer2_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
{formsubmit document.forms[0]}
<body class=content>
<form method="get" action="formsubmit_handler" name="bad_server_cert">
<input type=hidden name="baseRef" value="windowclose_doclose_js">
<input type=hidden name="target" value="%1$d">

<P>
{_server_cert_info simple,unknown_issuer_accept_format,unknown_issuer_accept_format}
</P>

<div class=Plainbox>
<TABLE>
<TR valign=top>
<TD>
<input type="radio" name="accept" value="permanent">
</TD>
<TD>
<DIV CLASS=Plain>{accept_permanent}</div>
</TD>
</TR>
<TR valign=top>
<TD>
<input type="radio" name="accept" value="session" checked>
</TD>
<TD>
<DIV CLASS=Plain>{accept_session}</div>
</TD>
</TR>
<TR valign=top>
<TD>
<input type="radio" name="accept" value="no">
</TD>
<TD>
<DIV CLASS=Plain>{accept_not}</div>
</TD>
</TR>
</TABLE>
</div>

<form>
</body>
</html>
:bad_server_cert_unknown_issuer2_main_content



;
; due to difference in button labeling, I have to write this out in verbatim
;
bad_server_cert_unknown_issuer2_buttons_type="text/html"
bad_server_cert_unknown_issuer2_buttons_hdrs=""
bad_server_cert_unknown_issuer2_buttons_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body alink="#333399" onLoad="parent.SetHelpURL('help.htm#1036414')">
<form method="get" action="ok_cancel_handler" name="ok_cancel_handler_form">
<input type=hidden name="target" value="%1$d">
<input type=hidden name="baseRef" value="formsubmit_dosubmit_js">
<div align=right>
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 HEIGHT="100%%" >
<tr ALIGN=RIGHT VALIGN=CENTER>

<td>
<div class=BUTTONSPACE>
<input type="submit" name="Cancel" value="{text_cancel}" width="72">
</div>
</td>

<td>
<div class=BUTTONSPACE>
<input type="submit" name="OK" value="{text_finished}" width="72">
</div>
<input type=hidden name="formName" value="bad_server_cert">
</td>

<td>
<div class=BUTTONSPACEHELP>
<input type="button" name="Help" value="{text_help}" width="72" onClick="parent.OpenHelp()">
</div>
</td>


</tr>
</table>
</div>
</form>
</body>
</html>
:bad_server_cert_unknown_issuer2_buttons_content



;
; server_cert_view
;
; this is to pop up a view server cert window (pretty print)
; note that for the time being the target should be an SSMSSLDataConnection
; object (thus this may not be of interest to anyone else)
; but hopefully I can make it general enough so that people only have to
; implement a keyword handler
;
server_cert_view_type=text/html
server_cert_view_hdrs=""
server_cert_view_width=520
server_cert_view_height=350
server_cert_view_content:
{frame_set server_cert_view,windowclose}
:server_cert_view_content

;
; for some reason mmullany did not use the CCS so I won't use the macros
;
server_cert_view_top_type=text/html
server_cert_view_top_hdrs=""
server_cert_view_top_content:
{top_frame server_cert_view_header,lockedgif,35,35}
:server_cert_view_top_content


server_cert_view_buttons_type=text/html
server_cert_view_buttons_hdrs=""
server_cert_view_buttons_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
</head>
<body bgcolor="#CCCCCC" link="#6666CC" vlink="#6666CC" alink="#333399"
      onLoad="parent.SetHelpURL('help.htm#1049021')">
<form method="get" action="get">
<input type=hidden name="baseRef" value="windowclose_doclose_js">
<div align=right>
<table border=0 cellspacing=0 cellpadding=0 height=100%%>
<tr align=right valign=center>
<td width=50%%>
<div class=buttonspace>
<input type="submit" name="do_ok" value="{text_ok}" width="72">
</div>
</td>
<td width=30%%>
<div class=BUTTONSPACE>
<input type="button" name="do_help" value="{text_help}" width="72"
        onClick="parent.OpenHelp()">
</div>
</td>
</tr>
</table>
</div>
</form>
</body>
</html>
:server_cert_view_buttons_content


server_cert_view_main_type=text/html
server_cert_view_main_hdrs=""
server_cert_view_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
<body class=CONTENT>
<p>
<table>
<td WIDTH="10"></td>
<tr></tr>
<tr>
<td>
<div>	
{_verify_server_cert}
</div>
</td>
</tr>
</table>
<table CELLSPACING=0 CELLPADDING=0>
<tr>
<td WIDTH="10"></td>
<td>
<table border=0 cellspacing=0>
<tr>
<td colspan="3"> &nbsp;
<div>
{_server_cert_info pretty,view_cert_wrapper,view_cert_wrapper_no_comment}
</div>
</td>
</tr>
</table>
</td>
</tr>
</table>
</body>
</html>
:server_cert_view_main_content


;
; _verify_server_cert: places a cert verification result
; usage: {_verify_server_cert verify_cert_bad_string}
;
verify_bad_string:
<tr>
<td><div><font size=-1>{bad_cert_pre_text}</font></div></td>

<td></td>
</tr>

<tr>
<td><div><b><font face="{nsm_view_cert_font}"><font size=-1>%1$s</font></font></b></div></td>

<td></td>
</tr>

<tr>
<td><div><font face="{nsm_view_cert_font}"><font size=-1>{bad_cert_post_text}
</font></font></div></td>

<td></td>
</tr>
:verify_bad_string

cert_usage_wrapper:
<script language="javascript">
var usage = [ {sslClient} ,  {sslServer} ,  {sslServerStepUp} , 
	      {sslCA} ,  {emailSigner} ,  {emailRecipient} ,
	      {objectSignerCert} ,  {userImport} ,  {caVerifier} ,
	      {protectObjectSigner} ,  {statusResponder} ,
	      {anyCA} ];
var verified = new Array();
var valid = '%13$d';
var i = 0;


verified[0] = '%1$d';
verified[1] = '%2$d';
verified[2] = '%3$d';
verified[3] = '%4$d';
verified[4] = '%5$d';
verified[5] = '%6$d';
verified[6] = '%7$d';
verified[7] = '%8$d';
verified[8] = '%9$d';
verified[9] = '%10$d';
verified[10] = '%11$d';
verified[11] = '%12$d';	

function print_verify_info() 
{
   document.write('<ul>');
   for (i = 0; i<13; i++)
     if (verified[i]=='1')
       document.write('<li>',usage[i]);
     document.write('</ul>');
}	
if (valid == '1')
  print_verify_info();
</script>
:cert_usage_wrapper

;
; Javascript used for formatting in verify cert and view cert
;
cat_component_func:
<script language=javascript>
function cat_name_component(n, c)
{
    if (c == '')
        return n;
    if (n != '')
        n = n + ', ';
    n = n + c;
    return n;
}
</script>
:cat_component_func


view_cert_wrapper_no_comment:
<script language=javascript>
function cat_name_component(n, c)
{
    if (c == '')
        return n;
    if (n != '')
        n = n + ', ';
    n = n + c;
    return n;
}
var cert_name = '';
var cert_cn = '%1$s';
var cert_e = '%2$s';
var cert_ou = '%3$s';
var cert_o = '%4$s';
var cert_lo = '%5$s';
var cert_st = '%6$s';
var cert_c = '%7$s';

cert_name = cert_cn;
cert_name = cat_name_component(cert_name, cert_e);
cert_name = cat_name_component(cert_name, cert_ou);
cert_name = cat_name_component(cert_name, cert_o);
cert_name = cat_name_component(cert_name, cert_lo);
cert_name = cat_name_component(cert_name, cert_st);
cert_name = cat_name_component(cert_name, cert_c);

if (cert_name == '')
    cert_name = "{text_no_cert_name}";
</script>
<table BORDER=0 CELLSPACING=0 WIDTH="100%%%%" >

<tr VALIGN=TOP>
<td>
<div align=right><font size=-1>{text_name}</font>
</div>
</td>
<td WIDTH="10"></td>
<td><div><font size=-1>
<script language=javascript>
document.write(cert_name);</script></div></font>
</td>
</tr>

<tr VALIGN=TOP>
<td>
<div align=right>
<font size=-1>{serverCert_issuer}</font>
</div>
</td>
<td WIDTH="10"></td>
<td><div><font face="{nsm_view_cert_font}"><font size=-1>%8$s</font></font></div></td>
</tr>


<tr VALIGN=TOP>
<td>
<div align=right>
<font face="{nsm_view_cert_font}" size=-1>{serial_number}</font>
</div>
</td>
<td></td>
<td><div><font face="{nsm_view_cert_font}"><font size=-1>%9$s</font></font></div></td>
</tr>

<tr VALIGN=TOP>
<td>
<div align=right>
<font face="{nsm_view_cert_font}" size=-1>{text_validity}</font>
</div>
</td>
<td></td>
<td><div><font face="{nsm_view_cert_font}" size=-1>{date_a_to_date_b}</font></div></td>
</tr>

<tr VALIGN=TOP>
<td>
<div align=right>
<font face="{nsm_view_cert_font}" size=-1>{text_fingerprint}</font>
</div>
</td>
<td></td>
<td><div><font face="{nsm_view_cert_font}" size=-1>%12$s</font></div></td>
</tr>
<tr><td></td></tr>

<td></td>
</table>
</td></tr>
</table>
:view_cert_wrapper_no_comment


view_cert_wrapper:
{view_cert_wrapper_no_comment}
<table BORDER=0 CELLSPACING=0 WIDTH="100%%%%" >
<tr  valign=top>
<td>
<div align=right>
<font face="{nsm_view_cert_font}" size=-1>{text_comment}</font>
</div>
</td>
<td></td>
<td><div><form><textarea rows="4" cols="30" wrap ="soft">
%13$s
</textarea></form></div></td>
</tr>
</table>
</td>

<td></td>
</tr>
:view_cert_wrapper


disable_right_click_js:
<script language=javascript>
<!--
function disableRightMouseClick()
{
    if (typeof(crypto) != "undefined" && 
        typeof(crypto.disableRightClick) == "function") {
            crypto.disableRightClick();
        }
}

disableRightMouseClick();
// -->
</script>
:disable_right_click_js

;
;---- sjlee: the following is a simple framework for handling standalone
;----        dialogs.  This may or may not be useful to others but be sure to 
;----        take a look.
;
;
; frame_set: use this macro to create a frameset occurring repeatedly
; {$1}: baseRef, {$2}: formsubmit or windowclose
; e.g. {frame_set client_auth,formsubmit}
;
; then provide baseRef_top, baseRef_main, baseRef_buttons
; Note: help javascript is also embedded here.
;
frame_set:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<title></title>
{help_monitor_js}
{{$2}_monitor_js}
{disable_right_click_js}
<frameset rows="50,*,40" border="0" frameborder="NO">
<frame src="get?baseRef={$1}_top&target=%1$d" name="DialogTop" scrolling="NO" marginwidth="0" marginheight="0">
<frame src="get?baseRef={$1}_main&target=%1$d" name="DialogContent" scrolling="Auto" marginwidth="0" marginheight="0">
<frame src="get?baseRef={$1}_buttons&target=%1$d" name="DialogFoot" scrolling="NO" marginwidth="0" marginheight="0">
</frameset>
</head>
</html>
:frame_set

;
; This frame set is intended to pass down variables using variables passed
; down to the macro instead of having the executable fill it in from code
; through a printf
;

frame_set_pass_var:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<title></title>
{help_monitor_js}
{{$2}_monitor_js}
{disable_right_click_js}
<frameset rows="50,*,40" border="0" frameborder="NO">
<frame src="get?baseRef={$1}_top&target=%1$d" name="DialogTop" scrolling="NO" marginwidth="0" marginheight="0">
<frame src="get?baseRef={$1}_main&target=%1$d{pass_var {$3}}" name="DialogContent" scrolling="Auto" marginwidth="0" marginheight="0">
<frame src="get?baseRef={$1}_buttons&target=%1$d" name="DialogFoot" scrolling="NO" marginwidth="0" marginheight="0">
</frameset>
</head>
</html>
:frame_set_pass_var

;
; This macro does the same thing as frame_set, except it allows to pass
; 2 more parameters to the frames from the top URL
;
frame_set_param:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<title></title>
{help_monitor_js}
{{$2}_monitor_js}
{disable_right_click_js}
<frameset rows="50,*,40" border="0" frameborder="NO">
<frame src="get?baseRef={$1}_top&target=%1$d" name="DialogTop" scrolling="NO" marginwidth="0" marginheight="0">
<frame src="get?baseRef={$1}_main&target=%1$d&action=%2$s&content=%3$s" name="DialogContent" scrolling="Auto" marginwidth="0" marginheight="0">
<frame src="get?baseRef={$1}_buttons&target=%1$d&content=%2$s" name="DialogFoot" scrolling="NO" marginwidth="0" marginheight="0">
</frameset>
</head>
</html>
:frame_set_param

;
; This macro does the same thing as frame_set, except it allows to pass
; 3 more parameters to the frames from the top URL
;
frame_set_3param:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<title></title>
{help_monitor_js}
{{$2}_monitor_js}
{disable_right_click_js}
<frameset rows="50,*,40" border="0" frameborder="NO">
<frame src="get?baseRef={$1}_top&target=%1$d" name="DialogTop" scrolling="NO" marginwidth="0" marginheight="0">
<frame src="get?baseRef={$1}_main&target=%1$d&action=%2$s&content=%3$s&origin=%4$s" name="DialogContent" scrolling="Auto" marginwidth="0" marginheight="0">
<frame src="get?baseRef={$1}_buttons&target=%1$d&content=%2$s" name="DialogFoot" scrolling="NO" marginwidth="0" marginheight="0">
</frameset>
</head>
</html>
:frame_set_3param



;
; top_frame: use this to compose the top frame
; {$1}: header keyword (this should be a keyword), {$2}: URL of the image file
; {$3}: image width, {$4}: image height
; e.g. {top_frame client_auth_header,client_authjpg,35,30}
;
; then provide the definition of the header in nsm_text.properties.in, and
; provide the image file in nsm_bin.properties.in
;
top_frame:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
<body CLASS=TOP alink="#333399">

<table>
<tr ALIGN="LEFT" VALIGN="top">
<!--- <td><img src="get?baseRef={$2}" width="{$3}" height="{$4}"></td> --->
<td><H1>{{$1}}</H1></td>
</tr>
</table>
</body>
</html>
:top_frame

top_frame_no_image:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
<body CLASS=TOP alink="#333399">
<table>
<tr ALIGN="LEFT" VALIGN="top">
<!-- <img src="get?baseRef={$2}" ...> -->
<td><H1>{{$1}}</H1></td>
</tr>
</table>
</body>
</html>
:top_frame_no_image




;
; formsubmit_buttons_frame: use this to compose the buttons frame in which
; one has three buttons (ok, cancel, and help) and form submission is done
; {$1}: form name, {$2}: help URL
; e.g. {formsubmit_buttons_frame form_name,help.htm#1036330}
;
formsubmit_buttons_frame:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body class=foot alink="#333399" onLoad="parent.SetHelpURL('{$2}')">
{ok_cancel_help {$1},formsubmit_dosubmit_js,ok_cancel_handler}
</body>
</html>
:formsubmit_buttons_frame

;
; windowclose_buttons_frame: use this to compose the buttons frame in which
; one has only two buttons (ok and help) and no form submission is involved
; {$1}: command keyword for which the command handler is registered
; {$2}: help URL
; e.g. {windowclose_buttons_frame BCAButton,help.htm#1036343}
;
windowclose_buttons_frame:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body class=foot alink="#333399" onLoad="parent.SetHelpURL('{$2}')">
{simple_ok_help {$1}}
</body>
</html>
:windowclose_buttons_frame

simple_ok_help:
<form method="get" action="{$1}">
<div align=right>
<table border="0" height="100%%" cellspacing="0" cellpadding="0">
<tr align=right valign=center>

<td>
<div class=BUTTONSPACE>
<input type=hidden name="baseRef" value="windowclose_doclose_js">
<input type=hidden name="target" value="%1$d">
<input type="SUBMIT" name="do_ok" value="{text_ok}" width="72">
</div>
</td>

<td>
<div class=BUTTONSPACEHELP>
<input type="button" name="do_help" value="{text_help}" width="72" onClick="parent.OpenHelp()">
</div>
</td>

</tr>
</table>
</div>
</form>
:simple_ok_help

signtext_auto_type="text/html"
signtext_auto_hdrs=""
signtext_auto_width=520
signtext_auto_height=500
signtext_auto_content:
<html>
{formsubmit_monitor_js}
<frameset rows="50,*,100,40" border="0" frameborder="NO">
<frame src="get?baseRef=signtext_top&target=%1$d" name="SignTextTop" scrolling="NO" marginwidth="0" marginheight="0">
<frame src="get?baseRef=signtext_content&target=%1$d" name="SignTextContent" scrolling="Auto" marginwidth="0" marginheight="0">
<frame src="get?baseRef=signtext_cert_auto&target=%1$d" name="SignTextCert" scrolling="Auto" marginwidth="0" marginheight="0">
<frame src="get?baseRef=signtext_bottom&target=%1$d" name="SignTextFoot" scrolling="NO" marginwidth="0" marginheight="0">
</frameset>
</html>
:signtext_auto_content

signtext_ask_type="text/html"
signtext_ask_hdrs=""
signtext_ask_width=520
signtext_ask_height=500
signtext_ask_content:
<html>
{formsubmit_monitor_js}
<frameset rows="50,*,110,40" border="0" frameborder="NO">
<frame src="get?baseRef=signtext_top&target=%1$d" name="SignTextTop" scrolling="NO" marginwidth="0" marginheight="0">
<frame src="get?baseRef=signtext_content&target=%1$d" name="SignTextContent" scrolling="Auto" marginwidth="0" marginheight="0">
<frame src="get?baseRef=signtext_cert_ask&target=%1$d" name="SignTextCert" scrolling="Auto" marginwidth="0" marginheight="0">
<frame src="get?baseRef=signtext_bottom&target=%1$d" name="SignTextFoot" scrolling="NO" marginwidth="0" marginheight="0">
</frameset>
</html>
:signtext_ask_content

signtext_top_type=text/html
signtext_top_hdrs=
signtext_top_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
<body CLASS=TOP alink="#333399">

<table>
<tr ALIGN="LEFT" VALIGN="top">
<td><img src="signed.JPG" width="30" height="30"></td>
<td><H1>{sig_request}</H1></td>
</tr>
</table>
</body>
</html>
:signtext_top_content

signtext_content_type=text/html
signtext_content_hdrs=
signtext_content_content:
<html>
<blockquote>
<!---- unused %1$d %2$s ----->
%3$s
</blockquote>
</html>
:signtext_content_content

signtext_cert_auto_type=text/html
signtext_cert_auto_hdrs=
signtext_cert_auto_content:
<html>
{formsubmit document.forms[0]}
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvmodalstyle">
{disable_right_click_js}
</head>
<body class=foot alink="#333399">
<form action="formsubmit_handler" method=get>
<input type=hidden name="target" value="%1$d">
<input type=hidden name="baseRef" value="windowclose_doclose_js">
</form>
<p>
{site_requests_signature}
</p>
<p>
{following_cert_used_to_sign}
</p>
<!------ unused %3$s -------->
</body>
</html>
:signtext_cert_auto_content

signtext_cert_ask_type=text/html
signtext_cert_ask_hdrs=
signtext_cert_ask_content:
<html>
{formsubmit document.forms[0]}
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvmodalstyle">
{disable_right_click_js}
</head>
<body class=foot alink="#333399">
<form action="formsubmit_handler" method=get>
<input type=hidden name="target" value="%1$d">
<input type=hidden name="baseRef" value="windowclose_doclose_js">
<table cellpadding=0 border=0 cellspacing=0>
<tr>
<td colspan=2>
<p>
{site_requests_signature}
</p>
</td>
</tr>
<tr>
<td>
<p>{which_cert_to_sign}</p>
</td>
<td>
{_signtext_certList userCert_prefix,userCert_wrapper,userCert_suffix}
</td>
</tr>
</table>
</form>
</body>
</html>
:signtext_cert_ask_content

signtext_bottom_type=text/html
signtext_bottom_hdrs=
signtext_bottom_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=secadvmodalstyle">
{disable_right_click_js}
</head>
<body class=foot alink="#333399" onLoad="">
<!-- hook up signtext_help target above -->
{ok_cancel_help signtext_form,formsubmit_dosubmit_js,ok_cancel_handler}
</body>
</html>
:signtext_bottom_content

;
; The dialog for telling the user the CA wants them to back up their cert.
;
backup_new_cert_type=text/html
backup_new_cert_height=350
backup_new_cert_width=520
backup_new_cert_content={frame_set cert_issue_backup,windowclose}

cert_issue_backup_top_type=text/html
cert_issue_backup_top_hdrs=
cert_issue_backup_top_content:
{top_frame security_certificate_backup,alert1gif,35,35}
:cert_issue_backup_top_content

cert_issue_backup_main_type=text/html
cert_issue_backup_main_hdrs=
cert_issue_backup_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
<body class=content>
<p> 
{issue_backup_statement}
</p>
<p>
{can_restore_from_file}
</p>
<p>
{press_backup_to_continue}
</p>
<p>
{prompts_for_all_certs}
</p>
</body>
</html>
:cert_issue_backup_main_content

cert_issue_backup_buttons_type=text/html
cert_issue_backup_buttons_hdrs=
cert_issue_backup_buttons_content:
<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body class=foot alink="#333399" onLoad="parent.SetHelpURL('help.htm#1036319')">
<form method="get" action="ok_cancel_handler" name="cert_issue_backup_form">
<input type=hidden name="target" value="%1$d">
<input type=hidden name="formName" value="cert_issue_backup_form">
<input type=hidden name="baseRef" value="windowclose_doclose_js">
<div align=right>
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 HEIGHT="100%%" >
<tr ALIGN=RIGHT VALIGN=CENTER>

<td>
<div class=BUTTONSPACE>
<input type="submit" name="OK" value="{text_backup_dots}" width="72"">
</div>
</td>

<td>
<div class=BUTTONSPACEHELP>
<input type="button" name="Help" value="{text_help}" width="72" 
    onClick="parent.OpenHelp()">
</div>
</td>


</tr>
</table>
</div>
</form>
</body>
</html>
:cert_issue_backup_buttons_content

verification_setup_type=text/html
verification_setup_hdrs=
verification_setup_content={frame_set verification_config,formsubmit}

verification_services=OCSP Settings

verification_config_top_type=text/html
verification_config_top_hdrs=
verification_config_top_content:
{top_frame verification_services,lockedgif,35,35}
:verification_config_top_content

default_responder_template=<option value="%1$s">%1$s
ocsp_list_prefix:
<script language=javascript>
document.writeln('<select NAME="selectCert" onChange="setDefaultServiceURL(true);">{_default_ocsp_responder}');
:ocsp_list_prefix

ocsp_list_wrapper:
value="%1$s";
ocspLocation = "%2$s";
value = value.replace(/'/g, "&#39;");
ocspLocation = ocspLocation.replace(/'/g, "&#39;");
document.writeln('<option value="'+value+'">'+value);
addNewServiceURL(value, ocspLocation);
:ocsp_list_wrapper

ocsp_list_suffix:
document.writeln('</select>');
</script>
:ocsp_list_suffix

ocsp_options_template:
<div><input type="RADIO" name="enableOCSP" value="noOCSP" %1$s>{dont_use_ocsp}<br>
<input type="RADIO" name="enableOCSP" value="noDefaultResponder" %2$s>{use_ocsp_if_extension}<br>
<input type="RADIO" name="enableOCSP" value="useDefaultResponder" %3$s>{use_ocsp_for_all}</div>
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%%%%">
<tr VALIGN=CENTER>
<td width="10"></td><td><div align=left><UL><LI>{service_url}</LI></UL> </div></td>
<td><div><input type="text" name="ocspURL" size="33" value="%4$s"></div></td>
</tr>
<tr>
<td width="10"></td><td><div align=left><UL><LI>{response_signer}</LI></UL></div></td>
<td><div>{_ocsp_responder_list ocsp_list_prefix,ocsp_list_suffix}
</div></td>
</tr>
</table>
:ocsp_options_template

verification_config_main_type=text/html
verification_config_main_hdrs=
verification_config_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
<script language=javascript>
<!---
var locations = new Object();
var ocspLocation;
var value;

function addNewServiceURL(caNickName, serviceURL)
{
    locations[caNickName] = serviceURL;
}
function setDefaultServiceURL(forceSelect)
{
    var form = document.forms[0];
    var defaultResponder = form.elements.selectCert;
    var serviceURL = form.elements.ocspURL;
    var responderNickname = 
          defaultResponder.options[defaultResponder.selectedIndex].value;    
    serviceURL.value = locations[responderNickname];
    if (forceSelect) {
        form.enableOCSP[2].checked = true;
    }
}

// -->
</script>
</head>
<body class=content onLoad = "setDefaultServiceURL(false);">
{formsubmit document.forms[0]}
<br>
<div>
{psm_knows_ocsp}
</div>
<br><div>
{configure_ocsp_as_follows}
<form method=get action="formsubmit_handler" name="configureOCSPForm">
<input type=hidden name="target" value="%1$d">
<input type=hidden name="formName" value="configureOCSPForm">
<input type=hidden name="baseRef" value="windowclose_doclose_js">
{_ocsp_options}
</form>
</div>
</body>
</html>
:verification_config_main_content

verification_config_buttons_type=text/html
verification_config_buttons_hdrs=
verification_config_buttons_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalonefoot">
{disable_right_click_js}
</head>
<body bgcolor="#CCCCCC"alink="#333399"  
      onLoad="parent.SetHelpURL('help.htm#1049128')">

{ok_cancel_help configureOCSPForm,formsubmit_dosubmit_js,ok_cancel_handler}
</body>
</html>
:verification_config_buttons_content

;
; glossary macro
; syntax {glossary word,glossary_target}
; e.g. {glossary certificate,certificate}
;
glossary:
<A HREF="glossary.htm#{$2}" onClick="top.window.open('','psm_glossary','width={help_width},height={help_height},status=no,menubar=no,scrollbars,screenX=50,screenY=100')" TARGET="psm_glossary">{$1}</A> {glossary_icon}
:glossary

certPrettyPrint_type="text/html"
certPrettyPrint_hdrs=""
certPrettyPrint_width=520
certPrettyPrint_height=350
certPrettyPrint_content:
{frame_set certDump,windowclose}
:certPrettyPrint_content

certDump_top_type="text/html"
certDump_top_hdrs=""
certDump_top_content:
{top_frame view_cert_detail,alert1gif,35,35}
:certDump_top_content

certDump_buttons_type="text/html"
certDump_buttons_hdrs=""
certDump_buttons_content:
{windowclose_buttons_frame OKButton,help.htm#1055417}
:certDump_buttons_content

certPrettyPrefix:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
<body class=content alink="#FF0000">
<br>
<pre>
:certPrettyPrefix

certPrettySuffix:
</pre>
</body>
</html>
:certPrettySuffix

certDump_main_type="text/html"
certDump_main_hdrs=""
certDump_main_content:
<html>
<head>
</head>
<body>
<script language=javascript>
window.location = "certPrettyPrint?target=%1$d";
</script>
</body>
</html>
:certDump_main_content

issuer_not_found_type="text/html"
issuer_not_found_hdrs=""
issuer_not_found_width=520
issuer_not_found_height=350
issuer_not_found_content:
{frame_set no_issuer,windowclose}
:issuer_not_found_content

no_issuer_top_type="text/html"
no_issuer_top_hdrs=""
no_issuer_top_content:
{top_frame issuer_not_found_title,alert1gif,35,35}
:no_issuer_top_content

no_issuer_buttons_type="text/html"
no_issuer_buttons_hdrs=""
no_issuer_buttons_content:
{windowclose_buttons_frame OKButton,help.htm#1055437}
:no_issuer_buttons_content

no_issuer_main_type="text/html"
no_issuer_main_hdrs=""
no_issuer_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
<body class=content alink="#FF0000">
<br>
<p>
{issuer_not_in_db}
</p>
</body>
</html>
:no_issuer_main_content

cert_renewal_type="text/html"
cert_renewal_hdrs=""
cert_renewal_width=520
cert_renewal_height=350
cert_renewal_content:
{frame_set cert_renewal,formsubmit}
:cert_renewal_content


cert_renewal_top_type="text/html"
bad_server_cert_hdrs=""
cert_renewal_top_content:
{top_frame cert_renewal_title,certgif,35,35}
:cert_renewal_top_content

cert_renewal_buttons_type="text/html"
cert_renewal_buttons_hdrs=""
cert_renewal_buttons_content:
{formsubmit_buttons_frame cert_renewal,help.htm#1055232}
:cert_renewal_buttons_content

;
; cert renewal main frame
;
cert_renewal_main_type="text/html"
cert_renewal_main_hdrs=""
cert_renewal_main_content:
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={nsm_charset}">
<SCRIPT></SCRIPT><LINK REL=STYLESHEET TYPE="text/css" HREF="get?baseRef=standalone">
{disable_right_click_js}
</head>
{formsubmit document.forms[0]}
<body class=content alink="#FF0000">
<p>{cert_renewal_info_string}</p>

<table WIDTH=500px>
<tr VALIGN=CENTER>
<td ALIGN=CENTER WIDTH="90px"><img SRC="get?baseRef=certgif" height=60 width=80></td>

<td ALIGN=CENTER VALIGN=TOP>
{_renewal_cert_info}

</td></tr></table>

<HR WIDTH=96%% ALIGN=CENTER>

<form method="get" action="formsubmit_handler" name="cert_renewal">
<input type=hidden name="baseRef" value="windowclose_doclose_js">
<input type=hidden name="target" value="%1$d">
<div class=Plainbox>
<TABLE>
<TR valign=top>
<TD>
<input type="radio" name="action" value="now" checked>
</TD>
<TD>
<DIV CLASS=Plain>Renew this certificate now</DIV>
</TD>
</TR>
<TR valign=top>
<TD>
<input type="radio" name="action" value="later">
</TD>
<TD>
<DIV CLASS=Plain>Remind me to renew this certificate later</DIV>
</TD>
</TR>
</TABLE>
</div>
</form>
</body>
</html>
:cert_renewal_main_content

;
; cert renewal format
;
cert_renewal_cert_info:
<table CELLSPACING=0 CELLPADDING=0 COLS=2 >
<tr><td COLSPAN="2">

<div class=plain>
%1$s
</div>
</td><td></td></tr>

<tr><td>
<div class=plain>
Valid from: %2$s
</div>
</td></tr>

<tr><td>
<div class=plain>
Expires on: %3$s
</div>
</td></tr>

<tr><td COLSPAN="2">
<div class=plain>
Issued under: %4$s
</div>
</td><td></td></tr></table>
:cert_renewal_cert_info

