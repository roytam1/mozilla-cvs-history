<HTML>
<HEAD>
</HEAD>
<BODY>
<H1>SOAP Test: Is It a Prime Number</H1>
Type slowly enough and the number will change color depending upon whether the soap call reports <font color="green">prime</font> or <font  color="red">nonprime</font>.
<SCRIPT>

// Passed in as the response handler in the asynchronous case
// and called directly (see below) in the synchronous case
function oncompletion(resp, call, status) { 
  if (status != 0) {
    alert("Error completion: " + status);
    return true;
  }

  // Was there a SOAP fault in the response?
  if (resp.fault != null) {
    var f = resp.fault;
    var detail = f.detail;
    var ds = new XMLSerializer();
    var detailStr = ds.serializeToString(detail);
    alert("Fault:\nFault code: " + f.faultCode + "\nFault string: " + f.faultString + "\nFault actor: "  + f.faultActor + "\nDetail: " + detailStr);
  }
  else {
    var foo = new Object();
    var ret = resp.getParameters(false, foo);
    var val = ret[0].value;
    if (val == "true") {
      document.getElementById("NUMBER").style.color="green"
    } else {
      document.getElementById("NUMBER").style.color="red"
    }
  }
  return true;
}

function makeCall(syncCall, value) {
  var s = new SOAPCall();
  // The targetObjectURI, methodName and destinatioName are mandatory.
  // The actionURI is optional.
  
  s.transportURI = "http://213.23.125.181:8080/RPC";

  // Set the parameters on the call object. Note that in this case,
  // the last parameter is an object that will be serialized into
  // a struct parameter. It does not have a parameter wrapper because 
  // we don't need it to be named
  s.encode(0, "isPrimeNumber", "urn:SpheonJSOAPStatistics", 0, null, 1, new Array(new SOAPParameter(value,"number")));

  if (syncCall) {
	  var r = s.invoke();
    oncompletion(r, s, 0);
  }
  else {
    s.asyncInvoke(oncompletion);
  }
}
</SCRIPT>
<P>
<FORM>
<INPUT ID=NUMBER TYPE="text" onkeyup="makeCall(true, value);">
</BODY>
</HTML>
