<HTML>
<HEAD>
  <TITLE>Signons</TITLE>
  <SCRIPT language="javascript" src="SignonWindow.js"></SCRIPT>
  <SCRIPT>
    index_frame = 0;
    title_frame = 1;
    spacer1_frame = 2;
    list_frame = 3;
    spacer2_frame = 4;
    button_frame = 5;

    var signon_mode;
    var signonList = [];
    var rejectList =  [];
    var nopreviewList =  [];
    var nocaptureList =  [];
    deleted_signons = new Array;
    deleted_rejects = new Array;
    deleted_nopreviews = new Array;
    deleted_nocaptures = new Array;

    function DeleteItemSelected() {
      if (signon_mode == 0) {
        DeleteSignonSelected();
      } else if (signon_mode == 1) {
        DeleteRejectSelected();
      } else if (signon_mode == 2) {
        DeleteNopreviewSelected();
      } else if (signon_mode == 3) {
        DeleteNocaptureSelected();
      }
    }

    function DeleteSignonSelected() {
      selname = top.frames[list_frame].document.fSelectSignon.selname;
      goneS = top.frames[button_frame].document.buttons.goneS;
      var p;
      var i;
      for (i=selname.options.length; i>0; i--) {
        if (selname.options[i-1].selected) {
          selname.options[i-1].selected = 0;
          goneS.value = goneS.value + selname.options[i-1].value + ",";
          deleted_signons[selname.options[i-1].value] = 1;
          for (j=i ; j<selname.options.length ; j++) {
            selname.options[j-1] = selname.options[j];
          }
          selname.options[selname.options.length-1] = null;
        }
      }
      top.loadSignonsList(); /* not needed in 4.5 */
    }

    function DeleteRejectSelected() {
      selname = top.frames[list_frame].document.fSelectReject.selname;
      goneR = top.frames[button_frame].document.buttons.goneR;
      var p;
      var i;
      for (i=selname.options.length; i>0; i--) {
        if (selname.options[i-1].selected) {
          selname.options[i-1].selected = 0;
          goneR.value = goneR.value + selname.options[i-1].value + ",";
          deleted_rejects[selname.options[i-1].value] = 1;
          for (j=i; j < selname.options.length; j++) {
            selname.options[j-1] = selname.options[j];
          }
          selname.options[selname.options.length-1] = null;
        }
      }
      top.loadRejectsList(); /* not needed in 4.5 */
    }

    function DeleteNopreviewSelected() {
      selname = top.frames[list_frame].document.fSelectNopreview.selname;
      goneP = top.frames[button_frame].document.buttons.goneP;
      var p;
      var i;
      for (i=selname.options.length; i>0; i--) {
        if (selname.options[i-1].selected) {
          selname.options[i-1].selected = 0;
          goneP.value = goneP.value + selname.options[i-1].value + ",";
          deleted_nopreviews[selname.options[i-1].value] = 1;
          for (j=i; j < selname.options.length; j++) {
            selname.options[j-1] = selname.options[j];
          }
          selname.options[selname.options.length-1] = null;
        }
      }
      top.loadNopreviewsList(); /* not needed in 4.5 */
    }

    function DeleteNocaptureSelected() {
      selname = top.frames[list_frame].document.fSelectNocapture.selname;
      goneC = top.frames[button_frame].document.buttons.goneC;
      var p;
      var i;
      for (i=selname.options.length; i>0; i--) {
        if (selname.options[i-1].selected) {
          selname.options[i-1].selected = 0;
          goneC.value = goneC.value + selname.options[i-1].value + ",";
          deleted_nocaptures[selname.options[i-1].value] = 1;
          for (j=i; j < selname.options.length; j++) {
            selname.options[j-1] = selname.options[j];
          }
          selname.options[selname.options.length-1] = null;
        }
      }
      top.loadNocapturesList(); /* not needed in 4.5 */
    }

    function loadSignons(){
      signon_mode = 0;
      top.frames[index_frame].document.open();
      top.frames[index_frame].document.write(
        "<BODY BGCOLOR=#C0C0C0>" +
          "<TABLE BORDER=0 WIDTH=100%>" +
            "<TR>" +
              "<TD ALIGN=CENTER VALIGN=MIDDLE BGCOLOR=#FFFFFF>" +
                "<FONT SIZE=2 COLOR=#666666>" +
                  "<B>Logons saved</B>" +
                "</FONT>" +
              "</TD>" +
              "<TD ALIGN=CENTER VALIGN=MIDDLE BGCOLOR=#C0C0C0>" +
                "<A HREF=javascript:top.loadRejects();>" +
                  "<FONT SIZE=2>Logons not saved</FONT>" +
                "</A>" +
              "</TD>" +
            "</TR>" +
            "<TR>" +
              "<TD ALIGN=CENTER VALIGN=MIDDLE BGCOLOR=#C0C0C0>" +
                "<A HREF=javascript:top.loadNopreviews();>" +
                  "<FONT SIZE=2>Forms not previewed</FONT>" +
                "</A>" +
              "</TD>" +
              "<TD ALIGN=CENTER VALIGN=MIDDLE BGCOLOR=#C0C0C0>" +
                "<A HREF=javascript:top.loadNocaptures();>" +
                  "<FONT SIZE=2>Forms not saved</FONT>" +
                "</A>" +
              "</TD>" +
              "<TD>&nbsp;&nbsp;&nbsp;</TD>" +
            "</TR>" +
          "</TABLE>" +
        "</BODY>"
      );
      top.frames[index_frame].document.close();

      top.frames[title_frame].document.open();
      top.frames[title_frame].document.write
        ("&nbsp;Logon information that has been saved");
      top.frames[title_frame].document.close();

      loadSignonsList();
    }

    function loadSignonsList(){
      top.frames[list_frame].document.open();
      top.frames[list_frame].document.write(
        "<FORM name=fSelectSignon>" +
          "<P>" +
          "<TABLE BORDER=0 WIDTH=100%HEIGHT=95%>" +
            "<TR>" +
              "<TD WIDTH=100%VALIGN=TOP>" +
                "<CENTER>" +
                  "<P>" +
                  "<SELECT NAME=selname SIZE=15 MULTIPLE> "
      );
      for (i=1; i<signonList.length; i++) {
        if (!deleted_signons[i-1]) {
          top.frames[list_frame].document.write(signonList[i]);
        }
      }
      top.frames[list_frame].document.write(
                  "</SELECT>" +
                "</CENTER>" +
              "</TD>" +
            "</TR>" +
          "</TABLE>" +
        "</FORM>"
      );
      top.frames[list_frame].document.close();
    }

    function loadRejects(){
      signon_mode = 1;
      top.frames[index_frame].document.open();
      top.frames[index_frame].document.write(
        "<BODY BGCOLOR=#C0C0C0>" +
          "<TABLE BORDER=0 WIDTH=100%>" +
            "<TR>" +
              "<TD ALIGN=CENTER VALIGN=MIDDLE BGCOLOR=#C0C0C0>" +
                "<A HREF=javascript:top.loadSignons();>" +
                  "<FONT SIZE=2>Logons saved</FONT>" +
                "</A>" +
              "</TD>" +
              "<TD ALIGN=CENTER VALIGN=MIDDLE BGCOLOR=#FFFFFF>" +
                "<FONT SIZE=2 COLOR=#666666>" +
                  "<B>Logons not saved</B>" +
                "</FONT>" +
              "</TD>" +
              "<TD>&nbsp;&nbsp;&nbsp;</TD>" +
            "</TR>" +
            "<TR>" +
              "<TD ALIGN=CENTER VALIGN=MIDDLE BGCOLOR=#C0C0C0>" +
                "<A HREF=javascript:top.loadNopreviews();>" +
                  "<FONT SIZE=2>Forms not previewed</FONT>" +
                "</A>" +
              "</TD>" +
              "<TD ALIGN=CENTER VALIGN=MIDDLE BGCOLOR=#C0C0C0>" +
                "<A HREF=javascript:top.loadNocaptures();>" +
                  "<FONT SIZE=2>Forms not saved</FONT>" +
                "</A>" +
              "</TD>" +
              "<TD>&nbsp;&nbsp;&nbsp;</TD>" +
            "</TR>" +
          "</TABLE>" +
        "</BODY>"
      );
      top.frames[index_frame].document.close();

      top.frames[title_frame].document.open();
      top.frames[title_frame].document.write
        ("&nbsp;Sites for which logon information won't be saved");
      top.frames[title_frame].document.close();

      loadRejectsList();
    }

    function loadRejectsList(){
      top.frames[list_frame].document.open();
      top.frames[list_frame].document.write(
        "<FORM name=fSelectReject>" +
          "<P>" +
          "<TABLE BORDER=0 WIDTH=100%HEIGHT=95%>" +
            "<TR>" +
              "<TD WIDTH=100%VALIGN=TOP>" +
                "<CENTER>" +
                  "<P>" +
                  "<SELECT NAME=selname SIZE=15 MULTIPLE> "
      );
      for (i=1; i<rejectList.length; i++) {
        if (!deleted_rejects[i-1]) {
          top.frames[list_frame].document.write(rejectList[i]);
        }
      }
      top.frames[list_frame].document.write(
                  "</SELECT>" +
                "</CENTER>" +
              "</TD>" +
            "</TR>" +
          "</TABLE>" +
        "</FORM>"
      );
      top.frames[list_frame].document.close();
    }

    function loadNopreviews(){
      signon_mode = 2;
      top.frames[index_frame].document.open();
      top.frames[index_frame].document.write(
        "<BODY BGCOLOR=#C0C0C0>" +
          "<TABLE BORDER=0 WIDTH=100%>" +
            "<TR>" +
              "<TD ALIGN=CENTER VALIGN=MIDDLE BGCOLOR=#C0C0C0>" +
                "<A HREF=javascript:top.loadSignons();>" +
                  "<FONT SIZE=2>Logons saved</FONT>" +
                "</A>" +
              "</TD>" +
              "<TD ALIGN=CENTER VALIGN=MIDDLE BGCOLOR=#C0C0C0>" +
                "<A HREF=javascript:top.loadRejects();>" +
                  "<FONT SIZE=2>Logons not saved</FONT>" +
                "</A>" +
              "</TD>" +
            "</TR>" +
            "<TR>" +
              "<TD ALIGN=CENTER VALIGN=MIDDLE BGCOLOR=#FFFFFF>" +
                "<FONT SIZE=2 COLOR=#666666>" +
                  "<B>Forms not previewed</B>" +
                "</FONT>" +
              "</TD>" +
              "<TD ALIGN=CENTER VALIGN=MIDDLE BGCOLOR=#C0C0C0>" +
                "<A HREF=javascript:top.loadNocaptures();>" +
                  "<FONT SIZE=2>Forms not saved</FONT>" +
                "</A>" +
              "</TD>" +
              "<TD>&nbsp;&nbsp;&nbsp;</TD>" +
            "</TR>" +
          "</TABLE>" +
        "</BODY>"
      );
      top.frames[index_frame].document.close();

      top.frames[title_frame].document.open();
      top.frames[title_frame].document.write
        ("&nbsp;Forms that won't be previewed before being pre-filled");
      top.frames[title_frame].document.close();

      loadNopreviewsList();
    }

    function loadNopreviewsList(){
      top.frames[list_frame].document.open();
      top.frames[list_frame].document.write(
        "<FORM name=fSelectNopreview>" +
          "<P>" +
          "<TABLE BORDER=0 WIDTH=100%HEIGHT=95%>" +
            "<TR>" +
              "<TD WIDTH=100%VALIGN=TOP>" +
                "<CENTER>" +
                  "<P>" +
                  "<SELECT NAME=selname SIZE=15 MULTIPLE> "
      );
      for (i=1; i<nopreviewList.length; i++) {
        if (!deleted_nopreviews[i-1]) {
          top.frames[list_frame].document.write(nopreviewList[i]);
        }
      }
      top.frames[list_frame].document.write(
                  "</SELECT>" +
                "</CENTER>" +
              "</TD>" +
            "</TR>" +
          "</TABLE>" +
        "</FORM>"
      );
      top.frames[list_frame].document.close();
    }

    function loadNocaptures(){
      signon_mode = 3;
      top.frames[index_frame].document.open();
      top.frames[index_frame].document.write(
        "<BODY BGCOLOR=#C0C0C0>" +
          "<TABLE BORDER=0 WIDTH=100%>" +
            "<TR>" +
              "<TD ALIGN=CENTER VALIGN=MIDDLE BGCOLOR=#C0C0C0>" +
                "<A HREF=javascript:top.loadSignons();>" +
                  "<FONT SIZE=2>Logons saved</FONT>" +
                "</A>" +
              "</TD>" +
              "<TD ALIGN=CENTER VALIGN=MIDDLE BGCOLOR=#C0C0C0>" +
                "<A HREF=javascript:top.loadRejects();>" +
                  "<FONT SIZE=2>Logons not saved</FONT>" +
                "</A>" +
              "</TD>" +
            "</TR>" +
            "<TR>" +
              "<TD ALIGN=CENTER VALIGN=MIDDLE BGCOLOR=#C0C0C0>" +
                "<A HREF=javascript:top.loadNopreviews();>" +
                  "<FONT SIZE=2>Forms not previewed</FONT>" +
                "</A>" +
              "</TD>" +
              "<TD ALIGN=CENTER VALIGN=MIDDLE BGCOLOR=#FFFFFF>" +
                "<FONT SIZE=2 COLOR=#666666>" +
                  "<B>Forms not saved</B>" +
                "</FONT>" +
              "</TD>" +
              "<TD>&nbsp;&nbsp;&nbsp;</TD>" +
            "</TR>" +
          "</TABLE>" +
        "</BODY>"
      );
      top.frames[index_frame].document.close();

      top.frames[title_frame].document.open();
      top.frames[title_frame].document.write
        ("&nbsp;Forms that won't be saved");
      top.frames[title_frame].document.close();

      loadNocapturesList();
    }

    function loadNocapturesList(){
      top.frames[list_frame].document.open();
      top.frames[list_frame].document.write(
        "<FORM name=fSelectNocapture>" +
          "<P>" +
          "<TABLE BORDER=0 WIDTH=100%HEIGHT=95%>" +
            "<TR>" +
              "<TD WIDTH=100%VALIGN=TOP>" +
                "<CENTER>" +
                  "<P>" +
                  "<SELECT NAME=selname SIZE=15 MULTIPLE> "
      );
      for (i=1; i<nocaptureList.length; i++) {
        if (!deleted_nocaptures[i-1]) {
          top.frames[list_frame].document.write(nocaptureList[i]);
        }
      }
      top.frames[list_frame].document.write(
                  "</SELECT>" +
                "</CENTER>" +
              "</TD>" +
            "</TR>" +
          "</TABLE>" +
        "</FORM>"
      );
      top.frames[list_frame].document.close();
    }

    function loadButtons(){
      top.frames[button_frame].document.open();
      top.frames[button_frame].document.write(
        "<FORM name=buttons>" +
          "<BR>" +
          "&nbsp;" +
          "<INPUT type=BUTTON " +
                 "value=Remove " +
                 "onclick=top.DeleteItemSelected();>" +
          "<DIV align=right>" +
            "<INPUT type=BUTTON value=OK width=80 onclick=parent.Save()>" +
            " &nbsp;&nbsp;" +
            "<INPUT type=BUTTON value=Cancel width=80 onclick=parent.DoCancel()>" +
          "</DIV>" +
          "<INPUT TYPE=HIDDEN NAME=goneS VALUE=\"\" SIZE=-1>" +
          "<INPUT TYPE=HIDDEN NAME=goneR VALUE=\"\" SIZE=-1>" +
          "<INPUT TYPE=HIDDEN NAME=goneP VALUE=\"\" SIZE=-1>" +
          "<INPUT TYPE=HIDDEN NAME=goneC VALUE=\"\" SIZE=-1>" +
          "<INPUT TYPE=HIDDEN NAME=signonList VALUE=\"\" SIZE=-1>" +
          "<INPUT TYPE=HIDDEN NAME=rejectList VALUE=\"\" SIZE=-1>" +
        "</FORM>"
      );
      top.frames[button_frame].document.close();
    }

    function loadFrames(){
      StartUp("Signons");
      list = DoGetSignonList();
      BREAK = list[0];
      signonList = list.split(BREAK);
      list = DoGetRejectList();
      BREAK = list[0];
      rejectList = list.split(BREAK);
      list = DoGetNopreviewList();
      BREAK = list[0];
      nopreviewList = list.split(BREAK);
      list = DoGetNocaptureList();
      BREAK = list[0];
      nocaptureList = list.split(BREAK);
      loadSignons();
      loadButtons();
    }

    function Save(){
      var goneS = top.frames[button_frame].document.buttons.goneS;
      var goneR = top.frames[button_frame].document.buttons.goneR;
      var goneP = top.frames[button_frame].document.buttons.goneP;
      var goneC = top.frames[button_frame].document.buttons.goneC;
      var result = "|goneS|"+goneS.value+"|goneR|"+goneR.value;
      result += "|goneC|"+goneC.value+"|goneP|"+goneP.value+"|";
      DoSave(result);
    }

  </SCRIPT>
</HEAD>
<FRAMESET ROWS = 50,25,*,75
         BORDER=0
         FRAMESPACING=0
         onLoad=loadFrames()>
  <FRAME SRC=about:blank
        NAME=index_frame
        SCROLLING=NO
        MARGINWIDTH=1
        MARGINHEIGHT=1
        NORESIZE>
  <FRAME SRC=about:blank
        NAME=title_frame
        SCROLLING=NO
        MARGINWIDTH=1
        MARGINHEIGHT=1
        NORESIZE>
  <FRAMESET COLS=5,*,5
           BORDER=0
           FRAMESPACING=0>
    <FRAME SRC=about:blank
          NAME=spacer1_frame
          SCROLLING=AUTO
          MARGINWIDTH=0
          MARGINHEIGHT=0
          NORESIZE>
    <FRAME SRC=about:blank
          NAME=list_frame
          SCROLLING=AUTO
          MARGINWIDTH=0
          MARGINHEIGHT=0
          NORESIZE>
    <FRAME SRC=about:blank
          NAME=spacer2_frame
          SCROLLING=AUTO
          MARGINWIDTH=0
          MARGINHEIGHT=0
          NORESIZE>
  </FRAMESET>
  <FRAME SRC=about:blank
        NAME=button_frame
        SCROLLING=NO
        MARGINWIDTH=1
        MARGINHEIGHT=1
        NORESIZE>
</FRAMESET>

<NOFRAMES>
  <BODY> <P> </BODY>
</NOFRAMES>
</HTML>
