<HTML>
<HEAD>
<TITLE>Debug Plug-in Test</TITLE>
</HEAD>
<BODY>

<center>
<h1> XPConnect Scriptable Debug Plug-in </h1>
</center>


<br><br>

<center>

<embed type="application/debug-plugin" width=1 height=1 hidden="true"><br>

<script>
var embed = document.embeds[0];
var started = false;
var theWindow;

function DumpFrames(firstTime,lastFile)
{
var loadingFlag;

  if (firstTime == true) {
    var filedirectory = "file:///S|/mozilla/layout/html/tests/block";
    embed.StartDirectorySearch(filedirectory);
    filename=embed.GetNextFileInDirectory();
    if( filename != null) {
      theWindow = window.open(filename);
    }
    started = true;
  } else {
    filename = lastFile;
  }

  while ( filename != null) {
    alert(filename);
    outputfilename = filename.replace (".html",".tst"); 
    
	  loading = embed.DumpLayout(theWindow,"s:/tests","outputfilename");

    alert (loading);
    if (loading != 0) {
      setTimeout("DumpFrames(false,filename)",1000);
      alert("Waiting");
      break;
    } else {
      theWindow.close();
      filename=embed.GetNextFileInDirectory();
      alert("successful");
      if( filename != null) {
        theWindow = window.open(filename);
      }
    }
  }
}

</script>

<br>
<form name="formname">
<input type=button value="DumpFrames" onclick='DumpFrames(true,0)'>
</form>

</center>

</BODY>
</HTML>
