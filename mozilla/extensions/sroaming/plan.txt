To do:
- UI
  - conflict dialog
    - column headings
    - width
  - listing progressmeter doesn't work
- error handling
  - (local profile) files missing, also adjust listing.xml
  - copy protocol
    - no remote files yet

Later:
- nsiprogresseventsink comment
- license headers
- nsresult for internal functions, clean up interfaces
- warn before saving pw
- alert() -> nsiprompt
- remove printfs
- XXXs
- clean up progressdialog

don't care (for now):
- conflict
  - some files failed (see XXX - update: eh, where was that?)
- world gone
  - problem: ddump, xpcom not defined after files done and dialog closed
    solution: close dialog only when done with processing.
    workaround: gTimeout
  - problem: cancel by user in progress dialog: xpconnect errors
    solution: prevent dialog closure (even if cancel pressed) until we're done.

Enhance
- protocols
  - HTTPS
  - LDAP (already done by Sun?)
  - IMAP
- password encrypt
- rewrite progress dialog
- no upload at switch profile
- don't transfer files that didn't change (server = local)

roaming urls
 <ftp://user@ftp-server//path/to/dir/>
 <http://user@http-server/path/to/dir/>
 Mind the number of slashes.
 Servers used: wu-FTPd and Apache with mod_roaming.


Feedback
- why do I need to implement nsIDocShellTreeItem for a http xml file *download*?
- onStopRequest (e.g. Request: http://ben:pgpben@http.server.bucksch.org/roaming/ben/listing.xml, StatusCode: NS_OK, HTTPResponse 200) called *before*  the file finished. ftp and http: onStopRequest *before* onStatus(SENDING_TO), but only for the first file

clipboard

undefined.message=Component returned failure code: 0x80004005 (NS_ERROR_FAILURE) [nsIURI.password]
undefined.result=2147500037
undefined.name=NS_ERROR_FAILURE
undefined.filename=chrome://sroaming/content/transfer/transfer.js
undefined.lineNumber=225
undefined.columnNumber=4294967295

WARNING: NS_ENSURE_TRUE(!aQualifiedName.IsEmpty()) failed, file ../../../../mozilla/content/base/src/nsNodeInfoManager.cpp, line 287

[4]
onStatus:
  Request: ftp://ben:ie02c@ftp.server.bucksch.org//mnt/save/roaming/ben/listing.xml
  StatusCode: NET_STATUS_SENDING_TO
  StatusArg: ftp.server.bucksch.org
request to change listing.xml from done (NS_OK) to busy (NET_STATUS_SENDING_TO)
SetProgressStatus(1): listing.xml, busy, NET_STATUS_SENDING_TO
  Setting listing.xml from done to busy
