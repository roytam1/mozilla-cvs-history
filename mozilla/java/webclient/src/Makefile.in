#//------------------------------------------------------------------------
#//
#// Makefile to build the native portion of webclient
#//
#//------------------------------------------------------------------------

DEPTH        = ../../..
topsrcdir	= @top_srcdir@
srcdir		= @srcdir@
VPATH		= @srcdir@

include $(DEPTH)/config/autoconf.mk

#//------------------------------------------------------------------------
#//
#// Specify any "command" targets. (ie. DIRS, INSTALL_FILES, ...)
#// (these must come before the common makefiles are included)
#// 
#// DIRS          - There are subdirectories to process
#//
#//------------------------------------------------------------------------
DIRS= motif


include $(topsrcdir)/config/config.mk

MODULE		= webclient
LIBRARY_NAME	= webclient

NO_LD_ARCHIVE_FLAGS = 1

CPPSRCS         = nsActions.cpp \
                  BrowserControlNativeShim.cpp  

ifeq ($(OS_TARGET),SunOS)
JDK_PLATFORM_PATH=jre/lib/sparc
else
JDK_PLATFORM_PATH=jre/lib/i386
endif

GTKLIBS = -L/usr/lib -L/usr/X11R6/lib -lgtk -lgdk -lgmodule -lglib -ldl -lXext -lX11 -lm
JAVALIBS = -L${JDKHOME}/$(JDK_PLATFORM_PATH) -L${JDKHOME}/$(JDK_PLATFORM_PATH)/classic -L${JDKHOME}/$(JDK_PLATFORM_PATH)/native_threads -ljava

EXTRA_DSO_LDOPTS = \
	$(GTKLIBS) \
	$(JAVALIBS) \
	$(NULL)

EXTRA_LIBS	= \
	raptorgfx \
	expat \
	xmltok \
	jsurl \
	mozdbm \
	mozjs \
	secfree \
	mozutil \
	nspr3 \
	xp \
	jpeg \
	png \
	z \
	pthread \
	xpcom \
	img \
	plds3 \
	gfx_gtk \
	raptorwebwidget \
	raptorhtmlpars \
	raptorplugin \
	pref \
	jsdom \
	timer_gtk_s \
	$(DEPTH)/xpfe/bootstrap/nsSetupRegistry.o \
	$(NULL)  

SHARED_LIBRARY_LIBS = $(DIST)/lib/libwebclient_motif.a

ifeq ($(NSPR_INCLUDE_DIR),)
INCLUDES +=            -I$(DIST)/include/private
else
INCLUDES +=            -I$(NSPR_INCLUDE_DIR)/private
endif

include $(topsrcdir)/config/rules.mk

#ifndef MOZ_MONOLITHIC_TOOLKIT
CXXFLAGS	+= $(MOZ_GTK_CFLAGS)
CFLAGS		+= $(MOZ_GTK_CFLAGS)
#else
CXXFLAGS	+= $(TK_CFLAGS)
CFLAGS		+= $(TK_CFLAGS)
#endif

DEFINES	+= -D_REENTRANT -DNECKO -DXP_UNIX -DDEBUG_RAPTOR_CANVAS

export:: BrowserControlNativeShim.h

BrowserControlMozillaShim.h:
	@echo Assuming class org.mozilla.webclient.BrowserControlNativeShim is in $(JAVAH_FLAGS)
	$(JAVAH) $(JAVAH_FLAGS)  -o $@ org.mozilla.webclient.BrowserControlNativeShim
