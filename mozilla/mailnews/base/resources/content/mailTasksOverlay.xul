<?xml version="1.0"?>

<!DOCTYPE window [
<!ENTITY % brandDTD SYSTEM "chrome://global/locale/brand.dtd" >
%brandDTD;
<!ENTITY % mailTasksOverlayDTD SYSTEM "chrome://messenger/locale/mailTasksOverlay.dtd" >
%mailTasksOverlayDTD;
]>

<overlay id="mailPrefsOverlay"
         xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">

  <script language="JavaScript">
  <![CDATA[
    // uses "toOpenWindowByType" function provided by utilityOverlay.js
    // which is included by most clients. 
    function toMessengerWindow()
      {
	var pref = Components.classes["component://netscape/preferences"].getService(Components.interfaces.nsIPref);
        var windowDoc = "chrome://messenger/content/messenger.xul";
      	try
          {
    	    	var layoutType = pref.GetIntPref("mail.pane_config");
    			  windowDoc = !layoutType ? "chrome://messenger/content/messenger.xul" : 
                                          "chrome://messenger/content/mail3PaneWindowVertLayout.xul";
    	    }
    	  catch(ex)
    	    {
    	    }
		    toOpenWindowByType("mail:3pane", windowDoc);
      }
    
    function toAddressBook() 
      {
    	  toOpenWindowByType("mail:addressbook", "chrome://messenger/content/addressbook/addressbook.xul");
      }
    
    function toNewsgroups() 
      {
        dump ("Sorry, command not implemented.\n");
      }

    function toImport()
      {
      	window.openDialog("chrome://messenger/content/importDialog.xul","importDialog","chrome, modal, titlebar", {importType: "addressbook"});
      }

  ]]>
  </script>         

  <keyset id="keyset">
    <key id="key_mail" xulkey="true" key="&messengerCmd.commandkey;" observes="Tasks:Mail"/>
  </keyset>


  <broadcasterset id="broadcasterset">
    <broadcaster id="Tasks:Mail" value="&messengerCmd.label;" oncommand="toMessengerWindow();"/>
  </broadcasterset>
  

  <box id="taskButtons">
    <button class="button-toolbar-4 taskbutton" id="mini-mail" onclick="toMessengerWindow()" 
            position="2" tooltip="aTooltip" tooltiptext="&taskMessenger.tooltip;"/>
  </box>
  
  <menupopup id="taskPopup">
    <menuitem position="2" value="&messengerCmd.label;" accesskey="&messengerCmd.accesskey;" key="key_mail" observes="Tasks:Mail"/>
  </menupopup>
  
</overlay>         

