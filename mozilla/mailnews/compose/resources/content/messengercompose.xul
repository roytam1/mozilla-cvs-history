<?xml version="1.0"?> 
<!--
   - The contents of this file are subject to the Netscape Public
   - License Version 1.1 (the "License"); you may not use this file
   - except in compliance with the License. You may obtain a copy of
   - the License at http://www.mozilla.org/NPL/
   -  
   - Software distributed under the License is distributed on an "AS
   - IS" basis, WITHOUT WARRANTY OF ANY KIND, either express or
   - implied. See the License for the specific language governing
   - rights and limitations under the License.
   -  
   - The Original Code is Mozilla Communicator client code, released
   - March 31, 1998.
   - 
   - The Initial Developer of the Original Code is Netscape
   - Communications Corporation. Portions created by Netscape are
   - Copyright (C) 1999 Netscape Communications Corporation. All
   - Rights Reserved.
   - 
   - Contributor(s):
   -   Ben Goodger <ben@netscape.com> (ass'td polish fixes)
  -->

<?xul-overlay href="chrome://global/content/charsetOverlay.xul"?>
<?xul-overlay href="chrome://communicator/content/tasksOverlay.xul"?>
<?xul-overlay href="chrome://communicator/content/communicatorOverlay.xul"?>
<?xul-overlay href="chrome://messenger/content/messengercompose/addressingWidgetOverlay.xul"?>
<?xul-overlay href="chrome://global/content/globalOverlay.xul"?>
<?xul-overlay href="chrome://communicator/content/utilityOverlay.xul"?>
<?xul-overlay href="chrome://editor/content/editorOverlay.xul"?>

<?xml-stylesheet href="chrome://messenger/skin/" type="text/css"?> 
<?xml-stylesheet href="chrome://messenger/skin/messengercompose/messengercompose.css" type="text/css"?> 

<!DOCTYPE window SYSTEM "chrome://messenger/locale/messengercompose/messengercompose.dtd">

<window id="main-window"
        xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
        xmlns:nc="http://home.netscape.com/NC-rdf#"
        onunload="ComposeUnload()"
        onload="ComposeLoad()"
        onclose="return ComposeCanClose()"
        onfocus="UpdateOfflineState()"
        title="&msgComposeWindow.title;"
        windowtype="msgcompose"
        orient="vertical"
        width="640" height="480"
        persist="screenX screenY width height sizemode"> 

<script language="JavaScript" src="chrome://global/content/strres.js"></script>
<script language="JavaScript" src="chrome://messenger/content/accountUtils.js"></script>
<script language="JavaScript" src="chrome://messenger/content/widgetglue.js"></script>
<script language="JavaScript" src="chrome://editor/content/editor.js"></script>
<script language="JavaScript" src="chrome://editor/content/ComposerCommands.js"></script>
<script language="JavaScript" src="chrome://editor/content/EditorCommandsDebug.js"></script>
<script language="JavaScript" src="chrome://messenger/content/messengercompose/MsgComposeCommands.js"></script>


<!-- drag and drop -->
<script language="JavaScript" src="chrome://global/content/nsDragAndDrop.js"></script>
<script language="JavaScript" src="chrome://global/content/nsJSSupportsUtils.js"></script>
<script language="JavaScript" src="chrome://global/content/nsJSComponentManager.js"></script>
<script language="JavaScript" src="chrome://global/content/nsTransferable.js"></script>

<commands id="commands">
  <commandset id="msgComposeCommandUpdate"
    commandupdater="true"
    events="create, focus,tree-select"
    oncommandupdate="CommandUpdate_MsgCompose()"
  />

  <commandset id="globalEditMenuItems"/>
  <commandset id="selectEditMenuItems"/>
  <commandset id="undoEditMenuItems"/>
  <commandset id="clipboardEditMenuItems"/>

  <commandset id="commonEditorMenuItems"/>
  <commandset id="composerMenuItems"/>
  <commandset id="composerEditMenuItems"/>
  <commandset id="composerSaveMenuItems"/>    
  <commandset id="composerStyleMenuItems"/>
  <commandset id="composerTableMenuItems"/>
  <commandset id="composerListMenuItems"/>
</commands>

<broadcasterset id="broadcasterset">
	<!-- File Menu -->
	<broadcaster id="cmd_new" oncommand="goDoCommand('cmd_newMessage')"/>
	<broadcaster id="cmd_attachFile" oncommand="goDoCommand('cmd_attachFile')"/>
	<broadcaster id="cmd_attachPage" oncommand="goDoCommand('cmd_attachPage')"/>
	<broadcaster id="cmd_close" oncommand="goDoCommand('cmd_close')"/>
	<broadcaster id="cmd_saveDefault" oncommand="goDoCommand('cmd_saveDefault')"/>
	<broadcaster id="cmd_saveAsFile" oncommand="goDoCommand('cmd_saveAsFile')"/>
	<broadcaster id="cmd_saveAsDraft" oncommand="goDoCommand('cmd_saveAsDraft')"/>
	<broadcaster id="cmd_saveAsTemplate" oncommand="goDoCommand('cmd_saveAsTemplate')"/>
	<broadcaster id="cmd_sendButton" oncommand="goDoCommand('cmd_sendButton')"/>
	<broadcaster id="cmd_sendNow" oncommand="goDoCommand('cmd_sendNow')"/>
	<broadcaster id="cmd_sendLater" oncommand="goDoCommand('cmd_sendLater')"/>
<!--NYI	<broadcaster id="cmd_printSetup" oncommand="dump('PRINT SETUP\n');"/>  -->
	<broadcaster id="cmd_print" oncommand="goDoCommand('cmd_print')"/>
	<broadcaster id="cmd_quit"/>

	<!-- Edit Menu -->
	<!--broadcaster id="cmd_pasteQuote"/  DO NOT INCLUDE THOSE PBROCASTER ESLE THE EDIT MENU WILL BE BROKEN! -->
	<!--broadcaster id="cmd_find"/-->
	<!--broadcaster id="cmd_findNext"/-->
	<broadcaster id="cmd_account" oncommand="goDoCommand('cmd_account')"/>
	<broadcaster id="cmd_preferences" oncommand="goDoCommand('cmd_preferences')"/>

  <!-- View Menu -->
  <broadcaster id="cmd_showComposeToolbar" oncommand="goDoCommand('cmd_showComposeToolbar')"/>
  <broadcaster id="cmd_showFormatToolbar" oncommand="goDoCommand('cmd_showFormatToolbar')"/>
  
  <!-- Insert Menu -->
  <broadcaster id="cmd_insert"/>
  <!--broadcaster id="cmd_link"/-->
  <!--broadcaster id="cmd_anchor"/-->
  <!--broadcaster id="cmd_image"/-->
  <!--broadcaster id="cmd_hline"/-->
  <!--broadcaster id="cmd_table"/-->
  <!--broadcaster id="cmd_insertHTML"/-->
  <!--broadcaster id="cmd_insertChars"/-->
  <!--broadcaster id="cmd_insertBreak"/-->
  <!--broadcaster id="cmd_insertBreakAll"/-->
  
  <!-- Format Menu -->
  <broadcaster id="cmd_format"/>
  <!--broadcaster id="cmd_decreaseFont"/-->
  <!--broadcaster id="cmd_increaseFont"/-->
  <!--broadcaster id="cmd_bold"/-->
  <!--broadcaster id="cmd_italic"/-->
  <!--broadcaster id="cmd_underline"/-->
  <!--broadcaster id="cmd_strikethrough"/-->
  <!--broadcaster id="cmd_superscript"/-->
  <!--broadcaster id="cmd_subscript"/-->
  <!--broadcaster id="cmd_nobreak"/-->
  <!--broadcaster id="cmd_em"/-->
  <!--broadcaster id="cmd_strong"/-->
  <!--broadcaster id="cmd_cite"/-->
  <!--broadcaster id="cmd_abbr"/-->
  <!--broadcaster id="cmd_acronym"/-->
  <!--broadcaster id="cmd_code"/-->
  <!--broadcaster id="cmd_samp"/-->
  <!--broadcaster id="cmd_var"/-->
  <!--broadcaster id="cmd_removeList"/-->
  <!--broadcaster id="cmd_ul"/-->
  <!--broadcaster id="cmd_ol"/-->
  <!--broadcaster id="cmd_dt"/-->
  <!--broadcaster id="cmd_dd"/-->
  <!--broadcaster id="cmd_listProperties"/-->
  <!--broadcaster id="cmd_indent"/-->
  <!--broadcaster id="cmd_outdent"/-->
  <!--broadcaster id="cmd_objectProperties"/-->
  <!--broadcaster id="cmd_InsertTable"/-->
  <!--broadcaster id="cmd_InsertRowAbove"/-->
  <!--broadcaster id="cmd_InsertRowBelow"/-->
  <!--broadcaster id="cmd_InsertColumnBefore"/-->
  <!--broadcaster id="cmd_InsertColumnAfter"/-->
  <!--broadcaster id="cmd_SelectTable"/-->
  <!--broadcaster id="cmd_SelectRow"/-->
  <!--broadcaster id="cmd_SelectColumn"/-->
  <!--broadcaster id="cmd_SelectCell"/-->
  <!--broadcaster id="cmd_SelectAllCells"/-->
  <!--broadcaster id="cmd_DeleteTable"/-->
  <!--broadcaster id="cmd_DeleteRow"/-->
  <!--broadcaster id="cmd_DeleteColumn"/-->
  <!--broadcaster id="cmd_DeleteCell"/-->
  <!--broadcaster id="cmd_DeleteCellContents"/-->
  <!--broadcaster id="cmd_NormalizeTable"/-->
  <!--broadcaster id="cmd_tableJoinCells"/-->
  <!--broadcaster id="cmd_tableSplitCell"/-->
  <!--broadcaster id="cmd_editTable"/-->
  
  <!-- Options Menu -->
	<broadcaster id="cmd_selectAddress" oncommand="goDoCommand('cmd_selectAddress')"/>
	<broadcaster id="cmd_outputFormat" oncommand="OutputFormatMenuSelect(event.target)"/>
	<!-- broadcaster id="cmd_quoteMessage" oncommand="goDoCommand('cmd_quoteMessage')"/ -->
	<broadcaster id="cmd_rewrap" oncommand="goDoCommand('cmd_rewrap')"/>

	<broadcaster id="Editor:Throbber" busy="false"/>
</broadcasterset>

<broadcaster id="args" value="editorType=default"/>

<popupset>
	<popup id="TextColorPopup"/>
	<popup id="BackColorPopup"/>
</popupset>
<popupset id="aTooltipSet"/>

<keyset id="keyset">
	<!-- File Menu -->
	<key id="key_newNavigator"/>
	<key id="key_close"/>
	<key id="key_save"  key="&saveCmd.key;" observes="cmd_saveDefault" modifiers="accel"/>
	<!-- key id="key_sendNow" xulkey="true" keycode="&sendNowCmd.keycode;" observes="cmd_sendNow"/ -->
	<!-- key id="key_sendLater" xulkey="true" keycode="&sendLaterCmd.keycode;" shift="true" observes="cmd_sendLater"/ -->
	<key id="key_print"  key="&printCmd.key;" observes="cmd_print" modifiers="accel"/>
	<key id="key_quit"/>
	
	<!-- Edit Menu -->
  <key id="key_undo"/>
  <key id="key_redo"/>
  <key id="key_cut"/>
  <key id="key_copy"/>
  <key id="key_paste"/>
  <key id="pastequotationkb"/>
  <key id="key_delete"/>
  <key id="key_selectAll"/>
	<key id="key_find"  key="&findCmd.key;"  observes="cmd_find" modifiers="accel"/>
	<key id="key_findNext"  key="&findAgainCmd.key;" observes="cmd_findNext" modifiers="accel"/>
  
	<!-- Format Menu -->
  <key id="boldkb"/>
  <key id="italickb"/>
  <key id="underlinekb"/>

  <key id="fontfixedwidthkb"/>
  <key id="increaseindentkb"/>
  <key id="decreaseindentkb"/>

  <key id="removestyleskb"/>
  <key id="decreasefontsizekb"/>
  <key id="increasefontsizekb"/>

	<!-- Options Menu -->
	<!-- key id="key_selectAddresses" xulkey="true" key="&selectAddressCmd.key;" observes="cmd_selectAddress"/ -->
  <key id="key_checkspelling"  key="&checkSpellingCmd.key;" observes="cmd_spelling"  modifiers="accel"/>
	
</keyset>

<popupset>
  <popup id="TextColorPopup"/>
  <popup id="BackColorPopup"/>
</popupset>

  <toolbox class="toolbox-top">
    <menubar id="compose-menubar">
      <menu id="menu_File">
        <menupopup id="menu_FilePopup">
          <menuitem value="&newMessage.label;" accesskey="&newMessage.accesskey;" key="key_newMessage" oncommand="goOpenNewMessage();"/>
          <menu id="menu_New">
            <menupopup id="menu_NewPopup">
              <menuitem id="menu_newNavigator"/>
              <menuitem id="menu_newEditor"/>
            </menupopup>
          </menu>
          <menuitem value="&attachFileCmd.label;" accesskey="&attachFileCmd.accesskey;" observes="cmd_attachFile"/>
          <menuitem value="&attachPageCmd.label;" accesskey="&attachPageCmd.accesskey;" observes="cmd_attachPage"/>
          <menuseparator/>
          <menuitem id="menu_close"/>
          <menuitem value="&saveCmd.label;" accesskey="&saveCmd.accesskey;" key="key_save" observes="cmd_saveDefault"/>
          <menu value="&saveAsCmd.label;" accesskey="&saveAsCmd.accesskey;">
            <menupopup>
              <menuitem value="&saveAsFileCmd.label;" accesskey="&saveAsFileCmd.accesskey;" observes="cmd_saveAsFile"/>
              <menuseparator/>
              <menuitem value="&saveAsDraftCmd.label;" accesskey="&saveAsDraftCmd.accesskey;" observes="cmd_saveAsDraft"/>
              <menuitem value="&saveAsTemplateCmd.label;" accesskey="&saveAsTemplateCmd.accesskey;" observes="cmd_saveAsTemplate"/>
            </menupopup>
          </menu>
          <menuseparator/>
          <menuitem value="&sendNowCmd.label;" accesskey="&sendNowCmd.accesskey;" observes="cmd_sendNow"/>
          <menuitem value="&sendLaterCmd.label;" accesskey="&sendLaterCmd.accesskey;" observes="cmd_sendLater"/>
          <menuseparator/>
<!--NYI          <menuitem value="&printSetupCmd.label;" accesskey="&printSetupCmd.accesskey;" observes="cmd_printSetup"/>   -->
          <menuitem id="printMenuItem" value="&printCmd.label;" accesskey="&printCmd.accesskey;" key="key_print" observes="cmd_print"/>
          <menuseparator/>
        </menupopup>
      </menu>
      <menu id="menu_Edit">
        <menupopup oncreate="EditorInitEditMenu()">
          <menuitem id="menu_undo"/>
          <menuitem id="menu_redo"/>
          <menuseparator/>
          <menuitem id="menu_cut"/>
          <menuitem id="menu_copy"/>
          <menuitem id="menu_paste"/>
          <menuitem id="menu_pasteQuote"/>
          <menuitem id="menu_delete"/>
          <menuseparator/>
          <menuitem id="menu_selectAll"/>
          <menuseparator/>
          <menuitem value="&findCmd.label;"      key="key_find"      accesskey="&findCmd.accesskey;"      observes="cmd_find"/>
          <menuitem value="&findAgainCmd.label;" key="key_findNext" accesskey="&findAgainCmd.accesskey;" observes="cmd_findNext"/>
          <menuseparator/>
          <menuitem value="&accountManagerCmd.label;" accesskey="&accountManagerCmd.accesskey;" observes="cmd_account"/>
          <menuitem id="menu_preferences" observes="cmd_preferences"/>
        </menupopup>
      </menu>
      <menu id="menu_View">
        <menupopup>
          <menu id="menu_Toolbars">
            <menupopup>
              <menuitem id="menu_showComposeToolbar"
                        type="checkbox"
                        value="&showComposeToolbarCmd.label;"
                        observes="cmd_showComposeToolbar"
                        accesskey="&showComposeToolbarCmd.accesskey;"
                        checked="true"/>
              <menuitem id="menu_showFormatToolbar"
                        type="checkbox"
                        value="&showFormatToolbarCmd.label;"
                        observes="cmd_showFormatToolbar"
                        accesskey="&showFormatToolbarCmd.accesskey;"
                        checked="true"/>
              <menuitem id="menu_showTaskbar"
                        type="checkbox"/>
            </menupopup>
          </menu>
          <menuseparator/>
          <menu id = "maileditCharsetMenu" />
        </menupopup>
      </menu>
  
      <menu id="insertMenu" observes="cmd_insert"/>

      <menu id="formatMenu" value="&formatMenu.label;" accesskey="&formatMenu.accesskey;" observes="cmd_format">
        <menupopup id="formatMenuPopup">
          <menu id="tableMenu"/>
          <menuseparator/>
          <menuitem id="objectProperties"/>
          <menuitem id="colorsAndBackground"/>
        </menupopup>
      </menu>
  
      <menu value="&optionsMenu.label;" accesskey="&optionsMenu.accesskey;">
        <menupopup>	
          <menuitem value="&selectAddressCmd.label;" accesskey="&selectAddressCmd.accesskey;" observes="cmd_selectAddress"/>
          <menuitem value="&checkSpellingCmd.label;" id="menu_checkspelling" accesskey="&checkSpellingCmd.accesskey;" key="key_checkspelling" observes="cmd_spelling"/>
          <!--menuitem value="&quoteOrigCmd.label;" accesskey="&quoteOrigCmd.accesskey;" observes="cmd_quoteMessage"/-->	
          <menuitem value="&editRewrapCmd.label;" accesskey="&editRewrapCmd.accesskey;" observes="cmd_rewrap" oncommand="editorShell.Rewrap(false)"/>
          <menuseparator/>
          <menu value="&outputFormatMenu.label;" accesskey="&outputFormatMenu.accesskey;" observes="cmd_outputFormat">
            <menupopup>
              <menuitem type="radio" name="output_format" value="&autoFormatCmd.label;" accesskey="&autoFormatCmd.accesskey;" id="1" checked="true"/>
              <menuitem type="radio" name="output_format" value="&plainTextFormatCmd.label;" accesskey="&plainTextFormatCmd.accesskey;" id="2"/>
              <menuitem type="radio" name="output_format" value="&htmlFormatCmd.label;" accesskey="&htmlFormatCmd.accesskey;" id="3"/>
              <menuitem type="radio" name="output_format" value="&bothFormatCmd.label;" accesskey="&bothFormatCmd.accesskey;" id="4"/>
            </menupopup>
          </menu>
          <menu value="&priorityMenu.label;" accesskey="&priorityMenu.accesskey;" oncommand="PriorityMenuSelect(event.target);">
            <menupopup>
              <menuitem type="radio" name="priority" value="&lowestPriorityCmd.label;" accesskey="&lowestPriorityCmd.accesskey;" id="lowest"/>
              <menuitem type="radio" name="priority" value="&lowPriorityCmd.label;" accesskey="&lowPriorityCmd.accesskey;" id="low"/>
              <menuitem type="radio" name="priority" value="&normalPriorityCmd.label;" accesskey="&normalPriorityCmd.accesskey;" id="normal" checked="true"/>
              <menuitem type="radio" name="priority" value="&highPriorityCmd.label;" accesskey="&highPriorityCmd.accesskey;" id="high"/>
              <menuitem type="radio" name="priority" value="&highestPriorityCmd.label;" accesskey="&highestPriorityCmd.accesskey;" id="highest"/>
            </menupopup>
          </menu>
          <menu value="&fileCarbonCopyCmd.label;" accesskey="&fileCarbonCopyCmd.accesskey;" id="fccMenu" datasources="rdf:mailnewsfolders rdf:msgaccountmanager" ref="msgaccounts:/" ignore="http://home.netscape.com/NC-rdf#MessageChild">
            <menupopup/>
            <template> 
              <rule nc:CanFileMessages="true" iscontainer="true" isempty="false">
                <menupopup>
                  <!--menuitem value="[current selection]" disabled="true"/>
                  <menuseparator/-->
                  <menu uri="..."  class="folderMenuItem" value="rdf:http://home.netscape.com/NC-rdf#Name"
                        SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
                        BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
                        IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
                        ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType">
                    <menupopup>
                      <menuitem uri="..." value="&fileHereMenu.label;"
                                oncommand="MessageFcc(event.target)"
                                SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
                                BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
                                IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
                                ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType" />
                      <menuseparator/>
                    </menupopup>
                  </menu>
                </menupopup>
              </rule>
              <rule nc:CanFileMessages="false" nc:ServerType="nntp"/>
              <rule nc:CanFileMessages="false" iscontainer="true" isempty="false">
                <menupopup>
                  <menu uri="..."  class="folderMenuItem" value="rdf:http://home.netscape.com/NC-rdf#Name"
                        SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
                        BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
                        IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
                        ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType">
                    <menupopup/>
                  </menu>
                </menupopup>
              </rule>
              <rule nc:CanFileMessages="true">
                <menupopup>
                  <menuitem uri="..." class="folderMenuItem" value="rdf:http://home.netscape.com/NC-rdf#Name"
                            oncommand="MessageFcc(event.target)" 
                            SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
                            BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
                            IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
                            ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType"/>
                </menupopup>
              </rule>
            </template>
          </menu>	    
          <!--menuseparator/>
          <menuitem value="&addSignatureCmd.label;" disabled="true" oncommand=""/>    	
          <menuitem value="&attachVCardCmd.label;" disabled="true" accesskey="&attachVCardCmd.accesskey;" oncommand="AttachVCard()"/-->    	
        </menupopup>
      </menu>
      <!--menu id="debugMenu"/-->
      <menu id="tasksMenu"/>
      <menu id="menu_Help"/>
    </menubar>

    <toolbar class="toolbar-primary chromeclass-toolbar" id="composeToolbar" persist="collapsed">
      <box id="toolbar_button_box">
       <button class="button-toolbar-2 top" 
               id="button-send" value="&sendButton.label;"
               tooltip="aTooltip" tooltiptext="&sendButton.tooltip;" 
               observes="cmd_sendButton"
               now_value="&sendButton.label;"
               now_tooltiptext="&sendButton.tooltip;"
               later_value="&sendLaterCmd.label;"
               later_tooltiptext=""
               />
       <toolbarseparator class="toolbarseparator-primary"/>
       <button class="button-toolbar-2 top" 
               id="button-address" value="&addressButton.label;" 
               tooltip="aTooltip" tooltiptext="&addressButton.tooltip;" 
               observes="cmd_selectAddress"/>
       <button class="button-toolbar-2 top" 
               id="button-attach" value="&attachButton.label;" 
               tooltip="aTooltip" tooltiptext="&attachButton.tooltip;" 
               observes="cmd_attachFile"/>
       <button class="button-toolbar-2 top" 
               id="spellingButton" value="&spellingButton.label;" 
               observes="cmd_spelling"/>
       <toolbarseparator class="toolbarseparator-primary"/>
       <button class="button-toolbar-2 top" 
               id="button-save" value="&saveButton.label;" 
               tooltip="aTooltip" tooltiptext="&saveButton.tooltip;" 
               observes="cmd_saveDefault"/>
       <spring flex="1"/>
       <box autostretch="never">
         <button id="navigator-throbber" 
               oncommand="goClickThrobber('compose.throbber.url')">
           <observes element="broadcaster_throbber" attribute="busy"/>
         </button>
       </box>
       </box>
    </toolbar>
  
    <toolbar id="MsgHeadersToolbar" persist="collapsed" tborient="vertical" tbautostretch="always" flex="1">
      <box id="msgheaderstoolbar-box" flex="1">
        <box orient="vertical" flex="75">
          <box autostretch="never">
            <text class="label" value="&fromAddr.label;"/>
            <menulist id="msgIdentity" value="..." flex="1" oncommand="LoadIdentity(false);">
              <menupopup id="msgIdentityPopup"/>
            </menulist>
          </box> 
          <tree id="addressingWidgetTree" flex="1"/>
          <box autostretch="never">
            <text class="label" value="&subject.label;"/>
            <textfield id="msgSubject" type="text" flex="1" onkeyup="SetComposeWindowTitle(event.which);"
                       onkeypress="subjectKeyPress(event);" onchange="contentChanged=true;"/>
          </box>
        </box>
        <splitter id="attachmentbucket-sizer" collapse="after"/>
        <box orient="vertical" flex="25">
          <text class="label" id="attachmentBucketText" value="&attachments.label;" crop="right"/>
          <tree id="attachmentBucket" class="inset toolbar-focustarget" flex="1" style="height: 0px; width: 0px;"
                dragdroptree="true"
                onkeypress="if (event.keyCode == 8 || event.keyCode == 46) RemoveSelectedAttachment();"
                onchange="contentChanged=true;"
                onclick="AttachmentBucketClicked(event);"
                ondragover="nsDragAndDrop.dragOver(event, attachmentBucketObserver);"
                ondragdrop="nsDragAndDrop.drop(event, attachmentBucketObserver);"
                ondragexit="nsDragAndDrop.dragExit(event, attachmentBucketObserver);">
                
            <treecolgroup>
              <treecol flex="1"/>
            </treecolgroup>
            <treechildren id="bucketBody" flex="1"/>
          </tree>
        </box>
      </box>
    </toolbar>
  
    <!-- These toolbar items get filled out from the editorOverlay -->
    <toolbar id="FormatToolbar" persist="collapsed" tbautostretch="never">
      <menulist id="ParagraphSelect"/>
      <menulist id="FontFaceSelect"/>
      <stack id="ColorButtons"/>
      <button id="DecreaseFontSizeButton"/>
      <button id="IncreaseFontSizeButton"/>
      <toolbarseparator class="toolbarseparator-standard"/>
      <button id="boldButton"/>
      <button id="italicButton"/>
      <button id="underlineButton"/>
      <toolbarseparator class="toolbarseparator-standard"/>
      <button id="ulButton"/>
      <button id="olButton"/>
      <button id="outdentButton"/>
      <button id="indentButton"/>
      <toolbarseparator class="toolbarseparator-standard"/>
    
      <menu>
        <button id="AlignPopupButton"/>
        <menupopup id="AlignmentPopup"/>
      </menu>
    
      <menu>
        <button id="InsertPopupButton"/>
        <menupopup id="InsertPopup"/>
      </menu>
      <spring flex="1"/>
    </toolbar>
  </toolbox>

  <splitter id="compose-toolbar-sizer" collapse="after"/>

  <!-- The mail message body frame -->
  <box id="appcontent" orient="vertical" flex="1">
    <editor type="content-primary" id="content-frame" src="about:blank" name="browser.message.body" flex="1"
            onkeypress="editorKeyPress(event);"/>
  </box>

  <statusbar id="status-bar">
    <statusbarpanel id="offline-status" onclick="setTimeout('UpdateOfflineState()', 0)"/> 
    <progressmeter class="progressmeter-statusbar" mode="normal" value="0"/>
    <statusbarpanel id="statusText" flex="1" value="&defaultStatusText.label;"/>
  </statusbar>

  <box id="taskbar"/>

</window>

