? rejs
? zip
? README/user
? extensions/spellcheck
? mailnews/mime/diff
? themes/classic/communicator/brand/throbber25-anim.gif
? themes/classic/communicator/brand/throbber25-single.gif
? themes/classic/global/animthrob.gif
? themes/classic/global/animthrob_single.gif
? themes/modern/communicator/brand/throbber25-anim.gif
? themes/modern/communicator/brand/throbber25-single.gif
? xpfe/bootstrap/icons/abcardWindow.ico
? xpfe/bootstrap/icons/addressbookWindow.ico
? xpfe/bootstrap/icons/bookmark-window.ico
? xpfe/bootstrap/icons/calendar-window.ico
? xpfe/bootstrap/icons/chatzilla-window.ico
? xpfe/bootstrap/icons/downloadManager.ico
? xpfe/bootstrap/icons/editorWindow.ico
? xpfe/bootstrap/icons/fullpack.ico
? xpfe/bootstrap/icons/gif.ico
? xpfe/bootstrap/icons/history-window.ico
? xpfe/bootstrap/icons/html.ico
? xpfe/bootstrap/icons/install.js
? xpfe/bootstrap/icons/jpeg.ico
? xpfe/bootstrap/icons/js.ico
? xpfe/bootstrap/icons/jsconsoleWindow.ico
? xpfe/bootstrap/icons/main-window.ico
? xpfe/bootstrap/icons/makefile.win
? xpfe/bootstrap/icons/messengerWindow.ico
? xpfe/bootstrap/icons/mng.ico
? xpfe/bootstrap/icons/mozapp.ico
? xpfe/bootstrap/icons/mozfile.ico
? xpfe/bootstrap/icons/mozfiletemplate.ico
? xpfe/bootstrap/icons/mozilla.ico
? xpfe/bootstrap/icons/msgcomposeWindow.ico
? xpfe/bootstrap/icons/png.ico
? xpfe/bootstrap/icons/svg.ico
? xpfe/bootstrap/icons/venkman-window.ico
? xpfe/bootstrap/icons/winInspectorMain.ico
? xpfe/bootstrap/icons/xml.ico
? xpfe/bootstrap/icons/xul.ico
? xpfe/communicator/resources/locale/en-US/welcome.html
? xpfe/components/prefwindow/resources/content/pref-referrer.xul
? xpfe/components/prefwindow/resources/locale/en-US/pref-referrer.dtd
? xpfe/components/search/datasets/AOLSearch.gif
? xpfe/components/search/datasets/AOLSearch.src
? xpfe/components/search/datasets/CompuServe.src
? xpfe/components/search/datasets/Excite.gif
? xpfe/components/search/datasets/Excite.src
? xpfe/components/search/datasets/GoTo.com.gif
? xpfe/components/search/datasets/GoTo.com.src
? xpfe/components/search/datasets/HotBot.gif
? xpfe/components/search/datasets/HotBot.src
? xpfe/components/search/datasets/ICQ.gif
? xpfe/components/search/datasets/ICQ.src
? xpfe/components/search/datasets/Jobs.gif
? xpfe/components/search/datasets/Jobs.src
? xpfe/components/search/datasets/LookSmart.gif
? xpfe/components/search/datasets/LookSmart.src
? xpfe/components/search/datasets/Lycos.gif
? xpfe/components/search/datasets/Lycos.src
? xpfe/components/search/datasets/Shareware.gif
? xpfe/components/search/datasets/Shareware.src
? xpfe/components/search/datasets/ShopNetscape.gif
? xpfe/components/search/datasets/ShopNetscape.src
? xpfe/components/search/datasets/Snap.com.gif
? xpfe/components/search/datasets/Snap.com.src
? xpfe/components/search/datasets/Tech_News.gif
? xpfe/components/search/datasets/Tech_News.src
? xpfe/components/search/datasets/eBay.gif
? xpfe/components/search/datasets/eBay.src
? xpfe/components/search/datasets/monster.gif
? xpfe/components/search/datasets/monster.src
? xpfe/global/resources/content/credits.html
? xpfe/global/resources/locale/en-US/about.html
? xpfe/global/resources/locale/en-US/license.html
? xpinstall/packager/windows/spellcheck.jst
Index: allmakefiles.sh
===================================================================
RCS file: /cvsroot/mozilla/allmakefiles.sh,v
retrieving revision 1.364
diff -u -u -w -r1.364 allmakefiles.sh
--- allmakefiles.sh	11 Jul 2002 21:00:28 -0000	1.364
+++ allmakefiles.sh	26 Aug 2002 05:32:13 -0000
@@ -1061,6 +1061,13 @@
             extensions/pref/autoconfig/src/Makefile
             extensions/pref/autoconfig/resources/Makefile
             " ;;
+        spellcheck ) MAKEFILES_extensions="$MAKEFILES_extensions
+            extensions/spellcheck/Makefile
+            extensions/spellcheck/idl/Makefile
+            extensions/spellcheck/myspell/Makefile
+            extensions/spellcheck/myspell/dictionaries/Makefile
+            extensions/spellcheck/src/Makefile
+            " ;;
         transformiix ) MAKEFILES_extensions="$MAKEFILES_extensions
             $MAKEFILES_transformiix"
             ;;
Index: configure
===================================================================
RCS file: /cvsroot/mozilla/configure,v
retrieving revision 1.995.6.1
diff -u -u -w -r1.995.6.1 configure
--- configure	9 Aug 2002 20:05:10 -0000	1.995.6.1
+++ configure	26 Aug 2002 05:32:22 -0000
@@ -211,7 +211,7 @@
   --enable-default-mozilla-five-home
                           Set the default value for MOZILLA_FIVE_HOME"
 ac_help="$ac_help
-  --with-user-appdir=DIR  Set user-specific appdir (default=.mozilla)"
+  --with-user-appdir=DIR  Set user-specific appdir (default=.beonex/comm)"
 ac_help="$ac_help
   --disable-verbose-config-defs
                           Do not output the contents of config-defs.h"
@@ -2848,7 +2848,7 @@
   echo "$ac_t""no" 1>&6
 fi
 
-for ac_prog in gawk mawk nawk awk
+for ac_prog in mawk gawk nawk awk
 do
 # Extract the first word of "$ac_prog", so it can be a program name with args.
 set dummy $ac_prog; ac_word=$2
@@ -11178,7 +11178,7 @@
 
 
 
-MOZ_EXTENSIONS_DEFAULT=" cookie wallet content-packs xml-rpc xmlextras help pref transformiix venkman inspector irc universalchardet"
+MOZ_EXTENSIONS_DEFAULT=" cookie wallet content-packs pref transformiix irc spellcheck"
 
 if test -n "$SUNCTL"; then
   MOZ_EXTENSIONS_DEFAULT="$MOZ_EXTENSIONS_DEFAULT ctl"
@@ -12261,7 +12261,7 @@
 fi
 else
   cat >> confdefs.h <<\EOF
-#define MOZ_USER_DIR ".mozilla"
+#define MOZ_USER_DIR ".beonex/comm"
 EOF
  
 fi
@@ -14131,9 +14131,11 @@
 elif test "$OS_ARCH" = "BeOS"; then
   cat >> confdefs.h <<\EOF
 #define XP_BEOS 1
+#define MOZ_USER_DIR "beonex/comm"
 EOF
 
   MOZ_MOVEMAIL=1
+
 elif test "$OS_ARCH" = "Darwin"; then
   cat >> confdefs.h <<\EOF
 #define XP_UNIX 1
Index: configure.in
===================================================================
RCS file: /cvsroot/mozilla/configure.in,v
retrieving revision 1.1068.6.2
diff -u -u -w -r1.1068.6.2 configure.in
--- configure.in	9 Aug 2002 20:05:34 -0000	1.1068.6.2
+++ configure.in	26 Aug 2002 05:32:24 -0000
@@ -3248,7 +3248,8 @@
 dnl = Enable compilation of specific extension modules
 dnl ========================================================
 
-MOZ_EXTENSIONS_DEFAULT=" cookie wallet content-packs xml-rpc xmlextras help pref transformiix venkman inspector irc universalchardet"
+MOZ_EXTENSIONS_DEFAULT=" cookie wallet content-packs pref transformiix irc spellcheck"
+dnl MOZ_EXTENSIONS_DEFAULT=" cookie wallet content-packs xml-rpc xmlextras help pref transformiix venkman inspector irc universalchardet"
 
 dnl Check if Thai Rendering Extension needs to be enabled
 if test -n "$SUNCTL"; then
@@ -3860,14 +3861,14 @@
 dnl = Location of the mozilla user directory (default is ~/.mozilla).],
 dnl ========================================================
 MOZ_ARG_WITH_STRING(user-appdir,
-[  --with-user-appdir=DIR  Set user-specific appdir (default=.mozilla)],
+[  --with-user-appdir=DIR  Set user-specific appdir (default=.beonex/comm)],
 [ val=`echo $withval`
 if echo "$val" | grep "\/" >/dev/null; then
     AC_MSG_ERROR("Homedir must be single relative path.")
 else 
     AC_DEFINE_UNQUOTED(MOZ_USER_DIR,"$val")
 fi], 
-    AC_DEFINE(MOZ_USER_DIR,".mozilla") )
+    AC_DEFINE(MOZ_USER_DIR,".beonex/comm") )
 
 dnl Need the contents of config-defs.h in the build logs
 VERBOSE_CONFIG_DEFS=1
@@ -4674,6 +4675,7 @@
   AC_DEFINE(XP_PC)
 elif test "$OS_ARCH" = "BeOS"; then
   AC_DEFINE(XP_BEOS)
+  AC_DEFINE(MOZ_USER_DIR,"beonex/comm")
   MOZ_MOVEMAIL=1
 elif test "$OS_ARCH" = "Darwin"; then
   AC_DEFINE(XP_UNIX)
Index: makefile.win
===================================================================
RCS file: /cvsroot/mozilla/makefile.win,v
retrieving revision 3.116
diff -u -u -w -r3.116 makefile.win
--- makefile.win	27 Mar 2002 06:31:29 -0000	3.116
+++ makefile.win	26 Aug 2002 05:32:24 -0000
@@ -157,7 +157,8 @@
 !if defined(FIND)
 !if "$(REBASE)" != ""
 	echo rebasing $(DIST:\=/)
-        $(FIND) $(DIST:\=/) -name "*.dll" > rebase.lst
+#        $(FIND) $(DIST:\=/) -name "*.dll" > rebase.lst
+	dir /s /b $(DIST)\*.dll > rebase.lst
         $(REBASE) -b 60000000 -R . -G rebase.lst
         del rebase.lst
 !else
@@ -171,7 +172,7 @@
 splitsymbols:
 !if defined(MOZILLA_OFFICIAL)
 !if defined(FIND)
-!if "$(SPLITSYM)" != ""
+!if exist($(SPLITSYM))
 	echo splitting symbols out of binaries
 	cd $(MOZ_SRC)\mozilla
 	$(FIND) $(DIST:\=/) -name "*.dll" -exec $(SPLITSYM) {} ;
Index: build/mac/build_scripts/MozillaBuildList.pm
===================================================================
RCS file: /cvsroot/mozilla/build/mac/build_scripts/MozillaBuildList.pm,v
retrieving revision 1.225
diff -u -u -w -r1.225 MozillaBuildList.pm
--- build/mac/build_scripts/MozillaBuildList.pm	2 Aug 2002 00:27:47 -0000	1.225
+++ build/mac/build_scripts/MozillaBuildList.pm	26 Aug 2002 05:32:25 -0000
@@ -705,8 +705,8 @@
 
     BuildEmbeddingPackage();
 
-    # Set the default skin to be classic
-    SetDefaultSkin("classic/1.0"); 
+    # Set the default skin
+    SetDefaultSkin("modern/1.0");
 
     EndBuildModule("resources");
 }
Index: config/config.mak
===================================================================
RCS file: /cvsroot/mozilla/config/config.mak,v
retrieving revision 3.139
diff -u -u -w -r3.139 config.mak
--- config/config.mak	31 Jul 2002 20:52:55 -0000	3.139
+++ config/config.mak	26 Aug 2002 05:32:26 -0000
@@ -369,6 +369,11 @@
 
 CFLAGS=$(CFLAGS) -DUSE_IMG2 -DNS_PRINT_PREVIEW
 
+!ifndef MOZ_USER_DIR
+MOZ_USER_DIR=Mozilla
+!endif
+CFLAGS=$(CFLAGS) -DMOZ_USER_DIR=\"$(MOZ_USER_DIR)\"
+
 !ifdef MOZ_STATIC_COMPONENT_LIBS
 CFLAGS=$(CFLAGS) -DXPCOM_TRANSLATE_NSGM_ENTRY_POINT -DMOZ_STATIC_COMPONENT_LIBS
 !endif
@@ -387,6 +392,7 @@
 PERL = perl.exe
 
 #if MOZILLA_OFFICIAL is set, then define splitsym
+#XXX bug 27316?
 !if defined (MOZILLA_OFFICIAL)
 SPLITSYM = $(MOZ_TOOLS)\bin\splitsym
 !endif
Index: config/rules.mk
===================================================================
RCS file: /cvsroot/mozilla/config/rules.mk,v
retrieving revision 3.356
diff -u -u -w -r3.356 rules.mk
--- config/rules.mk	24 Jul 2002 05:43:51 -0000	3.356
+++ config/rules.mk	26 Aug 2002 05:32:26 -0000
@@ -68,6 +68,10 @@
 topsrcdir		= $(DEPTH)
 endif
 
+CXX=gcc
+LDFLAGS += -Wl,-Bstatic -Wl,-lstdc++ -Wl,-Bdynamic
+
+
 ifndef MOZILLA_DIR
 MOZILLA_DIR = $(topsrcdir)
 endif
Index: content/macbuild/content.xml
===================================================================
RCS file: /cvsroot/mozilla/content/macbuild/content.xml,v
retrieving revision 1.31
diff -u -u -w -r1.31 content.xml
--- content/macbuild/content.xml	8 Jul 2002 07:09:34 -0000	1.31
+++ content/macbuild/content.xml	26 Aug 2002 05:32:28 -0000
@@ -2431,6 +2431,13 @@
                 </FILE>
                 <FILE>
                     <PATHTYPE>Name</PATHTYPE>
+                    <PATH>mozSanitizingSerializer.cpp</PATH>
+                    <PATHFORMAT>MacOS</PATHFORMAT>
+                    <FILEKIND>Text</FILEKIND>
+                    <FILEFLAGS>Debug</FILEFLAGS>
+                </FILE>
+                <FILE>
+                    <PATHTYPE>Name</PATHTYPE>
                     <PATH>nsDOMCSSRGBColor.cpp</PATH>
                     <PATHFORMAT>MacOS</PATHFORMAT>
                     <FILEKIND>Text</FILEKIND>
@@ -3532,6 +3539,11 @@
                 </FILEREF>
                 <FILEREF>
                     <PATHTYPE>Name</PATHTYPE>
+                    <PATH>mozSanitizingSerializer.cpp</PATH>
+                    <PATHFORMAT>MacOS</PATHFORMAT>
+                </FILEREF>
+                <FILEREF>
+                    <PATHTYPE>Name</PATHTYPE>
                     <PATH>nsDOMCSSRGBColor.cpp</PATH>
                     <PATHFORMAT>MacOS</PATHFORMAT>
                 </FILEREF>
@@ -5920,6 +5932,13 @@
                 </FILE>
                 <FILE>
                     <PATHTYPE>Name</PATHTYPE>
+                    <PATH>mozSanitizingSerializer.cpp</PATH>
+                    <PATHFORMAT>MacOS</PATHFORMAT>
+                    <FILEKIND>Text</FILEKIND>
+                    <FILEFLAGS>Debug</FILEFLAGS>
+                </FILE>
+                <FILE>
+                    <PATHTYPE>Name</PATHTYPE>
                     <PATH>nsDOMCSSRGBColor.cpp</PATH>
                     <PATHFORMAT>MacOS</PATHFORMAT>
                     <FILEKIND>Text</FILEKIND>
@@ -7021,6 +7040,11 @@
                 </FILEREF>
                 <FILEREF>
                     <PATHTYPE>Name</PATHTYPE>
+                    <PATH>mozSanitizingSerializer.cpp</PATH>
+                    <PATHFORMAT>MacOS</PATHFORMAT>
+                </FILEREF>
+                <FILEREF>
+                    <PATHTYPE>Name</PATHTYPE>
                     <PATH>nsDOMCSSRGBColor.cpp</PATH>
                     <PATHFORMAT>MacOS</PATHFORMAT>
                 </FILEREF>
@@ -7248,6 +7272,12 @@
                 <TARGETNAME>content.shlb</TARGETNAME>
                 <PATHTYPE>Name</PATHTYPE>
                 <PATH>nsContentAreaDragDrop.cpp</PATH>
+                <PATHFORMAT>MacOS</PATHFORMAT>
+            </FILEREF>
+            <FILEREF>
+                <TARGETNAME>content.shlb</TARGETNAME>
+                <PATHTYPE>Name</PATHTYPE>
+                <PATH>mozSanitizingSerializer.cpp</PATH>
                 <PATHFORMAT>MacOS</PATHFORMAT>
             </FILEREF>
             <FILEREF>
Index: docshell/base/nsDocShell.cpp
===================================================================
RCS file: /cvsroot/mozilla/docshell/base/nsDocShell.cpp,v
retrieving revision 1.461
diff -u -u -w -r1.461 nsDocShell.cpp
--- docshell/base/nsDocShell.cpp	15 Jul 2002 19:10:13 -0000	1.461
+++ docshell/base/nsDocShell.cpp	26 Aug 2002 05:32:32 -0000
@@ -6203,7 +6203,18 @@
     NS_ENSURE_STATE(mGlobalHistory);
 
     nsCAutoString spec;
+    nsCAutoString pw;
+    nsCAutoString blankpw("");
+    nsresult rv = aURI->GetPassword(pw);
+    if (pw.Length()) {
+       aURI->SetPassword(blankpw);
+    }
+
     NS_ENSURE_SUCCESS(aURI->GetSpec(spec), NS_ERROR_FAILURE);
+    if (pw.Length()) {
+       aURI->SetPassword(pw);
+    }
+
 
     NS_ENSURE_SUCCESS(mGlobalHistory->AddPage(spec.get()), NS_ERROR_FAILURE);
 
Index: editor/ui/composer/content/TextEditorAppShell.xul
===================================================================
RCS file: /cvsroot/mozilla/editor/ui/composer/content/TextEditorAppShell.xul,v
retrieving revision 1.75.8.1
diff -u -u -w -r1.75.8.1 TextEditorAppShell.xul
--- editor/ui/composer/content/TextEditorAppShell.xul	17 Aug 2002 23:02:45 -0000	1.75.8.1
+++ editor/ui/composer/content/TextEditorAppShell.xul	26 Aug 2002 05:32:32 -0000
@@ -57,7 +57,7 @@
 
   <script type="application/x-javascript" src="chrome://editor/content/editor.js"/>
   <script type="application/x-javascript" src="chrome://editor/content/ComposerCommands.js"/>
-  <script type="application/x-javascript" src="chrome://editor/content/EditorCommandsDebug.js"/>
+<!--  <script type="application/x-javascript" src="chrome://editor/content/EditorCommandsDebug.js"/>-->
   <script type="application/x-javascript" src="chrome://global/content/nsTransferable.js"/>
   <script type="application/x-javascript" src="chrome://global/content/nsDragAndDrop.js"/>
   <script type="application/x-javascript" src="chrome://communicator/content/contentAreaDD.js"/>
@@ -114,9 +114,9 @@
       <!-- tasks menu filled from tasksOverlay -->
       <menu accesskey="t" id="tasksMenu"/>
 
-      <!-- DEBUG only -->
-      <!-- <menu id="debugMenu" /> -->
-      <!-- end DEBUG only -->
+      <!-- DEBUG only
+      <menu id="debugMenu" />
+      end DEBUG only -->
 
       <!-- help menu filled from globalOverlay -->
       <menu accesskey="h" id="menu_Help"/>
Index: editor/ui/composer/content/editor.xul
===================================================================
RCS file: /cvsroot/mozilla/editor/ui/composer/content/editor.xul,v
retrieving revision 1.135.8.1
diff -u -u -w -r1.135.8.1 editor.xul
--- editor/ui/composer/content/editor.xul	17 Aug 2002 23:02:45 -0000	1.135.8.1
+++ editor/ui/composer/content/editor.xul	26 Aug 2002 05:32:32 -0000
@@ -65,7 +65,9 @@
         persist="screenX screenY width height sizemode">
 
   <script type="application/x-javascript" src="chrome://editor/content/editor.js"/>
+<!--
   <script type="application/x-javascript" src="chrome://editor/content/EditorCommandsDebug.js"/>
+-->
   <script type="application/x-javascript" src="chrome://editor/content/EditorContextMenu.js"/>
   <script type="application/x-javascript" src="chrome://editor/content/editorApplicationOverlay.js"/>
   <script type="application/x-javascript" src="chrome://editor/content/publishprefs.js"/>
@@ -154,9 +156,9 @@
 
     <menu id="windowMenu"/>
 
-    <!-- DEBUG only -->
-    <!-- <menu id="debugMenu" /> -->
-    <!-- end DEBUG only -->
+    <!-- DEBUG only
+    <menu id="debugMenu" />
+    end DEBUG only -->
   
     <!-- help menu filled from globalOverlay -->
     <menu id="menu_Help"/>
Index: editor/ui/composer/content/editorOverlay.xul
===================================================================
RCS file: /cvsroot/mozilla/editor/ui/composer/content/editorOverlay.xul,v
retrieving revision 1.211.6.1
diff -u -u -w -r1.211.6.1 editorOverlay.xul
--- editor/ui/composer/content/editorOverlay.xul	17 Aug 2002 23:02:47 -0000	1.211.6.1
+++ editor/ui/composer/content/editorOverlay.xul	26 Aug 2002 05:32:33 -0000
@@ -186,7 +186,7 @@
     <command id="cmd_italic"        state="false"     oncommand="goDoCommand('cmd_italic')"/>
     <command id="cmd_underline"     state="false"     oncommand="goDoCommand('cmd_underline')"/>
     <command id="cmd_tt"            state="false"     oncommand="goDoCommand('cmd_tt')"/>
-    <command id="cmd_smiley"        state=""  />
+<!--    <command id="cmd_smiley"        state=""  />-->
 
     <command id="cmd_strikethrough" state="false"     oncommand="goDoCommand('cmd_strikethrough')"/>
     <command id="cmd_superscript"   state="false"     oncommand="goDoCommand('cmd_superscript')"/>
@@ -611,6 +611,7 @@
 
 
   <!-- smiley menu -->
+<!--
   <toolbarbutton type="menu" id="smileButtonMenu"
                  observes="cmd_smiley"
                  tooltiptext="&SmileButton.tooltip;">
@@ -631,6 +632,7 @@
 						oncommand="doStatefulCommand('cmd_smiley', ':-\\' )" />           
        </menupopup>
    </toolbarbutton>
+-->
 
   <!-- this is only used in messengercompose.xul -->
   <toolbarbutton type="menu" id="AlignPopupButton" observes="cmd_align"
@@ -847,8 +849,7 @@
    -->
   <menuitem id="menu_pasteQuote" accesskey="&editpastequotation.accesskey;" observes="cmd_pasteQuote"/>
 
-  <!-- DEBUG only -->
-  <!--
+  <!-- DEBUG only
   <menu id="debugMenu" label="&debugMenu.label;">
   <menupopup>
     <menuitem label="&newEditorTestPage.label;" oncommand="window.openDialog('chrome://editor/content','_blank','chrome,all,dialog=no','chrome://editor/content/EditorInitPage.html')"/>
@@ -915,7 +916,6 @@
             oncommand="window.focus()"/>
   </menupopup>
   </menu>
-  -->
-  <!-- end DEBUG only -->
+  end DEBUG only -->
 
 </overlay>
Index: editor/ui/composer/locale/en-US/region.properties
===================================================================
RCS file: /cvsroot/mozilla/editor/ui/composer/locale/en-US/region.properties,v
retrieving revision 1.1
diff -u -u -w -r1.1 region.properties
--- editor/ui/composer/locale/en-US/region.properties	23 Feb 2001 08:32:39 -0000	1.1
+++ editor/ui/composer/locale/en-US/region.properties	26 Aug 2002 05:32:33 -0000
@@ -1,4 +1,4 @@
 #
 # editor.js
 # editor.properties
-editor.throbber.url=http://www.mozilla.org/
+editor.throbber.url=about:welcome
Index: extensions/makefile.win
===================================================================
RCS file: /cvsroot/mozilla/extensions/Attic/makefile.win,v
retrieving revision 1.22
diff -u -u -w -r1.22 makefile.win
--- extensions/makefile.win	24 Mar 2002 18:51:37 -0000	1.22
+++ extensions/makefile.win	26 Aug 2002 05:32:36 -0000
@@ -24,13 +24,13 @@
 
 DIRS = wallet \
 	cookie \
-	inspector \
+#	inspector \
 	irc \
 !if !defined(DISABLE_JSD) && !defined(DISABLE_VENKMAN)
     venkman \
 !endif
 	content-packs \
-	help \
+#	help \
 !if defined(MOZ_ENABLE_P3P)
   p3p \
 !endif
@@ -39,11 +39,12 @@
 	transformiix \
 !endif 
 	universalchardet \
-	xml-rpc \
+#	xml-rpc \
 !if defined(MOZ_ENABLE_IIX)
     interfaceinfo \
 !endif
-	xmlextras \
+#	xmlextras \
+	spellcheck \
 	$(NULL)
 
 
Index: extensions/cookie/resources/content/pref-images.xul
===================================================================
RCS file: /cvsroot/mozilla/extensions/cookie/resources/content/pref-images.xul,v
retrieving revision 1.23
diff -u -u -w -r1.23 pref-images.xul
--- extensions/cookie/resources/content/pref-images.xul	5 Jun 2002 03:38:58 -0000	1.23
+++ extensions/cookie/resources/content/pref-images.xul	26 Aug 2002 05:32:36 -0000
@@ -118,13 +118,11 @@
 
     <separator id="networkImagesBehaviorSeparator" observes="haveImageBlockingOrMailnews"/>
 
-<!--
-    <vbox align="start">
+    <vbox align="start" hidden="true">
       <checkbox id="networkImageWarnAboutImages" label="&warnAboutImages.label;"
                 accesskey="&warnAboutImages.accesskey;" observes="haveImageBlocking"
                 prefstring="network.image.warnAboutImages"/>
     </vbox>
--->
 
     <separator observes="haveImageBlocking"/>
 
Index: extensions/irc/xul/content/chatzillaOverlay.xul
===================================================================
RCS file: /cvsroot/mozilla/extensions/irc/xul/content/chatzillaOverlay.xul,v
retrieving revision 1.15
diff -u -u -w -r1.15 chatzillaOverlay.xul
--- extensions/irc/xul/content/chatzillaOverlay.xul	1 May 2002 23:03:57 -0000	1.15
+++ extensions/irc/xul/content/chatzillaOverlay.xul	26 Aug 2002 05:32:38 -0000
@@ -2,7 +2,7 @@
 
 <!DOCTYPE window SYSTEM "chrome://chatzilla/locale/chatzillaOverlay.dtd" >
 
-<!-- This is the overlay that addes "Chatzilla" to the (global) task menu. -->
+<!-- This is the overlay that adds "Chatzilla" to the (global) task menu. -->
 
 <?xml-stylesheet href="chrome://chatzilla/skin/chatzillaOverlay.css" type="text/css"?> 
 
Index: extensions/irc/xul/content/static.js
===================================================================
RCS file: /cvsroot/mozilla/extensions/irc/xul/content/static.js,v
retrieving revision 1.55
diff -u -u -w -r1.55 static.js
--- extensions/irc/xul/content/static.js	1 Aug 2002 21:08:58 -0000	1.55
+++ extensions/irc/xul/content/static.js	26 Aug 2002 05:32:38 -0000
@@ -220,13 +220,8 @@
     if (client.CHARSET)
         setCharset(client.CHARSET);
     
-    var ary = navigator.userAgent.match (/;\s*([^;\s]+\s*)\).*\/(\d+)/);
-    if (ary)
-        client.userAgent = "ChatZilla " + client.version + " [Mozilla " + 
-            ary[1] + "/" + ary[2] + "]";
-    else
-        client.userAgent = "ChatZilla " + client.version + " [" + 
-            navigator.userAgent + "]";
+    client.userAgent = "ChatZilla " + client.version +
+                       " in Beonex Communicator";
 
     obj = document.getElementById("input");
     obj.addEventListener("keypress", onInputKeyPress, false);
Index: extensions/irc/xul/locale/en-US/chatzillaOverlay.dtd
===================================================================
RCS file: /cvsroot/mozilla/extensions/irc/xul/locale/en-US/chatzillaOverlay.dtd,v
retrieving revision 1.3
diff -u -u -w -r1.3 chatzillaOverlay.dtd
--- extensions/irc/xul/locale/en-US/chatzillaOverlay.dtd	12 Jun 2001 23:26:00 -0000	1.3
+++ extensions/irc/xul/locale/en-US/chatzillaOverlay.dtd	26 Aug 2002 05:32:38 -0000
@@ -1,3 +1,3 @@
-<!ENTITY ircCmd.label		"IRC Chat">  
+<!ENTITY ircCmd.label		"ChatZilla">
 <!ENTITY ircCmd.accesskey	"i">  
 <!ENTITY ircCmd.commandkey	"3">  
Index: layout/html/document/src/html.css
===================================================================
RCS file: /cvsroot/mozilla/layout/html/document/src/html.css,v
retrieving revision 3.160
diff -u -u -w -r3.160 html.css
--- layout/html/document/src/html.css	26 Jul 2002 17:47:00 -0000	3.160
+++ layout/html/document/src/html.css	26 Aug 2002 05:32:48 -0000
@@ -314,7 +314,7 @@
 }
 
 blink {
-  text-decoration: blink;
+  font-weight: bolder;
 }
 
 big {
@@ -531,17 +531,10 @@
   display: block;
 }
 
-/* emulation of non-standard HTML <marquee> tag */
+/* marquee is a Microsoft extension to HTML. Set it to display: block for
+   graceful degradation */
 marquee {
-  -moz-binding: url('chrome://xbl-marquee/content/xbl-marquee.xml#marquee-horizontal');
-}
-
-marquee[direction="up"], marquee[direction="down"] {
-  -moz-binding: url('chrome://xbl-marquee/content/xbl-marquee.xml#marquee-vertical');
-}
-
-@media print {
-  marquee { -moz-binding: none; }
+  display: block;
 }
 /* PRINT ONLY rules follow */
 
Index: mailnews/base/prefs/resources/content/mailPrefsOverlay.xul
===================================================================
RCS file: /cvsroot/mozilla/mailnews/base/prefs/resources/content/mailPrefsOverlay.xul,v
retrieving revision 1.20
diff -u -u -w -r1.20 mailPrefsOverlay.xul
--- mailnews/base/prefs/resources/content/mailPrefsOverlay.xul	12 Jun 2002 04:04:35 -0000	1.20
+++ mailnews/base/prefs/resources/content/mailPrefsOverlay.xul	26 Aug 2002 05:32:53 -0000
@@ -34,7 +34,11 @@
 
   <!-- javascript toggle for mail/news -->
   <groupbox id="javascriptPreferences">
-    <checkbox id="javascriptAllowMailNews"
+    <hbox align="start" class="indent"
+          insertafter="javascriptAllowNavigator">
+      <description>&noJSInMailnews.label;</description>
+    </hbox>
+    <checkbox id="javascriptAllowMailNews" hidden="true"
               label="&enbJsCheckMailNews.label;" accesskey="&enbJsCheckMailNews.accesskey;"
               pref="true" preftype="bool" prefstring="javascript.allow.mailnews"
               prefattribute="checked" oncommand="javascriptEnabledChange();" insertafter="javascriptAllowNavigator"/>
@@ -56,7 +60,11 @@
   </groupbox>
   <!--- cookie toggle for mail/news -->
   <page id="cookiesPanel">
-    <checkbox id="networkDisableCookieForMailNews"
+    <hbox align="start" class="indent"
+          insertafter="networkCookieBehaviorSeparator">
+      <description>&noCookiesInMailnews.label;</description>
+    </hbox>
+    <checkbox id="networkDisableCookieForMailNews" hidden="true"
               label="&disableCookieForMailNews.label;" accesskey="&disableCookieForMailNews.accesskey;"
               preftype="bool" prefstring="network.cookie.disableCookieForMailNews"
               insertafter="networkCookieBehaviorSeparator"/>
Index: mailnews/base/prefs/resources/content/pref-advanced_overlay.xul
===================================================================
RCS file: /cvsroot/mozilla/mailnews/base/prefs/resources/content/pref-advanced_overlay.xul,v
retrieving revision 1.5
diff -u -u -w -r1.5 pref-advanced_overlay.xul
--- mailnews/base/prefs/resources/content/pref-advanced_overlay.xul	3 Nov 2001 03:57:16 -0000	1.5
+++ mailnews/base/prefs/resources/content/pref-advanced_overlay.xul	26 Aug 2002 05:32:53 -0000
@@ -17,7 +17,7 @@
   <vbox id="contentEnablingBox">
     <checkbox id="javascriptAllowMailNews" position="3"
               label="&enbJsCheckMailNews.label;" accesskey="&enbJsCheckMailNews.accesskey;"
-              prefstring="javascript.allow.mailnews"/>
+              prefstring="javascript.allow.mailnews" hidden="true" />
   </vbox>
     
          
Index: mailnews/base/prefs/resources/locale/en-US/mailPrefsOverlay.dtd
===================================================================
RCS file: /cvsroot/mozilla/mailnews/base/prefs/resources/locale/en-US/mailPrefsOverlay.dtd,v
retrieving revision 1.13
diff -u -u -w -r1.13 mailPrefsOverlay.dtd
--- mailnews/base/prefs/resources/locale/en-US/mailPrefsOverlay.dtd	4 Jun 2002 04:14:20 -0000	1.13
+++ mailnews/base/prefs/resources/locale/en-US/mailPrefsOverlay.dtd	26 Aug 2002 05:32:53 -0000
@@ -1,16 +1,14 @@
-
-<!ENTITY enbJsCheckMailNews.label     "Mail &amp; Newsgroups">
+<!ENTITY enbJsCheckMailNews.label     "Mailnews">
 <!ENTITY enbJsCheckMailNews.accesskey "m">
-<!ENTITY enbPluginCheckMailNews.label     "Mail &amp; Newsgroups">
-<!ENTITY enbPluginCheckMailNews.accesskey "p">
-
-<!ENTITY disableCookieForMailNews.label "Disable cookies in Mail &amp; Newsgroups">
+<!ENTITY noJSInMailnews.label "Mailnews (always disabled)">
+<!ENTITY noCookiesInMailnews.label "Cookies are always disabled in Mailnews">
+<!ENTITY disableCookieForMailNews.label "Disable cookies in Mailnews">
 <!ENTITY disableCookieForMailNews.accesskey "m">
-
-<!ENTITY disableImageInMailNews.label       "Do not load remote images in Mail &amp; Newsgroup messages">
+<!ENTITY enbPluginCheckMailNews.label     "Mailnews">
+<!ENTITY enbPluginCheckMailNews.accesskey "p">
+<!ENTITY disableImageInMailNews.label       "Do not load remote images in email and newsgroup messages">
 <!ENTITY disableImageInMailNews.accesskey   "i">
-
-<!ENTITY mail.label "Mail &amp; Newsgroups">
+<!ENTITY mail.label "Mailnews">
 <!ENTITY mail.accesskey "m">
 <!ENTITY address.label "Addressing">
 <!ENTITY viewingMessages.label "Message Display">
Index: mailnews/base/prefs/resources/locale/en-US/pref-viewing_messages.dtd
===================================================================
RCS file: /cvsroot/mozilla/mailnews/base/prefs/resources/locale/en-US/pref-viewing_messages.dtd,v
retrieving revision 1.15
diff -u -u -w -r1.15 pref-viewing_messages.dtd
--- mailnews/base/prefs/resources/locale/en-US/pref-viewing_messages.dtd	26 Jul 2002 23:06:27 -0000	1.15
+++ mailnews/base/prefs/resources/locale/en-US/pref-viewing_messages.dtd	26 Aug 2002 05:32:53 -0000
@@ -34,12 +34,12 @@
 <!ENTITY color.label                      "Color:">
 <!ENTITY color.accesskey                  "c">
 <!ENTITY displayWidth.label               "Plain Text Messages">
-<!ENTITY plainText.label				  "Use this font when displaying plain text messages:">
-<!ENTITY displayText.label				  "Use the following settings when  displaying quoted plain text messages:">
-<!ENTITY viewingPlainText.label			  "When viewing plain text messages:">
+<!ENTITY plainText.label                  "">
+<!ENTITY displayText.label                "Quotes">
+<!ENTITY viewingPlainText.label           "">
 <!ENTITY languagesTitle.label			  "Languages">
-<!ENTITY coding.label					  "Use the following character coding as the default for viewing messages:">
-<!ENTITY sendDefaultCharset.label         "Character Coding:">
+<!ENTITY coding.label                     "">
+<!ENTITY sendDefaultCharset.label         "Default Character Coding:">
 <!ENTITY sendDefaultCharset.accesskey	  "h">
 <!ENTITY forceCharsetOverride.label       "Apply default to all messages (ignore character coding specified by MIME header)">
 <!ENTITY forceCharsetOverride.accesskey   "A">
Index: mailnews/base/resources/content/mailWindowOverlay.xul
===================================================================
RCS file: /cvsroot/mozilla/mailnews/base/resources/content/mailWindowOverlay.xul,v
retrieving revision 1.205
diff -u -u -w -r1.205 mailWindowOverlay.xul
--- mailnews/base/resources/content/mailWindowOverlay.xul	12 Jun 2002 04:06:15 -0000	1.205
+++ mailnews/base/resources/content/mailWindowOverlay.xul	26 Aug 2002 05:32:53 -0000
@@ -1460,6 +1460,7 @@
       <toolbarbutton class="toolbarbutton-1" id="button-replyall" label="&replyAllButton.label;" tooltiptext="&replyAllButton.tooltip;" observes="button_replyall" oncommand="MsgReplyToAllMessage(event)"/>
       <toolbarbutton class="toolbarbutton-1" id="button-forward" label="&forwardButton.label;" tooltiptext="&forwardButton.tooltip;" observes="button_forward" oncommand="MsgForwardMessage(event)"/>
       <toolbarseparator class="toolbarseparator-primary"/>
+<!--
       <toolbarbutton type="menu" id="button-file" class="toolbarbutton-1" 
                   label="&fileButton.label;" observes="button_file"
                   datasources="rdf:null" 
@@ -1498,11 +1499,8 @@
             </menupopup>
           </rule>
           <rule nc:CanFileMessagesOnServer="false">
-            <!-- don't show servers (nntp & any others) which does not allow message filing -->
-            <!-- File, Move & Copy menus -->
           </rule>
           <rule nc:CanFileMessages="false" iscontainer="true" isempty="false">
-          <!-- note, there is no "file here" -->
             <menupopup>
               <menu uri="..."  class="folderMenuItem menu-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name"
                SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
@@ -1527,6 +1525,7 @@
         </template>
         <menupopup/>
       </toolbarbutton>
+-->
       <toolbarbutton class="toolbarbutton-1" id="button-next" label="&nextButton.label;" oncommand="goDoCommand('button_next')" tooltiptext="&nextButton.tooltip;" observes="button_next"/>
       <toolbarbutton class="toolbarbutton-1" id="button-delete" label="&deleteButton.label;" tooltiptext="&deleteButton.tooltip;" observes="button_delete" oncommand="goDoCommand('button_delete')"/>
       <toolbarbutton type="menu-button" id="button-mark" class="toolbarbutton-1" label="&markButton.label;" hidden="true" oncommand="goDoCommand('button_mark')"
@@ -1539,7 +1538,7 @@
                 <menuitem type="checkbox" id="markFlaggedToolbarItem" label="&markFlaggedCmd.label;" accesskey="&markFlaggedCmd.accesskey;" observes="cmd_markAsFlagged"/>
             </menupopup>
       </toolbarbutton>
-      <toolbarbutton id="button-print" type="menu-button" class="toolbarbutton-1" label="&printButton.label;" 
+      <toolbarbutton hidden="true" id="button-print" type="menu-button" class="toolbarbutton-1" label="&printButton.label;" 
                   observes="button_print" oncommand="goDoCommand('cmd_print')" tooltiptext="&printButton.tooltip;">  
         <menupopup id="printMenu">
           <menuitem label="&printCmd.label;" accesskey="&printCmd.accesskey;" default="true"/>
Index: mailnews/base/resources/content/msgHdrViewOverlay.js
===================================================================
RCS file: /cvsroot/mozilla/mailnews/base/resources/content/msgHdrViewOverlay.js,v
retrieving revision 1.90
diff -u -u -w -r1.90 msgHdrViewOverlay.js
--- mailnews/base/resources/content/msgHdrViewOverlay.js	26 Jun 2002 07:36:58 -0000	1.90
+++ mailnews/base/resources/content/msgHdrViewOverlay.js	26 Aug 2002 05:32:53 -0000
@@ -89,6 +89,7 @@
 // We also have an expanded header view. This shows many of your more common (and useful) headers.
 var gExpandedHeaderList = [ {name:"subject"}, 
                             {name:"from", outputFunction:OutputEmailAddresses},
+                            {name:"organization"},
                             {name:"reply-to", isEmailAddress:true, outputFunction:OutputEmailAddresses},
                             {name:"date"},
                             {name:"to", useToggle:true, outputFunction:OutputEmailAddresses},
Index: mailnews/base/resources/content/msgHdrViewOverlay.xul
===================================================================
RCS file: /cvsroot/mozilla/mailnews/base/resources/content/msgHdrViewOverlay.xul,v
retrieving revision 1.51
diff -u -u -w -r1.51 msgHdrViewOverlay.xul
--- mailnews/base/resources/content/msgHdrViewOverlay.xul	26 Jun 2002 07:36:59 -0000	1.51
+++ mailnews/base/resources/content/msgHdrViewOverlay.xul	26 Aug 2002 05:32:53 -0000
@@ -101,6 +101,7 @@
     <mail-toggle-headerfield id="expandedsubjectBox" class="subjectvalue" label="&subjectField.label;" ontwistyclick="ToggleHeaderView();" collapsed="true"/>
     
     <mail-emailheaderfield id="expandedfromBox" label="&fromField.label;" collapsed="true"/>
+    <mail-headerfield id="expandedorganizationBox" label="&organizationField.label;" collapsed="true"/>
     <mail-emailheaderfield id="expandedreply-toBox" label="&replyToField.label;" collapsed="true"/>
 
     <mail-headerfield id="expandeddateBox" label="&dateField.label;" collapsed="true"/>
Index: mailnews/base/resources/content/threadPane.js
===================================================================
RCS file: /cvsroot/mozilla/mailnews/base/resources/content/threadPane.js,v
retrieving revision 1.47
diff -u -u -w -r1.47 threadPane.js
--- mailnews/base/resources/content/threadPane.js	18 Apr 2002 22:32:25 -0000	1.47
+++ mailnews/base/resources/content/threadPane.js	26 Aug 2002 05:32:53 -0000
@@ -79,7 +79,6 @@
 
   displayMessageChanged : function(aFolder, aSubject)
   {
-    setTitleFromFolder(aFolder, aSubject);
     gHaveLoadedMessage = true;
   },
 
Index: mailnews/base/resources/locale/en-US/mailTasksOverlay.dtd
===================================================================
RCS file: /cvsroot/mozilla/mailnews/base/resources/locale/en-US/mailTasksOverlay.dtd,v
retrieving revision 1.12
diff -u -u -w -r1.12 mailTasksOverlay.dtd
--- mailnews/base/resources/locale/en-US/mailTasksOverlay.dtd	3 Apr 2002 07:07:10 -0000	1.12
+++ mailnews/base/resources/locale/en-US/mailTasksOverlay.dtd	26 Aug 2002 05:32:53 -0000
@@ -1,6 +1,6 @@
 
 <!-- LOCALIZATION NOTE (messengerCmd.label): DONT_TRANSLATE -->
-<!ENTITY messengerCmd.label					"Mail &amp; Newsgroups">
+<!ENTITY messengerCmd.label					"Mailnews">
 <!ENTITY messengerCmd.accesskey				"m">
 <!ENTITY messengerCmd.commandkey			"2">
 <!ENTITY addressBookCmd.label				"Address Book">  
Index: mailnews/base/resources/locale/en-US/messenger.dtd
===================================================================
RCS file: /cvsroot/mozilla/mailnews/base/resources/locale/en-US/messenger.dtd,v
retrieving revision 1.148
diff -u -u -w -r1.148 messenger.dtd
--- mailnews/base/resources/locale/en-US/messenger.dtd	10 Jul 2002 04:10:54 -0000	1.148
+++ mailnews/base/resources/locale/en-US/messenger.dtd	26 Aug 2002 05:32:53 -0000
@@ -198,13 +198,13 @@
 <!ENTITY headersNormalCmd.accesskey "N">
 <!ENTITY headersBriefCmd.label ".Brief">
 <!ENTITY headersBriefCmd.accesskey "B">
-<!ENTITY bodyMenu.label "Message Body As">
+<!ENTITY bodyMenu.label "Body">
 <!ENTITY bodyMenu.accesskey "O">
 <!ENTITY bodyAllowHTML.label "Original HTML">
 <!ENTITY bodyAllowHTML.accesskey "H">
 <!ENTITY bodySanitized.label "Simple HTML">
 <!ENTITY bodySanitized.accesskey "S">
-<!ENTITY bodyAsPlaintext.label "Plain Text">
+<!ENTITY bodyAsPlaintext.label "As Plain Text">
 <!ENTITY bodyAsPlaintext.accesskey "P">
 <!ENTITY viewAttachmentsInlineCmd.label ".View Attachments Inline">
 <!ENTITY viewAttachmentsInlineCmd.accesskey "A">
Index: mailnews/base/resources/locale/en-US/msgHdrViewOverlay.dtd
===================================================================
RCS file: /cvsroot/mozilla/mailnews/base/resources/locale/en-US/msgHdrViewOverlay.dtd,v
retrieving revision 1.7
diff -u -u -w -r1.7 msgHdrViewOverlay.dtd
--- mailnews/base/resources/locale/en-US/msgHdrViewOverlay.dtd	1 Feb 2002 23:05:45 -0000	1.7
+++ mailnews/base/resources/locale/en-US/msgHdrViewOverlay.dtd	26 Aug 2002 05:32:53 -0000
@@ -20,6 +20,7 @@
 
 <!ENTITY toField.label "To: ">
 <!ENTITY fromField.label "From: ">
+<!ENTITY organizationField.label "Organization: ">
 <!ENTITY replyToField.label "Reply-To: ">
 
 <!ENTITY subjectField.label "Subject: ">
Index: mailnews/base/resources/locale/en-US/region.properties
===================================================================
RCS file: /cvsroot/mozilla/mailnews/base/resources/locale/en-US/region.properties,v
retrieving revision 1.3
diff -u -u -w -r1.3 region.properties
--- mailnews/base/resources/locale/en-US/region.properties	9 Apr 2002 00:37:09 -0000	1.3
+++ mailnews/base/resources/locale/en-US/region.properties	26 Aug 2002 05:32:53 -0000
@@ -1,10 +1,10 @@
 #
 # messenger.properties
 # mailnews.js
-mailnews.start_page.url=http://www.mozilla.org/mailnews/start.html
-messenger.throbber.url=http://www.mozilla.org/
-compose.throbber.url=http://www.mozilla.org/
-addressbook.throbber.url=http://www.mozilla.org/
+mailnews.start_page.url=about:blank
+messenger.throbber.url=about:welcome
+compose.throbber.url=about:welcome
+addressbook.throbber.url=about:welcome
 # To make mapit buttons to disappear in the addressbook, specify empty string.  For example:
 # mail.addr_book.mapit_url.format=
 # The format for "mail.addr_book.mapit_url.format" is:
@@ -14,4 +14,4 @@
 # @ST == state
 # @ZI == zip code
 # @CO == country
-mail.addr_book.mapit_url.format=http://www.mapquest.com/maps/map.adp?country=@CO&address=@A1%20@A2&city=@CI&state=@ST&zipcode=@ZI
+mail.addr_book.mapit_url.format=http://maps.yahoo.com/py/maps.py?Pyt=Tmap&Country=@CO&addr=@A1%20@A2&csz=@CI,%20@ST%20@ZI
Index: mailnews/compose/resources/content/messengercompose.xul
===================================================================
RCS file: /cvsroot/mozilla/mailnews/compose/resources/content/messengercompose.xul,v
retrieving revision 1.249
diff -u -u -w -r1.249 messengercompose.xul
--- mailnews/compose/resources/content/messengercompose.xul	21 Jun 2002 01:52:02 -0000	1.249
+++ mailnews/compose/resources/content/messengercompose.xul	26 Aug 2002 05:32:54 -0000
@@ -368,7 +368,7 @@
           <menuitem label="&attachVCardCmd.label;" disabled="true" accesskey="&attachVCardCmd.accesskey;" oncommand="AttachVCard()"/-->     
         </menupopup>
       </menu>
-      <!--menu id="debugMenu"/-->
+      <!--<menu id="debugMenu"/>-->
       <menu id="tasksMenu"/>
       <menu id="windowMenu"/>
       <menu id="menu_Help"/>
@@ -467,7 +467,7 @@
       <toolbarseparator class="toolbarseparator-standard"/>
       <toolbarbutton id="AlignPopupButton"/>
       <toolbarbutton id="InsertPopupButton"/>
-      <toolbarbutton id="smileButtonMenu" padwithspace="true"/>
+<!--      <toolbarbutton id="smileButtonMenu" padwithspace="true"/>-->
       <spacer flex="1"/>
     </toolbar>
   </toolbox>
Index: mailnews/extensions/smime/resources/locale/en-US/msgCompSMIMEOverlay.dtd
===================================================================
RCS file: /cvsroot/mozilla/mailnews/extensions/smime/resources/locale/en-US/msgCompSMIMEOverlay.dtd,v
retrieving revision 1.7
diff -u -u -w -r1.7 msgCompSMIMEOverlay.dtd
--- mailnews/extensions/smime/resources/locale/en-US/msgCompSMIMEOverlay.dtd	12 Jun 2002 16:54:45 -0000	1.7
+++ mailnews/extensions/smime/resources/locale/en-US/msgCompSMIMEOverlay.dtd	26 Aug 2002 05:32:54 -0000
@@ -1,7 +1,7 @@
 <!--LOCALIZATION NOTE msgCompSMIMEOverlay.dtd UI for s/mime hooks in message composition -->
 
-<!ENTITY securityMenu.label "Security">
-<!ENTITY securityMenu.accesskey "e">
+<!ENTITY securityMenu.label "Cryptography">
+<!ENTITY securityMenu.accesskey "C">
 
 <!ENTITY menu_securityEncryptIfPossible.label "Encrypt if Possible">
 <!ENTITY menu_securityEncryptIfPossible.accesskey "P">
@@ -18,8 +18,8 @@
 <!ENTITY menu_securityStatus.label "View Security Info">
 <!ENTITY menu_securityStatus.accesskey "I">
 
-<!ENTITY securityButton.label "Security">
-<!ENTITY securityButton.tooltip "View or change security settings">
+<!ENTITY securityButton.label "Crypto">
+<!ENTITY securityButton.tooltip "View or change settings for cryptographic security">
 
 <!ENTITY menu_viewSecurityStatus.label "Message Security Info">
 <!ENTITY menu_viewSecurityStatus.accesskey "I">
Index: mailnews/mime/emitters/src/nsMimeHtmlEmitter.cpp
===================================================================
RCS file: /cvsroot/mozilla/mailnews/mime/emitters/src/nsMimeHtmlEmitter.cpp,v
retrieving revision 1.63
diff -u -u -w -r1.63 nsMimeHtmlEmitter.cpp
--- mailnews/mime/emitters/src/nsMimeHtmlEmitter.cpp	11 Jul 2002 01:00:21 -0000	1.63
+++ mailnews/mime/emitters/src/nsMimeHtmlEmitter.cpp	26 Aug 2002 05:32:55 -0000
@@ -219,7 +219,7 @@
               nsCRT::strcasecmp("cc", headerInfo->name) && nsCRT::strcasecmp("newsgroups", headerInfo->name) &&
               nsCRT::strcasecmp("bcc", headerInfo->name) && nsCRT::strcasecmp("followup-to", headerInfo->name) &&
               nsCRT::strcasecmp("reply-to", headerInfo->name) && nsCRT::strcasecmp("subject", headerInfo->name) &&
-              nsCRT::strcasecmp("user-agent", headerInfo->name))
+              nsCRT::strcasecmp("organization", headerInfo->name) && nsCRT::strcasecmp("user-agent", headerInfo->name))
                 continue;
         }
 
Index: mailnews/mime/src/mimethsa.cpp
===================================================================
RCS file: /cvsroot/mozilla/mailnews/mime/src/mimethsa.cpp,v
retrieving revision 1.2
diff -u -u -w -r1.2 mimethsa.cpp
--- mailnews/mime/src/mimethsa.cpp	17 Apr 2002 09:56:25 -0000	1.2
+++ mailnews/mime/src/mimethsa.cpp	26 Aug 2002 05:32:55 -0000
@@ -135,6 +135,12 @@
 #ifdef DEBUG_BenB
 printf("parse_eof\n");
 #endif
+
+  if (obj->closed_p)
+    return 0;
+  int status = ((MimeObjectClass*)&MIME_SUPERCLASS)->parse_eof(obj, abort_p);
+  if (status < 0) 
+    return status;
   MimeInlineTextHTMLSanitized *textHTMLSan =
                                        (MimeInlineTextHTMLSanitized *) obj;
 
@@ -142,12 +148,12 @@
 printf(" cbp: %d\n", textHTMLSan->complete_buffer);
 printf(" closed_p: %s\n", obj->closed_p?"true":"false");
 #endif
-  if (obj->closed_p || !textHTMLSan || !textHTMLSan->complete_buffer)
+  if (!textHTMLSan || !textHTMLSan->complete_buffer)
   {
 #ifdef DEBUG_BenB
 printf("/parse_eof (early exit)\n");
 #endif
-    return -1;
+    return 0;
   }
 #ifdef DEBUG_BenB
 printf(" E1\n");
@@ -184,15 +190,13 @@
   /* That function doesn't work correctly, if the first META tag is no
      charset spec. (It assumes that it's on its own line.)
      Most likely not fatally wrong, however. */
-  int status = ((MimeObjectClass*)&MIME_SUPERCLASS)->parse_line(
+  status = ((MimeObjectClass*)&MIME_SUPERCLASS)->parse_line(
                              NS_CONST_CAST(char*, resultCStr.get()),
                              resultCStr.Length(),
                              obj);
 #ifdef DEBUG_BenB
 printf(" E7\n");
 #endif
-  if (status < 0)
-    return status;
 
 #ifdef DEBUG_BenB
 printf(" E8\n");
@@ -203,7 +207,8 @@
 #ifdef DEBUG_BenB
 printf("/parse_eof\n");
 #endif
-  return ((MimeObjectClass*)&MIME_SUPERCLASS)->parse_eof(obj, abort_p);
+
+  return status;
 }
 
 void
@@ -264,7 +269,11 @@
     return -1;
   }
 
-  (textHTMLSan->complete_buffer)->Append(NS_ConvertUTF8toUCS2(line));
+  nsCString linestr(line, length);
+  NS_ConvertUTF8toUCS2 line_ucs2(linestr.get());
+  if (length && line_ucs2.IsEmpty())
+    line_ucs2.AssignWithConversion(linestr.get());
+  (textHTMLSan->complete_buffer)->Append(line_ucs2);
 
 #ifdef DEBUG_BenB
 printf("l ");
Index: modules/libpref/src/beos/beos.js
===================================================================
RCS file: /cvsroot/mozilla/modules/libpref/src/beos/beos.js,v
retrieving revision 1.13
diff -u -u -w -r1.13 beos.js
--- modules/libpref/src/beos/beos.js	16 Apr 2002 18:46:33 -0000	1.13
+++ modules/libpref/src/beos/beos.js	26 Aug 2002 05:32:56 -0000
@@ -39,7 +39,7 @@
 pref("intl.font_spec_list", "");
 pref("mail.signature_date", 0);
 
-pref("font.default", "serif");
+pref("font.default", "sans-serif");
 pref("font.size.variable.ar", 16);
 pref("font.size.fixed.ar", 13);
 
Index: modules/libpref/src/init/all.js
===================================================================
RCS file: /cvsroot/mozilla/modules/libpref/src/init/all.js,v
retrieving revision 3.401.2.1
diff -u -u -w -r3.401.2.1 all.js
--- modules/libpref/src/init/all.js	9 Aug 2002 16:01:00 -0000	3.401.2.1
+++ modules/libpref/src/init/all.js	26 Aug 2002 05:32:56 -0000
@@ -38,16 +38,18 @@
 // SYNTAX HINTS:  dashes are delimiters.  Use underscores instead.
 //  The first character after a period must be alphabetic.
 
-pref("startup.homepage_override_url","chrome://navigator-region/locale/region.properties");
-pref("browser.chromeURL","chrome://navigator/content/navigator.xul");
+pref("general.useragent.misc", "Stable");
+// Separate the ever-changing version info to avoid merge conflicts
+
+// see <http://www.mozilla.org/build/revised-user-agent-strings.html>
+pref("general.useragent.locale", "en");
+pref("general.useragent.vendor", "Beonex");
+pref("general.useragent.vendorSub", "0.9-pre-1");
 
-pref("network.search.url","http://cgi.netscape.com/cgi-bin/url_search.cgi?search=");
+pref("network.search.url","http://www.google.com/search?q=");
 
-pref("keyword.URL", "http://keyword.netscape.com/keyword/");
-pref("keyword.enabled", false);
-pref("general.useragent.locale", "chrome://navigator/locale/navigator.properties");
-pref("general.useragent.contentlocale", "chrome://navigator-region/locale/region.properties");
-pref("general.useragent.misc", "rv:1.1");
+pref("keyword.URL", "http://www.google.com/search?btnI=I%27m+Feeling+Lucky&q="); //XXX permanent?
+pref("keyword.enabled", true);
 
 pref("general.startup.browser",             true);
 pref("general.startup.mail",                false);
@@ -64,10 +66,14 @@
 // 0 = blank, 1 = home (browser.startup.homepage), 2 = last
 pref("browser.startup.page",                1);
 pref("browser.startup.homepage",	   "chrome://navigator-region/locale/region.properties");
+pref("startup.homepage_override_url",       "chrome://navigator-region/locale/region.properties");
 // "browser.startup.homepage_override" was for 4.x
-pref("browser.startup.homepage_override.1", true);
+pref("browser.startup.homepage_override.beonex.0-9.1", true);
+
 pref("browser.startup.autoload_homepage",   true);
 
+pref("browser.chromeURL","chrome://navigator/content/navigator.xul");
+
 pref("browser.cache.enable",                true); // see also network.http.use-cache
 pref("browser.cache.disk.enable",           true);
 pref("browser.cache.disk.capacity",         50000);
@@ -110,12 +116,12 @@
 pref("browser.chrome.toolbar_tips",         true);
 pref("browser.chrome.toolbar_style",        2);
 
-pref("browser.toolbars.showbutton.bookmarks", true);
+pref("browser.toolbars.showbutton.bookmarks", false);
 pref("browser.toolbars.showbutton.go",      false);
 pref("browser.toolbars.showbutton.home",    true);
-pref("browser.toolbars.showbutton.mynetscape", true);
-pref("browser.toolbars.showbutton.net2phone", true);
-pref("browser.toolbars.showbutton.print",   true);
+pref("browser.toolbars.showbutton.mynetscape", false);
+pref("browser.toolbars.showbutton.net2phone", false);
+pref("browser.toolbars.showbutton.print",   false);
 pref("browser.toolbars.showbutton.search",  true);
 
 pref("browser.turbo.enabled", false);
@@ -141,7 +147,7 @@
 pref("browser.search.defaulturl", "chrome://navigator-region/locale/region.properties");
 pref("browser.search.opensidebarsearchpanel", true);
 pref("browser.search.last_search_category", "NC:SearchCategory?category=urn:search:category:1");
-pref("browser.search.mode", 0);
+pref("browser.search.mode", 1);
 pref("browser.search.powermode", 0);
 // basic search popup constraint: minimum sherlock plugin version displayed
 // (note: must be a string representation of a float or it'll default to 0.0)
@@ -163,7 +169,7 @@
 pref("browser.PICS.pages_must_be_rated", false);
 pref("browser.PICS.disable_for_this_session", false);
 pref("browser.PICS.reenable_for_this_session", false);
-pref("browser.PICS.service.http___home_netscape_com_default_rating.service_enabled", true);
+pref("browser.PICS.service.http___home_netscape_com_default_rating.service_enabled", false);
 pref("browser.PICS.service.http___home_netscape_com_default_rating.s", 0);
 
 // loading and rendering of framesets and iframes
@@ -205,11 +211,11 @@
 pref("application.use_ns_plugin_finder", false);
 
 // Smart Browsing prefs
-pref("browser.related.enabled", true);
+pref("browser.related.enabled", false);
 pref("browser.related.autoload", 1);  // 0 = Always, 1 = After first use, 2 = Never
-pref("browser.related.provider", "http://www-rl.netscape.com/wtgn?");
+pref("browser.related.provider", "http://www-rl.netscape.com/wtgn?"); //XXX
 pref("browser.related.disabledForDomains", "");
-pref("browser.goBrowsing.enabled", true);
+pref("browser.goBrowsing.enabled", false);
 
 // URI fixup prefs
 pref("browser.fixup.alternate.enabled", true);
@@ -358,9 +364,9 @@
 pref("dom.disable_cookie_set",              false);
 pref("dom.disable_image_src_set",           false);
 pref("dom.disable_open_during_load",        false);
-pref("dom.disable_window_flip",             false);
-pref("dom.disable_window_move_resize",      false);
-pref("dom.disable_window_status_change",    false);
+pref("dom.disable_window_flip",             true);
+pref("dom.disable_window_move_resize",      true);
+pref("dom.disable_window_status_change",    true);
 
 pref("dom.disable_window_open_feature.titlebar",    false);
 pref("dom.disable_window_open_feature.close",       false);
@@ -381,7 +387,7 @@
 
 // advanced prefs
 pref("advanced.always_load_images",         true);
-pref("security.enable_java",                true);
+pref("security.enable_java",                false);
 pref("css.allow",                           true);
 pref("advanced.mailftp",                    false);
 pref("image.animation_mode",                "normal");
@@ -453,7 +459,20 @@
 // Headers
 pref("network.http.accept.default", "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,video/x-mng,image/png,image/jpeg,image/gif;q=0.2,text/css,*/*;q=0.1");
 
-pref("network.http.sendRefererHeader",      2); // 0=don't send any, 1=send only on clicks, 2=send on image requests as well
+
+// Controls how and when the referrer header will be sent:
+//  0 - never send the referrer
+//  1 - send only on HTTP link clicks
+//  2 - send for both HTTP link clicks and inlines (images)
+//  3 - not currently used
+//  4 - send the referrer only to the same home, otherwise none
+//  5 - send the referrer to the same host, otherwise send a faked referrer
+//  6 - always send a faked referrer (base URL of target server)
+pref("network.http.sendRefererHeader", 5);
+
+// If true, the modified referrer will be sent for schemes which
+// normally wouldn't send a referrer, such as file: and resource: and imap:
+pref("network.http.referrerSchemeOverride", false);
 
 // Maximum number of consecutive redirects before aborting.
 pref("network.http.redirection-limit", 10);
@@ -502,8 +521,7 @@
 pref("network.hosts.socks_conf",            "");
 pref("network.image.imageBehavior",         0); // 0-Accept, 1-dontAcceptForeign, 2-dontUse
 pref("network.image.warnAboutImages",       false);
-pref("network.proxy.autoconfig_url",        "");
-pref("network.proxy.type",                  0);
+pref("network.proxy.type",                  0); // 0=Direct, 1=Manual, 2=autoconfig
 pref("network.proxy.ftp",                   "");
 pref("network.proxy.ftp_port",              0);
 pref("network.proxy.gopher",                "");
@@ -520,21 +538,38 @@
 pref("network.proxy.socks_port",            0);
 pref("network.proxy.socks_version",         5);
 pref("network.proxy.no_proxies_on",         "");
+pref("network.proxy.autoconfig_url",        "");
 pref("network.online",                      true); //online/offline
 pref("network.accept_cookies",              0);     // 0 = Always, 1 = warn, 2 = never
-pref("network.foreign_cookies",             0); // 0 = Accept, 1 = Don't accept
-pref("network.cookie.cookieBehavior",       3); // 0-Accept, 1-dontAcceptForeign, 2-dontUse, 3-p3p
+pref("network.foreign_cookies",             1); // 0=Accept, 1=Don't accept
+pref("network.cookie.cookieBehavior",       1); // 0=Accept, 1=dontAcceptForeign, 2=dontUse, 3=p3p
 pref("network.cookie.disableCookieForMailNews", true); // disable all cookies for mail
 pref("network.cookie.warnAboutCookies",     false);
-pref("network.cookie.lifetime.enabled",     false);
-pref("network.cookie.lifetime.behavior",    0);
+pref("network.cookie.lifetime.enabled",     true);
+pref("network.cookie.lifetime.behavior",    0); // 0-session, 1-days
 pref("network.cookie.lifetime.days",        90);
-
-// The following default value is for p3p medium mode.
+/* morse, why did you break backwards-compatibility and made the pref more
+   inflexible, just to make the implementation of the prefs forntend easier??*/
+/* network.cookie.p3plevel consists of 8 characters having the
+ * following interpretation:
+ *   [0]: first-party cookies when site has no privacy policy
+ *   [1]: third-party cookies when site has no privacy policy
+ *   [2]: first-party cookies when site uses PII with no user consent
+ *   [3]: third-party cookies when site uses PII with no user consent
+ *   [4]: first-party cookies when site uses PII with implicit consent only
+ *   [5]: third-party cookies when site uses PII with implicit consent only
+ *   [6]: first-party cookies when site uses PII with explicit consent
+ *   [7]: third-party cookies when site uses PII with explicit consent
+ * PII = personally identifiable information
+ *
+ * each of the eight characters can be one of the following
+ *   'a': accept the cookie
+ *   'd': accept the cookie but downgrade it to a session cookie
+ *   'r': reject the cookie
+ */
+pref("network.cookie.p3p",                  "drrrrrdr");
+pref("network.cookie.p3plevel",             3);  // 0=low, 1=medium, 2=high, 3=custom
 // See extensions/cookie/resources/content/p3p.xul for the definitions of low/medium/hi
-pref("network.cookie.p3p",                  "ffffaaaa");
-pref("network.cookie.p3plevel",             1); // 0=low, 1=medium, 2=high, 3=custom
-
 pref("signon.rememberSignons",              true);
 pref("signon.expireMasterPassword",         false);
 pref("network.enablePad",                   false); // Allow client to do proxy autodiscovery
@@ -646,9 +681,12 @@
 // Customizable toolbar stuff
 pref("custtoolbar.personal_toolbar_folder", "");
 
-pref("sidebar.customize.all_panels.url", "http://sidebar-rdf.netscape.com/%LOCALE%/sidebar-rdf/%SIDEBAR_VERSION%/all-panels.rdf");
-pref("sidebar.customize.directory.url", "http://dmoz.org/Netscape/Sidebar/");
-pref("sidebar.customize.more_panels.url", "http://dmoz.org/Netscape/Sidebar/");
+//pref("sidebar.customize.all_panels.url", "chrome://communicator/locale/sidebar/net-panels.rdf");
+//pref("sidebar.customize.all_panels.url", "http://sidebar-rdf.netscape.com/%LOCALE%/sidebar-rdf/%SIDEBAR_VERSION%/all-panels.rdf");
+pref("sidebar.customize.all_panels.url", "");
+//pref("sidebar.customize.directory.url", "http://dmoz.org/Netscape/Sidebar/");
+pref("sidebar.customize.directory.url", "http://www.beonex.com/communicator/redir/panel");
+pref("sidebar.customize.more_panels.url", "http://www.beonex.com/communicator/redir/panel");
 pref("sidebar.num_tabs_in_view", 8);
 
 pref("prefs.converted-to-utf8",false);
@@ -726,7 +764,7 @@
 
 // update notifications prefs
 pref("update_notifications.enabled", true);
-pref("update_notifications.provider.0.frequency", 7); // number of days
+pref("update_notifications.provider.0.frequency", 1); // number of days
 pref("update_notifications.provider.0.datasource", "chrome://communicator-region/locale/region.properties");
 
 // 0 opens the download manager
Index: modules/libpref/src/init/editor.js
===================================================================
RCS file: /cvsroot/mozilla/modules/libpref/src/init/editor.js,v
retrieving revision 3.26
diff -u -u -w -r3.26 editor.js
--- modules/libpref/src/init/editor.js	16 Apr 2002 18:46:51 -0000	3.26
+++ modules/libpref/src/init/editor.js	26 Aug 2002 05:32:56 -0000
@@ -55,7 +55,7 @@
 
 pref("editor.table.maintain_structure", true);
 
-pref("editor.prettyprint", true);
+pref("editor.prettyprint", false);
 
 pref("editor.htmlWrapColumn", 72);
 
Index: modules/libpref/src/init/mailnews.js
===================================================================
RCS file: /cvsroot/mozilla/modules/libpref/src/init/mailnews.js,v
retrieving revision 3.157
diff -u -u -w -r3.157 mailnews.js
--- modules/libpref/src/init/mailnews.js	4 Jul 2002 00:56:33 -0000	3.157
+++ modules/libpref/src/init/mailnews.js	26 Aug 2002 05:32:56 -0000
@@ -66,7 +66,7 @@
 pref("mailnews.headers.showUserAgent",       false);
 
 // Mail server preferences, pop by default
-pref("mail.server_type",	0); 	// 0 pop, 1 imap,
+pref("mail.server_type",	1); 	// 0 pop, 1 imap,
 					// (Unix only:)
 					// 2 movemail, 3 inbox          
 pref("mail.auth_login", true);
@@ -91,6 +91,7 @@
 pref("mail.imap.mime_parts_on_demand",      true);
 pref("mail.imap.mime_parts_on_demand_max_depth", 15);
 pref("mail.imap.mime_parts_on_demand_threshold", 30000);
+//pref("mail.imap.noop_check_count",          1); //XXX should we?
 pref("mail.thread_without_re",	            true);
 pref("mail.leave_on_server",                false);
 pref("mail.default_cc",                     "");
@@ -268,8 +269,9 @@
 
 pref("mailnews.confirm.moveFoldersToTrash", true);
 
-pref("mailnews.start_page.url", "chrome://messenger-region/locale/region.properties");
-pref("mailnews.start_page.enabled", true);
+pref("mailnews.start_page.url", "about:blank");
+pref("mailnews.start_page.enabled", false);
+
 
 pref("mailnews.account_central_page.url", "chrome://messenger/locale/messenger.properties");
 
@@ -287,7 +289,7 @@
 pref("mail.identity.default.overrideGlobal_Pref", false);
 
 
-pref("mail.collect_email_address_incoming", true);
+pref("mail.collect_email_address_incoming", false);
 pref("mail.collect_email_address_outgoing", true);
 pref("mail.collect_email_address_newsgroup", false);
 pref("mail.collect_email_address_enable_size_limit", true);
@@ -337,9 +339,9 @@
 pref("mail.send_struct", false);   // HTML->HTML *bold* etc. during Send; ditto
 // For the next 4 prefs, see <http://www.bucksch.org/1/projects/mozilla/108153>
 pref("mailnews.display.prefer_plaintext", false);  // Ignore HTML parts in multipart/alternative
-pref("mailnews.display.html_as", 0);  // How to display HTML parts. 0 = Render the sender's HTML; 1 = HTML->TXT->HTML; 2 = Show HTML source; 3 = Sanitize HTML
+pref("mailnews.display.html_as", 3);  // How to display HTML parts. 0 = Render the sender's HTML; 1 = HTML->TXT->HTML; 2 = Show HTML source; 3 = Sanitize HTML
 pref("mailnews.display.html_sanitizer.allowed_tags", "html head title body p br div(lang,title) h1 h2 h3 h4 h5 h6 ul ol li(value,start,compact) dl dt dd blockquote(type,cite) pre noscript noframes strong em sub sup span(lang,title) acronym(title) abbr(title) del(title,cite,datetime) ins(title,cite,datetime) q(cite) a(href,name,title) img(alt,title,longdesc) base(href) area(alt) applet(alt) object(alt) var samp dfn address kbd code cite s strike tt b i table(align) caption tr(align,valign) td(rowspan,colspan,align,valign) th(rowspan,colspan,align,valign)");
-pref("mailnews.display.disallow_mime_handlers", 0);  /* Let only a few classes process incoming data. This protects from bugs (e.g. buffer overflows) and from security loopholes (e.g. allowing unchecked HTML in some obscure classes, although the user has html_as > 0).
+pref("mailnews.display.disallow_mime_handlers", 3);  /* Let only a few classes process incoming data. This protects from bugs (e.g. buffer overflows) and from security loopholes (e.g. allowing unchecked HTML in some obscure classes, although the user has html_as > 0).
 This option is mainly for the UI of html_as.
 0 = allow all available classes
 1 = Use hardcoded blacklist to avoid rendering (incoming) HTML
@@ -458,5 +460,5 @@
 pref("mailnews.fakeaccount.server", "");
 
 // message display properties
-pref("mailnews.message_display.disable_remote_image", false);
-pref("mailnews.message_display.allow.plugins", true);
+pref("mailnews.message_display.disable_remote_image", true);
+pref("mailnews.message_display.allow.plugins", false);
Index: modules/libpref/src/mac/macprefs.js
===================================================================
RCS file: /cvsroot/mozilla/modules/libpref/src/mac/macprefs.js,v
retrieving revision 3.25
diff -u -u -w -r3.25 macprefs.js
--- modules/libpref/src/mac/macprefs.js	26 Jun 2002 19:59:47 -0000	3.25
+++ modules/libpref/src/mac/macprefs.js	26 Aug 2002 05:32:56 -0000
@@ -137,7 +137,7 @@
 pref("font.name.cursive.zh-TW", "XXX.cursive");
 pref("font.name.fantasy.zh-TW", "XXX.fantasy");
 
-pref("font.default", "serif");
+pref("font.default", "sans-serif");
 pref("font.size.variable.ar", 16);
 pref("font.size.fixed.ar", 13);
 
Index: modules/libpref/src/os2/os2pref.js
===================================================================
RCS file: /cvsroot/mozilla/modules/libpref/src/os2/os2pref.js,v
retrieving revision 3.25
diff -u -u -w -r3.25 os2pref.js
--- modules/libpref/src/os2/os2pref.js	27 Jun 2002 22:37:30 -0000	3.25
+++ modules/libpref/src/os2/os2pref.js	26 Aug 2002 05:32:56 -0000
@@ -109,7 +109,7 @@
 pref("font.name.sans-serif.zh-TW", "Helv");
 pref("font.name.monospace.zh-TW", "Courier");
 
-pref("font.default", "serif");
+pref("font.default", "sans-serif");
 pref("font.size.variable.ar", 16);
 pref("font.size.fixed.ar", 13);
 
Index: modules/libpref/src/unix/unix.js
===================================================================
RCS file: /cvsroot/mozilla/modules/libpref/src/unix/unix.js,v
retrieving revision 3.74
diff -u -u -w -r3.74 unix.js
--- modules/libpref/src/unix/unix.js	25 Jul 2002 05:10:46 -0000	3.74
+++ modules/libpref/src/unix/unix.js	26 Aug 2002 05:32:56 -0000
@@ -58,7 +58,7 @@
 
 // Middle-mouse handling
 pref("middlemouse.paste", true);
-pref("middlemouse.contentLoadURL", true);
+pref("middlemouse.contentLoadURL", false);
 pref("middlemouse.openNewWindow", true);
 pref("middlemouse.scrollbarPosition", true);
 
@@ -176,7 +176,7 @@
 
 // zh-TW
 
-pref("font.default", "serif");
+pref("font.default", "sans-serif");
 pref("font.size.variable.ar", 16);
 pref("font.size.fixed.ar", 12);
 
@@ -208,10 +208,10 @@
 pref("font.size.fixed.x-cyrillic", 12);
 
 pref("font.size.variable.x-unicode", 16);
-pref("font.size.fixed.x-unicode", 12);
+pref("font.size.fixed.x-unicode", 14);
 
 pref("font.size.variable.x-western", 16);
-pref("font.size.fixed.x-western", 12);
+pref("font.size.fixed.x-western", 14);
 
 pref("font.size.variable.zh-CN", 16);
 pref("font.size.fixed.zh-CN", 16);
Index: modules/libpref/src/win/winpref.js
===================================================================
RCS file: /cvsroot/mozilla/modules/libpref/src/win/winpref.js,v
retrieving revision 3.38
diff -u -u -w -r3.38 winpref.js
--- modules/libpref/src/win/winpref.js	26 Jun 2002 20:09:14 -0000	3.38
+++ modules/libpref/src/win/winpref.js	26 Aug 2002 05:32:56 -0000
@@ -115,7 +115,7 @@
 pref("font.name-list.sans-serif.zh-TW", "MingLiU"); 
 pref("font.name-list.monospace.zh-TW", "MingLiU"); 
 
-pref("font.default", "serif");
+pref("font.default", "sans-serif");
 pref("font.size.variable.ar", 16);
 pref("font.size.fixed.ar", 13);
 
Index: netwerk/base/public/nsNetUtil.h
===================================================================
RCS file: /cvsroot/mozilla/netwerk/base/public/nsNetUtil.h,v
retrieving revision 1.56
diff -u -u -w -r1.56 nsNetUtil.h
--- netwerk/base/public/nsNetUtil.h	14 Jun 2002 17:44:20 -0000	1.56
+++ netwerk/base/public/nsNetUtil.h	26 Aug 2002 05:32:59 -0000
@@ -111,7 +111,7 @@
           nsIURI* baseURI = nsnull,
           nsIIOService* ioService = nsnull)     // pass in nsIIOService to optimize callers
 {
-    return NS_NewURI(result, NS_ConvertUCS2toUTF8(spec), charset, baseURI, ioService);
+    return NS_NewURI(result, NS_ConvertUCS2toUTF8(spec), "UTF-8", baseURI, ioService);
 }
 
 inline nsresult
Index: netwerk/base/public/security-prefs.js
===================================================================
RCS file: /cvsroot/mozilla/netwerk/base/public/security-prefs.js,v
retrieving revision 1.9
diff -u -u -w -r1.9 security-prefs.js
--- netwerk/base/public/security-prefs.js	2 Aug 2001 23:45:25 -0000	1.9
+++ netwerk/base/public/security-prefs.js	26 Aug 2002 05:32:59 -0000
@@ -28,7 +28,7 @@
 pref("security.warn_entering_weak",      true);
 pref("security.warn_leaving_secure",     true);
 pref("security.warn_viewing_mixed",      true);
-pref("security.warn_submit_insecure",    true);
+pref("security.warn_submit_insecure",    false);
 
 pref("security.OCSP.enabled",		0);
 
Index: netwerk/base/src/nsIOService.cpp
===================================================================
RCS file: /cvsroot/mozilla/netwerk/base/src/nsIOService.cpp,v
retrieving revision 1.146
diff -u -u -w -r1.146 nsIOService.cpp
--- netwerk/base/src/nsIOService.cpp	2 Jul 2002 18:14:37 -0000	1.146
+++ netwerk/base/src/nsIOService.cpp	26 Aug 2002 05:32:59 -0000
@@ -439,6 +439,7 @@
     if (NS_SUCCEEDED(rv)) return NS_OK;
 
     PRBool externalProtocol = PR_FALSE;
+    PRBool useAnyExternal = PR_TRUE;
     nsCOMPtr<nsIPrefBranch> prefBranch;
     GetPrefBranch(getter_AddRefs(prefBranch));
     if (prefBranch) {
@@ -447,26 +448,34 @@
         rv = prefBranch->GetBoolPref(externalProtocolPref.get(), &externalProtocol);
         if (NS_FAILED(rv))
             externalProtocol = PR_FALSE;
+
+        rv = prefBranch->GetBoolPref("network.protocol-handler.useAnyExternal",
+                                     &useAnyExternal);
     }
 
+    nsresult gotHandler = NS_ERROR_UNEXPECTED;
+
     if (!externalProtocol) {
         nsCAutoString contractID(NS_NETWORK_PROTOCOL_CONTRACTID_PREFIX);
         contractID += scheme;
         ToLowerCase(contractID);
 
-        rv = CallGetService(contractID.get(), result);
+        gotHandler = CallGetService(contractID.get(), result);
     }
     
-    if (externalProtocol || NS_FAILED(rv)) 
+    if (externalProtocol || (NS_FAILED(gotHandler) && useAnyExternal))
     {
       // okay we don't have a protocol handler to handle this url type, so use the default protocol handler.
       // this will cause urls to get dispatched out to the OS ('cause we can't do anything with them) when 
       // we try to read from a channel created by the default protocol handler.
 
-      rv = CallGetService(NS_NETWORK_PROTOCOL_CONTRACTID_PREFIX"default",
+      gotHandler = CallGetService(
+                             NS_NETWORK_PROTOCOL_CONTRACTID_PREFIX"default",
                           result);
-      if (NS_FAILED(rv)) return NS_ERROR_UNKNOWN_PROTOCOL;
     }
+
+    if (NS_FAILED(gotHandler))
+        return NS_ERROR_UNKNOWN_PROTOCOL;
 
     CacheProtocolHandler(scheme, *result);
 
Index: netwerk/build/nsNetModule.cpp
===================================================================
RCS file: /cvsroot/mozilla/netwerk/build/nsNetModule.cpp,v
retrieving revision 1.70
diff -u -u -w -r1.70 nsNetModule.cpp
--- netwerk/build/nsNetModule.cpp	2 Jul 2002 18:15:19 -0000	1.70
+++ netwerk/build/nsNetModule.cpp	26 Aug 2002 05:32:59 -0000
@@ -986,6 +986,16 @@
       NS_ABOUT_MODULE_CONTRACTID_PREFIX "credits",
       nsAboutRedirector::Create
     },
+    { "about:licence",
+      NS_ABOUT_REDIRECTOR_MODULE_CID,
+      NS_ABOUT_MODULE_CONTRACTID_PREFIX "licence",
+      nsAboutRedirector::Create
+    },
+    { "about:welcome",
+      NS_ABOUT_REDIRECTOR_MODULE_CID,
+      NS_ABOUT_MODULE_CONTRACTID_PREFIX "welcome",
+      nsAboutRedirector::Create
+    },
     { "about:plugins",
       NS_ABOUT_REDIRECTOR_MODULE_CID,
       NS_ABOUT_MODULE_CONTRACTID_PREFIX "plugins",
Index: netwerk/protocol/about/src/nsAboutRedirector.cpp
===================================================================
RCS file: /cvsroot/mozilla/netwerk/protocol/about/src/nsAboutRedirector.cpp,v
retrieving revision 1.10
diff -u -u -w -r1.10 nsAboutRedirector.cpp
--- netwerk/protocol/about/src/nsAboutRedirector.cpp	25 Jul 2002 13:27:15 -0000	1.10
+++ netwerk/protocol/about/src/nsAboutRedirector.cpp	26 Aug 2002 05:32:59 -0000
@@ -66,12 +66,15 @@
   before adding new map entries with dropChromePrivs == PR_FALSE.
  */
 static RedirEntry kRedirMap[] = {
-    { "credits", "http://www.mozilla.org/credits/", PR_TRUE },
-    { "mozilla", "chrome://global/content/mozilla.xhtml", PR_TRUE },
+    { "credits", "chrome://global/content/credits.html", PR_TRUE },
+    { "welcome", "chrome://communicator/locale/welcome.html", PR_TRUE },
+    { "licence", "chrome://global/locale/license.html", PR_TRUE },
+    { "license", "chrome://global/locale/license.html", PR_TRUE },
+    { "mozilla", "chrome://global/content/mozilla.html", PR_TRUE },
     { "plugins", "chrome://global/content/plugins.html", PR_TRUE },
     { "config", "chrome://global/content/config.xul", PR_FALSE }
 };
-static const int kRedirTotal = 4; // sizeof(kRedirMap)/sizeof(*kRedirMap)
+static const int kRedirTotal = 7; // sizeof(kRedirMap)/sizeof(*kRedirMap)
 
 NS_IMETHODIMP
 nsAboutRedirector::NewChannel(nsIURI *aURI, nsIChannel **result)
Index: netwerk/protocol/http/public/nsIHttpChannel.idl
===================================================================
RCS file: /cvsroot/mozilla/netwerk/protocol/http/public/nsIHttpChannel.idl,v
retrieving revision 1.10
diff -u -u -w -r1.10 nsIHttpChannel.idl
--- netwerk/protocol/http/public/nsIHttpChannel.idl	1 Jul 2002 23:12:12 -0000	1.10
+++ netwerk/protocol/http/public/nsIHttpChannel.idl	26 Aug 2002 05:33:00 -0000
@@ -42,17 +42,20 @@
     /**
      * Get/set the referrer URI on the request.  This is the address (URI) of
      * the resource from which this channel's URI was obtained (see RFC2616
-     * section 14.36).  The referrer type may be used to block the referrer
-     * from being sent in certain cases.
+     * section 14.36).  The referrer type may be used to block or modify the 
+     * referrer in certain cases.
      */
     readonly attribute nsIURI referrer;
     void setReferrer(in nsIURI referrer, in unsigned long referrerType);
 
     /* possible values for the referrerType */
     const unsigned long REFERRER_NONE = 0;
-    const unsigned long REFERRER_LINK_CLICK = 1; // http link clicks
-    const unsigned long REFERRER_INLINES = 2;    // images and other inlines
-    const unsigned long REFERRER_NON_HTTP = 3;   // e.g. news or FTP clicks
+    const unsigned long REFERRER_LINK_CLICK                 = 1;   /* http link clicks */
+    const unsigned long REFERRER_INLINES                    = 2;   /* images and other inlines */
+    const unsigned long REFERRER_NON_HTTP                   = 3;   /* e.g. news or FTP clicks */
+    const unsigned long REFERRER_SAME_HOST_ONLY             = 4;   /* Send the referrer only for requests from the same host, otherwise send no referrer. */
+    const unsigned long REFERRER_3RDPARTY_PREPATH           = 5;   /* Send the referrer only for requests from the same host, otherwise send target URI's pre-path as the referrer. */
+    const unsigned long REFERRER_PREPATH_URI_ALWAYS         = 6;   /* Always send the target URI's pre-path as the referrer. */
 
     /**
      * An http channel can own a reference to the document URI
Index: netwerk/protocol/http/src/nsHttpChannel.cpp
===================================================================
RCS file: /cvsroot/mozilla/netwerk/protocol/http/src/nsHttpChannel.cpp,v
retrieving revision 1.121.6.1
diff -u -u -w -r1.121.6.1 nsHttpChannel.cpp
--- netwerk/protocol/http/src/nsHttpChannel.cpp	8 Aug 2002 04:52:06 -0000	1.121.6.1
+++ netwerk/protocol/http/src/nsHttpChannel.cpp	26 Aug 2002 05:33:00 -0000
@@ -2455,87 +2455,127 @@
         "file",
         "mailbox",
         "imap",
+        "imaps",
         "news",
         "snews",
-        "imaps",
         "data",
         nsnull
     };
 
+
     NS_ENSURE_TRUE(!mIsPending, NS_ERROR_IN_PROGRESS);
 
-    if (nsHttpHandler::get()->ReferrerLevel() < referrerType)
+    // Clear the old referer first.
+    mRequestHead.SetHeader(nsHttp::Referer, NS_LITERAL_CSTRING(""));
+
+    PRUint8 referrerLevel = nsHttpHandler::get()->ReferrerLevel();
+
+    // Maintain compatability with the original (pre 1.0) usage of referrer levels.
+    if (referrerLevel == REFERRER_NONE || (referrerLevel <= REFERRER_NON_HTTP && referrerLevel < referrerType))
         return NS_OK;
 
-    // don't remember this referrer if it's on our black list....
-    if (referrer) {
-        PRBool match = PR_FALSE;
 
+    if (!referrer || !mURI)
+        return NS_ERROR_FAILURE;
+
+    // Don't send the referrer if it has a scheme in the above blacklist.
+    PRBool match = PR_FALSE;
         const char *const *scheme = invalidReferrerSchemes;
         for (; *scheme && !match; ++scheme)
             referrer->SchemeIs(*scheme, &match);
-
-        if (match)
-            return NS_OK; // kick out....
+    if (match) {
+        // If the user has configured the referrer override, force the referrer 
+        // type to send the target URI's pre-path (REFERRER_PREPATH_URI_ALWAYS), 
+        // even for schemes that normally wouldn't be allowed to send referrers.
+        if(nsHttpHandler::get()->ReferrerSchemeOverride())
+            referrerLevel = REFERRER_PREPATH_URI_ALWAYS;
+        else
+            return NS_OK;
     }
 
+
+    nsCAutoString referrerHost, host;
+    nsresult rv;
+
+    rv = referrer->GetAsciiHost(referrerHost);
+    if (NS_FAILED(rv))
+        return rv;
+    rv = mURI->GetAsciiHost(host);
+    if (NS_FAILED(rv)) 
+        return rv;
+
     // Handle secure referrals.
-    // Support referrals from a secure server if this is a secure site
+    // Support referrals from a secure server only if this is a secure site
     // and the host names are the same.
-    if (referrer) {
         PRBool isHTTPS = PR_FALSE;
         referrer->SchemeIs("https", &isHTTPS);
         if (isHTTPS) {
-            nsCAutoString referrerHost;
-            nsCAutoString host;
-
-            referrer->GetAsciiHost(referrerHost);
-            mURI->GetAsciiHost(host);
             mURI->SchemeIs("https", &isHTTPS);
 
-            if (!isHTTPS)
-                return NS_OK;
-
-            if ((nsCRT::strcasecmp(referrerHost.get(), host.get()) != 0) &&
+        if ((!isHTTPS || nsCRT::strcasecmp(referrerHost.get(), host.get()) != 0) &&
                 (!nsHttpHandler::get()->SendSecureXSiteReferrer()))
                 return NS_OK;
-
-        }
     }
 
+
     // save a copy of the referrer so we can return it if requested
     mReferrer = referrer;
 
     // save a copy of the referrer type for redirects
     mReferrerType = (PRUint8) referrerType;
 
-    // clear the old referer first
-    mRequestHead.SetHeader(nsHttp::Referer, NS_LITERAL_CSTRING(""));
-
-    if (referrer) {
-        nsCAutoString spec;
-        referrer->GetAsciiSpec(spec);
-        if (!spec.IsEmpty()) {
-            // strip away any userpass; we don't want to be giving out passwords ;-)
-            nsCAutoString userpass;
-            referrer->GetUserPass(userpass);
-            if (!userpass.IsEmpty()) {
-                // userpass is UTF8 encoded and spec is ASCII, so we might not find
-                // userpass as a substring of spec.
-                nsCOMPtr<nsIURI> clone;
-                nsresult rv = referrer->Clone(getter_AddRefs(clone));
-                if (NS_FAILED(rv)) return rv;
 
-                rv = clone->SetUserPass(NS_LITERAL_CSTRING(""));
-                if (NS_FAILED(rv)) return rv;
+    nsIURI *refPtr = referrer;
+    PRBool sendURIPath = PR_TRUE;
 
-                rv = clone->GetAsciiSpec(spec);
-                if (NS_FAILED(rv)) return rv;
+    switch(referrerLevel) {
+        // Send the referrer only for requests from the same host, otherwise send no referrer. 
+        case REFERRER_SAME_HOST_ONLY:
+            if (nsCRT::strcasecmp(referrerHost.get(), host.get()) == 0)
+                refPtr = referrer;  // Hosts match, so send the real referrer.
+            else 
+                return NS_OK;       // No match, send no referrer.
+        break;
+
+        // Send the referrer only for requests from the same host, otherwise send target URI's pre-path as the referrer.
+        case REFERRER_3RDPARTY_PREPATH:
+            if (nsCRT::strcasecmp(referrerHost.get(), host.get()) == 0)
+                refPtr = referrer;  // Hosts match, so send the real referrer.
+            else {
+                refPtr = mURI;      // Hosts do not match - send the target URI's pre-path.
+                sendURIPath = PR_FALSE;
+            }
+        break;
+
+        // Always send the target URI's pre-path as the referrer.
+        case REFERRER_PREPATH_URI_ALWAYS:
+            refPtr = mURI;
+            sendURIPath = PR_FALSE;
+        break;
             }
+
+
+    if (!refPtr)
+        return NS_ERROR_FAILURE;
+
+    nsCOMPtr<nsIURI> theReferrer;  
+    rv = refPtr->Clone(getter_AddRefs(theReferrer));
+    if (NS_FAILED(rv) || !theReferrer)
+        return rv;
+
+    // Never send usernames & passwords!
+    theReferrer->SetUserPass(NS_LITERAL_CSTRING(""));
+
+    if (!sendURIPath)
+        theReferrer->SetPath(NS_LITERAL_CSTRING(""));
+
+    // Set the referrer header.
+    nsCAutoString spec;
+    rv = theReferrer->GetAsciiSpec(spec);
+    if (NS_SUCCEEDED(rv))
             mRequestHead.SetHeader(nsHttp::Referer, spec);
-        }
-    }
-    return NS_OK;
+
+    return rv;
 }
 
 NS_IMETHODIMP
Index: netwerk/protocol/http/src/nsHttpHandler.cpp
===================================================================
RCS file: /cvsroot/mozilla/netwerk/protocol/http/src/nsHttpHandler.cpp,v
retrieving revision 1.61
diff -u -u -w -r1.61 nsHttpHandler.cpp
--- netwerk/protocol/http/src/nsHttpHandler.cpp	18 Jul 2002 05:08:55 -0000	1.61
+++ netwerk/protocol/http/src/nsHttpHandler.cpp	26 Aug 2002 05:33:03 -0000
@@ -105,7 +105,8 @@
     , mProxyHttpVersion(NS_HTTP_VERSION_1_1)
     , mCapabilities(NS_HTTP_ALLOW_KEEPALIVE)
     , mProxyCapabilities(NS_HTTP_ALLOW_KEEPALIVE)
-    , mReferrerLevel(0xff) // by default we always send a referrer
+    , mReferrerLevel(2)    // 2 == REFERRER_INLINES - by default, always send the referrer
+    , mReferrerSchemeOverride(PR_FALSE)
     , mIdleTimeout(10)
     , mMaxRequestAttempts(10)
     , mMaxRequestDelay(10)
@@ -1189,36 +1190,15 @@
     OSVERSIONINFO info = { sizeof OSVERSIONINFO };
     if (GetVersionEx(&info)) {
         if (info.dwPlatformId == VER_PLATFORM_WIN32_NT) {
-            if (info.dwMajorVersion      == 3)
-                mOscpu.Adopt(nsCRT::strdup("WinNT3.51"));
-            else if (info.dwMajorVersion == 4)
-                mOscpu.Adopt(nsCRT::strdup("WinNT4.0"));
-            else {
-                char *buf = PR_smprintf("Windows NT %ld.%ld",
-                                        info.dwMajorVersion,
-                                        info.dwMinorVersion);
-                if (buf) {
-                    mOscpu.Adopt(nsCRT::strdup(buf));
-                    PR_smprintf_free(buf);
-                }
-            }
+          mOscpu.Adopt(nsCRT::strdup("WinNT"));
         } else if (info.dwPlatformId == VER_PLATFORM_WIN32_WINDOWS &&
                    info.dwMajorVersion == 4) {
-            if (info.dwMinorVersion == 90)
-                mOscpu.Adopt(nsCRT::strdup("Win 9x 4.90"));  // Windows Me
-            else if (info.dwMinorVersion > 0)
-                mOscpu.Adopt(nsCRT::strdup("Win98"));
-            else
-                mOscpu.Adopt(nsCRT::strdup("Win95"));
+          mOscpu.Adopt(nsCRT::strdup("Win9x"));
         } else {
-            char *buf = PR_smprintf("Windows %ld.%ld",
-                                    info.dwMajorVersion,
-                                    info.dwMinorVersion);
-            if (buf) {
-                mOscpu.Adopt(nsCRT::strdup(buf));
-                PR_smprintf_free(buf);
-            }
+          mOscpu.Adopt(nsCRT::strdup("Win"));
         }
+    } else {
+      mOscpu.Adopt(nsCRT::strdup("Win"));
     }
 #elif defined (XP_MACOSX)
     mOscpu.Adopt(nsCRT::strdup("PPC Mac OS X"));
@@ -1249,6 +1229,7 @@
 {
     nsresult rv = NS_OK;
     PRInt32 val;
+    PRBool cVar = PR_FALSE;
 
     LOG(("nsHttpHandler::PrefsChanged [pref=%s]\n", pref));
 
@@ -1306,20 +1287,8 @@
         mUserAgentIsDirty = PR_TRUE;
     }
 
-    // Gather locale.
-    if (PREF_CHANGED(UA_PREF("locale"))) {
-        nsCOMPtr<nsIPrefLocalizedString> pls;
-        prefs->GetComplexValue(UA_PREF("locale"),
-                                NS_GET_IID(nsIPrefLocalizedString),
-                                getter_AddRefs(pls));
-        if (pls) {
-            nsXPIDLString uval;
-            pls->ToString(getter_Copies(uval));
-            if (uval)
-                mLanguage.Adopt(ToNewUTF8String(nsDependentString(uval)));
-        } 
-        mUserAgentIsDirty = PR_TRUE;
-    }
+    // Set locale.
+    mLanguage.Adopt(nsCRT::strdup("en"));
 
     // general.useragent.override
     if (PREF_CHANGED(UA_PREF("override"))) {
@@ -1380,6 +1349,12 @@
             mReferrerLevel = (PRUint8) CLAMP(val, 0, 0xff);
     }
 
+    if (PREF_CHANGED(HTTP_PREF("referrerSchemeOverride"))) {
+        rv = prefs->GetBoolPref(HTTP_PREF("referrerSchemeOverride"), &cVar);
+        if (NS_SUCCEEDED(rv))
+            mReferrerSchemeOverride = cVar;
+    }
+
     if (PREF_CHANGED(HTTP_PREF("redirection-limit"))) {
         rv = prefs->GetIntPref(HTTP_PREF("redirection-limit"), &val);
         if (NS_SUCCEEDED(rv))
@@ -1410,8 +1385,6 @@
             // it does not make sense to issue a HTTP/0.9 request to a proxy server
         }
     }
-
-    PRBool cVar = PR_FALSE;
 
     if (PREF_CHANGED(HTTP_PREF("keep-alive"))) {
         rv = prefs->GetBoolPref(HTTP_PREF("keep-alive"), &cVar);
Index: netwerk/protocol/http/src/nsHttpHandler.h
===================================================================
RCS file: /cvsroot/mozilla/netwerk/protocol/http/src/nsHttpHandler.h,v
retrieving revision 1.27
diff -u -u -w -r1.27 nsHttpHandler.h
--- netwerk/protocol/http/src/nsHttpHandler.h	19 Apr 2002 22:25:21 -0000	1.27
+++ netwerk/protocol/http/src/nsHttpHandler.h	26 Aug 2002 05:33:03 -0000
@@ -90,6 +90,7 @@
     nsHttpVersion  HttpVersion()             { return mHttpVersion; }
     nsHttpVersion  ProxyHttpVersion()        { return mProxyHttpVersion; }
     PRUint8        ReferrerLevel()           { return mReferrerLevel; }
+    PRBool         ReferrerSchemeOverride()  { return mReferrerSchemeOverride; }
     PRBool         SendSecureXSiteReferrer() { return mSendSecureXSiteReferrer; }
     PRUint8        RedirectionLimit()        { return mRedirectionLimit; }
     PRUint16       IdleTimeout()             { return mIdleTimeout; }
@@ -258,10 +259,11 @@
     //
 
     PRUint8  mHttpVersion;
+    PRUint8  mReferrerLevel;
+    PRPackedBool mReferrerSchemeOverride;
     PRUint8  mProxyHttpVersion;
     PRUint8  mCapabilities;
     PRUint8  mProxyCapabilities;
-    PRUint8  mReferrerLevel;
 
     PRUint16 mIdleTimeout;
     PRUint16 mMaxRequestAttempts;
Index: netwerk/streamconv/converters/mozTXTToHTMLConv.cpp
===================================================================
RCS file: /cvsroot/mozilla/netwerk/streamconv/converters/mozTXTToHTMLConv.cpp,v
retrieving revision 1.59
diff -u -u -w -r1.59 mozTXTToHTMLConv.cpp
--- netwerk/streamconv/converters/mozTXTToHTMLConv.cpp	17 May 2002 23:04:12 -0000	1.59
+++ netwerk/streamconv/converters/mozTXTToHTMLConv.cpp	26 Aug 2002 05:33:03 -0000
@@ -220,7 +220,9 @@
          aInString[PRUint32(i)] == '.'
          ); i--)
       ;
-    if (++i >= 0 && i < pos && nsCRT::IsAsciiAlpha(aInString[PRUint32(i)]))
+    if (++i >= 0
+        && i < PRInt32(pos)
+        && nsCRT::IsAsciiAlpha(aInString[PRUint32(i)]))
     {
       start = PRUint32(i);
       return PR_TRUE;
@@ -243,7 +245,8 @@
       ;
     if
       (
-        ++i >= 0 && i < pos
+        ++i >= 0
+        && i < PRInt32(pos)
           &&
           (
             nsCRT::IsAsciiAlpha(aInString[PRUint32(i)]) ||
@@ -1123,7 +1126,8 @@
 }
 
 void
-mozTXTToHTMLConv::ScanHTML(nsString& aInString, PRUint32 whattodo, nsString &aOutString)
+mozTXTToHTMLConv::ScanHTML(nsString& aInString, PRUint32 whattodo,
+                           nsString &aOutString)
 { 
   // some common variables we were recalculating
   // every time inside the for loop...
@@ -1138,7 +1142,7 @@
   /* Skip all tags ("<[...]>") and content in an a tag ("<a[...]</a>")
      or in a tag ("<!--[...]-->").
      Unescape the rest (text between tags) and pass it to ScanTXT. */
-  for (PRInt32 i = 0; PRUint32(i) < lengthOfInString;)
+  for (PRInt32 i = 0; i < lengthOfInString;)
   {
     if (aInString[i] == '<')  // html tag
     {
Index: netwerk/streamconv/public/mozITXTToHTMLConv.idl
===================================================================
RCS file: /cvsroot/mozilla/netwerk/streamconv/public/mozITXTToHTMLConv.idl,v
retrieving revision 1.4
diff -u -u -w -r1.4 mozITXTToHTMLConv.idl
--- netwerk/streamconv/public/mozITXTToHTMLConv.idl	11 Jan 2002 00:07:36 -0000	1.4
+++ netwerk/streamconv/public/mozITXTToHTMLConv.idl	26 Aug 2002 05:33:03 -0000
@@ -24,7 +24,7 @@
  * License for the specific language governing rights and limitations
  * under the License.
  * 
- * The Original Code is the Text to HTML converter code.
+ * The Original Code is the Mozilla Text to HTML converter code.
  * 
  * The Initial Developer of the Original Code is Ben Bucksch
  * <http://www.bucksch.org>. Portions created by Ben Bucksch are Copyright
Index: profile/defaults/bookmarks.html
===================================================================
RCS file: /cvsroot/mozilla/profile/defaults/bookmarks.html,v
retrieving revision 1.10
diff -u -u -w -r1.10 bookmarks.html
--- profile/defaults/bookmarks.html	2 Nov 2001 03:32:23 -0000	1.10
+++ profile/defaults/bookmarks.html	26 Aug 2002 05:33:04 -0000
@@ -7,66 +7,16 @@
 <H1>Bookmarks</H1>
 
 <DL><p>
-    <DT><H3 ADD_DATE="961112773" LAST_MODIFIED="0" PERSONAL_TOOLBAR_FOLDER="true" ID="NC:PersonalToolbarFolder">Personal Toolbar Folder</H3>
+    <DT><H3 PERSONAL_TOOLBAR_FOLDER="true" ID="NC:PersonalToolbarFolder">Personal Toolbar Folder</H3>
     <DL><p>
-        <DT><A HREF="http://www.mozilla.org/" ADD_DATE="961112911" LAST_VISIT="0" LAST_MODIFIED="0" LAST_CHARSET="ISO-8859-1">mozilla.org</A>
-        <DT><A HREF="http://ftp.mozilla.org/pub/mozilla/nightly/latest/" ADD_DATE="961112935" LAST_VISIT="0" LAST_MODIFIED="0" LAST_CHARSET="ISO-8859-1">Latest Builds</A>
-    </DL><p>
-    <HR>
-    <DT><H3 ADD_DATE="961099767" LAST_MODIFIED="0">Mozilla Project</H3>
-    <DL><p>
-        <DT><H3 ADD_DATE="961099767" LAST_MODIFIED="0" ID="NC:BookmarksRoot#$7a37f5df">mozilla.org</H3>
-        <DL><p>
-            <DT><A HREF="http://www.mozilla.org/" ADD_DATE="961099870" LAST_VISIT="0" LAST_MODIFIED="0" LAST_CHARSET="ISO-8859-1">The Mozilla Organization</A>
-            <DT><A HREF="http://www.mozilla.org/status/" ADD_DATE="961099993" LAST_VISIT="0" LAST_MODIFIED="0" LAST_CHARSET="ISO-8859-1">Weekly Status Update</A>
-            <DT><A HREF="http://www.mozilla.org/feedback.html" ADD_DATE="961100017" LAST_VISIT="0" LAST_MODIFIED="0" LAST_CHARSET="ISO-8859-1">Feedback</A>
-        </DL><p>
-        <DT><H3 ADD_DATE="961102203" LAST_MODIFIED="0" ID="NC:BookmarksRoot#$b742f58">Developer Information</H3>
-        <DL><p>
-            <DT><A HREF="http://www.mozilla.org/get-involved.html" ADD_DATE="961102879">Getting Involved</A>
-            <DT><A HREF="http://www.mozilla.org/docs/" ADD_DATE="961102901">Documentation</A>
-            <DT><A HREF="http://www.mozilla.org/source.html" ADD_DATE="961105505" LAST_VISIT="0" LAST_MODIFIED="0" LAST_CHARSET="ISO-8859-1">Download Source Code</A>
-            <DT><H3 ADD_DATE="961102925" LAST_MODIFIED="0" ID="NC:BookmarksRoot#$b742f59">Standards</H3>
-            <DL><p>
-                <DT><A HREF="http://www.w3c.org/" ADD_DATE="961102978">World Wide Web Consortium</A>
-                <DT><A HREF="http://www.faqs.org/rfcs/" ADD_DATE="961104168">RFC Archive</A>
-            </DL><p>
-            <DT><H3 ADD_DATE="961103100" LAST_MODIFIED="0" ID="NC:BookmarksRoot#$b742f5b">User interface design</H3>
-            <DL><p>
-                <DT><A HREF="http://developer.apple.com/techpubs/mac/HIGuidelines/HIGuidelines-2.html" ADD_DATE="961104987">Macintosh Human Interface Guidelines</A>
-                <DT><A HREF="http://www-3.ibm.com/ibm/easy/eou_ext.nsf/Publish/561" ADD_DATE="961105043">IBM/Ease of Use/Design</A>
-                <DT><A HREF="http://msdn.microsoft.com/ui/" ADD_DATE="961104948">Microsoft User Experience and Interface Design Resources</A>
-                <DT><A HREF="http://developer.kde.org/documentation/standards/kde/style/basics/" ADD_DATE="961105043">KDE User Interface Guidelines</A>
-            </DL><p>
-        </DL><p>
-        <DT><H3 ADD_DATE="961105105" LAST_MODIFIED="0" ID="NC:BookmarksRoot#$b8619366">Webtools</H3>
-        <DL><p>
-            <DT><A HREF="http://lxr.mozilla.org/" ADD_DATE="961105149" LAST_VISIT="0" LAST_MODIFIED="0" LAST_CHARSET="ISO-8859-1">lxr - Mozilla Cross-Reference</A>
-            <DT><A HREF="http://bonsai.mozilla.org/" ADD_DATE="961105218" LAST_MODIFIED="0">bonsai - CVS Tree Control</A>
-            <DT><A HREF="http://tinderbox.mozilla.org/showbuilds.cgi" ADD_DATE="961105359">tinderbox - Tree Status</A>
-            <DT><A HREF="http://bugzilla.mozilla.org/" ADD_DATE="961105401">bugzilla - Bug-Tracking System</A>
-        </DL><p>
-        <DT><H3 ADD_DATE="961111855" LAST_MODIFIED="0" ID="NC:BookmarksRoot#$ebf1a63">Community</H3>
-        <DL><p>
-            <DT><A HREF="http://www.mozilla.org/community.html" ADD_DATE="961111887" LAST_VISIT="0" LAST_MODIFIED="0">Newsgroups</A>
-            <DT><A HREF="http://www.mozillazine.org/" ADD_DATE="961111887" LAST_VISIT="0" LAST_MODIFIED="0" LAST_CHARSET="ISO-8859-1">MozillaZine</A>
-            <DT><A HREF="http://www.mozdev.org/" ADD_DATE="961112176" LAST_VISIT="0" LAST_MODIFIED="0" LAST_CHARSET="ISO-8859-1">Alphanumerica's Mozilla Development Projects</A>
-            <DT><A HREF="http://www.gerbilbox.com/newzilla/" ADD_DATE="961112731">NewZilla - the Unofficial Netscape 6 and Mozilla FAQ</A>
-        </DL><p>
-        <DT><H3 ADD_DATE="961106554" LAST_MODIFIED="0" ID="NC:BookmarksRoot#$ebf1a62">Third-Party Tools</H3>
-        <DL><p>
-            <DT><A HREF="http://aphrodite.mozdev.org/total_recall.html" ADD_DATE="961106831">Crash Recovery - Alphanumerica's Total Recall</A>
-        </DL><p>
-        <DT><H3 ADD_DATE="968309291">Technology Demonstration</H3>
-        <DL><p>
-            <DT><H3 ADD_DATE="916354466">SmartFind queries</H3>
-            <DL><p>
-    	    <DT><A HREF="find:datasource=rdf:bookmarks&match=http://home.netscape.com/NC-rdf#Name&method=contains&text=Mozilla" ADD_DATE="0" LAST_VISIT="0" LAST_MODIFIED="0">Bookmark Names containing 'Mozilla'</A>
-    	    <DT><A HREF="find:datasource=rdf:bookmarks&match=http://home.netscape.com/NC-rdf#Name&method=startswith&text=M" ADD_DATE="0" LAST_VISIT="0" LAST_MODIFIED="0">Bookmark Names starting with 'M'</A>
-    	    <DT><A HREF="find:datasource=rdf:bookmarks&match=http://home.netscape.com/NC-rdf#Name&method=endswith&text=Reference" ADD_DATE="0" LAST_VISIT="0" LAST_MODIFIED="0">Bookmark Names ending with 'Reference'</A>
-    	    <DT><A HREF="find:datasource=rdf:bookmarks&match=http://home.netscape.com/NC-rdf#URL&method=contains&text=.org" ADD_DATE="0" LAST_VISIT="0" LAST_MODIFIED="0">Bookmark URLs containing '.org'</A>
-            </DL><p>
-        </DL><p>
+        <DT><A HREF="http://www.beonex.com">Beonex</A>
     </DL><p>
     <HR>
+<!--
+    <DT><A HREF="http://www.beonex.com/communicator/version/0.9/release-notes/security-alert/latest" ADD_DATE="994541583" LAST_MODIFIED="994541824" SCHEDULE="0123456|0-24|1440|icon,sound,open" LAST_PING="994541639" PING_ETAG=""122824-512-3b42dbcb"" PING_LAST_MODIFIED="Wed, 04 Jul 2001 09:03:07 GMT" LAST_CHARSET="ISO-8859-1" PING_CONTENT_LEN="1298">Beonex Communicator Security Alert</A>
+<DD>This bookmark notifies you when
+Beonex releases a new security alert.
+See the &quot;Disable&quot; link on that page
+for more information.
+-->
 </DL><p>
Index: profile/defaults/localstore.rdf
===================================================================
RCS file: /cvsroot/mozilla/profile/defaults/localstore.rdf,v
retrieving revision 1.14
diff -u -u -w -r1.14 localstore.rdf
--- profile/defaults/localstore.rdf	19 Feb 2002 21:20:30 -0000	1.14
+++ profile/defaults/localstore.rdf	26 Aug 2002 05:33:04 -0000
@@ -1,107 +1,254 @@
 <?xml version="1.0"?>
-<RDF:RDF
-     xmlns:NC="http://home.netscape.com/NC-rdf#"
+<RDF:RDF xmlns:NC="http://home.netscape.com/NC-rdf#"
      xmlns:RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
-  <RDF:Description about="chrome://messenger/content/messenger.xul#flaggedCol">
-    <hidden>true</hidden>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/messenger.xul#unreadCol">
-    <hidden>true</hidden>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/messenger.xul#totalCol">
-    <hidden>true</hidden>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/messenger.xul#OrderReceivedColumn">
-    <hidden>true</hidden>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/messenger.xul#statusCol">
-    <hidden>true</hidden>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/messenger.xul#sizeCol">
-    <hidden>true</hidden>
+  <RDF:Description about="chrome://navigator/content/navigator.xul#main-window"
+                   sizemode="normal" />
+  <RDF:Description about="chrome://editor/content/editor.xul#editorWindow"
+                   sizemode="normal" />
+  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#addressbookWindow"
+                   sizemode="normal" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#messengerWindow"
+                   sizemode="normal" />
+  <RDF:Description about="chrome://chatzilla/content/chatzilla.xul#chatzilla-window" />
+  <RDF:Description about="chrome://messenger/content/AccountWizard.xul#AccountWizard" />
+
+<!--what's above is hand-edited -->
+
+  <RDF:Description about="chrome://navigator/content/navigator.xul">
+    <NC:persist resource="chrome://navigator/content/navigator.xul#print-button"/>
+    <NC:persist resource="chrome://navigator/content/navigator.xul#main-window"/>
+    <NC:persist resource="chrome://navigator/content/navigator.xul#PersonalToolbar"/>
+    <NC:persist resource="chrome://navigator/content/navigator.xul#cmd_viewpersonaltoolbar"/>
+    <NC:persist resource="chrome://navigator/content/navigator.xul#sidebar-panels"/>
+    <NC:persist resource="chrome://navigator/content/navigator.xul#sidebar-splitter"/>
+    <NC:persist resource="chrome://navigator/content/navigator.xul#sidebar-box"/>
+    <NC:persist resource="chrome://navigator/content/navigator.xul#sidebar-title-box"/>
+    <NC:persist resource="chrome://navigator/content/navigator.xul#sidebar-panels-splitter-box"/>
+    <NC:persist resource="chrome://navigator/content/navigator.xul#bookmarks-button"/>
+    <NC:persist resource="chrome://navigator/content/navigator.xul#linktoolbar"/>
+  </RDF:Description>
+  <RDF:Description about="chrome://messenger/content/messenger.xul#statusCol"
+                   hidden="true"
+                   ordinal="13" />
+  <RDF:Description about="chrome://messenger/content/AccountWizard.xul">
+    <NC:persist resource="chrome://messenger/content/AccountWizard.xul#AccountWizard"/>
+  </RDF:Description>
+  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#FaxNumber"
+                   ordinal="13"
+                   hidden="true" />
+  <RDF:Description about="chrome://editor/content/editor.xul#taskbar"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/messengercompose/messengercompose.xul#menu_showTaskbar"
+                   checked="false" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#subjectCol"
+                   ordinal="5" />
+  <RDF:Description about="chrome://messenger/content/messageWindow.xul#taskbar"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#menu_showTaskbar"
+                   checked="false" />
+  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#WorkPhone"
+                   ordinal="5" />
+  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#abResultsOutliner"
+                   height="94" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#labelCol"
+                   hidden="true"
+                   ordinal="19" />
+  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#CellularNumber"
+                   ordinal="17"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/messengercompose/messengercompose.xul">
+    <NC:persist resource="chrome://messenger/content/messengercompose/messengercompose.xul#taskbar"/>
+    <NC:persist resource="chrome://messenger/content/messengercompose/messengercompose.xul#menu_showTaskbar"/>
+  </RDF:Description>
+  <RDF:Description about="chrome://messenger/content/messenger.xul#taskbar"
+                   hidden="true" />
+  <RDF:Description about="chrome://editor/content/editor.xul#sidebar-title-box"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#Company"
+                   ordinal="7" />
+  <RDF:Description about="chrome://navigator/content/navigator.xul#bookmarks-button"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#sidebar-title-box"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/messageWindow.xul">
+    <NC:persist resource="chrome://messenger/content/messageWindow.xul#taskbar"/>
+    <NC:persist resource="chrome://messenger/content/messageWindow.xul#menu_showTaskbar"/>
+  </RDF:Description>
+  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#sidebar-panels-splitter-box"
+                   hidden="true" />
+  <RDF:Description about="chrome://editor/content/editor.xul#sidebar-panels-splitter-box"
+                   hidden="true" />
+  <RDF:Description about="chrome://navigator/content/navigator.xul#sidebar-box"
+                   state="open"
+                   hidden="true"
+                   width="190" />
+  <RDF:Description about="chrome://navigator/content/navigator.xul#component-bar"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#priorityCol"
+                   ordinal="21" />
+  <RDF:Description about="chrome://navigator/content/navigator.xul#cmd_viewcomponentbar"
+                   checked="false" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#OrderReceivedColumn"
+                   hidden="true" />
+  <RDF:Description about="chrome://navigator/content/navigator.xul#linktoolbar"
+                   hidden="maybe" />
+  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#SecondEmail"
+                   ordinal="19"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#totalCol"
+                   hidden="true"
+                   ordinal="25" />
+  <RDF:Description about="chrome://chatzilla/content/chatzilla.xul">
+    <NC:persist resource="chrome://chatzilla/content/chatzilla.xul#chatzilla-window"/>
+  </RDF:Description>
+  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#HomePhone"
+                   ordinal="11"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#flaggedCol"
+                   hidden="true"
+                   ordinal="17" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#unreadCol"
+                   hidden="true"
+                   ordinal="23" />
+  <RDF:Description about="chrome://navigator/content/navigator.xul#sidebar-splitter"
+                   state="open"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#GeneratedName"
+                   ordinal="1" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#senderOrRecipientCol"
+                   ordinal="7" />
+  <RDF:Description about="mailbox://browser@etzu"
+                   open="true" />
+  <RDF:Description about="chrome://navigator/content/navigator.xul#sidebar-panels"
+                   last-selected-panel="urn:sidebar:panel:search" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#StatusColumn"
+                   hidden="true" />
+  <RDF:Description about="chrome://navigator/content/navigator.xul#PersonalToolbar"
+                   hidden="true" />
+  <RDF:Description about="chrome://editor/content/editor.xul#sidebar-splitter"
+                   hidden="true" />
+  <RDF:Description about="chrome://navigator/content/navigator.xul#cmd_viewpersonaltoolbar"
+                   checked="false" />
+  <RDF:Description about="chrome://navigator/content/navigator.xul#status-bar"
+                   hidden="false" />
+  <RDF:Description about="chrome://editor/content/editor.xul">
+    <NC:persist resource="chrome://editor/content/editor.xul#sidebar-panels"/>
+    <NC:persist resource="chrome://editor/content/editor.xul#main-window"/>
+    <NC:persist resource="chrome://editor/content/editor.xul#sidebar-box"/>
+    <NC:persist resource="chrome://editor/content/editor.xul#sidebar-splitter"/>
+    <NC:persist resource="chrome://editor/content/editor.xul#sidebar-title-box"/>
+    <NC:persist resource="chrome://editor/content/editor.xul#sidebar-panels-splitter-box"/>
+    <NC:persist resource="chrome://editor/content/editor.xul#taskbar"/>
+    <NC:persist resource="chrome://editor/content/editor.xul#cmd_viewtaskbar"/>
+    <NC:persist resource="chrome://editor/content/editor.xul#editorWindow"/>
   </RDF:Description>
   <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul">
-    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#abResultsOutliner"/>
-    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#sidebar-panels-splitter-box"/>
+    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#sidebar-panels"/>
+    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#addressbookWindow"/>
     <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#sidebar-title-box"/>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#abResultsOutliner" height="94" />
-  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#sidebar-panels-splitter-box">
-    <collapsed>true</collapsed>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#sidebar-title-box">
-    <hidden>true</hidden>
-  </RDF:Description>
+    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#sidebar-panels-splitter-box"/>
+    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#sidebar-box"/>
+    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#taskbar"/>
+    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#menu_showTaskbar"/>
+    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#abResultsOutliner"/>
+    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#GeneratedName"/>
+    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#PrimaryEmail"/>
+    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#WorkPhone"/>
+    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#Company"/>
+    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#NickName"/>
+    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#HomePhone"/>
+    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#FaxNumber"/>
+    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#PagerNumber"/>
+    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#CellularNumber"/>
+    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#SecondEmail"/>
+    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#JobTitle"/>
+    <NC:persist resource="chrome://messenger/content/addressbook/addressbook.xul#Department"/>
+  </RDF:Description>
+  <RDF:Description about="chrome://messenger/content/messageWindow.xul#menu_showTaskbar"
+                   checked="false" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#dateCol"
+                   ordinal="11" />
+  <RDF:Description about="chrome://messenger/content/messengercompose/messengercompose.xul#taskbar"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#threadCol"
+                   ordinal="1" />
+  <RDF:Description about="chrome://navigator/content/navigator.xul#cmd_viewtaskbar"
+                   checked="false" />
+  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#JobTitle"
+                   ordinal="21"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#PrimaryEmail"
+                   ordinal="3" />
+  <RDF:Seq about="nc:urlbar-history">
+  </RDF:Seq>
+  <RDF:Description about="chrome://messenger/content/messenger.xul#folderTotalCol"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#PagerNumber"
+                   ordinal="15"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#sidebar-panels-splitter-box"
+                   height="288"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#Department"
+                   ordinal="23"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#sidebar-title-box"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#NickName"
+                   ordinal="9"
+                   hidden="true" />
+  <RDF:Description about="chrome://navigator/content/navigator.xul#print-button"
+                   hidden="true" />
   <RDF:Description about="chrome://messenger/content/messenger.xul">
-    <NC:persist resource="chrome://messenger/content/messenger.xul#statusCol"/>
-    <NC:persist resource="chrome://messenger/content/messenger.xul#sizeCol"/>
-    <NC:persist resource="chrome://messenger/content/messenger.xul#unreadCol"/>
-    <NC:persist resource="chrome://messenger/content/messenger.xul#totalCol"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#StatusColumn"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#SizeColumn"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#UnreadColumn"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#TotalColumn"/>
     <NC:persist resource="chrome://messenger/content/messenger.xul#OrderReceivedColumn"/>
-    <NC:persist resource="chrome://messenger/content/messenger.xul#flaggedCol"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#FlaggedButtonColumn"/>
     <NC:persist resource="chrome://messenger/content/messenger.xul#messengerWindow"/>
     <NC:persist resource="chrome://messenger/content/messenger.xul#sidebar-panels"/>
     <NC:persist resource="chrome://messenger/content/messenger.xul#sidebar-panels-splitter-box"/>
-    <NC:persist resource="chrome://messenger/content/messenger.xul#threadOutliner"/>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/messenger.xul#messengerWindow">
-    <screenX>4</screenX>
-    <screenY>4</screenY>
-    <width>632</width>
-    <height>450</height>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/messenger.xul#sidebar-panels">
-    <last-selected-panel>urn:sidebar:panel:bookmarks</last-selected-panel>
-    <hidden>true</hidden>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/messenger.xul#sidebar-panels-splitter-box">
-    <height>288</height>
-    <hidden>true</hidden>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/messenger.xul#threadOutliner" height="94" />
-  <RDF:Description about="chrome://messenger/content/mail3PaneWindowVertLayout.xul">
-    <NC:persist resource="chrome://messenger/content/mail3PaneWindowVertLayout.xul#sidebar-panels-splitter-box"/>
-    <NC:persist resource="chrome://messenger/content/mail3PaneWindowVertLayout.xul#sidebar-panels"/>
-    <NC:persist resource="chrome://messenger/content/mail3PaneWindowVertLayout.xul#threadOutliner"/>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/mail3PaneWindowVertLayout.xul#sidebar-panels-splitter-box">
-    <hidden>true</hidden>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/mail3PaneWindowVertLayout.xul#sidebar-panels">
-    <hidden>true</hidden>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/mail3PaneWindowVertLayout.xul#threadOutliner" height="94" />
-  <RDF:Description about="chrome://navigator/content/navigator.xul#sidebar-panels">
-    <last-selected-panel>urn:sidebar:panel:bookmarks</last-selected-panel>
-  </RDF:Description>
-  <RDF:Description about="chrome://navigator/content/navigator.xul">
-    <NC:persist resource="chrome://navigator/content/navigator.xul#sidebar-panels"/>
-  </RDF:Description>
-
-  <RDF:Description about="chrome://messenger/content/mail3PaneWindowVertLayout.xul#flaggedCol">
-    <hidden>true</hidden>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/mail3PaneWindowVertLayout.xul#unreadCol">
-    <hidden>true</hidden>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/mail3PaneWindowVertLayout.xul#totalCol">
-    <hidden>true</hidden>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/mail3PaneWindowVertLayout.xul#OrderReceivedColumn">
-    <hidden>true</hidden>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/mail3PaneWindowVertLayout.xul#statusCol">
-    <hidden>true</hidden>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/mail3PaneWindowVertLayout.xul#sizeCol">
-    <hidden>true</hidden>
-  </RDF:Description>
-  <RDF:Description about="chrome://messenger/content/mail3PaneWindowVertLayout.xul">
-    <NC:persist resource="chrome://messenger/content/mail3PaneWindowVertLayout.xul#statusCol"/>
-    <NC:persist resource="chrome://messenger/content/mail3PaneWindowVertLayout.xul#sizeCol"/>
-    <NC:persist resource="chrome://messenger/content/mail3PaneWindowVertLayout.xul#unreadCol"/>
-    <NC:persist resource="chrome://messenger/content/mail3PaneWindowVertLayout.xul#totalCol"/>
-    <NC:persist resource="chrome://messenger/content/mail3PaneWindowVertLayout.xul#OrderReceivedColumn"/>
-    <NC:persist resource="chrome://messenger/content/mail3PaneWindowVertLayout.xul#flaggedCol"/>
-  </RDF:Description>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#sidebar-title-box"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#sidebar-box"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#taskbar"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#menu_showTaskbar"/>
+    <NC:persist resource="mailbox://browser@etzu"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#totalCol"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#unreadCol"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#statusCol"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#flaggedCol"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#threadCol"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#subjectCol"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#senderOrRecipientCol"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#unreadButtonColHeader"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#dateCol"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#sizeCol"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#labelCol"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#priorityCol"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#folderUnreadCol"/>
+    <NC:persist resource="chrome://messenger/content/messenger.xul#folderTotalCol"/>
+  </RDF:Description>
+  <RDF:Description about="chrome://messenger/content/messenger.xul#unreadButtonColHeader"
+                   ordinal="9" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#TotalColumn"
+                   hidden="true" />
+  <RDF:Description about="chrome://editor/content/editor.xul#cmd_viewtaskbar"
+                   checked="false" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#sizeCol"
+                   ordinal="15" />
+  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#taskbar"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#UnreadColumn"
+                   hidden="true" />
+  <RDF:Description about="chrome://editor/content/editor.xul#sidebar-box"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#folderUnreadCol"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/addressbook/addressbook.xul#menu_showTaskbar"
+                   checked="false" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#FlaggedButtonColumn"
+                   hidden="true" />
+  <RDF:Description about="chrome://messenger/content/messenger.xul#SizeColumn"
+                   hidden="true" />
 </RDF:RDF>
Index: profile/defaults/panels.rdf
===================================================================
RCS file: /cvsroot/mozilla/profile/defaults/panels.rdf,v
retrieving revision 1.17
diff -u -u -w -r1.17 panels.rdf
--- profile/defaults/panels.rdf	18 Jun 2001 20:56:12 -0000	1.17
+++ profile/defaults/panels.rdf	26 Aug 2002 05:33:04 -0000
@@ -13,31 +13,16 @@
   <RDF:Description about="urn:sidebar:current-panel-list">
     <NC:panel-list>
       <RDF:Seq>
-        <RDF:li resource="urn:sidebar:panel:whats-related"/>
         <RDF:li resource="urn:sidebar:panel:search"/>
-        <RDF:li resource="urn:sidebar:panel:tinderbox"/>
-        <RDF:li resource="urn:sidebar:panel:tinderbox-ports"/>
         <RDF:li resource="urn:sidebar:panel:bookmarks"/>
         <RDF:li resource="urn:sidebar:panel:history"/>
       </RDF:Seq>
     </NC:panel-list>
     <NC:version>0.1</NC:version>
   </RDF:Description>
-  <RDF:Description about="urn:sidebar:panel:whats-related">
-    <NC:title>&sidebar.whats-related.label;</NC:title>
-    <NC:content>chrome://communicator/content/related/related-panel.xul</NC:content>
-  </RDF:Description>
   <RDF:Description about="urn:sidebar:panel:search">
     <NC:title>&sidebar.search.label;</NC:title>
     <NC:content>chrome://communicator/content/search/search-panel.xul</NC:content>
-  </RDF:Description>
-  <RDF:Description about="urn:sidebar:panel:tinderbox">
-    <NC:title>&sidebar.tinderbox-seamonkey.label;</NC:title>
-    <NC:content>http://tinderbox.mozilla.org/SeaMonkey/panel.html</NC:content>
-  </RDF:Description>
-  <RDF:Description about="urn:sidebar:panel:tinderbox-ports">
-    <NC:title>&sidebar.tinderbox-ports.label;</NC:title>
-    <NC:content>http://tinderbox.mozilla.org/SeaMonkey-Ports/panel.html</NC:content>
   </RDF:Description>
   <RDF:Description about="urn:sidebar:panel:bookmarks">
     <NC:title>&sidebar.client-bookmarks.label;</NC:title>
Index: profile/defaults/search.rdf
===================================================================
RCS file: /cvsroot/mozilla/profile/defaults/search.rdf,v
retrieving revision 1.7
diff -u -u -w -r1.7 search.rdf
--- profile/defaults/search.rdf	26 Oct 2000 00:17:22 -0000	1.7
+++ profile/defaults/search.rdf	26 Aug 2002 05:33:04 -0000
@@ -23,8 +23,9 @@
 
 <!DOCTYPE RDF 
 [
-<!ENTITY search.category.mozilla	"Mozilla">
+<!ENTITY search.category.news	        "News">
 <!ENTITY search.category.web		"Web">
+<!ENTITY search.category.special	"Specialized">
 ]
 >
 
@@ -38,8 +39,12 @@
 
   <RDF:Seq about="NC:SearchCategoryRoot">
   	<RDF:li>
+  		<RDF:Description about="urn:search:category:3">
+			<NC:title>&search.category.special;</NC:title>
+  		</RDF:Description>
+
   		<RDF:Description about="urn:search:category:2">
-			<NC:title>&search.category.mozilla;</NC:title>
+			<NC:title>&search.category.news;</NC:title>
   		</RDF:Description>
 
   		<RDF:Description about="urn:search:category:1">
@@ -53,15 +58,18 @@
 
 
   <RDF:Seq about="NC:SearchCategory?category=urn:search:category:1">
-  	<RDF:li resource="NC:SearchCategory?engine=urn:search:engine:NetscapeSearch.src" />
-    <RDF:li resource="NC:SearchCategory?engine=urn:search:engine:google.src" />
   	<RDF:li resource="NC:SearchCategory?engine=urn:search:engine:dmoz.src" />
+        <RDF:li resource="NC:SearchCategory?engine=urn:search:engine:google.src" />
+        <RDF:li resource="NC:SearchCategory?engine=urn:search:engine:Excite.src" />
+        <RDF:li resource="NC:SearchCategory?engine=urn:search:engine:Lycos.src" />
+        <RDF:li resource="NC:SearchCategory?engine=urn:search:engine:HotBot.src" />
   </RDF:Seq>
-
-  <RDF:Seq about="NC:SearchCategory?category=urn:search:category:2">
-  	<RDF:li resource="NC:SearchCategory?engine=urn:search:engine:mozilla.src" />
-  	<RDF:li resource="NC:SearchCategory?engine=urn:search:engine:bugzilla.src" />
-  	<RDF:li resource="NC:SearchCategory?engine=urn:search:engine:lxrmozilla.src" />
+  <RDF:Seq about="NC:SearchCategory?category=urn:search:category:3">
+  	<RDF:li resource="NC:SearchCategory?engine=urn:search:engine:ICQ.src" />
+  	<RDF:li resource="NC:SearchCategory?engine=urn:search:engine:monster.src" />
+  	<RDF:li resource="NC:SearchCategory?engine=urn:search:engine:eBay.src" />
+  	<RDF:li resource="NC:SearchCategory?engine=urn:search:engine:dictionary.src" />
+  	<RDF:li resource="NC:SearchCategory?engine=urn:search:engine:thesaurus.src" />
   </RDF:Seq>
 
 </RDF:RDF>
Index: profile/resources/content/confirmMigration.xul
===================================================================
RCS file: /cvsroot/mozilla/profile/resources/content/confirmMigration.xul,v
retrieving revision 1.13
diff -u -u -w -r1.13 confirmMigration.xul
--- profile/resources/content/confirmMigration.xul	3 Nov 2001 16:46:10 -0000	1.13
+++ profile/resources/content/confirmMigration.xul	26 Aug 2002 05:33:04 -0000
@@ -1,6 +1,7 @@
 <?xml version="1.0"?> 
 
 
+<?xml-stylesheet href="chrome://communicator/skin/" type="text/css"?>
 <?xml-stylesheet href="chrome://communicator/skin/profile/profile.css" type="text/css"?>
 <?xul-overlay href="chrome://global/content/dialogOverlay.xul"?>
 
Index: profile/resources/locale/en-US/profileSelection.dtd
===================================================================
RCS file: /cvsroot/mozilla/profile/resources/locale/en-US/profileSelection.dtd,v
retrieving revision 1.12
diff -u -u -w -r1.12 profileSelection.dtd
--- profile/resources/locale/en-US/profileSelection.dtd	22 Nov 2001 02:28:34 -0000	1.12
+++ profile/resources/locale/en-US/profileSelection.dtd	26 Aug 2002 05:33:04 -0000
@@ -41,7 +41,7 @@
 
 <!ENTITY            manageprofiles.label  "Manage Profiles">
 
-<!ENTITY            start.label           "Start &vendorShortName;">
+<!ENTITY            start.label           "Start &brandShortName;">
 <!ENTITY            exit.label            "Exit">
 <!ENTITY            manage.label          "Manage Profiles...">
 
Index: security/nss/cmd/modutil/specification.html
===================================================================
RCS file: /cvsroot/mozilla/security/nss/cmd/modutil/specification.html,v
retrieving revision 1.1
diff -u -u -w -r1.1 specification.html
--- security/nss/cmd/modutil/specification.html	31 Mar 2000 20:09:13 -0000	1.1
+++ security/nss/cmd/modutil/specification.html	26 Aug 2002 05:33:06 -0000
@@ -139,7 +139,7 @@
 otherwise, the password will be obtained interactively.
 <b>Storing passwords in a file is much less secure than supplying them
 interactively.</b>
-<p>The password on the Netscape internal module cannot be changed if
+<p>The password on the NSS internal module cannot be changed if
 the <code>-nocertdb</code> option is specified.
 </td>
 </tr>
@@ -240,7 +240,7 @@
 
 Listing of PKCS #11 Modules
 -----------------------------------------------------------
-  1. Netscape Internal PKCS #11 Module
+  1. NSS Internal PKCS #11 Module
          slots: 2 slots attached
         status: loaded
 
@@ -256,13 +256,13 @@
 and its slots and tokens.
 <blockquote>
 <pre>
-% <b>modutil -list "Netscape Internal PKCS #11 Module"</b>
+% <b>modutil -list "NSS Internal PKCS #11 Module"</b>
 Using database directory /u/nicolson/.netscape...
 
 -----------------------------------------------------------
-Name: Netscape Internal PKCS #11 Module
+Name: NSS Internal PKCS #11 Module
 Library file: **Internal ONLY module**
-Manufacturer: Netscape Communications Corp    
+Manufacturer: mozilla.org
 Description: Communicator Internal Crypto Svc
 PKCS #11 Version 2.0
 Library Version: 4.0
@@ -270,13 +270,13 @@
 Default Mechanism Flags: RSA:DSA:RC2:RC4:DES:SHA1:MD5:MD2
 
   Slot: Communicator Internal Cryptographic Services Version 4.0
-  Manufacturer: Netscape Communications Corp    
+  Manufacturer: mozilla.org
   Type: Software
   Version Number: 4.1
   Firmware Version: 0.0
   Status: Enabled
   Token Name: Communicator Generic Crypto Svcs
-  Token Manufacturer: Netscape Communications Corp    
+  Token Manufacturer: mozilla.org
   Token Model: Libsec 4.0      
   Token Serial Number: 0000000000000000
   Token Version: 4.0
@@ -286,13 +286,13 @@
   User Pin: NOT Initialized
 
   Slot: Communicator User Private Key and Certificate Services
-  Manufacturer: Netscape Communications Corp    
+  Manufacturer: mozilla.org
   Type: Software
   Version Number: 3.0
   Firmware Version: 0.0
   Status: Enabled
   Token Name: Communicator Certificate DB     
-  Token Manufacturer: Netscape Communications Corp    
+  Token Manufacturer: mozilla.org
   Token Model: Libsec 4.0      
   Token Serial Number: 0000000000000000
   Token Version: 7.0
@@ -340,7 +340,7 @@
 With the <code>-create</code> command, this means that only a secmod.db file
 will be created; cert7.db and key3.db will not be created.  With the
 <code>-jar</code> command, signatures on the JAR file will not be checked.
-With the <code>-changepw</code> command, the password on the Netscape internal 
+With the <code>-changepw</code> command, the password on the NSS internal 
 module cannot be set or changed, since this password is stored in key3.db.
 </td>
 </tr>
Index: security/nss/lib/softoken/pkcs11.c
===================================================================
RCS file: /cvsroot/mozilla/security/nss/lib/softoken/pkcs11.c,v
retrieving revision 1.45.2.1
diff -u -u -w -r1.45.2.1 pkcs11.c
--- security/nss/lib/softoken/pkcs11.c	23 May 2002 13:56:30 -0000	1.45.2.1
+++ security/nss/lib/softoken/pkcs11.c	26 Aug 2002 05:33:08 -0000
@@ -2046,7 +2046,7 @@
 	 "NSS User Private Key and Certificate Services                   ";
     case FIPS_SLOT_ID:
         return 
-         "Netscape FIPS-140-1 User Private Key Services                   ";
+         "NSS FIPS-140-1 User Private Key Services                        ";
     default:
 	break;
     }
Index: themes/Makefile.in
===================================================================
RCS file: /cvsroot/mozilla/themes/Makefile.in,v
retrieving revision 1.5
diff -u -u -w -r1.5 Makefile.in
--- themes/Makefile.in	11 Apr 2001 03:32:13 -0000	1.5
+++ themes/Makefile.in	26 Aug 2002 05:33:08 -0000
@@ -28,5 +28,8 @@
 
 DIRS		= classic modern 
 
-include $(topsrcdir)/config/rules.mk
 
+#default-theme:
+#	echo "skin,install,select,modern/1.0" >> $(DIST)/bin/chrome/installed-chrome.txt
+
+include $(topsrcdir)/config/rules.mk
Index: themes/makefile.win
===================================================================
RCS file: /cvsroot/mozilla/themes/Attic/makefile.win,v
retrieving revision 1.6
diff -u -u -w -r1.6 makefile.win
--- themes/makefile.win	11 Apr 2001 03:32:13 -0000	1.6
+++ themes/makefile.win	26 Aug 2002 05:33:08 -0000
@@ -25,6 +25,6 @@
 
 include <$(DEPTH)\config\rules.mak>
 
-# choose Classic skin as default
+# choose Modern skin as default
 chrome::
-    echo skin,install,select,classic/1.0 >>$(DIST)\bin\chrome\installed-chrome.txt
+    echo skin,install,select,modern/1.0 >>$(DIST)\bin\chrome\installed-chrome.txt
Index: themes/classic/communicator/brand/throbber-anim.gif
===================================================================
RCS file: /cvsroot/mozilla/themes/classic/communicator/brand/throbber-anim.gif,v
retrieving revision 1.1
diff -u -u -w -r1.1 throbber-anim.gif
Binary files /tmp/cvsCvs1N_ and throbber-anim.gif differ
Index: themes/classic/communicator/brand/throbber-single.gif
===================================================================
RCS file: /cvsroot/mozilla/themes/classic/communicator/brand/throbber-single.gif,v
retrieving revision 1.1
diff -u -u -w -r1.1 throbber-single.gif
Binary files /tmp/cvsW7q16_ and throbber-single.gif differ
Index: themes/modern/communicator/brand/throbber-anim.gif
===================================================================
RCS file: /cvsroot/mozilla/themes/modern/communicator/brand/throbber-anim.gif,v
retrieving revision 1.2
diff -u -u -w -r1.2 throbber-anim.gif
Binary files /tmp/cvsjvYnA_ and throbber-anim.gif differ
Index: themes/modern/communicator/brand/throbber-single.gif
===================================================================
RCS file: /cvsroot/mozilla/themes/modern/communicator/brand/throbber-single.gif,v
retrieving revision 1.2
diff -u -u -w -r1.2 throbber-single.gif
Binary files /tmp/cvsxGU1l_ and throbber-single.gif differ
Index: themes/modern/messenger/messageBody.css
===================================================================
RCS file: /cvsroot/mozilla/themes/modern/messenger/messageBody.css,v
retrieving revision 1.6
diff -u -u -w -r1.6 messageBody.css
--- themes/modern/messenger/messageBody.css	16 May 2002 19:19:44 -0000	1.6
+++ themes/modern/messenger/messageBody.css	26 Aug 2002 05:33:09 -0000
@@ -49,7 +49,7 @@
   overflow: auto;
 }
 
-html|html {
+html|html, body {
   /* XXX Doesn't seem to work. (Same with "html|body".) */
   background-color: white;
 }
Index: widget/src/gtk/mozicon.xpm
===================================================================
RCS file: /cvsroot/mozilla/widget/src/gtk/mozicon.xpm,v
retrieving revision 1.1
diff -u -u -w -r1.1 mozicon.xpm
--- widget/src/gtk/mozicon.xpm	21 Nov 1998 21:49:17 -0000	1.1
+++ widget/src/gtk/mozicon.xpm	26 Aug 2002 05:33:14 -0000
@@ -1,292 +1,396 @@
 /* XPM */
-static char * mozilla_icon_xpm[] = {
-"32 32 257 2",
+static char * mozicon_xpm[] = {
+"28 32 361 2",
 "  	c None",
-". 	c #AA7303",
-"+ 	c #A67003",
-"@ 	c #B77C03",
-"# 	c #8D6003",
-"$ 	c #8D6004",
-"% 	c #6C4A04",
-"& 	c #3A2804",
-"* 	c #6B4802",
-"= 	c #9B6903",
-"- 	c #5A2C04",
-"; 	c #411B04",
-"> 	c #9D6A03",
-", 	c #7A5203",
-"' 	c #510D04",
-") 	c #6B1104",
-"! 	c #7D5503",
-"~ 	c #674604",
-"{ 	c #C21E04",
-"] 	c #C21D04",
-"^ 	c #523804",
-"/ 	c #513702",
-"( 	c #552904",
-"_ 	c #DD2204",
-": 	c #DF2204",
-"< 	c #582904",
-"[ 	c #5F3F02",
-"} 	c #6B2504",
-"| 	c #FE2604",
-"1 	c #AB7303",
-"2 	c #9B6904",
-"3 	c #C31F04",
-"4 	c #FE2704",
-"5 	c #A81904",
-"6 	c #926304",
-"7 	c #4D3302",
-"8 	c #483104",
-"9 	c #C61E04",
-"0 	c #B11B04",
-"a 	c #891604",
-"b 	c #761204",
-"c 	c #614304",
-"d 	c #775102",
-"e 	c #795102",
-"f 	c #785102",
-"g 	c #C58603",
-"h 	c #642404",
-"i 	c #B21A04",
-"j 	c #1F0604",
-"k 	c #550E04",
-"l 	c #631004",
-"m 	c #402404",
-"n 	c #AF7703",
-"o 	c #3D2902",
-"p 	c #7F5602",
-"q 	c #805604",
-"r 	c #0C0904",
-"s 	c #080604",
-"t 	c #080706",
-"u 	c #090604",
-"v 	c #060404",
-"w 	c #620F04",
-"x 	c #7A1304",
-"y 	c #030204",
-"z 	c #570E04",
-"A 	c #721204",
-"B 	c #270704",
-"C 	c #080504",
-"D 	c #0A0604",
-"E 	c #533804",
-"F 	c #A56F02",
-"G 	c #B87C03",
-"H 	c #3B2804",
-"I 	c #A51904",
-"J 	c #FC2704",
-"K 	c #D62004",
-"L 	c #691004",
-"M 	c #C01E04",
-"N 	c #6D1004",
-"O 	c #9C1804",
-"P 	c #B31C04",
-"Q 	c #150404",
-"R 	c #801404",
-"S 	c #DD2304",
-"T 	c #120404",
-"U 	c #130404",
-"V 	c #500C04",
-"W 	c #CC1E04",
-"X 	c #AA1A04",
-"Y 	c #100904",
-"Z 	c #B47A03",
-"` 	c #A77103",
-" .	c #513704",
-"..	c #891704",
-"+.	c #F62604",
-"@.	c #BA1D04",
-"#.	c #3C0A04",
-"$.	c #EB2304",
-"%.	c #DE2304",
-"&.	c #560E04",
-"*.	c #E82304",
-"=.	c #FE2804",
-"-.	c #BE1D04",
-";.	c #F12404",
-">.	c #661004",
-",.	c #020204",
-"'.	c #5E0F04",
-").	c #A61A04",
-"!.	c #4A3204",
-"~.	c #BC7E03",
-"{.	c #8E6002",
-"].	c #684604",
-"^.	c #390D04",
-"/.	c #EE2404",
-"(.	c #FE2904",
-"_.	c #7D1304",
-":.	c #8C1504",
-"<.	c #200604",
-"[.	c #A81A04",
-"}.	c #E72204",
-"|.	c #DA2004",
-"1.	c #070204",
-"2.	c #280704",
-"3.	c #543904",
-"4.	c #9F6C02",
-"5.	c #674602",
-"6.	c #B47B04",
-"7.	c #311004",
-"8.	c #B11C04",
-"9.	c #AA1B04",
-"0.	c #6A1104",
-"a.	c #801504",
-"b.	c #2B0704",
-"c.	c #09090A",
-"d.	c #450B04",
-"e.	c #360904",
-"f.	c #DC2204",
-"g.	c #EE2504",
-"h.	c #C11D04",
-"i.	c #6F1104",
-"j.	c #704B04",
-"k.	c #9C6902",
-"l.	c #A56F03",
-"m.	c #5F4004",
-"n.	c #8D1604",
-"o.	c #440A04",
-"p.	c #1A0504",
-"q.	c #931604",
-"r.	c #621004",
-"s.	c #7F1404",
-"t.	c #921704",
-"u.	c #F82504",
-"v.	c #F52504",
-"w.	c #981804",
-"x.	c #241804",
-"y.	c #5B3E04",
-"z.	c #D82204",
-"A.	c #D02004",
-"B.	c #DA2104",
-"C.	c #D52104",
-"D.	c #2A1A04",
-"E.	c #AC7403",
-"F.	c #2B1C04",
-"G.	c #D04004",
-"H.	c #FC3C04",
-"I.	c #F94E04",
-"J.	c #881504",
-"K.	c #FC2604",
-"L.	c #792804",
-"M.	c #AC7503",
-"N.	c #9A6803",
-"O.	c #782804",
-"P.	c #F66504",
-"Q.	c #F94B04",
-"R.	c #F46804",
-"S.	c #F46604",
-"T.	c #F76504",
-"U.	c #FB4204",
-"V.	c #C13D04",
-"W.	c #5D0E04",
-"X.	c #DA2204",
-"Y.	c #741604",
-"Z.	c #8C5E03",
-"`.	c #885B03",
-" +	c #8B1904",
-".+	c #DE2204",
-"++	c #D22D04",
-"@+	c #C42D04",
-"#+	c #580E04",
-"$+	c #9F1804",
-"%+	c #895D04",
-"&+	c #D62204",
-"*+	c #371904",
-"=+	c #2C1A04",
-"-+	c #4A0C04",
-";+	c #140404",
-">+	c #AB1A04",
-",+	c #DA2304",
-"'+	c #6A4702",
-")+	c #754F02",
-"!+	c #821404",
-"~+	c #462B04",
-"{+	c #B37A03",
-"]+	c #B17803",
-"^+	c #714C04",
-"/+	c #580F04",
-"(+	c #E32204",
-"_+	c #DD2104",
-":+	c #611D04",
-"<+	c #BA7F03",
-"[+	c #B27803",
-"}+	c #6F1D04",
-"|+	c #FD2704",
-"1+	c #F22504",
-"2+	c #634304",
-"3+	c #875B03",
-"4+	c #734F02",
-"5+	c #805704",
-"6+	c #1D0504",
-"7+	c #DB2204",
-"8+	c #EA2404",
-"9+	c #2E0804",
-"0+	c #815803",
-"a+	c #941704",
-"b+	c #C11E04",
-"c+	c #391B04",
-"d+	c #A77104",
-"e+	c #B67C04",
-"f+	c #371D04",
-"g+	c #360A04",
-"h+	c #573A04",
-"i+	c #372604",
-"j+	c #3E2104",
-"k+	c #B57A03",
-"l+	c #B57B03",
-"m+	c #603F04",
-"n+	c #430A04",
-"o+	c #351904",
-"p+	c #A36E03",
-"q+	c #BE8103",
-"r+	c #1D1404",
-"s+	c #483004",
-"t+	c #A26E03",
-"u+	c #6D4B02",
-"v+	c #825804",
-"w+	c #0B0804",
-"x+	c #976603",
-"y+	c #815703",
-"z+	c #926404",
-"A+	c #895D03",
-"B+	c #614202",
-"C+	c #9A6804",
-"D+	c #C88704",
-"E+	c #C18303",
-"F+	c #654302",
-"G+	c #744F02",
-"H+	c #704B02",
-"                                                                ",
-"                                .                               ",
-"                              + @                               ",
-"                              # $                               ",
-"                              % & *                             ",
-"                            = - ; >                             ",
-"                            , ' ) !                             ",
-"                            ~ { ] ^                             ",
-"                          / ( _ : < [                           ",
-"                          . } | | } 1                           ",
-"                          2 3 | 4 5 6                           ",
-"                        7 8 9 0 a b c                           ",
-"  d e f f f d d d d d d g h i j k l m n d d d d d d d d d d d o ",
-"  p q r s s s s t s s u v w x y z A B C D D D D D s s s s E F   ",
-"      G H I J 4 | 4 | K L L M N O P Q R | S T U V W X Y Z       ",
-"        `  ...+.| 4 @.#.$.4 | %.&.*.4 =.-.;.>.,.'.).!.~.        ",
-"          {.].^./.(.X _.;.| :.T <.[.| }.z | |.1.2.3.4.          ",
-"            5.6.7.8.9.0.a.b.c.d.e.f.g.h.&.| i.u j.k.            ",
-"                l.m.n.o.p.q._.r.a.s.t.u.v.w.x.Z                 ",
-"                  {.y.P z.R A.v.x j B.| C.D.E.                  ",
-"                    F.G.H.I.4 | 4 t.J.f.K.L.M.                  ",
-"                  N.O.P.Q.R.S.T.U.V.W.X.4 Y.Z.                  ",
-"                  `. +4 =.| | .+++@+#+$+| K %+                  ",
-"                  %+&+| | | I *+=+-+;+>+,+&+x.'+                ",
-"                )+=+X.=.| !+~+{+]+^+,./+(+_+:+<+                ",
-"                [+}+|+1+) 2+3+    4+5+6+7+8+9+0+                ",
-"                $ a+b+c+d+            e+f+0.g+h+                ",
-"                i+A j+k+                l+m+n+o+p+              ",
-"              q+r+s+t+                    u+v+w+x+              ",
-"              y+z+A+                        B+C+2               ",
-"              D+                                E+F+            ",
-"            G+                                    H+            "};
+". 	c #111111",
+"+ 	c #040404",
+"@ 	c #040406",
+"# 	c #636363",
+"$ 	c #999999",
+"% 	c #0A0A0A",
+"& 	c #000000",
+"* 	c #002C3C",
+"= 	c #006483",
+"- 	c #006F92",
+"; 	c #006582",
+"> 	c #000C0F",
+", 	c #5F5F5F",
+"' 	c #545D64",
+") 	c #59636D",
+"! 	c #566067",
+"~ 	c #4A575B",
+"{ 	c #384449",
+"] 	c #384149",
+"^ 	c #0D0F0F",
+"/ 	c #001C29",
+"( 	c #00374F",
+"_ 	c #00698B",
+": 	c #0095C4",
+"< 	c #02131A",
+"[ 	c #313131",
+"} 	c #434343",
+"| 	c #858585",
+"1 	c #617077",
+"2 	c #63727A",
+"3 	c #849EAF",
+"4 	c #C7EEFB",
+"5 	c #C5EAFA",
+"6 	c #C7EBF6",
+"7 	c #2F383F",
+"8 	c #002233",
+"9 	c #00405E",
+"0 	c #006685",
+"a 	c #0091BF",
+"b 	c #08171D",
+"c 	c #A1A1A1",
+"d 	c #61717B",
+"e 	c #C2E5FB",
+"f 	c #BDE2F7",
+"g 	c #BFE4F6",
+"h 	c #2D363B",
+"i 	c #001E28",
+"j 	c #008EB9",
+"k 	c #00A8DD",
+"l 	c #08181D",
+"m 	c #5B5B5B",
+"n 	c #383838",
+"o 	c #353535",
+"p 	c #333333",
+"q 	c #4E4E4E",
+"r 	c #A7A7A7",
+"s 	c #62727B",
+"t 	c #C2E7FB",
+"u 	c #BDE3F8",
+"v 	c #BFE6F7",
+"w 	c #003040",
+"x 	c #00A9DE",
+"y 	c #00B5EF",
+"z 	c #0090BE",
+"A 	c #08181C",
+"B 	c #464646",
+"C 	c #1F1F1F",
+"D 	c #414141",
+"E 	c #5A5A5A",
+"F 	c #62727C",
+"G 	c #BDE0F7",
+"H 	c #C2E3F6",
+"I 	c #2D363D",
+"J 	c #005974",
+"K 	c #00B7F2",
+"L 	c #00B5ED",
+"M 	c #0090BF",
+"N 	c #494949",
+"O 	c #616161",
+"P 	c #BDE2F8",
+"Q 	c #BFE4F7",
+"R 	c #005874",
+"S 	c #00B7F1",
+"T 	c #474747",
+"U 	c #C2E9FB",
+"V 	c #BDE1F7",
+"W 	c #C2E2F5",
+"X 	c #62717B",
+"Y 	c #BDE0F8",
+"Z 	c #BFE5F7",
+"` 	c #005774",
+" .	c #00B5EC",
+"..	c #424242",
+"+.	c #030303",
+"@.	c #005A74",
+"#.	c #008FBD",
+"$.	c #061519",
+"%.	c #ACACAC",
+"&.	c #B6B6B6",
+"*.	c #C2E4F7",
+"=.	c #008DBB",
+"-.	c #000E14",
+";.	c #010104",
+">.	c #010406",
+",.	c #020306",
+"'.	c #000404",
+").	c #262626",
+"!.	c #5C5C5C",
+"~.	c #C2C2C2",
+"{.	c #BFE5F6",
+"].	c #00465A",
+"^.	c #008EBB",
+"/.	c #008CB9",
+"(.	c #0086B1",
+"_.	c #007599",
+":.	c #003E50",
+"<.	c #000101",
+"[.	c #004156",
+"}.	c #008DB9",
+"|.	c #0093C0",
+"1.	c #0098C7",
+"2.	c #0089B3",
+"3.	c #005D7C",
+"4.	c #012531",
+"5.	c #151617",
+"6.	c #909090",
+"7.	c #63737D",
+"8.	c #002134",
+"9.	c #004969",
+"0.	c #004667",
+"a.	c #003954",
+"b.	c #00141A",
+"c.	c #020D10",
+"d.	c #030404",
+"e.	c #03141A",
+"f.	c #022934",
+"g.	c #003546",
+"h.	c #00789C",
+"i.	c #00B4EE",
+"j.	c #00B5F1",
+"k.	c #00A2D4",
+"l.	c #004359",
+"m.	c #0F1212",
+"n.	c #9D9D9D",
+"o.	c #A7A8A8",
+"p.	c #677885",
+"q.	c #BCE2F7",
+"r.	c #C0E4F7",
+"s.	c #004465",
+"t.	c #008DD0",
+"u.	c #008DCD",
+"v.	c #006DA0",
+"w.	c #050F15",
+"x.	c #5D6F73",
+"y.	c #758C96",
+"z.	c #758B96",
+"A.	c #748991",
+"B.	c #3B464E",
+"C.	c #040B0C",
+"D.	c #006080",
+"E.	c #00B2EB",
+"F.	c #002E3B",
+"G.	c #2C2C2C",
+"H.	c #A8A8A8",
+"I.	c #697884",
+"J.	c #BFE3F6",
+"K.	c #001E29",
+"L.	c #004058",
+"M.	c #004056",
+"N.	c #003143",
+"O.	c #05090B",
+"P.	c #4C5961",
+"Q.	c #54626D",
+"R.	c #53646C",
+"S.	c #54636C",
+"T.	c #4B5A62",
+"U.	c #121518",
+"V.	c #000A0C",
+"W.	c #009BCA",
+"X.	c #00B5EE",
+"Y.	c #0091C0",
+"Z.	c #081B22",
+"`.	c #00556D",
+" +	c #00AFE5",
+".+	c #00ADE2",
+"++	c #0087B0",
+"@+	c #051215",
+"#+	c #263032",
+"$+	c #010202",
+"%+	c #040405",
+"&+	c #030405",
+"*+	c #010101",
+"=+	c #006387",
+"-+	c #00B0E7",
+";+	c #002F3F",
+">+	c #697885",
+",+	c #BCE3F7",
+"'+	c #C0E2F5",
+")+	c #008BB8",
+"!+	c #08171A",
+"~+	c #425057",
+"{+	c #3B474C",
+"]+	c #798E9A",
+"^+	c #768A9A",
+"/+	c #778B95",
+"(+	c #293337",
+"_+	c #003C51",
+":+	c #00B3EB",
+"<+	c #00B8F1",
+"[+	c #005771",
+"}+	c #9E9E9E",
+"|+	c #687885",
+"1+	c #C2E6FA",
+"2+	c #BBDEF2",
+"3+	c #B7D9E5",
+"4+	c #2C3438",
+"5+	c #008EBA",
+"6+	c #08161A",
+"7+	c #424E56",
+"8+	c #424C54",
+"9+	c #859DAA",
+"0+	c #8097A5",
+"a+	c #7C929F",
+"b+	c #363F45",
+"c+	c #002D3B",
+"d+	c #00ADE3",
+"e+	c #00B8F3",
+"f+	c #007093",
+"g+	c #090909",
+"h+	c #0D0D0D",
+"i+	c #8E8E8E",
+"j+	c #868A8B",
+"k+	c #3A4147",
+"l+	c #526069",
+"m+	c #47525A",
+"n+	c #465154",
+"o+	c #121415",
+"p+	c #008CB7",
+"q+	c #08151A",
+"r+	c #424E55",
+"s+	c #3B3B3B",
+"t+	c #7D7E7E",
+"u+	c #7F8080",
+"v+	c #828383",
+"w+	c #404040",
+"x+	c #002A37",
+"y+	c #00AAE2",
+"z+	c #00799E",
+"A+	c #272727",
+"B+	c #4E4F4F",
+"C+	c #94A6AD",
+"D+	c #B1C4CC",
+"E+	c #B6C8D3",
+"F+	c #2D2D2D",
+"G+	c #012C3A",
+"H+	c #00ACE1",
+"I+	c #007699",
+"J+	c #151515",
+"K+	c #424E54",
+"L+	c #505050",
+"M+	c #484848",
+"N+	c #003648",
+"O+	c #00B1E8",
+"P+	c #00B9F3",
+"Q+	c #006586",
+"R+	c #202020",
+"S+	c #454545",
+"T+	c #0B0B0B",
+"U+	c #008DB8",
+"V+	c #525252",
+"W+	c #222222",
+"X+	c #005672",
+"Y+	c #00B3ED",
+"Z+	c #004459",
+"`+	c #3C3C3C",
+" @	c #060606",
+".@	c #8C8C8C",
+"+@	c #585858",
+"@@	c #797979",
+"#@	c #000507",
+"$@	c #0092BE",
+"%@	c #00B7F0",
+"&@	c #00A8DC",
+"*@	c #03202A",
+"=@	c #6A6A6A",
+"-@	c #242424",
+";@	c #7D7D7D",
+">@	c #071419",
+",@	c #3C4650",
+"'@	c #030304",
+")@	c #727272",
+"!@	c #111414",
+"~@	c #004961",
+"{@	c #00B6EE",
+"]@	c #00516D",
+"^@	c #1E2122",
+"/@	c #949494",
+"(@	c #010F12",
+"_@	c #0B0E10",
+":@	c #111213",
+"<@	c #1D1F20",
+"[@	c #030F12",
+"}@	c #004B60",
+"|@	c #00779A",
+"1@	c #010A0D",
+"2@	c #6B6B6B",
+"3@	c #767676",
+"4@	c #121212",
+"5@	c #005A77",
+"6@	c #00B9F2",
+"7@	c #00A6DB",
+"8@	c #007397",
+"9@	c #003B4F",
+"0@	c #003748",
+"a@	c #007BA2",
+"b@	c #00A4D4",
+"c@	c #00B7F4",
+"d@	c #0091BE",
+"e@	c #00465C",
+"f@	c #646464",
+"g@	c #B8B8B8",
+"h@	c #252525",
+"i@	c #2B2D2D",
+"j@	c #00212A",
+"k@	c #004258",
+"l@	c #004457",
+"m@	c #004356",
+"n@	c #00445A",
+"o@	c #00252F",
+"p@	c #00232C",
+"q@	c #004357",
+"r@	c #004054",
+"s@	c #002B3B",
+"t@	c #07171D",
+"u@	c #242627",
+"v@	c #818181",
+"w@	c #5D5D5D",
+"x@	c #696969",
+"y@	c #525656",
+"z@	c #323333",
+"A@	c #333636",
+"B@	c #333738",
+"C@	c #333638",
+"D@	c #333637",
+"E@	c #323436",
+"F@	c #373A3B",
+"G@	c #4B4D4E",
+"H@	c #545656",
+"I@	c #545454",
+"J@	c #080808",
+"K@	c #191919",
+"L@	c #315F6C",
+"M@	c #181818",
+"N@	c #070707",
+"O@	c #8A8A8A",
+"P@	c #0C0C0C",
+"Q@	c #1D1D1D",
+"R@	c #757575",
+"S@	c #393939",
+"T@	c #6D6D6D",
+"        . + + + @ + + + + + #                           ",
+"      $ % & & * = - ; > & & ,                           ",
+"' ) ! ~ { ] ^ / ( _ : < [ } |                           ",
+"1 2 3 4 5 6 7 8 9 0 a b c                               ",
+"    d e f g h i j k a l m n o p q                       ",
+"  r s t u v h w x y z A B + C D E                       ",
+"  r F t G H I J K L M l N + O                           ",
+"  r F t P Q h R S L M l T + ,                           ",
+"  r F U V W h J S y M l B + ,                           ",
+"  r X t Y Z h ` S  .M l ..+.O                           ",
+"  r X t f g h @.S y #.$.o +.N %.%.%.&.                  ",
+"  r F t V *.I ` S y =.-.;.& & >.,.'.% ).!.~.            ",
+"  r F t f {.h ].^./.(._.:.<.[.}.|.1.2.3.4.5.6.          ",
+"  r 7.t G H I 8.9.0.a.b.c.d.e.f.g.h.i.j.k.l.m.n.        ",
+"  o.p.t q.r.h s.t.u.v.w.x.y.z.A.B.C.D.L y E.F.G.        ",
+"  H.I.e f J.h K.L.M.N.O.P.Q.R.S.T.U.V.W.X.L Y.Z.$       ",
+"  H.I.t Y *.I `. +.+++@+#+$+$+%+&+%+*+=+y y -+;+n       ",
+"  H.>+t ,+'+h ` S y )+!+~+d.{+]+^+/+(+_+:+L <+[+& !.    ",
+"  }+|+1+2+3+4+` S y 5+6+7+d.8+9+0+a+b+c+d+L e+f+g+h+i+  ",
+"  j+k+l+m+n+o+` S y p+q+r+d.s+t+u+v+w+x+y+L S z+. A+s+  ",
+"    B+C+D+E+F+` S y 5+6+r+d.#       , G+H+L S I+J+s+J+  ",
+"            F+R S  .}.6+K+d.L+      M+N+O+ .P+Q+R+S+T+  ",
+"            F+J S y U+6+K+d.V+      W+X+X. .Y+Z+`+.. @.@",
+"            F+` S y 5+6+r+d.+@    @@#@$@%@L &@*@=@-@ @;@",
+"            F+@.S y p+>@,@'@L+  )@!@~@:+X.{@]@^@/@ @%   ",
+"            F+` S y }.(@_@& :@<@[@}@x y Y+|@1@2@3@*+4@  ",
+"            F+5@6@y 7@8@9@<.0@a@b@c@:+d@e@O.f@g@R+& h@  ",
+"            i@j@k@l@m@n@o@& p@e@q@r@s@t@u@v@  w@*+& x@  ",
+"            y@z@A@B@C@D@D@E@E@D@D@F@G@H@    I@J@& K@    ",
+"                                      L@I@M@& & N@O@    ",
+"                    J+P@P@P@P@P@P@P@T+ @& & +.Q@R@      ",
+"                    S@[ [ [ [ [ [ [ [ [ o } T@M+        "};
Index: widget/src/gtk/mozicon16.xpm
===================================================================
RCS file: /cvsroot/mozilla/widget/src/gtk/mozicon16.xpm,v
retrieving revision 1.1
diff -u -u -w -r1.1 mozicon16.xpm
--- widget/src/gtk/mozicon16.xpm	18 Feb 2000 23:28:29 -0000	1.1
+++ widget/src/gtk/mozicon16.xpm	26 Aug 2002 05:33:14 -0000
@@ -1,105 +1,140 @@
 /* XPM */
-static char * minimozicon_xpm[] = {
-"16 16 86 1",
+static char * mozicon16_xpm[] = {
+"14 16 121 2",
 " 	c None",
-".	c #9A6803",
-"+	c #A26E04",
-"@	c #764A04",
-"#	c #613D03",
-"$	c #7D3104",
-"%	c #7F2F04",
-"&	c #7E5502",
-"*	c #A72604",
-"=	c #A82604",
-"-	c #855902",
-";	c #654403",
-">	c #CE2004",
-",	c #A91A04",
-"'	c #7A5304",
-")	c #7B5402",
-"!	c #5F4003",
-"~	c #402C03",
-"{	c #402C04",
-"]	c #642F04",
-"^	c #540D04",
-"/	c #601004",
-"(	c #482A04",
-"_	c #523803",
-":	c #734E02",
-"<	c #763A04",
-"[	c #DE2304",
-"}	c #FE2604",
-"|	c #B21B04",
-"1	c #AF1A04",
-"2	c #C21E04",
-"3	c #A31904",
-"4	c #A41A04",
-"5	c #E22204",
-"6	c #230604",
-"7	c #881504",
-"8	c #703504",
-"9	c #6F4504",
-"0	c #B41E04",
-"a	c #8F1604",
-"b	c #A61A04",
-"c	c #3B0B06",
-"d	c #761304",
-"e	c #E52204",
-"f	c #AA1A04",
-"g	c #560E04",
-"h	c #623D04",
-"i	c #865A03",
-"j	c #781E04",
-"k	c #811404",
-"l	c #661004",
-"m	c #D82104",
-"n	c #A31E04",
-"o	c #815703",
-"p	c #9A3A04",
-"q	c #F84F04",
-"r	c #FA4604",
-"s	c #D32F04",
-"t	c #A71A04",
-"u	c #BA2304",
-"v	c #9C6A03",
-"w	c #885C04",
-"x	c #D72204",
-"y	c #AE1E04",
-"z	c #832004",
-"A	c #6E1104",
-"B	c #E12304",
-"C	c #5D3F03",
-"D	c #704003",
-"E	c #F22604",
-"F	c #942404",
-"G	c #805503",
-"H	c #875C03",
-"I	c #3E1B04",
-"J	c #E12204",
-"K	c #723F04",
-"L	c #722C04",
-"M	c #7B3504",
-"N	c #6E3A04",
-"O	c #411A04",
-"P	c #A06C03",
-"Q	c #604104",
-"R	c #624204",
-"S	c #996804",
-"T	c #9E6B03",
-"U	c #875B02",
-"                ",
-"       .+       ",
-"       @#       ",
-"       $%       ",
-"      &*=-      ",
-"      ;>,'      ",
-")!~~{~]^/(~~~~_:",
-"  <[}|12345678  ",
-"   90abcdefgh   ",
-"    ijk,lmno    ",
-"     pqrstuv    ",
-"    wx}yzABC    ",
-"    DEFGHIJK    ",
-"    LM    NO    ",
-"   PQ      RS   ",
-"   T        U   "};
+". 	c #080808",
+"+ 	c #020D11",
+"@ 	c #023748",
+"# 	c #021F27",
+"$ 	c #020202",
+"% 	c #5C6971",
+"& 	c #7B919B",
+"* 	c #7F97A0",
+"= 	c #0F212B",
+"- 	c #00526F",
+"; 	c #02546F",
+"> 	c #7E7E7E",
+", 	c #91ACBB",
+"' 	c #BEE3F7",
+") 	c #162E37",
+"! 	c #00A5D9",
+"~ 	c #04546D",
+"{ 	c #373737",
+"] 	c #323232",
+"^ 	c #999999",
+"/ 	c #92ADBC",
+"( 	c #BFE2F7",
+"_ 	c #164758",
+": 	c #00B6EF",
+"< 	c #04546E",
+"[ 	c #262626",
+"} 	c #92ADBB",
+"| 	c #164757",
+"1 	c #242424",
+"2 	c #92ACBB",
+"3 	c #BFE3F7",
+"4 	c #00B6F0",
+"5 	c #015069",
+"6 	c #0E0E0F",
+"7 	c #3D3E3F",
+"8 	c #565858",
+"9 	c #727272",
+"0 	c #163542",
+"a 	c #006A91",
+"b 	c #00526E",
+"c 	c #011419",
+"d 	c #014357",
+"e 	c #00769A",
+"f 	c #0094C3",
+"g 	c #05485D",
+"h 	c #8C8D8D",
+"i 	c #95AFC0",
+"j 	c #163441",
+"k 	c #006693",
+"l 	c #022E41",
+"m 	c #5D6E76",
+"n 	c #647780",
+"o 	c #273035",
+"p 	c #006F91",
+"q 	c #00B4ED",
+"r 	c #0D4252",
+"s 	c #95B0C0",
+"t 	c #164656",
+"u 	c #00B2EA",
+"v 	c #034F66",
+"w 	c #1B2124",
+"x 	c #2E373B",
+"y 	c #3D474E",
+"z 	c #0A3544",
+"A 	c #007BA2",
+"B 	c #5B5B5B",
+"C 	c #6E808C",
+"D 	c #8096A1",
+"E 	c #0F3D4D",
+"F 	c #045169",
+"G 	c #23292D",
+"H 	c #5F686E",
+"I 	c #7F8B92",
+"J 	c #1D353D",
+"K 	c #00B0E8",
+"L 	c #0096C6",
+"M 	c #131313",
+"N 	c #164251",
+"O 	c #04526A",
+"P 	c #23292C",
+"Q 	c #2A424A",
+"R 	c #00B1E8",
+"S 	c #0093C1",
+"T 	c #2D2D2D",
+"U 	c #656565",
+"V 	c #084456",
+"W 	c #00B5EE",
+"X 	c #007093",
+"Y 	c #434343",
+"Z 	c #454545",
+"` 	c #164351",
+" .	c #024F67",
+"..	c #131619",
+"+.	c #484949",
+"@.	c #21383E",
+"#.	c #223A42",
+"$.	c #444444",
+"%.	c #606060",
+"&.	c #16353F",
+"*.	c #007DA4",
+"=.	c #006889",
+"-.	c #001820",
+";.	c #00475C",
+">.	c #00779D",
+",.	c #016280",
+"'.	c #2A3E44",
+").	c #959595",
+"!.	c #1F596A",
+"~.	c #275D6D",
+"{.	c #27424B",
+"].	c #273E45",
+"^.	c #285765",
+"/.	c #3A5C66",
+"(.	c #4C4C4C",
+"_.	c #171717",
+":.	c #2A2A2A",
+"<.	c #232323",
+"[.	c #1E1E1E",
+"}.	c #1D1D1D",
+"|.	c #353535",
+"    . + @ # $               ",
+"% & * = - ; >               ",
+"  , ' ) ! ~ { ] ^           ",
+"  / ( _ : < [               ",
+"  } ( | : < 1               ",
+"  2 3 _ 4 5 6 7 8 9         ",
+"  / ' 0 a b c d e f g h     ",
+"  i ' j k l m n o p q r     ",
+"  s ( t u v w x y z q A B   ",
+"  C D E 4 F G H I J K L M   ",
+"      N : O P     Q R S T U ",
+"      N 4 O P     V W X Y Z ",
+"      ` 4  ...+.@.L ! #.$.%.",
+"      &.*.=.-.;.>.,.'.).. ^ ",
+"        !.~.{.].^./.(._.:.  ",
+"          <.[.[.[.}.[.|.    "};
Index: widget/src/gtk/mozicon50.xpm
===================================================================
RCS file: /cvsroot/mozilla/widget/src/gtk/mozicon50.xpm,v
retrieving revision 1.1
diff -u -u -w -r1.1 mozicon50.xpm
--- widget/src/gtk/mozicon50.xpm	4 Apr 1999 08:20:50 -0000	1.1
+++ widget/src/gtk/mozicon50.xpm	26 Aug 2002 05:33:14 -0000
@@ -1,63 +1,697 @@
 /* XPM */
 static char * mozicon50_xpm[] = {
-"50 51 9 1",
+"42 48 646 2",
 " 	c None",
-".	c #000000",
-"+	c #FF0000",
-"@	c #808000",
-"#	c #800000",
-"$	c #FF6633",
-"%	c #990066",
-"&	c #FF00FF",
-"*	c #222222",
-"                                                  ",
-"                         @                        ",
-"                        $@                        ",
-"                        @@                        ",
-"                        @@$                       ",
-"                       $@*@                       ",
-"                       @@.@                       ",
-"                       @..@                       ",
-"                      $@..@@                      ",
-"                      $@##*@                      ",
-"                      @*#+.@                      ",
-"                      @.++.@$                     ",
-"                     $@.++.@$                     ",
-"                     @*#++#*@                     ",
-"                     @.++++.@                     ",
-"                    $@.++++.@$                    ",
-"                    @*#++++**@                    ",
-"                    @.#++++#.@                    ",
-"                   $@.++####.@                    ",
-"                   @@*+#*##*.@@                   ",
-"*@@@@@@@@@@@@@@@@@@@.#+..*##*#@@@@@@@@@@@@@@@@@@@*",
-" *@@*................+#..*###.................@@* ",
-"  %@@@.#++++++++++++#**#*#++.###++*...#+++#.*@@*  ",
-"    *@@.#+++++++++#.##++#+#+*.#+++#..##++#.@@@%   ",
-"      $@..+++++++.#++++++##++++#++#...++*.@@$     ",
-"       @@*.#+++++.#+++++*.#++++##++#.*...@@       ",
-"        $@@.#+++#*++++#....#+++*#+++...*@$        ",
-"         *@@..++#*++#**.*.*+++#.#++*..@@$         ",
-"           $@*.++******#+++++#+#+++..@@           ",
-"            $@@.##..*$#**#+#*#++++..@@            ",
-"             $@@.#+#***##...#++++.*@@             ",
-"              %@@*++++++++#.#++++.@@              ",
-"               @.#+++++++++.##+++.@$              ",
-"               @.+$$$$$+$$$#*#+++*@@              ",
-"              $@*+$$$$$$$+$#.#+++#.@              ",
-"              @*#+++++++++++.#++++.@              ",
-"              @.#+++++++#*++.##+++.@$             ",
-"             $@.+++++++....#..+#++*@@             ",
-"             @@*+++++#.*@@@...*+++#.@             ",
-"             @.#++++#.@@@ @@..#++++.@             ",
-"             @.++++*.@@$  %@@..+++#.@@            ",
-"            $@.+++..@@*     $@*.#+#**@            ",
-"            @@#+#.*@$%       $@@.##..@            ",
-"            @.##.@@            @@..#.@$           ",
-"           $@.*.@@$             @@**.@$           ",
-"           $@.*@@               %$@@.*@           ",
-"           @.@@$                  *@@.@           ",
-"           @@@$                    %@@@$          ",
-"          $@@%                      %@@@          ",
-"          @@                          $@          ",
-"          $                            *          "};
+". 	c #909090",
+"+ 	c #1A1A1A",
+"@ 	c #070707",
+"# 	c #464646",
+"$ 	c #8B8B8B",
+"% 	c #121212",
+"& 	c #000000",
+"* 	c #000203",
+"= 	c #001015",
+"- 	c #001B27",
+"; 	c #001B26",
+"> 	c #001A23",
+", 	c #001B23",
+"' 	c #000A0C",
+") 	c #3F3F3F",
+"! 	c #6F6F6F",
+"~ 	c #0F0F0F",
+"{ 	c #000A0E",
+"] 	c #00475F",
+"^ 	c #007A9F",
+"/ 	c #007EA2",
+"( 	c #0090C1",
+"_ 	c #00A0CF",
+": 	c #003B4A",
+"< 	c #4B5255",
+"[ 	c #51575D",
+"} 	c #50565B",
+"| 	c #4C5457",
+"1 	c #3C4346",
+"2 	c #262F32",
+"3 	c #242B2E",
+"4 	c #23292F",
+"5 	c #0C0F0F",
+"6 	c #000507",
+"7 	c #002232",
+"8 	c #003950",
+"9 	c #003749",
+"0 	c #008DBE",
+"a 	c #00BCF7",
+"b 	c #004059",
+"c 	c #020202",
+"d 	c #2B2B2B",
+"e 	c #5D5D5D",
+"f 	c #647881",
+"g 	c #768A9A",
+"h 	c #768A98",
+"i 	c #7E94A4",
+"j 	c #8DA9B5",
+"k 	c #93AEB9",
+"l 	c #91B0B9",
+"m 	c #94AEB9",
+"n 	c #93AEB7",
+"o 	c #353F45",
+"p 	c #00070B",
+"q 	c #002F47",
+"r 	c #004368",
+"s 	c #00202C",
+"t 	c #007EA6",
+"u 	c #00B3ED",
+"v 	c #003B4F",
+"w 	c #090909",
+"x 	c #656565",
+"y 	c #B5B5B5",
+"z 	c #C3C3C3",
+"A 	c #545F63",
+"B 	c #5D676E",
+"C 	c #505B60",
+"D 	c #647885",
+"E 	c #B2D8E8",
+"F 	c #C6EDFC",
+"G 	c #C4E9FA",
+"H 	c #C4EAFE",
+"I 	c #C8ECF5",
+"J 	c #46555E",
+"K 	c #000609",
+"L 	c #00283B",
+"M 	c #003F5B",
+"N 	c #003547",
+"O 	c #008BB4",
+"P 	c #00B7F1",
+"Q 	c #0C0C0C",
+"R 	c #7E7E7E",
+"S 	c #D9D9D9",
+"T 	c #D7D7D7",
+"U 	c #D6D6D6",
+"V 	c #D8D8D8",
+"W 	c #D5D5D5",
+"X 	c #DCDCDC",
+"Y 	c #878787",
+"Z 	c #48545B",
+"` 	c #A9C9DC",
+" .	c #C0E4F9",
+"..	c #BCE3F6",
+"+.	c #BCE1F9",
+"@.	c #C0E5F5",
+"#.	c #445258",
+"$.	c #002A38",
+"%.	c #00789E",
+"&.	c #0092C0",
+"*.	c #00AADE",
+"=.	c #00B7F0",
+"-.	c #636363",
+";.	c #5C5C5C",
+">.	c #4B4B4B",
+",.	c #484848",
+"'.	c #4A4A4A",
+").	c #999999",
+"!.	c #969696",
+"~.	c #4E595F",
+"{.	c #AACBDC",
+"].	c #C0E3F9",
+"^.	c #BCDFF6",
+"/.	c #BCE4F6",
+"(.	c #C3E5F5",
+"_.	c #0098C6",
+":.	c #00BBF5",
+"<.	c #00B4EE",
+"[.	c #003B49",
+"}.	c #565656",
+"|.	c #1E1E1E",
+"1.	c #040404",
+"2.	c #030303",
+"3.	c #888888",
+"4.	c #4A545B",
+"5.	c #AACCDC",
+"6.	c #BCE6FC",
+"7.	c #BFE5F5",
+"8.	c #00090D",
+"9.	c #004E68",
+"0.	c #00A5DA",
+"a.	c #00B6EF",
+"b.	c #003B4E",
+"c.	c #555555",
+"d.	c #1B1B1B",
+"e.	c #222222",
+"f.	c #616161",
+"g.	c #A4A4A4",
+"h.	c #8A8A8A",
+"i.	c #4E585F",
+"j.	c #BCDEF6",
+"k.	c #BCDEF7",
+"l.	c #C4E5F5",
+"m.	c #44525E",
+"n.	c #001318",
+"o.	c #007396",
+"p.	c #00B8F5",
+"q.	c #0D0D0D",
+"r.	c #5A5A5A",
+"s.	c #424242",
+"t.	c #BCE0F7",
+"u.	c #001218",
+"v.	c #007196",
+"w.	c #00B9F3",
+"x.	c #00B4EA",
+"y.	c #00B4EC",
+"z.	c #4D575E",
+"A.	c #AAC9DC",
+"B.	c #C0E6F9",
+"C.	c #BCE1F6",
+"D.	c #BCE4FC",
+"E.	c #007296",
+"F.	c #1C1C1C",
+"G.	c #898989",
+"H.	c #4B555C",
+"I.	c #C0E5F9",
+"J.	c #C5E5F5",
+"K.	c #007496",
+"L.	c #4C575D",
+"M.	c #C0E7F9",
+"N.	c #C2E5F5",
+"O.	c #00B4ED",
+"P.	c #535353",
+"Q.	c #151515",
+"R.	c #4B565D",
+"S.	c #AACADC",
+"T.	c #BCE5FA",
+"U.	c #C1E5F5",
+"V.	c #414141",
+"W.	c #4B565C",
+"X.	c #BCE2F6",
+"Y.	c #0B0B0B",
+"Z.	c #3C3C3C",
+"`.	c #ACACAC",
+" +	c #CDCDCD",
+".+	c #CECECE",
+"++	c #D3D3D3",
+"@+	c #4C575E",
+"#+	c #BCE0F6",
+"$+	c #BCE3FB",
+"%+	c #003142",
+"&+	c #191919",
+"*+	c #060606",
+"=+	c #101010",
+"-+	c #303030",
+";+	c #353535",
+">+	c #393939",
+",+	c #343434",
+"'+	c #8C8C8C",
+")+	c #B6B6B6",
+"!+	c #4A555B",
+"~+	c #BCE0F8",
+"{+	c #003245",
+"]+	c #000506",
+"^+	c #010106",
+"/+	c #010105",
+"(+	c #010207",
+"_+	c #000606",
+":+	c #000505",
+"<+	c #272727",
+"[+	c #676767",
+"}+	c #B8B8B8",
+"|+	c #4D585F",
+"1+	c #AAC8DC",
+"2+	c #445259",
+"3+	c #001418",
+"4+	c #007898",
+"5+	c #00BDF6",
+"6+	c #00B6F0",
+"7+	c #0099C7",
+"8+	c #008AB5",
+"9+	c #006786",
+"0+	c #00090E",
+"a+	c #003040",
+"b+	c #0083AA",
+"c+	c #008EBA",
+"d+	c #008AB7",
+"e+	c #008AB0",
+"f+	c #0082AD",
+"g+	c #007597",
+"h+	c #005771",
+"i+	c #002735",
+"j+	c #010609",
+"k+	c #9D9D9D",
+"l+	c #49545B",
+"m+	c #BCE6FD",
+"n+	c #000407",
+"o+	c #001F2C",
+"p+	c #003548",
+"q+	c #003447",
+"r+	c #00374E",
+"s+	c #003E4E",
+"t+	c #00313D",
+"u+	c #000405",
+"v+	c #002632",
+"w+	c #006889",
+"x+	c #007AA0",
+"y+	c #008DBA",
+"z+	c #00B1E7",
+"A+	c #00BEF6",
+"B+	c #00BBF7",
+"C+	c #00BAFB",
+"D+	c #00B2EB",
+"E+	c #0081A9",
+"F+	c #002A3B",
+"G+	c #0D0E0E",
+"H+	c #8A8B8B",
+"I+	c #4E5960",
+"J+	c #ABCCDC",
+"K+	c #00080D",
+"L+	c #00314E",
+"M+	c #00537C",
+"N+	c #005277",
+"O+	c #005077",
+"P+	c #001117",
+"Q+	c #030304",
+"R+	c #050606",
+"S+	c #030404",
+"T+	c #00212F",
+"U+	c #007393",
+"V+	c #00AEE4",
+"W+	c #00B5EF",
+"X+	c #00B4F1",
+"Y+	c #00BDF9",
+"Z+	c #00A6D6",
+"`+	c #003F54",
+" @	c #ABABAB",
+".@	c #898B8B",
+"+@	c #4E5C64",
+"@@	c #AECCE1",
+"#@	c #BCE1F8",
+"$@	c #000F16",
+"%@	c #005B86",
+"&@	c #0092D9",
+"*@	c #008FD5",
+"=@	c #0093D5",
+"-@	c #0090D5",
+";@	c #00273C",
+">@	c #050506",
+",@	c #313A40",
+"'@	c #4F5E61",
+")@	c #4C5A61",
+"!@	c #4D5B61",
+"~@	c #455357",
+"{@	c #2A3238",
+"]@	c #080A0A",
+"^@	c #000C10",
+"/@	c #005E7B",
+"(@	c #00AAE1",
+"_@	c #00B6ED",
+":@	c #00B5EC",
+"<@	c #00B9F7",
+"[@	c #00A5DB",
+"}@	c #002F3B",
+"|@	c #4C4C4C",
+"1@	c #CCCCCC",
+"2@	c #515C65",
+"3@	c #AECEE2",
+"4@	c #003753",
+"5@	c #005A84",
+"6@	c #005A81",
+"7@	c #001522",
+"8@	c #0C0E10",
+"9@	c #758C95",
+"0@	c #AFD2D9",
+"a@	c #A5C5D5",
+"b@	c #A5C7D5",
+"c@	c #A8C6D5",
+"d@	c #AAC7D5",
+"e@	c #8CA6B8",
+"f@	c #323D42",
+"g@	c #00161D",
+"h@	c #00769C",
+"i@	c #00B6EE",
+"j@	c #00BEF7",
+"k@	c #008BB5",
+"l@	c #00141B",
+"m@	c #A2A2A2",
+"n@	c #AECBE2",
+"o@	c #000709",
+"p@	c #002C3A",
+"q@	c #004860",
+"r@	c #00485F",
+"s@	c #050607",
+"t@	c #323840",
+"u@	c #404C52",
+"v@	c #3A434C",
+"w@	c #3A464C",
+"x@	c #3A444C",
+"y@	c #3A474C",
+"z@	c #3E4C50",
+"A@	c #2D363E",
+"B@	c #000202",
+"C@	c #003F4F",
+"D@	c #00A4D6",
+"E@	c #00B5EB",
+"F@	c #00B5EE",
+"G@	c #00B8F1",
+"H@	c #005472",
+"I@	c #080808",
+"J@	c #BCE2FA",
+"K@	c #44525C",
+"L@	c #001115",
+"M@	c #006887",
+"N@	c #00A9DD",
+"O@	c #00A6D9",
+"P@	c #252D31",
+"Q@	c #080B0B",
+"R@	c #001E29",
+"S@	c #0083AE",
+"T@	c #0087B2",
+"U@	c #00070A",
+"V@	c #2D2D2D",
+"W@	c #A5A5A5",
+"X@	c #AED0E2",
+"Y@	c #44525B",
+"Z@	c #007497",
+"`@	c #00BCF5",
+" #	c #00333F",
+".#	c #0B0E0F",
+"+#	c #4E6067",
+"@#	c #131919",
+"##	c #191F1F",
+"$#	c #1B2024",
+"%#	c #1A1F24",
+"&#	c #1C2121",
+"*#	c #0A0E0E",
+"=#	c #000B10",
+"-#	c #00678B",
+";#	c #009DCE",
+">#	c #001F29",
+",#	c #444444",
+"'#	c #515C64",
+")#	c #AED0E1",
+"!#	c #53636E",
+"~#	c #151B1B",
+"{#	c #39444B",
+"]#	c #8FA7B3",
+"^#	c #9EB8CA",
+"/#	c #9CB6CA",
+"(#	c #9DB7CA",
+"_#	c #9CB6C2",
+":#	c #556770",
+"<#	c #000102",
+"[#	c #00546F",
+"}#	c #00B0E8",
+"|#	c #00B6EC",
+"1#	c #00B5ED",
+"2#	c #00B0E4",
+"3#	c #003C4D",
+"4#	c #515C66",
+"5#	c #AED0E3",
+"6#	c #C5E8FE",
+"7#	c #C4E6FD",
+"8#	c #C4EBFD",
+"9#	c #CCECF5",
+"0#	c #49575E",
+"a#	c #003440",
+"b#	c #53616E",
+"c#	c #414B54",
+"d#	c #A2BECE",
+"e#	c #B3D4E5",
+"f#	c #B1D2E3",
+"g#	c #AAC5DD",
+"h#	c #A7C7D7",
+"i#	c #6A7D88",
+"j#	c #00455B",
+"k#	c #00A8DC",
+"l#	c #00B2EE",
+"m#	c #00526A",
+"n#	c #0E0E0E",
+"o#	c #828282",
+"p#	c #505B62",
+"q#	c #A7C4D9",
+"r#	c #B5D6EA",
+"s#	c #A8C8D9",
+"t#	c #97B8C9",
+"u#	c #8AA9B1",
+"v#	c #30383F",
+"w#	c #003340",
+"x#	c #0C0E0F",
+"y#	c #536168",
+"z#	c #090A0B",
+"A#	c #1A1C1E",
+"B#	c #192122",
+"C#	c #1D2122",
+"D#	c #172021",
+"E#	c #1E2021",
+"F#	c #141516",
+"G#	c #00A3D7",
+"H#	c #00B5E8",
+"I#	c #00B3EB",
+"J#	c #005B7A",
+"K#	c #3B3B3B",
+"L#	c #222629",
+"M#	c #272B32",
+"N#	c #202326",
+"O#	c #1B1B20",
+"P#	c #212122",
+"Q#	c #292929",
+"R#	c #131313",
+"S#	c #00B4E9",
+"T#	c #002D3F",
+"U#	c #53616D",
+"V#	c #989898",
+"W#	c #B4B4B4",
+"X#	c #BABABA",
+"Y#	c #7F7F7F",
+"Z#	c #0A0A0A",
+"`#	c #003E50",
+" $	c #00A3D8",
+".$	c #00B7F2",
+"+$	c #00B4EB",
+"@$	c #006280",
+"#$	c #202020",
+"$$	c #8D8D8D",
+"%$	c #929292",
+"&$	c #686868",
+"*$	c #74787A",
+"=$	c #949CA0",
+"-$	c #A7AFB3",
+";$	c #B4BBC0",
+">$	c #B5BDC2",
+",$	c #536169",
+"'$	c #474747",
+")$	c #003F55",
+"!$	c #00A4D8",
+"~$	c #00B7EC",
+"{$	c #00B3EA",
+"]$	c #005F79",
+"^$	c #3E3E3E",
+"/$	c #53616C",
+"($	c #454545",
+"_$	c #7D7D7D",
+":$	c #00455C",
+"<$	c #00526E",
+"[$	c #2E2E2E",
+"}$	c #00313F",
+"|$	c #53616A",
+"1$	c #00536E",
+"2$	c #00AFE5",
+"3$	c #00B5EA",
+"4$	c #00B2E8",
+"5$	c #004258",
+"6$	c #161616",
+"7$	c #2C2C2C",
+"8$	c #00303F",
+"9$	c #53616B",
+"0$	c #000D12",
+"a$	c #006C8D",
+"b$	c #00A2D6",
+"c$	c #002834",
+"d$	c #232323",
+"e$	c #2F2F2F",
+"f$	c #1D1D1D",
+"g$	c #CACACA",
+"h$	c #858686",
+"i$	c #101313",
+"j$	c #00212C",
+"k$	c #0089B3",
+"l$	c #00B8F2",
+"m$	c #008CBA",
+"n$	c #323232",
+"o$	c #727272",
+"p$	c #252525",
+"q$	c #C2C2C2",
+"r$	c #3A3B3B",
+"s$	c #004358",
+"t$	c #00AADD",
+"u$	c #005E7F",
+"v$	c #525252",
+"w$	c #747474",
+"x$	c #002E3F",
+"y$	c #0D0F11",
+"z$	c #586673",
+"A$	c #151B1F",
+"B$	c #494949",
+"C$	c #BCBCBC",
+"D$	c #001B25",
+"E$	c #0082AC",
+"F$	c #00BAF3",
+"G$	c #808080",
+"H$	c #5E5E5E",
+"I$	c #070808",
+"J$	c #2F363A",
+"K$	c #0C0C12",
+"L$	c #050505",
+"M$	c #000E13",
+"N$	c #006C8C",
+"O$	c #00BAF2",
+"P$	c #00ABDF",
+"Q$	c #002C3C",
+"R$	c #575757",
+"S$	c #373737",
+"T$	c #002F3C",
+"U$	c #000304",
+"V$	c #010304",
+"W$	c #010202",
+"X$	c #030606",
+"Y$	c #020608",
+"Z$	c #002E3A",
+"`$	c #0086AC",
+" %	c #00B7F4",
+".%	c #009FD3",
+"+%	c #003D4D",
+"@%	c #001219",
+"#%	c #007297",
+"$%	c #006888",
+"%%	c #00455D",
+"&%	c #000206",
+"*%	c #001921",
+"=%	c #004357",
+"-%	c #00597A",
+";%	c #0087AC",
+">%	c #00AFE9",
+",%	c #00BAF9",
+"'%	c #00A8DD",
+")%	c #00799E",
+"!%	c #002431",
+"~%	c #030506",
+"{%	c #181818",
+"]%	c #979797",
+"^%	c #404040",
+"/%	c #7A7A7A",
+"(%	c #001116",
+"_%	c #006483",
+":%	c #009DCD",
+"<%	c #0097C7",
+"[%	c #0096C6",
+"}%	c #009ECD",
+"|%	c #009BCD",
+"1%	c #00789C",
+"2%	c #000D0D",
+"3%	c #00384B",
+"4%	c #0090BA",
+"5%	c #00A3D4",
+"6%	c #00A3D2",
+"7%	c #009CCC",
+"8%	c #0095C5",
+"9%	c #008CB9",
+"0%	c #006E8F",
+"a%	c #003A4C",
+"b%	c #717171",
+"c%	c #AAAAAA",
+"d%	c #3F4444",
+"e%	c #000404",
+"f%	c #00181E",
+"g%	c #002533",
+"h%	c #002934",
+"i%	c #002732",
+"j%	c #002530",
+"k%	c #002A35",
+"l%	c #002535",
+"m%	c #001E26",
+"n%	c #000303",
+"o%	c #000E11",
+"p%	c #00252E",
+"q%	c #002736",
+"r%	c #002531",
+"s%	c #00232E",
+"t%	c #00141D",
+"u%	c #020508",
+"v%	c #282828",
+"w%	c #5B5B5B",
+"x%	c #010101",
+"y%	c #515151",
+"z%	c #545C5C",
+"A%	c #242424",
+"B%	c #262626",
+"C%	c #232527",
+"D%	c #434343",
+"E%	c #858585",
+"F%	c #5A7880",
+"G%	c #2B7287",
+"H%	c #286D82",
+"I%	c #296679",
+"J%	c #296375",
+"K%	c #294F5B",
+"L%	c #292C2E",
+"M%	c #294149",
+"N%	c #296374",
+"O%	c #296477",
+"P%	c #296376",
+"Q%	c #296373",
+"R%	c #275E70",
+"S%	c #1F505E",
+"T%	c #34494F",
+"U%	c #41555C",
+"V%	c #111111",
+"W%	c #B2B2B2",
+"X%	c #355C70",
+"Y%	c #588092",
+"Z%	c #545454",
+"`%	c #4E4E4E",
+" &	c #6B6B6B",
+".&	c #949494",
+"          . + @ @ @ @ @ @ @ @ @ @ @ @ @ @ #                                         ",
+"          $ % & & & * = - ; > , ' & & & & )                                         ",
+"          ! ~ & & & { ] ^ / ( _ : & & & & )                                         ",
+"< [ [ } | 1 2 3 4 5 6 7 8 9 0 a b c + d d e                                         ",
+"f g h i j k l m n o p q r s t u v w x y y z                                         ",
+"A B C D E F G H I J K L M N O P v Q R S T T U V W X                                 ",
+"    Y Z `  ...+.@.#.* $.%.&.*.=.v Q -.;.>.>.,.'.,.).                                ",
+"    !.~.{.].^./.(.#.& $._.:.<.<.[.Q }.|.1.1.2.2.2.R                                 ",
+"    3.4.5. ...6.7.#.8.9.0.a.<.<.b.Q c.d.& e.c.f.f.g.                                ",
+"    h.i.5. .j.k.l.m.n.o.p.<.<.<.v q.r.d.& s.                                        ",
+"    3.4.{. ./.t.l.#.u.v.w.x.y.<.v Q c.d.& )                                         ",
+"    h.z.A.B.C.D.7.#.u.E.w.<.<.<.v Q c.F.& )                                         ",
+"    G.H.5.I...j.J.#.n.K.w.<.<.<.v Q }.F.& )                                         ",
+"    h.L.5.M.^.+.N.#.u.v.w.O.<.<.v Q P.Q.& )                                         ",
+"    G.R.S.I.^.T.U.#.u.v.w.y.O.<.v Q P.Q.& V.                                        ",
+"    G.W.S.I.X.C.U.#.n.K.w.<.<.<.: Y.>.Q.& Z.`. + + +.+++                            ",
+"    h.@+5. .#+$+(.#.u.E.w.<.<.<.%+2.&+*+& =+-+;+>+,+;+s.f.'+)+                      ",
+"    3.!+5. ...~+J.m.u.v.w.<.<.<.{+]+^+& & & /+]+(+_+:+2.w % <+[+}+                  ",
+"    h.|+1+B.#+/.7.2+3+4+5+<.w.6+7+8+9+0+& a+b+c+d+e+f+g+h+i+j+@ d k+                ",
+"    3.l+5. ./.m+J.2+n+o+p+N q+q+r+s+t+u+& v+w+x+y+z+A+B+C+D+E+F+6 G+3.              ",
+"    H+I+J+].^.j.l.m.K+L+M+N+O+O+P+& Q+R+R+R+R+S+& T+U+V+W+X+Y+Z+`+]+d. @            ",
+"    .@+@@@]...#@@.#.$@%@&@*@=@-@;@>@,@'@)@)@!@~@{@]@^@/@(@_@:@<@[@}@*+|@1@          ",
+"    $ 2@3@B.C.$+N.#.8.4@5@6@6@6@7@8@9@0@a@b@c@d@e@f@c g@h@i@W+:@j@k@l@F.m@          ",
+"    $ 2@n@].X.j.U.#.o@p@q@r@r@r@n.s@t@u@v@w@x@y@z@A@2.B@C@D@6+E@F@G@H@I@x           ",
+"    $ 2@3@I.^.J@J.K@L@M@N@O@O@O@}@s@P@Q@& & & & & & & & R@S@6+W+W+=.T@U@V@W@        ",
+"    $ 2@X@ .X.+.@.Y@n.Z@`@P P u  #.#+#@#& Q@##$#%#%#&#*#=#-#u W+W+<.;#>#w ,#        ",
+"    $ '#)# ./.^.(.#.u.v.w.<.<.u  #8@!#~#& {#]#^#/#(#_#:#<#[#}#|#1#W+2#3#& w ;.      ",
+"    $ 4#5#6#7#8#9#0#u.v.w.<.<.<.a#8@b#~#& c#d#e#f#g#h#i#2.j#k#=.F@W+l#m#1.@ n#o#    ",
+"    $ p#q#r#s#t#u#v#u.v.w.<.<.<.w#x#y#~#& z#A#B#C#D#E#F#& `+G#P H#F@I#J#I@|.=+K#    ",
+"    .@L#M#N#O#P#Q#R#u.v.w.<.<.S#T#8@U#~#& Z.V#W#)+)+X#Y#Z#`# $.$F@W++$@$Y.;+#$w $$  ",
+"    %$&$*$=$-$;$>$,#u.v.w.<.<.<.a#x#,$~#& '$          G.Q )$!$~$1#W+{$]$Q ^$<+& f.  ",
+"                  ,#u.v.w.O.<.<.a#8@/$~#& ($          _$2.:$N@P :@W+{$<$~ '.[$& V.  ",
+"                  ,#n.o.w.y.O.y.}$8@|$~#& '$          x * 1$2$6+3$W+4$5$6$}.-+& 7$  ",
+"                  ,#n.o.w.<.<.+$8$8@9$~#& #           Z.0$a$O.W+E@F@b$c$d$&$e$& f$g$",
+"                  ,#u.v.w.<.<.<.a#8@9$~#& #         h$i$j$k$l$W+:@l$m$' n$o$p$& &+`.",
+"                  ,#u.v.w.<.<.<.a#8@|$~#& '$      q$r$]+s$t$l$E@F@j@u$@ v$w$R#& &+`.",
+"                  ,#n.K.w.<.<.S#x$y$z$A$& B$    C$($*+D$E$G@W+1#F$( P++ G$H$2.& d$  ",
+"                  ,#u.v.w.<.<.<.w#I$J$K$& Q#;.e d$L$M$N$O.W+3$O$P$Q$L$R$  >+& & S$  ",
+"                  ,#u.v.w.<.<.<.T$U$V$& & W$X$Y$o@Z$`$P W+W+ %.%+%U$F.g.G$q.& & c.  ",
+"                  ,#@%#%w.<.<.<.$%%%p+&%& *%=%-%;%>%,%a._@'%)%!%~%{%]%  ^%& & c /%  ",
+"                  ,#(%_%:%<%<%[%}%|%1%2%& 3%4%5%6%7%8%9%0%a%=#q.;+W@  b%Y.& & d.c%  ",
+"                  d%e%f%g%h%i%j%k%l%m%n%& o%p%q%r%j%s%t%u%~ v%w%}+    #$& & x%y%    ",
+"                  z%d$A%p$d$B%A%B%A%B%A%C%C%A%B%A%B%v%n$'$^%D%    E%e$& & & d.k+    ",
+"                                                          F%v$>+|@f$& & & Z#e       ",
+"                              G%H%I%J%K%L%Q#M%N%O%P%Q%R%S%T%^$A%@ & & & @ s.)+      ",
+"                            U%|.% % % % % % % % % % % V%n#@ x%& & & & Z#'.W%        ",
+"                            X%n#& & & & & & & & & & & & & & & & & x%d w$`.          ",
+"                            Y%Z%'.'.'.'.'.'.'.'.'.'.'.'.'.'.`%R$ &.&!.              "};
Index: widget/src/gtksuperwin/Makefile.in
===================================================================
RCS file: /cvsroot/mozilla/widget/src/gtksuperwin/Makefile.in,v
retrieving revision 1.6
diff -u -u -w -r1.6 Makefile.in
--- widget/src/gtksuperwin/Makefile.in	27 Oct 2001 05:49:19 -0000	1.6
+++ widget/src/gtksuperwin/Makefile.in	26 Aug 2002 05:33:14 -0000
@@ -49,6 +49,9 @@
 DEFINES		+= -D_BSD_SOURCE
 endif
 
+CXX=gcc
+LDFLAGS += -Wl,-Bstatic -Wl,-lstdc++ -Wl,-Bdynamic
+
 INCLUDES	+= \
 		-I$(srcdir) \
 		$(NULL)
Index: widget/src/gtkxtbin/Makefile.in
===================================================================
RCS file: /cvsroot/mozilla/widget/src/gtkxtbin/Makefile.in,v
retrieving revision 1.7
diff -u -u -w -r1.7 Makefile.in
--- widget/src/gtkxtbin/Makefile.in	27 Oct 2001 05:49:21 -0000	1.7
+++ widget/src/gtkxtbin/Makefile.in	26 Aug 2002 05:33:14 -0000
@@ -47,6 +47,9 @@
 DEFINES		+= -D_BSD_SOURCE
 endif
 
+CXX=gcc
+LDFLAGS += -Wl,-Bstatic -Wl,-lstdc++ -Wl,-Bdynamic
+
 INCLUDES	+= \
 		-I$(srcdir) \
 		$(NULL)
Index: xpcom/components/nsComponentManager.h
===================================================================
RCS file: /cvsroot/mozilla/xpcom/components/nsComponentManager.h,v
retrieving revision 1.77
diff -u -u -w -r1.77 nsComponentManager.h
--- xpcom/components/nsComponentManager.h	14 Jun 2002 21:32:50 -0000	1.77
+++ xpcom/components/nsComponentManager.h	26 Aug 2002 05:33:15 -0000
@@ -227,32 +227,6 @@
 
 #define NS_ERROR_IS_DIR NS_ERROR_GENERATE_FAILURE(NS_ERROR_MODULE_XPCOM, 24)
 
-#if defined(XP_UNIX) && !defined(XP_MACOSX)
-/* The default registry on the unix system is $HOME/.mozilla/registry per
- * vr_findGlobalRegName(). vr_findRegFile() will create the registry file
- * if it doesn't exist. But it wont create directories.
- *
- * Hence we need to create the directory if it doesn't exist already.
- *
- * Why create it here as opposed to the app ?
- * ------------------------------------------
- * The app cannot create the directory in main() as most of the registry
- * and initialization happens due to use of static variables.
- * And we dont want to be dependent on the order in which
- * these static stuff happen.
- *
- * Permission for the $HOME/.mozilla will be Read,Write,Execute
- * for user only. Nothing to group and others.
- */
-#define NS_MOZILLA_DIR_NAME		".mozilla"
-#define NS_MOZILLA_DIR_PERMISSION	00700
-#endif /* XP_UNIX */
-
-#ifdef XP_BEOS
-#define NS_MOZILLA_DIR_NAME		"Mozilla"
-#define NS_MOZILLA_DIR_PERMISSION	00700
-#endif /* XP_BEOS */
-
 /**
  * When using the registry we put a version number in it.
  * If the version number that is in the registry doesn't match
Index: xpcom/components/nsRegistry.cpp
===================================================================
RCS file: /cvsroot/mozilla/xpcom/components/nsRegistry.cpp,v
retrieving revision 1.68
diff -u -u -w -r1.68 nsRegistry.cpp
--- xpcom/components/nsRegistry.cpp	14 Jun 2002 05:08:05 -0000	1.68
+++ xpcom/components/nsRegistry.cpp	26 Aug 2002 05:33:15 -0000
@@ -452,6 +452,7 @@
 static void
 EnsureDefaultRegistryDirectory() {
     #if defined(XP_UNIX) && !defined(XP_MACOSX)
+#define NS_MOZILLA_DIR_PERMISSION	00700
     // Create ~/.mozilla as that is the default place for the registry file
 
     /* The default registry on the unix system is $HOME/.mozilla/registry per
@@ -475,7 +476,7 @@
     {
         char dotMozillaDir[1024];
         PR_snprintf(dotMozillaDir, sizeof(dotMozillaDir),
-                    "%s/" NS_MOZILLA_DIR_NAME, home);
+                    "%s/" MOZ_USER_DIR, home);
         if (PR_Access(dotMozillaDir, PR_ACCESS_EXISTS) != PR_SUCCESS)
         {
             PR_MkDir(dotMozillaDir, NS_MOZILLA_DIR_PERMISSION);
@@ -486,13 +487,14 @@
 #endif /* XP_UNIX */
 
 #ifdef XP_BEOS
+#define NS_MOZILLA_DIR_PERMISSION	00700
     BPath p;
     const char *settings = "/boot/home/config/settings";
     if(find_directory(B_USER_SETTINGS_DIRECTORY, &p) == B_OK)
         settings = p.Path();
     char settingsMozillaDir[1024];
     PR_snprintf(settingsMozillaDir, sizeof(settingsMozillaDir),
-                "%s/" NS_MOZILLA_DIR_NAME, settings);
+                "%s/" MOZ_USER_DIR, settings);
     if (PR_Access(settingsMozillaDir, PR_ACCESS_EXISTS) != PR_SUCCESS) {
         PR_MkDir(settingsMozillaDir, NS_MOZILLA_DIR_PERMISSION);
         PR_LOG(nsComponentManagerLog, PR_LOG_ALWAYS,
Index: xpcom/io/nsAppFileLocationProvider.cpp
===================================================================
RCS file: /cvsroot/mozilla/xpcom/io/nsAppFileLocationProvider.cpp,v
retrieving revision 1.38
diff -u -u -w -r1.38 nsAppFileLocationProvider.cpp
--- xpcom/io/nsAppFileLocationProvider.cpp	14 Jun 2002 12:30:38 -0000	1.38
+++ xpcom/io/nsAppFileLocationProvider.cpp	26 Aug 2002 05:33:15 -0000
@@ -70,10 +70,11 @@
 #endif
 
 // define default product directory
-#if defined(XP_WIN) || defined(XP_MAC) || defined(XP_OS2) || defined(XP_BEOS)
-#define DEFAULT_PRODUCT_DIR NS_LITERAL_CSTRING("Mozilla")
-#elif defined (XP_UNIX)
-#define DEFAULT_PRODUCT_DIR NS_LITERAL_CSTRING(".mozilla")
+#if defined(XP_MAC) || defined(XP_OS2)
+// bug 58327
+#define DEFAULT_PRODUCT_DIR "Beonex::Communicator"
+#elif defined (XP_UNIX) || defined(XP_BEOS) || defined(XP_WIN)
+#define DEFAULT_PRODUCT_DIR MOZ_USER_DIR
 #endif
 
 // Locally defined keys used by nsAppDirectoryEnumerator
@@ -375,7 +376,8 @@
 #error dont_know_how_to_get_product_dir_on_your_platform
 #endif
 
-    rv = localDir->AppendRelativeNativePath(DEFAULT_PRODUCT_DIR);
+    rv = localDir->AppendRelativeNativePath
+                                    (NS_LITERAL_CSTRING(DEFAULT_PRODUCT_DIR));
     if (NS_FAILED(rv)) return rv;
     rv = localDir->Exists(&exists);
     if (NS_SUCCEEDED(rv) && !exists)
Index: xpcom/io/nsDirectoryService.cpp
===================================================================
RCS file: /cvsroot/mozilla/xpcom/io/nsDirectoryService.cpp,v
retrieving revision 1.49
diff -u -u -w -r1.49 nsDirectoryService.cpp
--- xpcom/io/nsDirectoryService.cpp	16 Jul 2002 22:17:56 -0000	1.49
+++ xpcom/io/nsDirectoryService.cpp	26 Aug 2002 05:33:15 -0000
@@ -107,13 +107,6 @@
 #define HOME_DIR NS_BEOS_HOME_DIR
 #endif
 
-// define default product directory
-#if defined(XP_WIN) || defined(XP_MAC) || defined(XP_OS2) || defined(XP_BEOS)
-#define DEFAULT_PRODUCT_DIR "Mozilla"
-#elif defined (XP_UNIX) || defined(XP_MACOSX)
-#define DEFAULT_PRODUCT_DIR ".mozilla"
-#endif
-
 //----------------------------------------------------------------------------------------
 nsresult 
 nsDirectoryService::GetCurrentProcessDirectory(nsILocalFile** aFile)
Index: xpfe/bootstrap/Makefile.in
===================================================================
RCS file: /cvsroot/mozilla/xpfe/bootstrap/Makefile.in,v
retrieving revision 1.184.6.2
diff -u -u -w -r1.184.6.2 Makefile.in
--- xpfe/bootstrap/Makefile.in	14 Aug 2002 23:52:19 -0000	1.184.6.2
+++ xpfe/bootstrap/Makefile.in	26 Aug 2002 05:33:17 -0000
@@ -139,6 +139,11 @@
 CPPSRCS += nsNativeAppSupportBase.cpp
 endif
 
+install:: $(topsrcdir)/README/user/unix-tarball.txt $(topsrcdir)/LICENSE
+# Can't use nsinstall, because I want a different filename
+	cp $(topsrcdir)/README/user/unix-tarball.txt $(DIST)/bin/README
+	cp $(topsrcdir)/LICENSE $(DIST)/bin/LICENSE
+
 ifeq ($(MOZ_WIDGET_TOOLKIT),photon)
 CPPSRCS += nsNativeAppSupportPh.cpp
 LIBS += -lphexlib -lph
Index: xpfe/bootstrap/makefile.win
===================================================================
RCS file: /cvsroot/mozilla/xpfe/bootstrap/Attic/makefile.win,v
retrieving revision 1.66.6.1
diff -u -u -w -r1.66.6.1 makefile.win
--- xpfe/bootstrap/makefile.win	14 Aug 2002 22:32:20 -0000	1.66.6.1
+++ xpfe/bootstrap/makefile.win	26 Aug 2002 05:33:17 -0000
@@ -50,6 +50,8 @@
 		  $(NULL)
 include <$(DEPTH)/config/config.mak>
 
+DIRS=icons
+
 DEFINES=-DWIN32_LEAN_AND_MEAN
 
 !if defined(MOZ_STATIC_COMPONENT_LIBS) && !defined(MOZ_GECKO_DLL)
@@ -71,7 +73,7 @@
  $(NULL)
 
 MAKE_OBJ_TYPE = EXE
-PROGRAM = .\$(OBJDIR)\mozilla.exe
+PROGRAM = .\$(OBJDIR)\beonex-comm.exe
 RESFILE = splash.res
 
 LCFLAGS = \
@@ -193,9 +195,15 @@
 	$(MAKE_INSTALL) .\icons\windows\msgcomposeWindow.ico $(DIST)\bin\chrome\icons\default
 	$(MAKE_INSTALL) .\icons\windows\venkman-window.ico $(DIST)\bin\chrome\icons\default
 	$(MAKE_INSTALL) .\icons\windows\winInspectorMain.ico $(DIST)\bin\chrome\icons\default
+	copy $(topsrcdir)\README\user\win32.txt $(DIST)\bin\README.txt
+	copy $(topsrcdir)\LICENSE $(DIST)\bin\LICENSE.txt
+
+# I don't know, if the copy commands work. Please fix (or execute manually),
+# if not.
+# Can't use install above, because I want a different filename
 
 clobber::
-	$(RM) $(DIST)\bin\mozilla.exe
+	$(RM) $(DIST)\bin\beonex-comm.exe
 	$(RM) $(DIST)\bin\chrome\icons\default\abcardWindow.ico
 	$(RM) $(DIST)\bin\chrome\icons\default\addressbookWindow.ico
 	$(RM) $(DIST)\bin\chrome\icons\default\bmPropsWindow.ico
Index: xpfe/browser/resources/content/navigator.js
===================================================================
RCS file: /cvsroot/mozilla/xpfe/browser/resources/content/navigator.js,v
retrieving revision 1.467
diff -u -u -w -r1.467 navigator.js
--- xpfe/browser/resources/content/navigator.js	10 Jul 2002 03:53:23 -0000	1.467
+++ xpfe/browser/resources/content/navigator.js	26 Aug 2002 05:33:17 -0000
@@ -834,6 +834,8 @@
   } catch (ex) {
   }
 
+  debug("Search defaultSearchURL: " + defaultSearchURL + "\n");
+
   // Fallback to a default url (one that we can get sidebar search results for)
   if (!defaultSearchURL)
     defaultSearchURL = fallbackDefaultSearchURL;
@@ -1701,6 +1703,16 @@
     return true;
   }
   return false;
+}
+
+function PageProxyClickHandler(aEvent)
+{
+  if (aEvent.button == 1)
+    // load url/keyword from clipboard
+    return middleMousePaste();
+  else
+    // popup "file bookmark" dialog
+    return BookmarksUtils.addBookmarkForBrowser(getBrowser().webNavigation, true);
 }
 
 function updateComponentBarBroadcaster()
Index: xpfe/browser/resources/content/navigator.xul
===================================================================
RCS file: /cvsroot/mozilla/xpfe/browser/resources/content/navigator.xul,v
retrieving revision 1.385
diff -u -u -w -r1.385 navigator.xul
--- xpfe/browser/resources/content/navigator.xul	30 Jul 2002 03:00:04 -0000	1.385
+++ xpfe/browser/resources/content/navigator.xul	26 Aug 2002 05:33:17 -0000
@@ -173,9 +173,11 @@
                  onclick="URLBarClickHandler(event);">
           <deck id="page-proxy-deck">
             <image id="page-proxy-button"
+                   onclick="PageProxyClickHandler(event);"
                    ondraggesture="PageProxyDragGesture(event);"
                    tooltiptext="&proxyIcon.tooltip;"/>
             <image id="page-proxy-favicon" validate="never"
+                   onclick="PageProxyClickHandler(event);"
                    ondraggesture="PageProxyDragGesture(event);"
                    onload="this.parentNode.selectedIndex = 1;
                            event.stopPropagation();
Index: xpfe/browser/resources/content/navigatorOverlay.xul
===================================================================
RCS file: /cvsroot/mozilla/xpfe/browser/resources/content/navigatorOverlay.xul,v
retrieving revision 1.262.6.1
diff -u -u -w -r1.262.6.1 navigatorOverlay.xul
--- xpfe/browser/resources/content/navigatorOverlay.xul	17 Aug 2002 23:02:50 -0000	1.262.6.1
+++ xpfe/browser/resources/content/navigatorOverlay.xul	26 Aug 2002 05:33:17 -0000
@@ -152,6 +152,7 @@
              accesskey="&addCurPageAsCmd.accesskey;"
              oncommand="addBookmarkAs();"/>
     <command id="Browser:AddGroupmarkAs" label="&addCurTabsAsCmd.label;"
+             hidden="true"
              accesskey="&addCurTabsAsCmd.accesskey;"
              oncommand="addGroupmarkAs(); event.preventBubble();"/>
     <command id="Browser:ManageBookmark" label="&manBookmarksCmd.label;" accesskey="&manBookmarksCmd.accesskey;" 
@@ -184,7 +185,14 @@
   <menubar id="main-menubar" class="chromeclass-menubar">
     <menu id="menu_File">
       <menupopup id="menu_FilePopup" onpopupshowing="getContentAreaFrameCount();">
-        <menu id="menu_New">
+        <menuitem id="menu_newNavigator" command="cmd_newNavigator"
+                  key="key_newNavigator"
+                  label="&browserCmd.label;"
+                  accesskey="&browserCmd.accesskey;"/>
+        <menuitem id="menu_newNavigatorTab" command="cmd_newNavigatorTab"
+                  key="key_newNavigatorTab"
+                  label="&newtabCmd.label;" accesskey="&tabCmd.accesskey;"/>
+        <menu hidden="true" id="menu_New">
           <menupopup id="menu_NewPopup">
             <!-- From utilityOverlay.xul -->
             <menuitem id="menu_newNavigator" command="cmd_newNavigator"/>
@@ -263,8 +271,8 @@
         <menuseparator />
         <menuitem accesskey="&pageSourceCmd.accesskey;" label="&pageSourceCmd.label;" key="key_viewSource" command="View:PageSource"/>
         <menuitem accesskey="&pageInfoCmd.accesskey;"   label="&pageInfoCmd.label;"   key="key_viewInfo"   command="View:PageInfo"/>
-        <menuseparator />
-        <menu label="&applyTheme.label;" accesskey="&applyTheme.accesskey;">
+        <menuseparator hidden="true" />
+        <menu hidden="true" label="&applyTheme.label;" accesskey="&applyTheme.accesskey;">
           <menupopup id="theme" datasources="rdf:chrome" ref="urn:mozilla:skin:root" oncommand="applyTheme(event.target)" onpopupshowing="checkTheme()">
             <menuitem label="&themePreferencesCmd.label;" accesskey="&themePreferencesCmd.accesskey;"
                       oncommand="goPreferences('appearance','chrome://communicator/content/pref/pref-themes.xul', 'themes-panel')"/>
@@ -362,7 +370,8 @@
   <menu id="windowMenu"/>
   
   <menu accesskey="&helpMenuCmd.accesskey;" id="menu_Help"/>
-
+  <!-- Menu for testing.
+-->
 </menubar>
 
 </overlay>
Index: xpfe/browser/resources/locale/en-US/navigator.dtd
===================================================================
RCS file: /cvsroot/mozilla/xpfe/browser/resources/locale/en-US/navigator.dtd,v
retrieving revision 1.157.8.1
diff -u -u -w -r1.157.8.1 navigator.dtd
--- xpfe/browser/resources/locale/en-US/navigator.dtd	18 Aug 2002 18:59:08 -0000	1.157.8.1
+++ xpfe/browser/resources/locale/en-US/navigator.dtd	26 Aug 2002 05:33:17 -0000
@@ -11,10 +11,27 @@
 <!ENTITY mainWindow.titlemodifiermenuseparator " - ">
 <!ENTITY viewsourcetitle.preface "Source for: ">
 
+
+
+<!-- Could you please decide, where to place that? Finally? -->
+
+<!-- LOCALIZATION NOTE (mainWindow.title): DONT_TRANSLATE --> 
+<!ENTITY mainWindow.title "&brandShortName;"> 
+<!-- LOCALIZATION NOTE (mainWindow.titlemodifier) : DONT_TRANSLATE --> 
+<!ENTITY mainWindow.titlemodifier "&brandShortName;"> 
+<!-- LOCALIZATION NOTE (mainWindow.titlemodifiermenuseparator): DONT_TRANSLATE -->
+<!ENTITY mainWindow.titlemodifiermenuseparator " - ">
+<!ENTITY viewsourcetitle.preface "Source for: ">
+
+<!-- end removed stuff -->
+
+
+
 <!ENTITY nothingAvailable.label "(Nothing Available)">
 
-<!ENTITY browserCmd.label	"New Navigator Window">
+<!ENTITY browserCmd.label	"New Window">
 <!ENTITY browserCmd.accesskey	"N">
+<!ENTITY newtabCmd.label "New Tab">
 <!ENTITY tabCmd.label "Navigator Tab">
 <!ENTITY tabCmd.accesskey "T">
 <!ENTITY tabCmd.commandkey "t">
@@ -130,7 +147,7 @@
 
 <!ENTITY bookmarksMenu.label "Bookmarks">
 <!ENTITY bookmarksMenu.accesskey "B">
-<!ENTITY addCurPageCmd.label "Bookmark This Page">
+<!ENTITY addCurPageCmd.label "Add to Bookmarks">
 <!ENTITY addCurPageCmd.accesskey "B">
 <!ENTITY addCurPageCmd.commandkey "d">
 <!ENTITY addCurPageAsCmd.label "File Bookmark...">
@@ -165,15 +182,15 @@
 
 <!-- Toolbar items --> 
 <!ENTITY backButton.label             "Back">
-<!ENTITY backButton.tooltip           "Go back one page">
+<!ENTITY backButton.tooltip           "Go back one page in browsing history">
 <!ENTITY forwardButton.label          "Forward">
-<!ENTITY forwardButton.tooltip        "Go forward one page">
+<!ENTITY forwardButton.tooltip        "Go forward one page in browsing history">
 <!ENTITY reloadButton.label           "Reload">
-<!ENTITY reloadButton.tooltip         "Reload current page">
+<!ENTITY reloadButton.tooltip         "Reload current page. Use SHIFT-click to circumvent cache.">
 <!ENTITY stopButton.label             "Stop">
 <!ENTITY stopButton.tooltip           "Stop loading this page">
-<!ENTITY searchButton.label           "Search">
-<!ENTITY searchButton.tooltip         "Type a word in the field to the left, then click Search">
+<!ENTITY searchButton.label           "">
+<!ENTITY searchButton.tooltip         "Type a word in the field to the left, then click this button to search for the word using your favorite search engine">
 <!ENTITY goButton.label               "Go">
 <!ENTITY goButton.tooltip             "Type a location in the field to the left, then click Go">
 <!ENTITY printButton.label            "Print">
Index: xpfe/browser/resources/locale/en-US/region.properties
===================================================================
RCS file: /cvsroot/mozilla/xpfe/browser/resources/locale/en-US/region.properties,v
retrieving revision 1.6
diff -u -u -w -r1.6 region.properties
--- xpfe/browser/resources/locale/en-US/region.properties	2 Aug 2002 00:53:34 -0000	1.6
+++ xpfe/browser/resources/locale/en-US/region.properties	26 Aug 2002 05:33:17 -0000
@@ -1,19 +1,20 @@
 # navigator.properties
-homePageDefault=http://www.mozilla.org/
+homePageDefault=about:welcome
+keywordList=http://www.beonex.com/communicator/redir/keyword
+webmailKeyword=http://www.beonex.com/communicator/redir/webmail
+fallbackDefaultSearchURL=http://www.google.com/search?q=
+otherSearchURL=http://www.google.com/
+
+careerKeyword=keyword:[Your city] careers
 shopKeyword=keyword:shop [Product]
 quoteKeyword=keyword:quote [Enter symbol here]
 localKeyword=keyword:zip [Your zip code]
-keywordList=http://home.netscape.com/escapes/keywords
-webmailKeyword=http://webmail.netscape.com
-careerKeyword=keyword:[Your city] careers
-fallbackDefaultSearchURL=http://search.netscape.com/cgi-bin/search?charset=UTF-8&search=
-otherSearchURL=http://home.netscape.com/bookmark/6_0/tsearch.html
 #
 # all.js
 #
-browser.startup.homepage=http://www.mozilla.org/start/
-browser.throbber.url=http://www.mozilla.org/
-browser.search.defaulturl=http://search.netscape.com/cgi-bin/search?search=
+browser.startup.homepage=about:welcome
+browser.throbber.url=about:welcome
+browser.search.defaulturl=http://www.google.com/search?q=
 general.useragent.contentlocale=US
 
 wallet.Server=http://www.mozilla.org/wallet/tables/
@@ -21,4 +22,4 @@
 
 #config.js
 #
-startup.homepage_override_url=http://www.mozilla.org/start/
+startup.homepage_override_url=about:welcome
Index: xpfe/communicator/jar.mn
===================================================================
RCS file: /cvsroot/mozilla/xpfe/communicator/jar.mn,v
retrieving revision 1.21
diff -u -u -w -r1.21 jar.mn
--- xpfe/communicator/jar.mn	20 Feb 2002 06:19:18 -0000	1.21
+++ xpfe/communicator/jar.mn	26 Aug 2002 05:33:18 -0000
@@ -31,6 +31,7 @@
     content/communicator/printPreviewBindings.xml        (resources/content/printPreviewBindings.xml)
 
 en-US.jar:
+	  		locale/en-US/communicator/welcome.html                      (resources/locale/en-US/welcome.html)
         locale/en-US/communicator/contents.rdf                      (resources/locale/en-US/contents.rdf)
         locale/en-US/communicator/utilityOverlay.dtd                (resources/locale/en-US/utilityOverlay.dtd) 
         locale/en-US/communicator/utilityOverlay.properties         (resources/locale/en-US/utilityOverlay.properties) 
Index: xpfe/communicator/resources/content/nsContextMenu.js
===================================================================
RCS file: /cvsroot/mozilla/xpfe/communicator/resources/content/nsContextMenu.js,v
retrieving revision 1.73
diff -u -u -w -r1.73 nsContextMenu.js
--- xpfe/communicator/resources/content/nsContextMenu.js	8 Jul 2002 06:19:28 -0000	1.73
+++ xpfe/communicator/resources/content/nsContextMenu.js	26 Aug 2002 05:33:18 -0000
@@ -106,7 +106,7 @@
         //this.setItemAttrFromNode( "context-stop", "disabled", "canStop" );
     },
     initSaveItems : function () {
-        this.showItem( "context-savepage", !( this.inDirList || this.isTextSelected || this.onTextInput ) && !( this.onLink && this.onImage ) );
+        this.showItem( "context-savepage", !( this.inDirList || this.isTextSelected || this.onTextInput || this.onLink ) );
 
         // Save link depends on whether we're in a link.
         this.showItem( "context-savelink", this.onSaveableLink );
@@ -144,7 +144,7 @@
     },
     initMiscItems : function () {
         // Use "Bookmark This Link" if on a link.
-        this.showItem( "context-bookmarkpage", !( this.isTextSelected || this.onTextInput ) );
+        this.showItem( "context-bookmarkpage", !( this.isTextSelected || this.onTextInput || this.onLink || this.onImage ) );
         this.showItem( "context-bookmarklink", this.onLink && !this.onMailtoLink );
         this.showItem( "context-searchselect", this.isTextSelected );
         this.showItem( "frame", this.inFrame );
Index: xpfe/communicator/resources/content/utilityOverlay.xul
===================================================================
RCS file: /cvsroot/mozilla/xpfe/communicator/resources/content/utilityOverlay.xul,v
retrieving revision 1.35
diff -u -u -w -r1.35 utilityOverlay.xul
--- xpfe/communicator/resources/content/utilityOverlay.xul	19 Jun 2002 06:42:27 -0000	1.35
+++ xpfe/communicator/resources/content/utilityOverlay.xul	26 Aug 2002 05:33:18 -0000
@@ -227,11 +227,15 @@
         label="&helpMenu.label;"
         accesskey="&helpMenu.accesskey;">
     <menupopup id="helpPopup">
+      <menuitem accesskey="&welcomeCommCmd.accesskey;"
+                label="&welcomeCommCmd.label;"
+                oncommand="openTopWin('about:welcome')"/>
       <menuitem accesskey="&releaseCmd.accesskey;"
                 label="&releaseCmd.label;"
                 id="releaseUrl"
                 oncommand="openTopWin('&releaseURL;');"/>
 
+<!--
       <menuseparator id="menu_HelpAboutSeparator"/>
 
       <menuitem class="about"
@@ -239,6 +243,7 @@
                 label="&aboutCommPluginsCmd.label;"
                 id="pluginInfo"
                 oncommand="openTopWin('about:plugins')"/>
+-->
       <menuitem accesskey="&aboutCmd.accesskey;"
                 label="&aboutCmd.label;"
                 id="aboutName"
Index: xpfe/communicator/resources/locale/en-US/MANIFEST
===================================================================
RCS file: /cvsroot/mozilla/xpfe/communicator/resources/locale/en-US/MANIFEST,v
retrieving revision 1.5
diff -u -u -w -r1.5 MANIFEST
--- xpfe/communicator/resources/locale/en-US/MANIFEST	23 Feb 2001 03:31:46 -0000	1.5
+++ xpfe/communicator/resources/locale/en-US/MANIFEST	26 Aug 2002 05:33:18 -0000
@@ -5,3 +5,4 @@
 taskbar.rdf
 taskbarOverlay.dtd
 tasksOverlay.dtd
+welcome.html
Index: xpfe/communicator/resources/locale/en-US/region.properties
===================================================================
RCS file: /cvsroot/mozilla/xpfe/communicator/resources/locale/en-US/region.properties,v
retrieving revision 1.4
diff -u -u -w -r1.4 region.properties
--- xpfe/communicator/resources/locale/en-US/region.properties	20 Feb 2002 04:01:32 -0000	1.4
+++ xpfe/communicator/resources/locale/en-US/region.properties	26 Aug 2002 05:33:18 -0000
@@ -1,7 +1,7 @@
 # search-panel.properties
 #   Localizable URLs
-defaultSearchURL=http://search.netscape.com/cgi-bin/search?charset=UTF-8&search=
-browser.search.defaultenginename=Netscape Search
+defaultSearchURL=http://www.google.com/search?q=
+browser.search.defaultenginename=Google
 
 # sidebar customize/more... panel locale
 intl.content.langcode=en-US
Index: xpfe/communicator/resources/locale/en-US/taskbar.rdf
===================================================================
RCS file: /cvsroot/mozilla/xpfe/communicator/resources/locale/en-US/taskbar.rdf,v
retrieving revision 1.1
diff -u -u -w -r1.1 taskbar.rdf
--- xpfe/communicator/resources/locale/en-US/taskbar.rdf	17 Jun 2000 03:06:34 -0000	1.1
+++ xpfe/communicator/resources/locale/en-US/taskbar.rdf	26 Aug 2002 05:33:18 -0000
@@ -1,18 +1,5 @@
 <?xml version="1.0"?>
-<!DOCTYPE RDF 
-[
-<!-- LOCALIZATION NOTE  (mozillaButton.label): DONT_TRANSLATE -->
-<!ENTITY  mozillaButton.label "Mozilla">
-<!ENTITY  mozillaTooltip.label  "Links to mozilla.org webtools">
-<!-- taskbar popups -->
-<!-- LOCALIZATION NOTE  (bugzillaButton.label): Do NOT translate "Bugzilla" -->
-<!ENTITY  bugzillaButton.label "Go to Bugzilla">
-<!ENTITY  tinderboxButton.label "Look at Tinderbox">
-<!-- LOCALIZATION NOTE  (bonsai.label): Do NOT translate "Bonsai" -->
-<!ENTITY  bonsai.label "Look at Bonsai">
-
-]
->
+<!DOCTYPE RDF [] >
 <RDF:RDF xmlns:RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
          xmlns:NC="http://home.netscape.com/NC-rdf#">
 
@@ -20,9 +7,9 @@
   <RDF:Seq ID="root">
 
     <RDF:li>
-      <RDF:Seq about="urn:taskbar:mozilla-group">
-        <RDF:li resource="urn:taskbar:mozilla-group:bonsai" />
-        <RDF:li resource="urn:taskbar:mozilla-group:bugzilla" />
+      <RDF:Seq about="urn:taskbar:beonex-group">
+        <RDF:li resource="urn:taskbar:beonex-group:homepage" />
+        <RDF:li resource="urn:taskbar:beonex-group:support" />
      </RDF:Seq>
     </RDF:li>
 
@@ -30,18 +17,18 @@
 <!-- root end -->
 
 <!-- Description -->
-<RDF:Description about="urn:taskbar:mozilla-group">
-    <NC:title>&mozillaButton.label;</NC:title>
-    <NC:tooltip>&mozillaTooltip.label;</NC:tooltip>
+<RDF:Description about="urn:taskbar:beonex-group">
+    <NC:title>Beonex</NC:title>
+    <NC:tooltip>Links to the Beonex website</NC:tooltip>
 </RDF:Description>
 
-  <RDF:Description about="urn:taskbar:mozilla-group:bonsai">
-    <NC:title>&bonsai.label;</NC:title> 
-    <NC:content>openTopWin('http://bonsai.mozilla.org/toplevel.cgi?treeid=SeaMonkey')</NC:content>
+  <RDF:Description about="urn:taskbar:beonex-group:homepage">
+    <NC:title>Beonex Homepage</NC:title>
+    <NC:content>openTopWin('http://www.beonex.com')</NC:content>
   </RDF:Description>
 
-  <RDF:Description about="urn:taskbar:mozilla-group:bugzilla">
-    <NC:title>&bugzillaButton.label;</NC:title> 
-    <NC:content>openTopWin('http://bugzilla.mozilla.org')</NC:content>
+  <RDF:Description about="urn:taskbar:beonex-group:support">
+    <NC:title>Support</NC:title>
+    <NC:content>openTopWin('http://www.beonex.com/communicator/support')</NC:content>
   </RDF:Description>
 </RDF:RDF>
Index: xpfe/communicator/resources/locale/en-US/utilityOverlay.dtd
===================================================================
RCS file: /cvsroot/mozilla/xpfe/communicator/resources/locale/en-US/utilityOverlay.dtd,v
retrieving revision 1.21
diff -u -u -w -r1.21 utilityOverlay.dtd
--- xpfe/communicator/resources/locale/en-US/utilityOverlay.dtd	25 Jul 2002 20:36:09 -0000	1.21
+++ xpfe/communicator/resources/locale/en-US/utilityOverlay.dtd	26 Aug 2002 05:33:18 -0000
@@ -57,10 +57,11 @@
 <!ENTITY helpMenu.label					"Help"> 
 <!ENTITY helpMenu.accesskey				"h"> 
 
-<!-- NOTE (whatNewCmd.label): This is not used in Mozilla but is used in Netscape -->
-<!ENTITY whatNewCmd.label				"What's New">  
-
-<!ENTITY releaseCmd.label				"Release Notes">
+<!ENTITY docCommCmd.label			"Documentation">
+<!ENTITY docCommCmd.accesskey	                "d">
+<!ENTITY welcomeCommCmd.label			"Welcome">
+<!ENTITY welcomeCommCmd.accesskey		"w">
+<!ENTITY releaseCmd.label				"Release-Notes">
 <!ENTITY releaseCmd.accesskey				"r">
 <!ENTITY aboutCmd.label					"About &brandShortName;">
 <!ENTITY aboutCmd.accesskey				"A">
Index: xpfe/communicator/resources/locale/en-US/unix/platformCommunicatorOverlay.dtd
===================================================================
RCS file: /cvsroot/mozilla/xpfe/communicator/resources/locale/en-US/unix/platformCommunicatorOverlay.dtd,v
retrieving revision 1.1
diff -u -u -w -r1.1 platformCommunicatorOverlay.dtd
--- xpfe/communicator/resources/locale/en-US/unix/platformCommunicatorOverlay.dtd	3 Dec 2001 08:22:19 -0000	1.1
+++ xpfe/communicator/resources/locale/en-US/unix/platformCommunicatorOverlay.dtd	26 Aug 2002 05:33:18 -0000
@@ -1,12 +1,12 @@
 <!-- unix -->
 <!-- LOCALIZATION NOTE : FILE Do not translate all the Cmd.key and accesskey --> 
 
-<!ENTITY closeCmd.label			"Close">  
+<!ENTITY closeCmd.label			"Close Window">  
 <!ENTITY closeCmd.key			"W">  
 <!ENTITY closeCmd.accesskey		"c">
 
-<!ENTITY quitApplicationCmd.label	"Quit"> 
-<!ENTITY quitApplicationCmd.key		"Q"> 
+<!ENTITY quitApplicationCmd.label	"Quit Communicator"> 
+<!ENTITY quitApplicationCmd.key		""> 
 <!ENTITY quitApplicationCmd.accesskey	"q">
 
 <!ENTITY redoCmd.label			"Redo">  
Index: xpfe/communicator/resources/locale/en-US/win/platformCommunicatorOverlay.dtd
===================================================================
RCS file: /cvsroot/mozilla/xpfe/communicator/resources/locale/en-US/win/platformCommunicatorOverlay.dtd,v
retrieving revision 1.1
diff -u -u -w -r1.1 platformCommunicatorOverlay.dtd
--- xpfe/communicator/resources/locale/en-US/win/platformCommunicatorOverlay.dtd	3 Dec 2001 08:22:22 -0000	1.1
+++ xpfe/communicator/resources/locale/en-US/win/platformCommunicatorOverlay.dtd	26 Aug 2002 05:33:18 -0000
@@ -1,12 +1,12 @@
 <!-- win -->
 <!-- LOCALIZATION NOTE : FILE Do not translate all the Cmd.key and accesskey --> 
 
-<!ENTITY closeCmd.label			"Close">  
+<!ENTITY closeCmd.label			"Close Window">  
 <!ENTITY closeCmd.key			"W">  
 <!ENTITY closeCmd.accesskey		"c">
 
-<!ENTITY quitApplicationCmd.label	"Exit"> 
-<!ENTITY quitApplicationCmd.key		"Q"> 
+<!ENTITY quitApplicationCmd.label	"Exit Communicator"> 
+<!ENTITY quitApplicationCmd.key		""> 
 <!ENTITY quitApplicationCmd.accesskey	"x">
 
 <!ENTITY redoCmd.label			"Redo">  
Index: xpfe/components/jar.mn
===================================================================
RCS file: /cvsroot/mozilla/xpfe/components/jar.mn,v
retrieving revision 1.58
diff -u -u -w -r1.58 jar.mn
--- xpfe/components/jar.mn	11 Jul 2002 21:36:50 -0000	1.58
+++ xpfe/components/jar.mn	26 Aug 2002 05:33:18 -0000
@@ -37,6 +37,7 @@
     content/communicator/pref/pref-history.xul                  (prefwindow/resources/content/pref-history.xul)
     content/communicator/pref/pref-http.xul                     (prefwindow/resources/content/pref-http.xul)
     content/communicator/pref/pref-http.js                      (prefwindow/resources/content/pref-http.js)
+    content/communicator/pref/pref-referrer.xul                 (prefwindow/resources/content/pref-referrer.xul)
     content/communicator/pref/pref-languages.xul                (prefwindow/resources/content/pref-languages.xul)
     content/communicator/pref/pref-languages-add.xul            (prefwindow/resources/content/pref-languages-add.xul)
     content/communicator/pref/pref-languages.js                 (prefwindow/resources/content/pref-languages.js)
@@ -124,6 +125,7 @@
     locale/en-US/communicator/pref/pref-fonts.dtd               (prefwindow/resources/locale/en-US/pref-fonts.dtd)
     locale/en-US/communicator/pref/pref-history.dtd             (prefwindow/resources/locale/en-US/pref-history.dtd)
     locale/en-US/communicator/pref/pref-http.dtd                (prefwindow/resources/locale/en-US/pref-http.dtd)
+    locale/en-US/communicator/pref/pref-referrer.dtd            (prefwindow/resources/locale/en-US/pref-referrer.dtd)
     locale/en-US/communicator/pref/pref-languages.dtd           (prefwindow/resources/locale/en-US/pref-languages.dtd)
     locale/en-US/communicator/pref/pref-languages.properties    (prefwindow/resources/locale/en-US/pref-languages.properties)
     locale/en-US/communicator/pref/pref-navigator.dtd           (prefwindow/resources/locale/en-US/pref-navigator.dtd)
Index: xpfe/components/bookmarks/resources/addBookmark.xul
===================================================================
RCS file: /cvsroot/mozilla/xpfe/components/bookmarks/resources/addBookmark.xul,v
retrieving revision 1.23
diff -u -u -w -r1.23 addBookmark.xul
--- xpfe/components/bookmarks/resources/addBookmark.xul	1 Apr 2002 08:47:13 -0000	1.23
+++ xpfe/components/bookmarks/resources/addBookmark.xul	26 Aug 2002 05:33:18 -0000
@@ -36,7 +36,7 @@
 %addBookmarkDTD;
 ]>
 
-<dialog id="newBookmarkDialog" style="width: 36em;"
+<dialog id="newBookmarkDialog" style="width: 36em; height: 36em;"
         xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
         ondialogaccept="return onOK(event)"
         title="&newBookmark.title;" title-selectFolder="&selectFolder.label;"
Index: xpfe/components/prefwindow/resources/content/pref-advanced.xul
===================================================================
RCS file: /cvsroot/mozilla/xpfe/components/prefwindow/resources/content/pref-advanced.xul,v
retrieving revision 1.72
diff -u -u -w -r1.72 pref-advanced.xul
--- xpfe/components/prefwindow/resources/content/pref-advanced.xul	25 Jul 2002 22:03:11 -0000	1.72
+++ xpfe/components/prefwindow/resources/content/pref-advanced.xul	26 Aug 2002 05:33:19 -0000
@@ -140,7 +140,8 @@
       <checkbox id="advancedJavaAllow" label="&enbJavaCheck.label;" accesskey="&enbJavaCheck.accesskey;"
                 prefstring="security.enable_java"/>
     </vbox>
-    <vbox>
+
+    <vbox hidden="true">
     <vbox align="start">
       <checkbox id="advancedMailFTP" label="&sendAddFtpCheck.label;" accesskey="&sendAddFtpCheck.accesskey;"
                 prefstring="advanced.mailftp"
@@ -152,7 +153,6 @@
                flex="2"/>
     </hbox>
     </vbox>
-    <separator/>
   </groupbox>
   <groupbox id="perfSettings">
     <caption id="perfLabel" label="&perfTitle.label;"/>
Index: xpfe/components/prefwindow/resources/content/pref-smartupdate.xul
===================================================================
RCS file: /cvsroot/mozilla/xpfe/components/prefwindow/resources/content/pref-smartupdate.xul,v
retrieving revision 1.43
diff -u -u -w -r1.43 pref-smartupdate.xul
--- xpfe/components/prefwindow/resources/content/pref-smartupdate.xul	29 Mar 2002 02:45:48 -0000	1.43
+++ xpfe/components/prefwindow/resources/content/pref-smartupdate.xul	26 Aug 2002 05:33:19 -0000
@@ -18,28 +18,33 @@
         getService(Components.interfaces.nsIPrefBranch);
       if (!prefs.getBoolPref("update_notifications.enabled"))
       {
-        // disable frequency radiogroup
-        var freqWeekly = document.getElementById("freqWeekly");
-        var freqMonthly = document.getElementById("freqMonthly");
-        freqWeekly.setAttribute("disabled", "true");
-        freqMonthly.setAttribute("disabled", "true");
+        enableFrequency(false);
       }
     }
 
     function toggleFrequency()
     {
       var enabled = document.getElementById("updateNotificationsEnabled");
+      enableFrequency(enabled.getAttribute("checked") == "true");
+    }
+
+    function enableFrequency(enable)
+    {
+      var freqDaily = document.getElementById("freqDaily");
       var freqWeekly = document.getElementById("freqWeekly");
       var freqMonthly = document.getElementById("freqMonthly");
-      if (enabled.getAttribute("checked") == "true")
+
+      if (enable)
       {
         // enable frequency radiogroup
+        freqDaily.removeAttribute("disabled");
         freqWeekly.removeAttribute("disabled");
         freqMonthly.removeAttribute("disabled");
       }
       else
       {
         // disable frequency radiogroup
+        freqDaily.setAttribute("disabled", "true");
         freqWeekly.setAttribute("disabled", "true");
         freqMonthly.setAttribute("disabled", "true");
       }
@@ -60,8 +65,9 @@
               accesskey="&enableUN.accesskey;" oncommand="toggleFrequency();"
               prefstring="update_notifications.enabled"/>
     <radiogroup id="updateFrequency" orient="horizontal" 
-                prefstring="update_notifications.provider.0.frequency"
-                prefdefval="7">
+                prefstring="update_notifications.provider.0.frequency">
+      <radio id="freqDaily" label="&daily.label;" 
+             accesskey="&daily.accesskey;" value="1"/>
       <radio id="freqWeekly" label="&weekly.label;" 
              accesskey="&weekly.accesskey;" value="7"/>
       <radio id="freqMonthly" label="&monthly.label;" 
Index: xpfe/components/prefwindow/resources/content/preftree.xul
===================================================================
RCS file: /cvsroot/mozilla/xpfe/components/prefwindow/resources/content/preftree.xul,v
retrieving revision 1.94.8.1
diff -u -u -w -r1.94.8.1 preftree.xul
--- xpfe/components/prefwindow/resources/content/preftree.xul	17 Aug 2002 23:02:53 -0000	1.94.8.1
+++ xpfe/components/prefwindow/resources/content/preftree.xul	26 Aug 2002 05:33:19 -0000
@@ -119,7 +119,13 @@
       <treerow>
         <treecell url="chrome://communicator/content/pref/pref-security.xul" label="&security.label;" />
       </treerow>
-      <treechildren id="securityChildren"/>
+      <treechildren id="securityChildren">
+        <treeitem>
+          <treerow>
+            <treecell url="chrome://communicator/content/pref/pref-referrer.xul" label="&referrer.label;"/>
+          </treerow>
+        </treeitem>
+      </treechildren>
     </treeitem>
 
     <treeitem container="true" id="advancedItem">
@@ -159,6 +165,9 @@
         </treeitem> 
       </treechildren>
     </treeitem>
+
+<!-- debug stuff
+-->
 
     <treeitem id="offlineItem">
       <treerow>
Index: xpfe/components/prefwindow/resources/locale/en-US/pref-smart_browsing.dtd
===================================================================
RCS file: /cvsroot/mozilla/xpfe/components/prefwindow/resources/locale/en-US/pref-smart_browsing.dtd,v
retrieving revision 1.27
diff -u -u -w -r1.27 pref-smart_browsing.dtd
--- xpfe/components/prefwindow/resources/locale/en-US/pref-smart_browsing.dtd	12 Jun 2002 20:38:42 -0000	1.27
+++ xpfe/components/prefwindow/resources/locale/en-US/pref-smart_browsing.dtd	26 Aug 2002 05:33:19 -0000
@@ -5,7 +5,7 @@
 
 <!--LOCALIZATION NOTE (internetKeywordsHeader.label): DONT_TRANSLATE -->
 <!ENTITY  internetKeywordsHeader.label          "Internet Keywords">
-<!ENTITY  internetKeywordsDescription.label     "&brandShortName; Internet Keywords enables fast access to services such as stock quotes, search and other information from the Location bar.">
+<!ENTITY  internetKeywordsDescription.label     "Internet Keywords enable fast access to services such as stock quotes, search and other information from the Location bar.">
 <!ENTITY  moreInformation.label                 "More Information...">
 <!ENTITY  moreInformation.accesskey             "m">
 <!--LOCALIZATION NOTE (enableKeyCheck.label): Do not translate 'Internet Keywords' -->
Index: xpfe/components/prefwindow/resources/locale/en-US/pref-smartupdate.dtd
===================================================================
RCS file: /cvsroot/mozilla/xpfe/components/prefwindow/resources/locale/en-US/pref-smartupdate.dtd,v
retrieving revision 1.12
diff -u -u -w -r1.12 pref-smartupdate.dtd
--- xpfe/components/prefwindow/resources/locale/en-US/pref-smartupdate.dtd	20 Feb 2002 04:01:34 -0000	1.12
+++ xpfe/components/prefwindow/resources/locale/en-US/pref-smartupdate.dtd	26 Aug 2002 05:33:19 -0000
@@ -1,7 +1,7 @@
 <!--LOCALIZATION NOTE : FILE UI for Software Updates prefs -->
 <!ENTITY lHeader                              "Software Installation">
 <!ENTITY smartTitle.label                     "Manage Software Installations and Updates">
-<!ENTITY enableSU.label                       "Enable software installation. (You will be prompted for each update.)">
+<!ENTITY enableSU.label                       "Enable software installation. (You will be prompted before each update.)">
 
 <!ENTITY enableSU.accesskey                   "e">
 <!ENTITY enableNotification.label             "Notify me when new and updated software is available">
@@ -11,11 +11,12 @@
 <!ENTITY selectUninstall.label                "To uninstall, select from the following list and click the uninstall button">
 <!ENTITY uninstallButton.label                "Uninstall">
 <!ENTITY uninstallButton.accesskey            "u">
-
 <!ENTITY updateNotifications.label            "Update Notifications">
 <!ENTITY updateNotifications.desc             "Check for new versions of this software.  No information about you or your computer will be revealed during this operation.">
 <!ENTITY enableUN.label                       "Check for updates:">
 <!ENTITY enableUN.accesskey                   "c">
+<!ENTITY daily.label                          "daily">
+<!ENTITY daily.accesskey                      "d">
 <!ENTITY weekly.label                         "weekly">
 <!ENTITY weekly.accesskey                     "w">
 <!ENTITY monthly.label                        "monthly">
Index: xpfe/components/prefwindow/resources/locale/en-US/preftree.dtd
===================================================================
RCS file: /cvsroot/mozilla/xpfe/components/prefwindow/resources/locale/en-US/preftree.dtd,v
retrieving revision 1.48
diff -u -u -w -r1.48 preftree.dtd
--- xpfe/components/prefwindow/resources/locale/en-US/preftree.dtd	4 Jun 2002 04:14:25 -0000	1.48
+++ xpfe/components/prefwindow/resources/locale/en-US/preftree.dtd	26 Aug 2002 05:33:19 -0000
@@ -21,6 +21,7 @@
 <!ENTITY publish.label "Publish">
 <!ENTITY offline.label "Offline &amp; Disk Space">
 <!ENTITY security.label "Privacy &amp; Security">
+<!ENTITY referrer.label "HTTP Referrer">
 <!ENTITY advance.label "Advanced">
 <!ENTITY down.label "Download">
 <!ENTITY cache.label "Cache">
Index: xpfe/components/search/datasets/MANIFEST
===================================================================
RCS file: /cvsroot/mozilla/xpfe/components/search/datasets/MANIFEST,v
retrieving revision 1.21
diff -u -u -w -r1.21 MANIFEST
--- xpfe/components/search/datasets/MANIFEST	26 Oct 2000 00:07:45 -0000	1.21
+++ xpfe/components/search/datasets/MANIFEST	26 Aug 2002 05:33:19 -0000
@@ -1,12 +1,16 @@
-bugzilla.gif
-bugzilla.src
-dmoz.gif
-dmoz.src
+ICQ.gif
+ICQ.src
 google.gif
 google.src
-lxrmozilla.gif
-lxrmozilla.src
-mozilla.gif
-mozilla.src
-NetscapeSearch.gif
-NetscapeSearch.src
+Lycos.gif
+Lycos.src
+HotBot.gif
+HotBot.src
+Excite.gif
+Excite.src
+eBay.gif
+eBay.src
+monster.gif
+monster.src
+dmoz.gif
+dmoz.src
Index: xpfe/components/search/datasets/Makefile.in
===================================================================
RCS file: /cvsroot/mozilla/xpfe/components/search/datasets/Makefile.in,v
retrieving revision 1.29
diff -u -u -w -r1.29 Makefile.in
--- xpfe/components/search/datasets/Makefile.in	25 Apr 2002 02:52:30 -0000	1.29
+++ xpfe/components/search/datasets/Makefile.in	26 Aug 2002 05:33:19 -0000
@@ -27,18 +27,22 @@
 include $(DEPTH)/config/autoconf.mk
 
 FILES		= \
-	bugzilla.gif        \
-	bugzilla.src        \
-	dmoz.gif            \
-	dmoz.src            \
+ICQ.gif \
+ICQ.src \
 	google.gif          \
 	google.src          \
-	lxrmozilla.gif      \
-	lxrmozilla.src      \
-	mozilla.gif         \
-	mozilla.src         \
-	NetscapeSearch.gif  \
-	NetscapeSearch.src  \
+Lycos.gif \
+Lycos.src \
+HotBot.gif \
+HotBot.src \
+Excite.gif \
+Excite.src \
+eBay.gif \
+eBay.src \
+monster.gif \
+monster.src \
+dmoz.gif \
+dmoz.src \
 	$(NULL)
 
 include $(topsrcdir)/config/rules.mk
Index: xpfe/components/search/datasets/NetscapeSearch.src
===================================================================
RCS file: /cvsroot/mozilla/xpfe/components/search/datasets/NetscapeSearch.src,v
retrieving revision 1.13
diff -u -u -w -r1.13 NetscapeSearch.src
--- xpfe/components/search/datasets/NetscapeSearch.src	19 Jun 2002 00:50:18 -0000	1.13
+++ xpfe/components/search/datasets/NetscapeSearch.src	26 Aug 2002 05:33:19 -0000
@@ -1,49 +1,59 @@
-# Netscape Search Sherlock for Netscape 6
-# Copyright (c) 2000 Netscape Communications Corp.
-#
-# The BROWSER alsomatch= tags must be there or the GIF will not update!
-#
+# Netscape Search - Sherlock Plug-in for Navigator 6.0
+# Copyright (C)2000 Netscape Communications Corp.
 
  <SEARCH
    name            = "Netscape Search"
    description     = "Netscape Search"
-   routeType       = "Internet"
    method          = "GET"
-   action          = "http://info.netscape.com/fwd/clk61srsid/http://search.netscape.com/search.psp"
-   actionButton    = "http://info.netscape.com/fwd/clk61srurl1/http://search.netscape.com/search.psp?search="
-   actionBar       = "http://info.netscape.com/fwd/clk61srurl2/http://search.netscape.com/search.psp?search="
-   searchForm      = "http://search.netscape.com/nscp_index.adp"
+	action="http://info.netscape.com/fwd/sidb_ns/http://search.netscape.com/cgi-bin/search"
+	queryCharset="UTF-8"
  >
 
-<INPUT NAME="search" USER>
+<INPUT NAME="search" user>
+<INPUT NAME="charset" VALUE="UTF-8">
 
+<INTERPRET
+	browserResultType = "result"
+	bannerStart="<!--AD_TAG VENDOR=AOL WIDTH=468 HEIGHT=60-->"
+	bannerEnd="<!--/AD_TAG-->"
+	resultListStart = "<!----**Netcenter**---->"
+	resultListEnd = "Groups of reviewed web sites related to your search term."
+	resultItemStart = "<LI>"
+>
 
-# Search Results
+<INTERPRET
+	browserResultType = "category"
+	bannerStart="<!--AD_TAG VENDOR=AOL WIDTH=468 HEIGHT=60-->"
+	bannerEnd="<!--/AD_TAG-->"
+	resultListStart = "Groups of reviewed web sites related to your search term."
+	resultListEnd = "Web sites reviewed and categorized by a team of editors."
+	resultItemStart = "<LI>"
+	nameStart = '">'
+	nameEnd = "</FONT>"
+>
 
 <INTERPRET
-  charset           = "ISO-8859-1"
   browserResultType = "result"
-  bannerStart       = "<!-- START: AOL BANNER AD -->"
-  bannerEnd         = "<!-- END: AOL BANNER AD -->"
-  resultListStart   = "<!-- BEGIN SEARCH RESULTS-->"
-  resultListEnd     = "<!-- END SEARCH RESULTS -->"
-  resultItemStart   = "<li>"
-  resultItemEnd     = "<br>"
-  relevanceStart    = ""
-  relevanceEnd      = ""
-  resultItemSiteTag = ""
+	bannerStart="<!--AD_TAG VENDOR=AOL WIDTH=468 HEIGHT=60-->"
+	bannerEnd="<!--/AD_TAG-->"
+	resultListStart = "Web sites reviewed and categorized by a team of editors."
+	resultItemStart = "<LI>"
 >
 
+<INTERPRET
+	browserResultType = "result"
+	bannerStart="<!--AD_TAG VENDOR=AOL WIDTH=468 HEIGHT=60-->"
+	bannerEnd="<!--/AD_TAG-->"
+	resultListStart = "The Google search engine found these pages."
+	resultListEnd = "</TD>"
+	resultItemStart = "<LI>"
+>
 
 </SEARCH>
 
-  
-
 <BROWSER
-  alsomatch="http://search.netscape.com/search.psp http://search.netscape.com/cgi-bin/search http://search.netscape.com/search.tmpl http://search.netscape.com/google.tmpl"
-  update          = "http://search.netscape.com/sherlock/SBWeb_01.src" 
-  updateIcon      = "http://search.netscape.com/sherlock/SBWeb_01.gif" 
-  updateCheckDays = "1" 
-
+      alsomatch="http://search.netscape.com/cgi-bin/search http://search.netscape.com/search.tmpl http://google.netscape.com/netscape"
+      update="http://search.netscape.com/sherlock/NetscapeSearch.src" 
+      updateIcon="http://search.netscape.com/sherlock/NetscapeSearch.gif" 
+      updateCheckDays="3"
 >
-
Index: xpfe/components/search/datasets/dmoz.src
===================================================================
RCS file: /cvsroot/mozilla/xpfe/components/search/datasets/dmoz.src,v
retrieving revision 1.1
diff -u -u -w -r1.1 dmoz.src
--- xpfe/components/search/datasets/dmoz.src	26 Oct 2000 00:06:31 -0000	1.1
+++ xpfe/components/search/datasets/dmoz.src	26 Aug 2002 05:33:19 -0000
@@ -4,7 +4,7 @@
 
 <SEARCH
 	name="dmoz.org"
-	description = "dmoz.org"
+	description = "dmoz.org - Directory - Maintained by volunteers, owned by Netscape"
 	method="GET"
 	action="http://search.dmoz.org/cgi-bin/search"
 >
@@ -26,9 +26,3 @@
 >
 
 </SEARCH>
-
-<BROWSER
-      update="http://www.mozilla.org/projects/search/dmoz.src" 
-      updateIcon="http://www.mozilla.org/projects/search/dmoz.gif" 
-      updateCheckDays="3"
->
Index: xpfe/components/search/datasets/google.src
===================================================================
RCS file: /cvsroot/mozilla/xpfe/components/search/datasets/google.src,v
retrieving revision 1.2
diff -u -u -w -r1.2 google.src
--- xpfe/components/search/datasets/google.src	21 Mar 2002 23:29:44 -0000	1.2
+++ xpfe/components/search/datasets/google.src	26 Aug 2002 05:33:19 -0000
@@ -2,11 +2,9 @@
 
 <search 
    name="Google"
-   description="Google Search"
+   description="Google - Web Search"
    method="GET"
    action="http://www.google.com/search"
-   update="http://www.google.com/mozilla/google.src"
-   updateCheckDays=1   
 >
 
 <input name="q" user>
Index: xpfe/components/search/datasets/lxrmozilla.src
===================================================================
RCS file: /cvsroot/mozilla/xpfe/components/search/datasets/lxrmozilla.src,v
retrieving revision 1.2
diff -u -u -w -r1.2 lxrmozilla.src
--- xpfe/components/search/datasets/lxrmozilla.src	19 Jun 2002 00:50:18 -0000	1.2
+++ xpfe/components/search/datasets/lxrmozilla.src	26 Aug 2002 05:33:19 -0000
@@ -6,7 +6,6 @@
 	name = "LXR @ mozilla.org"
 	method = "get"
 	action = "http://lxr.mozilla.org/seamonkey/search"
-	searchForm = "http://lxr.mozilla.org/seamonkey/search"
 	>
 	
 <input name="string" user>
Index: xpfe/components/search/datasets/makefile.win
===================================================================
RCS file: /cvsroot/mozilla/xpfe/components/search/datasets/Attic/makefile.win,v
retrieving revision 1.25
diff -u -u -w -r1.25 makefile.win
--- xpfe/components/search/datasets/makefile.win	21 Nov 2001 09:49:23 -0000	1.25
+++ xpfe/components/search/datasets/makefile.win	26 Aug 2002 05:33:19 -0000
@@ -24,19 +24,23 @@
 include <$(DEPTH)\config\rules.mak>
 
 FILES=\
-	bugzilla.gif        \
-	bugzilla.src        \
-	dmoz.gif            \
-	dmoz.src            \
+ICQ.gif \
+ICQ.src \
 	google.gif          \
 	google.src          \
-	lxrmozilla.gif      \
-	lxrmozilla.src      \
-	mozilla.gif         \
-	mozilla.src         \
-	NetscapeSearch.gif  \
-	NetscapeSearch.src  \
+Lycos.gif \
+Lycos.src \
+HotBot.gif \
+HotBot.src \
+Excite.gif \
+Excite.src \
+eBay.gif \
+eBay.src \
+monster.gif \
+monster.src \
+dmoz.gif \
+dmoz.src \
     $(NULL)
 
-libs:: $(FILES:/=\)
+install:: $(FILES:/=\)
 	!@$(MAKE_INSTALL) $** $(DIST)\bin\searchplugins
Index: xpfe/components/search/datasets/mozilla.src
===================================================================
RCS file: /cvsroot/mozilla/xpfe/components/search/datasets/mozilla.src,v
retrieving revision 1.2
diff -u -u -w -r1.2 mozilla.src
--- xpfe/components/search/datasets/mozilla.src	19 Jun 2002 00:50:18 -0000	1.2
+++ xpfe/components/search/datasets/mozilla.src	26 Aug 2002 05:33:19 -0000
@@ -6,7 +6,6 @@
 	name = "mozilla.org"
 	method = "get"
 	action = "http://www.mozilla.org/htdig-cgi/htsearch"
-	searchForm = "http://www.mozilla.org/search.html"
 	>
 	
 <input name="config" value="htdig">
Index: xpfe/components/sidebar/resources/local-panels.rdf
===================================================================
RCS file: /cvsroot/mozilla/xpfe/components/sidebar/resources/local-panels.rdf,v
retrieving revision 1.20
diff -u -u -w -r1.20 local-panels.rdf
--- xpfe/components/sidebar/resources/local-panels.rdf	12 Aug 2001 01:49:08 -0000	1.20
+++ xpfe/components/sidebar/resources/local-panels.rdf	26 Aug 2002 05:33:20 -0000
@@ -28,17 +28,12 @@
   <rdf:Description about="urn:sidebar:master-panel-list">
     <nc:panel-list>
       <rdf:Seq>
-        <rdf:li resource="urn:sidebar:panel:whats-related"/>
         <rdf:li resource="urn:sidebar:panel:search"/>
         <rdf:li resource="urn:sidebar:panel:bookmarks"/>
         <rdf:li resource="urn:sidebar:panel:history"/>
         <rdf:li resource="urn:sidebar:panel:addressbook"/>
       </rdf:Seq>
     </nc:panel-list>
-  </rdf:Description>
-  <rdf:Description about="urn:sidebar:panel:whats-related">
-    <nc:title>&sidebar.whats-related.label;</nc:title>
-    <nc:content>chrome://communicator/content/related/related-panel.xul</nc:content>
   </rdf:Description>
   <rdf:Description about="urn:sidebar:panel:search">
     <nc:title>&sidebar.search.label;</nc:title>
Index: xpfe/components/sidebar/resources/sidebarOverlay.js
===================================================================
RCS file: /cvsroot/mozilla/xpfe/components/sidebar/resources/sidebarOverlay.js,v
retrieving revision 1.106
diff -u -u -w -r1.106 sidebarOverlay.js
--- xpfe/components/sidebar/resources/sidebarOverlay.js	17 Jul 2002 01:36:37 -0000	1.106
+++ xpfe/components/sidebar/resources/sidebarOverlay.js	26 Aug 2002 05:33:21 -0000
@@ -398,7 +398,7 @@
         content.removeAttribute('hidden');
         content.removeAttribute('collapsed');
 
-        if (sidebarObj.collapsed && panel.is_sandboxed()) {
+        if (sidebarObj.collapsed) {
           if (!panel.is_persistent()) {
             debug("    set src=about:blank");
             iframe.setAttribute('src', 'about:blank');
@@ -444,10 +444,6 @@
             iframe.setAttribute('loadstate', 'never loaded');
           }
         }
-        if (panel.is_sandboxed()) {
-          if (!panel.is_persistent())
-            iframe.setAttribute('src', 'about:blank');
-        }
       }
     }
   }
@@ -890,7 +886,7 @@
     url = prefs.getCharPref("sidebar.customize.all_panels.url");
     url = url.replace(/%SIDEBAR_VERSION%/g, SIDEBAR_VERSION);
   } catch(ex) {
-    debug("Unable to get remote url pref. What now? "+ex);
+    debug("Unable to get pref |sidebar.customize.all_panels.url|. "+ex);
   }
   try {
     locale = prefs.getComplexValue("intl.content.langcode",
@@ -903,8 +899,14 @@
       locale = prefs.getComplexValue("general.useragent.locale",
                                      Components.interfaces.nsIPrefLocalizedString);
   } catch(ex) {
-      debug("Unable to get system locale. What now? "+ex);
+      locale = "en";
+      debug("Unable to get system locale. Falling back to 'en'. "+ex);
     }
+  }
+  if (!locale || locale == "")
+  {
+    locale = "en";
+    debug("Have empty locale. Falling back to 'en'.");
   }
   locale = locale.data.toLowerCase();
   url = url.replace(/%LOCALE%/g, locale);
Index: xpfe/components/updates/src/nsUpdateNotifier.js
===================================================================
RCS file: /cvsroot/mozilla/xpfe/components/updates/src/nsUpdateNotifier.js,v
retrieving revision 1.5
diff -u -u -w -r1.5 nsUpdateNotifier.js
--- xpfe/components/updates/src/nsUpdateNotifier.js	11 Jun 2002 20:46:52 -0000	1.5
+++ xpfe/components/updates/src/nsUpdateNotifier.js	26 Aug 2002 05:33:21 -0000
@@ -36,7 +36,8 @@
  * ***** END LICENSE BLOCK ***** */
 
 const kDebug               = false;
-const kUpdateCheckDelay    = 5 * 60 * 1000; // 5 minutes
+const kUpdateCheckStartDelay = 5 * 60 * 1000; // 5 minutes after startup
+const kUpdateCheckMinFreq  = 6 * 60 * 60 * 1000; // then every 6 hours
 const kUNEnabledPref       = "update_notifications.enabled";
 const kUNDatasourceURIPref = "update_notifications.provider.0.datasource";
 const kUNFrequencyPref     = "update_notifications.provider.0.frequency";
@@ -77,12 +78,7 @@
     {
       try 
       {
-        const kIScriptableTimer = Components.interfaces.nsIScriptableTimer;
-        mTimer = Components.classes["@mozilla.org/timer;1"].
-          createInstance(kIScriptableTimer);
-        mTimer.init(this, kUpdateCheckDelay, true,
-          kIScriptableTimer.TYPE_ONE_SHOT);
-
+        this.setTimer(kUpdateCheckStartDelay);
         // we are no longer interested in the ``domwindowopened'' topic
         var observerService = Components.
           classes["@mozilla.org/observer-service;1"].
@@ -91,13 +87,29 @@
       }
       catch (ex)
       {
-        debug("Exception init'ing timer: " + ex);
+        debug("Exception removing observer for update notification: " + ex);
       }
     }
     else if (aTopic == "timer-callback")
     {
       mTimer = null; // free up timer so it can be gc'ed
       this.checkForUpdate();
+      this.setTimer(kUpdateCheckMinFreq);
+    }
+  },
+
+  setTimer: function(delay)
+  {
+    try 
+    {
+      const kIScriptableTimer = Components.interfaces.nsIScriptableTimer;
+      mTimer = Components.classes["@mozilla.org/timer;1"].
+        createInstance(kIScriptableTimer);
+      mTimer.init(this, delay, true, kIScriptableTimer.TYPE_ONE_SHOT);
+    }
+    catch (ex)
+    {
+      debug("Exception init'ing timer: " + ex);
     }
   },
 
Index: xpfe/global/jar.mn
===================================================================
RCS file: /cvsroot/mozilla/xpfe/global/jar.mn,v
retrieving revision 1.58
diff -u -u -w -r1.58 jar.mn
--- xpfe/global/jar.mn	25 Jul 2002 13:27:12 -0000	1.58
+++ xpfe/global/jar.mn	26 Aug 2002 05:33:21 -0000
@@ -16,6 +16,7 @@
         content/global/config.xul                   (resources/content/config.xul) 
         content/global/config.css                   (resources/content/config.css) 
         content/global/config.js                    (resources/content/config.js) 
+        content/global/credits.html                 (resources/content/credits.html) 
         content/global/mozilla.xhtml                (resources/content/mozilla.xhtml) 
         content/global/plugins.html                 (resources/content/plugins.html) 
         content/global/charsetOverlay.xul           (resources/content/charsetOverlay.xul) 
@@ -97,7 +98,8 @@
     locale/en-US/global/accept2locale.properties    (resources/locale/en-US/accept2locale.properties) 
     locale/en-US/global/languageNames.properties    (resources/locale/en-US/languageNames.properties) 
     locale/en-US/global/regionNames.properties      (resources/locale/en-US/regionNames.properties) 
-    locale/en-US/global/about.xhtml                 (resources/locale/en-US/about.xhtml) 
+    locale/en-US/global/about.html                  (resources/locale/en-US/about.html)
+    locale/en-US/global/license.html                (resources/locale/en-US/license.html)
     locale/en-US/global/commonDialogs.properties    (resources/locale/en-US/commonDialogs.properties) 
     locale/en-US/global/plugins.properties          (resources/locale/en-US/plugins.properties) 
     locale/en-US/global/nsTreeSorting.properties    (resources/locale/en-US/nsTreeSorting.properties)
Index: xpfe/global/resources/content/logo.gif
===================================================================
RCS file: /cvsroot/mozilla/xpfe/global/resources/content/logo.gif,v
retrieving revision 1.4
diff -u -u -w -r1.4 logo.gif
Binary files /tmp/cvsBRV4g_ and logo.gif differ
Index: xpfe/global/resources/locale/en-US/MANIFEST
===================================================================
RCS file: /cvsroot/mozilla/xpfe/global/resources/locale/en-US/MANIFEST,v
retrieving revision 1.20
diff -u -u -w -r1.20 MANIFEST
--- xpfe/global/resources/locale/en-US/MANIFEST	25 Jul 2002 13:27:14 -0000	1.20
+++ xpfe/global/resources/locale/en-US/MANIFEST	26 Aug 2002 05:33:22 -0000
@@ -1,5 +1,7 @@
 intl.css
-about.xhtml
+about.html
+plugins.html
+license.html
 globalOverlay.dtd
 dialogOverlay.dtd
 builtinURLs.rdf
Index: xpfe/global/resources/locale/en-US/brand.dtd
===================================================================
RCS file: /cvsroot/mozilla/xpfe/global/resources/locale/en-US/brand.dtd,v
retrieving revision 1.8.6.1
diff -u -u -w -r1.8.6.1 brand.dtd
--- xpfe/global/resources/locale/en-US/brand.dtd	9 Aug 2002 03:40:00 -0000	1.8.6.1
+++ xpfe/global/resources/locale/en-US/brand.dtd	26 Aug 2002 05:33:22 -0000
@@ -1,4 +1,13 @@
 <!ENTITY  lang.version          "1.1">
-<!ENTITY  brandShortName        "Mozilla">
-<!ENTITY  vendorShortName       "Mozilla">
+<!-- Mozilla looks here for locale (theme?) versions, and refuses to use
+     the locale, if it doesn't match. -->
+<!-- Separate the ever-changing version info to avoid merge conflicts -->
+
+
+<!-- TODO: Maybe change lang.version later, so that nobody installs a Mozilla
+     langpack in Beonex Communicator. -->
+
+<!ENTITY  brandShortName        "Beonex Communicator">
+<!ENTITY  vendorShortName       "Beonex">
+<!ENTITY  vendorLongName        "Ben Bucksch">
 <!ENTITY  sidebarName           "Sidebar">
\ No newline at end of file
Index: xpfe/global/resources/locale/en-US/brand.properties
===================================================================
RCS file: /cvsroot/mozilla/xpfe/global/resources/locale/en-US/brand.properties,v
retrieving revision 1.14
diff -u -u -w -r1.14 brand.properties
--- xpfe/global/resources/locale/en-US/brand.properties	10 Aug 2001 21:28:03 -0000	1.14
+++ xpfe/global/resources/locale/en-US/brand.properties	26 Aug 2002 05:33:22 -0000
@@ -1,3 +1,4 @@
-brandShortName=Mozilla
-vendorShortName=Mozilla
+brandShortName=Beonex Communicator
+vendorShortName=Beonex
+vendorLongName=Ben Bucksch
 sidebarName=Sidebar
Index: xpfe/global/resources/locale/en-US/builtinURLs.rdf
===================================================================
RCS file: /cvsroot/mozilla/xpfe/global/resources/locale/en-US/builtinURLs.rdf,v
retrieving revision 1.8
diff -u -u -w -r1.8 builtinURLs.rdf
--- xpfe/global/resources/locale/en-US/builtinURLs.rdf	19 Jun 2002 00:50:12 -0000	1.8
+++ xpfe/global/resources/locale/en-US/builtinURLs.rdf	26 Aug 2002 05:33:22 -0000
@@ -25,25 +25,25 @@
          xmlns:NC="http://home.netscape.com/NC-rdf#">
 
   <RDF:Description about='urn:clienturl:toolbar:mynetscape'>
-    <NC:title>My Netscape</NC:title>
-    <NC:content>http://my.netscape.com/</NC:content>
+    <NC:title>Support</NC:title>
+    <NC:content>http://www.beonex.com/communicator/support</NC:content>
   </RDF:Description>
 
   <RDF:Description about='urn:clienturl:toolbar:home'>
     <NC:title>Home</NC:title>
-    <NC:content>http://home.netscape.com/</NC:content>
+    <NC:content>about:welcome</NC:content>
   </RDF:Description>
 
   <RDF:Description about='urn:clienturl:toolbar:relnotes'>
-    <NC:title>Release Notes</NC:title>
-    <NC:content>http://www.mozilla.org/releases/</NC:content>
+    <NC:title>Release-Notes</NC:title>
+    <NC:content>http://www.beonex.com/communicator/version/0.9/release-notes</NC:content>
   </RDF:Description>
 
   <!-- View Menu -->
 
   <RDF:Description about='urn:clienturl:viewmenu:intlwebcontent'>
     <NC:title>International Languages and Web Content</NC:title>
-    <NC:content>http://www.mozilla.org/projects/l10n/mlp_status.html#contrib</NC:content>
+    <NC:content>http://www.beonex.com/communicator/version/0.9/add-ons/l10n</NC:content>
   </RDF:Description>
 
   <!-- Composer -->
Index: xpfe/global/resources/locale/en-US/makefile.win
===================================================================
RCS file: /cvsroot/mozilla/xpfe/global/resources/locale/en-US/Attic/makefile.win,v
retrieving revision 1.23
diff -u -u -w -r1.23 makefile.win
--- xpfe/global/resources/locale/en-US/makefile.win	25 Jul 2002 13:27:14 -0000	1.23
+++ xpfe/global/resources/locale/en-US/makefile.win	26 Aug 2002 05:33:22 -0000
@@ -28,7 +28,8 @@
 
 CHROME_L10N = \
 	.\intl.css \
-	.\about.xhtml \
+	.\about.html \
+	.\license.html \
 	.\globalOverlay.dtd \
 	.\dialogOverlay.dtd \
 	.\builtinURLs.rdf \
Index: xpfe/global/resources/locale/en-US/region.dtd
===================================================================
RCS file: /cvsroot/mozilla/xpfe/global/resources/locale/en-US/region.dtd,v
retrieving revision 1.11.6.1
diff -u -u -w -r1.11.6.1 region.dtd
--- xpfe/global/resources/locale/en-US/region.dtd	9 Aug 2002 03:40:00 -0000	1.11.6.1
+++ xpfe/global/resources/locale/en-US/region.dtd	26 Aug 2002 05:33:22 -0000
@@ -1,5 +1,12 @@
 <!-- brand.dtd -->
-<!ENTITY  vendorURL             "http://www.mozilla.org/">
-<!ENTITY  releaseURL            "http://www.mozilla.org/releases/">
-<!ENTITY  getNewThemesURL       "http://mozilla.org/themes/download/">
 <!ENTITY  content.version       "1.1">
+<!-- I bet that Mozilla looks here for theme/locale versions, and refuses
+     to use the locale, if we change that. So, keep Mozilla version for
+     compatibility. -->
+<!-- Separate the ever-changing version info to avoid merge conflicts -->
+
+
+<!ENTITY  vendorURL             "http://www.beonex.com">
+<!ENTITY  releaseURL            "http://www.beonex.com/communicator/version/0.9/release-notes">
+<!-- releaseURL is actually release-notes -->
+<!ENTITY  getNewThemesURL       "http://www.beonex.com/communicator/version/0.9/add-ons/themes/">
Index: xpfe/global/resources/locale/en-US/region.properties
===================================================================
RCS file: /cvsroot/mozilla/xpfe/global/resources/locale/en-US/region.properties,v
retrieving revision 1.9
diff -u -u -w -r1.9 region.properties
--- xpfe/global/resources/locale/en-US/region.properties	15 Jun 2002 21:29:52 -0000	1.9
+++ xpfe/global/resources/locale/en-US/region.properties	26 Aug 2002 05:33:22 -0000
@@ -3,13 +3,13 @@
 #
 #    This is the message for the noDefaultPlugin dialog.  Please note
 #    that the URL must be tweaked.
-noDefaultPluginMessage=Mozilla cannot find the Plugin Downloader Plugin.  Without the Plugin Downloader Plugin, you cannot automatically download and install plugins.  Please visit http://www.netscape.com/ to install the Plugin Downloader Plugin.
+noDefaultPluginMessage=Communicator cannot find the Plugin Downloader Plugin.  Without the Plugin Downloader Plugin, you cannot automatically download and install plugins.  Please visit http://www.netscape.com to install the Plugin Downloader Plugin.
 pluginStartupMessage=Starting Plugin for type
 #
 # brand.properties
 #
-getNewThemesURL=http://mozilla.org/themes/download/
-smartBrowsingURL=http://www.mozilla.org/docs/end-user/internet-keywords.html
+getNewThemesURL=http://www.beonex.com/communicator/version/0.9/add-ons/themes
+smartBrowsingURL=http://www.beonex.com/communicator/redir/smartbrowsing
 
 #
 # fontdownload.properties
Index: xpinstall/packager/packages-mac
===================================================================
RCS file: /cvsroot/mozilla/xpinstall/packager/packages-mac,v
retrieving revision 1.178
diff -u -u -w -r1.178 packages-mac
--- xpinstall/packager/packages-mac	16 Jul 2002 23:25:51 -0000	1.178
+++ xpinstall/packager/packages-mac	26 Aug 2002 05:33:22 -0000
@@ -206,14 +206,8 @@
 viewer:Components:xpinstall.xpt 
 viewer:Components:widget.shlb 
 viewer:Components:autocomplete.xpt 
-viewer:Components:xml-rpc.xpt
 viewer:Components:nsDictionary.js
 viewer:Components:nsProxyAutoConfig.js
-viewer:Components:nsXmlRpcClient.js
-viewer:Components:xmlextras.xpt
-viewer:Components:xmlextras.shlb
-viewer:Components:xmlsoap.xpt
-viewer:Components:xmlschema.xpt
 viewer:Components:nsHelperAppDlg.js
 viewer:Components:nsProgressDialog.js
 viewer:Components:nsDownloadProgressListener.js
Index: xpinstall/packager/packages-unix
===================================================================
RCS file: /cvsroot/mozilla/xpinstall/packager/packages-unix,v
retrieving revision 1.217.6.1
diff -u -u -w -r1.217.6.1 packages-unix
--- xpinstall/packager/packages-unix	17 Aug 2002 04:10:05 -0000	1.217.6.1
+++ xpinstall/packager/packages-unix	26 Aug 2002 05:33:22 -0000
@@ -12,9 +12,7 @@
 ;
 ; en-US
 bin/chrome/en-US.jar
-bin/chrome/en-mac.jar
 bin/chrome/en-unix.jar
-bin/chrome/en-win.jar
 
 [regus]
 ;
@@ -31,6 +29,7 @@
 bin/defaults/profile/localstore.rdf
 bin/defaults/profile/search.rdf
 bin/defaults/profile/mimeTypes.rdf
+bin/defaults/profile/chrome/*
 
 [xpcom]
 bin/libmozjs.so
@@ -47,6 +46,8 @@
 [browser]
 bin/mozilla
 bin/mozilla-bin
+bin/LICENSE
+bin/README
 bin/icons/*
 bin/libgtksuperwin.so
 bin/libgtkxtbin.so
@@ -57,6 +58,9 @@
 bin/regExport
 bin/regxpcom
 bin/regchrome
+bin/component.reg
+bin/components/xpti.dat
+bin/components/xptitemp.dat
 bin/mozilla-xremote-client
 bin/xpicleanup
 bin/res/cmessage.txt
@@ -226,10 +230,8 @@
 bin/components/util.xpt
 bin/components/xpcom_components.xpt
 bin/components/xpcom_threads.xpt
-bin/components/xml-rpc.xpt
 bin/components/nsDictionary.js
 bin/components/nsProxyAutoConfig.js
-bin/components/nsXmlRpcClient.js
 bin/components/libxremote_client.so
 bin/components/libxremoteservice.so
 bin/components/xremoteservice.xpt
@@ -237,10 +239,6 @@
 bin/components/commandhandler.xpt
 bin/components/webbrowserpersist.xpt
 bin/components/windowwatcher.xpt
-bin/components/xmlextras.xpt
-bin/components/libxmlextras.so
-bin/components/xmlsoap.xpt
-bin/components/xmlschema.xpt
 bin/components/nsHelperAppDlg.js
 bin/components/helperAppDlg.xpt
 bin/components/nsProgressDialog.js
@@ -267,6 +265,15 @@
 bin/chrome/classic.jar
 bin/chrome/installed-chrome.txt
 bin/chrome/chromelist.txt
+bin/chrome/user-skins.rdf
+bin/chrome/user-locales.rdf
+bin/chrome/all-locales.rdf
+bin/chrome/all-skins.rdf
+bin/chrome/all-packages.rdf
+bin/chrome/overlayinfo/communicator/content/overlays.rdf
+bin/chrome/overlayinfo/navigator/content/overlays.rdf
+bin/chrome/overlayinfo/editor/content/overlays.rdf
+
 ;-bin/chrome/comm/content/editor/EditorInitPage.html
 ;-bin/chrome/comm/content/editor/content/EditorInitPagePlain.html
 ;Include this for "debug" testing - remove for actual beta release:
@@ -327,7 +334,7 @@
 bin/res/fonts/*
 bin/res/dtd/*
 ;debug menus reference samples dir - remove for actual releases:
-bin/res/samples/*
+;bin/res/samples/*
 bin/res/builtin/htmlBindings.xml
 bin/res/builtin/platformHTMLBindings.xml
 
@@ -346,6 +353,7 @@
 bin/components/libmsgnews.so
 bin/components/libvcard.so
 bin/components/libsmimestb.so
+;XXX libsigned.so?
 bin/components/libimport.so
 bin/components/libimpText.so
 bin/components/libimpComm4xMail.so
@@ -368,6 +376,7 @@
 bin/components/libmsgsmime.so
 bin/components/msgsmime.xpt
 bin/components/smime-service.js
+bin/chrome/overlayinfo/messenger/content/overlays.rdf
 bin/components/libmsgmdn.so
 bin/components/msgmdn.xpt
 bin/components/mdn-service.js
@@ -424,3 +433,9 @@
 bin/res/inspector/viewer-registry.rdf
 bin/res/inspector/search-registry.rdf
 bin/chrome/icons/default/winInspectorMain*.xpm
+
+[spellchecker]
+bin/components/libmyspell.so
+bin/components/libspellchecker.so
+bin/components/spellchecker.xpt
+bin/components/myspell/*
Index: xpinstall/packager/packages-win
===================================================================
RCS file: /cvsroot/mozilla/xpinstall/packager/packages-win,v
retrieving revision 1.216
diff -u -u -w -r1.216 packages-win
--- xpinstall/packager/packages-win	24 Jul 2002 06:43:12 -0000	1.216
+++ xpinstall/packager/packages-win	26 Aug 2002 05:33:22 -0000
@@ -15,17 +15,12 @@
 bin\chrome\en-mac.jar
 bin\chrome\en-unix.jar
 bin\chrome\en-win.jar
-bin\chrome\en-US\*
-bin\chrome\en-win\*
-bin\chrome\en-unix\*
-bin\chrome\en-mac\*
 
 [regus]
 ;
 ; US
 ; If you add a new directory you must explicitly call addDirectory in regus.jst
 bin\chrome\US.jar
-bin\chrome\US\*
 bin\defaults\profile\US\*
 bin\searchplugins\*
 
@@ -62,7 +57,7 @@
 bin\components\gkwidget.dll
 bin\jpeg3250.dll
 bin\jsj3250.dll
-bin\mozilla.exe
+bin\beonex-comm.exe
 bin\mozctl.dll
 bin\mozctlx.dll
 bin\regxpcom.exe
@@ -245,15 +240,9 @@
 bin\components\xppref32.dll
 bin\components\autoconfig.dll
 bin\components\autoconfig.xpt
-bin\components\xml-rpc.xpt
 bin\components\nsDictionary.js
 bin\components\nsProxyAutoConfig.js
-bin\components\nsXmlRpcClient.js
 bin\plugins\npnul32.dll
-bin\components\xmlextras.xpt
-bin\components\xmlextras.dll
-bin\components\xmlsoap.xpt
-bin\components\xmlschema.xpt
 bin\components\nsHelperAppDlg.js
 bin\components\helperAppDlg.xpt
 bin\components\nsKillAll.js
@@ -280,10 +269,6 @@
 bin\chrome\forms.jar
 bin\chrome\modern.jar
 bin\chrome\classic.jar
-bin\chrome\comm\*
-bin\chrome\toolkit\*
-bin\chrome\modern\*
-bin\chrome\classic\*
 bin\chrome\chromelist.txt
 bin\chrome\icons\default\bmPropsWindow.ico
 bin\chrome\icons\default\bookmark-window.ico
@@ -343,8 +328,6 @@
 bin\res\rdf\folder-open.gif
 bin\res\rdf\loading.gif
 bin\res\throbber\*
-;debug menus reference samples dir - remove for actual releases:
-bin\res\samples\*
 bin\res\builtin\htmlBindings.xml
 bin\res\builtin\platformHTMLBindings.xml
 
@@ -436,3 +419,9 @@
 bin\defaults\pref\inspector.js
 bin\res\inspector\viewer-registry.rdf
 bin\res\inspector\search-registry.rdf
+
+[spellchecker]
+bin/components/libmyspell.dll
+bin/components/libspellchecker.dll
+bin/components/spellchecker.xpt
+bin/components/myspell/*
Index: xpinstall/packager/windows/config.it
===================================================================
RCS file: /cvsroot/mozilla/xpinstall/packager/windows/config.it,v
retrieving revision 1.115
diff -u -u -w -r1.115 config.it
--- xpinstall/packager/windows/config.it	31 Jul 2002 23:25:05 -0000	1.115
+++ xpinstall/packager/windows/config.it	26 Aug 2002 05:33:23 -0000
@@ -17,7 +17,7 @@
 ;   WINDISK
 ;   WINDIR
 ;   WINSYSDIR
-Path=[PROGRAMFILESDIR]\$CompanyName$\$ProductName$
+Path=[PROGRAMFILESDIR]\$CompanyName$\Communicator
 
 ; Sub Path, when set will indicate to Setup to create a subfolder from
 ; what is offered to the user to change.  It will not be shown to the user
@@ -180,7 +180,7 @@
 C6=Component US region pack
 ; Make sure Component QFA is LAST so 3rd party developers who might not want
 ; this component can easily remove it.
-C7=Component QFA
+;C7=Component QFA
 
 [Setup Type1]
 ;*** LOCALIZE ME BABY ***
@@ -197,14 +197,15 @@
 C3=Component PSM
 C4=Component Uninstaller
 C5=Component Chatzilla
-C6=Component Venkman
-C7=Component US English Profile Defaults
-C8=Component En US lang pack
-C9=Component US region pack
+;C6=Component Venkman
+C6=Component US English Profile Defaults
+C7=Component En US lang pack
+C8=Component US region pack
 ; Make sure Component QFA is LAST so 3rd party developers who might not want
 ; this component can easily remove it.
-C10=Component DOM Inspector
-C11=Component QFA
+;C10=Component DOM Inspector
+;C11=Component QFA
+C12=Component Spellcheck
 
 [Setup Type2]
 ;*** LOCALIZE ME BABY ***
@@ -223,14 +224,15 @@
 C3=Component PSM
 C4=Component Uninstaller
 C5=Component Chatzilla
-C6=Component Venkman
-C7=Component US English Profile Defaults
-C8=Component En US lang pack
-C9=Component US region pack
+;C6=Component Venkman
+C6=Component US English Profile Defaults
+C7=Component En US lang pack
+C8=Component US region pack
 ; Make sure Component QFA is LAST so 3rd party developers who might not want
 ; this component can easily remove it.
-C10=Component DOM Inspector
-C11=Component QFA
+;C10=Component DOM Inspector
+;C11=Component QFA
+C12=Component Spellcheck
 
 
 
@@ -580,6 +582,17 @@
 Attributes=SELECTED|FORCE_UPGRADE
 Force Upgrade File0=[SETUP PATH]\Chrome\inspector.jar
 
+[Component Spellcheck]
+Description Short=Spellchecker
+;*** LOCALIZE ME BABY ***
+Description Long=to check the spelling of your emails and webpages
+Archive=spellcheck.xpi
+$InstallSize$:spellcheck
+$InstallSizeSystem$
+$InstallSizeArchive$:spellcheck.xpi
+Attributes=SELECTED|FORCE_UPGRADE
+Force Upgrade File0=[SETUP PATH]\components\libspellchecker.dll
+
 [Component US English Profile Defaults]
 Description Short=US English profile defaults
 ;*** LOCALIZE ME BABY ***
@@ -733,7 +746,7 @@
 ;Delete FileX sections
 [Delete File0]
 Timing=post download
-Destination=[COMMON_PROGRAMS]\Mozilla Seamonkey\Mozilla AppRunner.lnk
+Destination=[COMMON_PROGRAMS]\Beonex Communicator\Mozilla AppRunner.lnk
 
 [Delete File1]
 Timing=post launchapp
Index: xpinstall/packager/windows/makeall.pl
===================================================================
RCS file: /cvsroot/mozilla/xpinstall/packager/windows/makeall.pl,v
retrieving revision 1.56
diff -u -u -w -r1.56 makeall.pl
--- xpinstall/packager/windows/makeall.pl	24 Jul 2002 06:43:15 -0000	1.56
+++ xpinstall/packager/windows/makeall.pl	26 Aug 2002 05:33:23 -0000
@@ -76,7 +76,7 @@
 if($inXpiURL eq "")
 {
   # archive url not supplied, set it to default values
-  $inXpiURL      = "ftp://not.supplied.com";
+  $inXpiURL      = "ftp://not.supplied.domain.invalid";
 }
 if($inRedirIniURL eq "")
 {
@@ -114,6 +114,28 @@
 $ENV{WIZ_userAgentShort}       = "$versionMain";
 $ENV{WIZ_xpinstallVersion}     = "$versionMain";
 
+
+
+#Shit, we never submitted the LocalOptions function, did we?
+
+$seiFileNameGeneric   = "nsinstall.exe";
+$seiFileNameSpecific  = "beonex-comm-0.9-dev-1-win32-installer.exe";
+$seiFileNameSpecificStub  = "beonex-comm-0.9-dev-1-win32-stub-installer.exe";
+$seuFileNameSpecific  = "BeonexComm09Uninstall.exe";
+$seuzFileNameSpecific = "BeonexComm09Uninstall.zip";
+
+# set environment vars for use by other .pl scripts called from this script.
+$ENV{WIZ_userAgent}            = "0.9 (en)";
+$ENV{WIZ_userAgentShort}       = "0.9";
+$ENV{WIZ_xpinstallVersion}     = "0.9";
+$ENV{WIZ_nameCompany}          = "Beonex";
+$ENV{WIZ_nameProduct}          = "Beonex Communicator";
+$ENV{WIZ_fileMainExe}          = "beonex-comm.exe";
+$ENV{WIZ_fileUninstall}        = $seuFileNameSpecific;
+$ENV{WIZ_fileUninstallZip}     = $seuzFileNameSpecific;
+
+
+
 # Set the location of the local tmp stage directory
 $gLocalTmpStage = $inStagePath;
 
@@ -128,7 +150,6 @@
                    "browser",
                    "mail",
                    "psm",
-                   "talkback",
                    "chatzilla",
                    "deflenus",
                    "langenus",
@@ -222,6 +243,10 @@
 {
   die "\n Error: copy $ENV{MOZ_SRC}\\mozilla\\LICENSE $inDistPath\\setup\\license.txt\n";
 }
+#if(system("copy $ENV{MOZ_SRC}\\mozilla\\README\\user\\win32.txt $inDistPath\\setup\\readme.txt"))
+#{
+#  die "\n Error: copy $ENV{MOZ_SRC}\\mozilla\\xpfe\\bootstrap\\README-win32.txt $inDistPath\\setup\\readme.txt\n";
+#}
 
 # build the self-extracting .exe (installer) file.
 print "\nbuilding self-extracting stub installer ($seiFileNameSpecificStub)...\n";
Index: xpinstall/res/content/SoftwareUpdate-Source-1.rdf
===================================================================
RCS file: /cvsroot/mozilla/xpinstall/res/content/SoftwareUpdate-Source-1.rdf,v
retrieving revision 1.1
diff -u -u -w -r1.1 SoftwareUpdate-Source-1.rdf
--- xpinstall/res/content/SoftwareUpdate-Source-1.rdf	28 Mar 2000 11:51:59 -0000	1.1
+++ xpinstall/res/content/SoftwareUpdate-Source-1.rdf	26 Aug 2002 05:33:23 -0000
@@ -26,7 +26,7 @@
 
   <RDF:Bag about="http://home.netscape.com/NC-rdf#SoftwareUpdateRoot">
     <RDF:li>
-       <RDF:Bag about="http://home.netscape.com/NC-rdf#SoftwarePackages" NC:title="Test Updates" NC:url="http://www.netscape.com/people/dougt">
+       <RDF:Bag about="http://home.netscape.com/NC-rdf#SoftwarePackages" NC:title="Test Updates" NC:url="http://www.beonex.com/communicator/redir/xpupdate">
 
             <RDF:li>
                 <RDF:Description ID="Update344">
Index: xpinstall/wizard/windows/builder/build.pl
===================================================================
RCS file: /cvsroot/mozilla/xpinstall/wizard/windows/builder/build.pl,v
retrieving revision 1.9
diff -u -u -w -r1.9 build.pl
--- xpinstall/wizard/windows/builder/build.pl	6 Feb 2001 07:43:25 -0000	1.9
+++ xpinstall/wizard/windows/builder/build.pl	26 Aug 2002 05:33:24 -0000
@@ -47,7 +47,7 @@
 if($inXpiURL eq "")
 {
   # archive url not supplied, set it to default values
-  $inXpiURL      = "ftp://not.supplied.com";
+  $inXpiURL      = "ftp://not.supplied.domain.invalid";
 }
 if($inRedirIniURL eq "")
 {
@@ -98,9 +98,9 @@
 print "\n";
 print "**\n";
 print "*\n";
-print "*  A self-extracting installer has been built and delivered:\n";
+print "*  A self-extracting installer has been built and delivered to:\n";
 print "*\n";
-print "*      $cwdDistWin\\install\\mozilla-win32-install.exe\n";
+print "*      $cwdDistWin\\install\\\n";
 print "*\n";
 print "**\n";
 print "\n";
@@ -246,7 +246,7 @@
     $distWinPathName = "Win32_d.obj";
   }
 
-  $fileMozilla = "$depthPath\\dist\\$distWinPathName\\bin\\mozilla.exe";
+  $fileMozilla = "$depthPath\\dist\\$distWinPathName\\bin\\beonex-comm.exe";
   # verify the existance of file
   if(!(-e "$fileMozilla"))
   {
Index: xpinstall/wizard/windows/nsinstall/nsinstall.rc
===================================================================
RCS file: /cvsroot/mozilla/xpinstall/wizard/windows/nsinstall/nsinstall.rc,v
retrieving revision 1.8
diff -u -u -w -r1.8 nsinstall.rc
--- xpinstall/wizard/windows/nsinstall/nsinstall.rc	14 Mar 2001 00:24:11 -0000	1.8
+++ xpinstall/wizard/windows/nsinstall/nsinstall.rc	26 Aug 2002 05:33:24 -0000
@@ -126,3 +126,39 @@
 /////////////////////////////////////////////////////////////////////////////
 #endif    // not APSTUDIO_INVOKED
 
+VS_VERSION_INFO VERSIONINFO
+ FILEVERSION 1,0,0,2
+ PRODUCTVERSION 0,7,0,1
+ FILEFLAGSMASK 0x3fL
+#ifdef _DEBUG
+ FILEFLAGS 0x1L
+#else
+ FILEFLAGS 0x0L
+#endif
+ FILEOS 0x40004L
+ FILETYPE 0x1L
+ FILESUBTYPE 0x0L
+BEGIN
+    BLOCK "StringFileInfo"
+    BEGIN
+        BLOCK "040904b0"
+        BEGIN
+            VALUE "Comments", "\0"
+            VALUE "CompanyName", "Beonex\0"
+            VALUE "FileDescription", "Beonex Communicator Installer\0"
+            VALUE "FileVersion", "1, 0, 0, 2\0"
+            VALUE "InternalName", "install\0"
+            VALUE "LegalCopyright", "Copyright  2001\0"
+            VALUE "LegalTrademarks", "\0"
+            VALUE "OriginalFilename", "install.exe\0"
+            VALUE "PrivateBuild", "\0"
+            VALUE "ProductName", "Beonex Communicator Installer\0"
+            VALUE "ProductVersion", "0, 7, 0, 1\0"
+            VALUE "SpecialBuild", "\0"
+        END
+    END
+    BLOCK "VarFileInfo"
+    BEGIN
+        VALUE "Translation", 0x409, 1200
+    END
+END
Index: xpinstall/wizard/windows/setuprsc/setuprsc.rc
===================================================================
RCS file: /cvsroot/mozilla/xpinstall/wizard/windows/setuprsc/setuprsc.rc,v
retrieving revision 1.55
diff -u -u -w -r1.55 setuprsc.rc
--- xpinstall/wizard/windows/setuprsc/setuprsc.rc	1 Aug 2002 06:40:52 -0000	1.55
+++ xpinstall/wizard/windows/setuprsc/setuprsc.rc	26 Aug 2002 05:33:24 -0000
@@ -424,7 +424,7 @@
 
 IDB_BOX_UNCHECKED       BITMAP  FIXED IMPURE    "box_unch.bmp"
 IDB_BOX_CHECKED         BITMAP  FIXED IMPURE    "box_chec.bmp"
-IDB_BITMAP_WELCOME      BITMAP  DISCARDABLE     "bitmap1.bmp"
+IDB_BITMAP_WELCOME      BITMAP  DISCARDABLE     "dialogsLogo.bmp"
 IDB_BOX_CHECKED_DISABLED BITMAP  FIXED IMPURE    "box_ch_d.bmp"
 IDB_BITMAP_DOWNLOAD_LOGO BITMAP  DISCARDABLE     "downloadLogo.bmp"
 IDB_QUICK_LAUNCH        BITMAP  DISCARDABLE     "turbo-systray.bmp"
@@ -477,3 +477,29 @@
 /////////////////////////////////////////////////////////////////////////////
 #endif    // not APSTUDIO_INVOKED
 
+1 VERSIONINFO 
+FILEVERSION 0, 7, 0, 1
+PRODUCTVERSION 1, 0, 0, 0
+FILEOS VOS_DOS_WINDOWS16
+FILETYPE VFT_APP
+{
+ BLOCK "StringFileInfo"
+ {
+  BLOCK "040904E4"
+  {
+   VALUE "CompanyName", "Beonex\000\000"
+   VALUE "FileDescription", "Beonex Communicator Installer\000"
+   VALUE "FileVersion", "1.0.0.1\000\000"
+   VALUE "InternalName", "mozilla-installer\000"
+   VALUE "LegalCopyright", "Copyright  2001\000\000"
+   VALUE "OriginalFilename", "beonex-comm-installer.exe\000"
+  }
+
+ }
+
+ BLOCK "VarFileInfo"
+ {
+  VALUE "Translation", 0x409, 1252
+ }
+
+}
Index: xpinstall/wizard/windows/uninstall/uninstall.rc
===================================================================
RCS file: /cvsroot/mozilla/xpinstall/wizard/windows/uninstall/uninstall.rc,v
retrieving revision 1.5
diff -u -u -w -r1.5 uninstall.rc
--- xpinstall/wizard/windows/uninstall/uninstall.rc	3 May 2001 21:47:18 -0000	1.5
+++ xpinstall/wizard/windows/uninstall/uninstall.rc	26 Aug 2002 05:33:24 -0000
@@ -71,15 +71,15 @@
         BLOCK "040904b0"
         BEGIN
             VALUE "Comments", "\0"
-            VALUE "CompanyName", "mozilla.org\0"
-            VALUE "FileDescription", "uninstall\0"
+            VALUE "CompanyName", "Beonex\0"
+            VALUE "FileDescription", "Uninstaller for Beonex Communicator\0"
             VALUE "FileVersion", "1, 0, 0, 2\0"
             VALUE "InternalName", "uninstall\0"
             VALUE "LegalCopyright", "Copyright  2001\0"
             VALUE "LegalTrademarks", "\0"
             VALUE "OriginalFilename", "uninstall.exe\0"
             VALUE "PrivateBuild", "\0"
-            VALUE "ProductName", "Mozilla uninstaller\0"
+            VALUE "ProductName", "Beonex uninstaller\0"
             VALUE "ProductVersion", "1, 0, 0, 2\0"
             VALUE "SpecialBuild", "\0"
         END
