<?xml version="1.0"?> 
<?xml-stylesheet href="xul.css" type="text/css"?> 

<!DOCTYPE window> 

<window xmlns:html="http://www.w3.org/TR/REC-html40"
			  xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
			  onload="Startup()"> 

  <html:style>
      #header {
        position: fixed;
        width: 100%;
        height: 75px;
        top: 0;
        right: 0;
        bottom: auto;
        left: 0;
      }
      #main {
        position: fixed;
        width: auto;
        height: auto;
        top: 75px;
        right: 0;
        bottom: 34px;
        left: 0;
        overflow: auto;
        padding: 2px .5em;
        border: solid 0px black;
      }
      #footer {
        position: fixed;
        width: 100%;
        height: 34px;
        top: auto;
        right: 0;
        bottom: 0;
        left: 0;
        margin-top: auto;
      }

      button {
        background-color: green;
        color: red;
      }

  </html:style>

  <html:script>
  function Startup()
  {
    dump("Doing Startup...\n");
    appCore = XPAppCoresManager.Find("EditorAppCore");  
    dump("Looking up EditorAppCore...\n");
    if (appCore == null) {
      dump("Creating EditorAppCore...\n");
      appCore = new EditorAppCore();
      if (appCore != null) {
        dump("EditorAppCore has been created.\n");
        appCore.Init("EditorAppCore");
	      appCore.setContentWindow(window.frames[0]);
	      appCore.setWebShellWindow(window);
	      appCore.setToolbarWindow(window);
        dump("Adding EditorAppCore to AppCoreManager...\n");
        XPAppCoresManager.Add(appCore);  
      }
    } else {
      dump("EditorAppCore has already been created! Why?\n");
    }
	}

  function EditorBold()
  {
    appCore = XPAppCoresManager.Find("EditorAppCore");  
    if (appCore != null) {
	    dump("Applying bold\n");
      appCore.setAttribute("bold", "");
    } else {
      dump("EditorAppCore has not been created!\n");
    }
  }

  function EditorGetText()
  {
    appCore = XPAppCoresManager.Find("EditorAppCore");  
    if (appCore != null) {
			var	outputText = appCore.contentsAsText;
			dump(outputText + "\n");
    } else {
      dump("EditorAppCore has not been created!\n");
    }
  }

  function EditorGetHTML()
  {
    appCore = XPAppCoresManager.Find("EditorAppCore");  
    if (appCore != null) {
			var	outputText = appCore.contentsAsHTML;
			dump(outputText + "\n");
    } else {
      dump("EditorAppCore has not been created!\n");
    }
  }


  function EditorUndo()
  {
    appCore = XPAppCoresManager.Find("EditorAppCore");  
    if (appCore != null) {
	    dump("Undoing\n");
      appCore.undo();
    } else {
      dump("EditorAppCore has not been created!\n");
    }
  }

  function EditorRedo()
  {
    appCore = XPAppCoresManager.Find("EditorAppCore");  
    if (appCore != null) {
	    dump("Redoing\n");
      appCore.redo();
    } else {
      dump("EditorAppCore has not been created!\n");
    }
  }

  function EditorExit()
  {
    appCore = XPAppCoresManager.Find("EditorAppCore");  
    if (appCore != null) {
	    dump("Exiting\n");
      appCore.exit();
    } else {
      dump("EditorAppCore has not been created!\n");
    }
  }

 function EditorPrintPreview() {
    var toolkitCore = XPAppCoresManager.Find("ToolkitCore");
    if (!toolkitCore) {
      toolkitCore = new ToolkitCore();
      if (toolkitCore)
        toolkitCore.Init("ToolkitCore");
    }
    if (toolkitCore) {
      toolkitCore.ShowWindow("resource:/res/samples/printsetup.html", window);
    }
  }
  </html:script>

  <broadcaster id="canGoBack"/>
  <broadcaster id="canGoForward"/>
  <broadcaster id="canReload"/>
  <broadcaster id="canStop"/>
  <broadcaster id="canPrint"/>
  
  <menubar>
    <menu name="File">
      <menuitem name="New Window" onClick="EditorUndo();"/>
      <menuitem name="Change Icons" onClick="EditorUndo();"/>
      <separator />
      <menuitem name="Print Setup" onClick="EditorPrintPreview();"/>
      <menuitem name="Print Preview" onClick="EditorPrintPreview();"/>
      <menuitem name="Print" onClick=""/>
      <separator />
      <menuitem name="Close" onClick=""/>
      <menuitem name="Exit" onClick="EditorExit();"/>
    </menu>
    <menu name="Edit">
      <menuitem name="Undo" onClick="EditorUndo();"/>
      <menuitem name="Redo" onClick="EditorRedo();"/>
      <separator />
      <menuitem name="Cut" onClick="EditorCut();"/>
      <menuitem name="Copy" onClick="EditorCopy();"/>
      <menuitem name="Paste" onClick="EditorPaste();"/>
    </menu>
    <menu name="View">
      <menuitem name="Hide Composition Toolbar" onClick="EditorUndo();"/>
      <menuitem name="Hide Format Toolbar" onClick="BrowserForward();" />
    </menu>
    <menu name="Insert">
      <menuitem name="Link..." onClick="EditorUndo();"/>
      <menuitem name="Target..." onClick="EditorUndo();"/>
      <menuitem name="Image..." onClick="EditorUndo();"/>
      <menuitem name="Horizontal Line" onClick="EditorUndo();"/>
      <menuitem name="Table" onClick="EditorUndo();"/>
      <menuitem name="HTML Tag..." onClick="EditorUndo();"/>
      <separator />
      <menuitem name="Line Break" onClick="EditorUndo();"/>
      <menuitem name="Break Below Image(s)" onClick="EditorUndo();"/>
    </menu>
    <menu name="Format">
      <menuitem name="Font" onClick="EditorUndo();"/>
      <menuitem name="Size" onClick="EditorUndo();"/>
      <menuitem name="Style" onClick="EditorUndo();"/>
      <menuitem name="Color..." onClick="EditorUndo();"/>
      <menuitem name="Remove All Style(s)" onClick="EditorUndo();"/>
      <separator />
      <menuitem name="Heading" onClick="EditorUndo();"/>
    </menu>
    <menu name="Tools">
      <menuitem name="Spell Check" onClick="EditorUndo();"/>
    </menu>
    <menu name="Communicator">
      <menuitem name="Navigator" onClick="EditorUndo();"/>
    </menu>
    <menu name="Help">
      <menuitem name="About" onClick="EditorUndo();"/>
    </menu>

  </menubar>
  
  <html:div html:id="header">
  <toolbox>
  
    <toolbar>
	    <titledbutton src="resource:/res/toolbar/ED_Undo.gif"
	    				align="bottom" value="Undo"
	    				onClick="EditorUndo()"
	    				style="background-color:rgb(192,192,50);">
	    </titledbutton>
	    
	    <titledbutton src="resource:/res/toolbar/ED_Redo.gif"
	    				align="bottom" value="Redo"
	    				onClick="EditorRedo()"
	    				style="background-color:rgb(192,192,50);">
	    </titledbutton>
	    
	    <titledbutton src="resource:/res/toolbar/ED_Cut.gif"
	    			align="bottom" value="Cut"
	    			onClick="EditorUndo()">
	    </titledbutton>
	    
	    <titledbutton src="resource:/res/toolbar/ED_Copy.gif"
	    			align="bottom" value="Copy"
	    			onClick="EditorUndo()">
	    </titledbutton>
	    
	    <titledbutton src="resource:/res/toolbar/ED_Paste.gif"
	    			align="bottom" value="Paste"
	    			onClick="EditorUndo()">
	    </titledbutton>
	    
	    <titledbutton src="resource:/res/toolbar/ED_Table.gif"
	    			align="bottom" value="Get HTML"
	    			onClick="EditorGetHTML()">
	    </titledbutton>
	    
	    <titledbutton src="resource:/res/toolbar/ED_Spell.gif"
	    		align="bottom" value="Get Text"
	    		onClick="EditorGetText()">
	    </titledbutton>

	    <titledbutton src="resource:/res/toolbar/ED_Bold.gif"
	    		align="bottom" value="Bold"
	    		onClick="EditorBold()">
	    </titledbutton>

    </toolbar>

		<!-- Having so many buttons made loading v. slow. Commented out for now.
    <toolbar>
	    <titledbutton src="resource:/res/toolbar/ED_Find.gif" align="bottom" value="" onClick="EditorUndo()">	</titledbutton>
	    <titledbutton src="resource:/res/toolbar/ED_Link.gif" align="bottom" value="" onClick="EditorUndo()">	</titledbutton>
	    <titledbutton src="resource:/res/toolbar/ED_Target.gif" align="bottom" value="" onClick="EditorUndo()">	</titledbutton>
	    <titledbutton src="resource:/res/toolbar/ED_Image.gif" align="bottom" value="" onClick="EditorUndo()">	</titledbutton>
	    <titledbutton src="resource:/res/toolbar/ED_HLine.gif" align="bottom" value="" onClick="EditorUndo()">	</titledbutton>

	    <titledbutton src="resource:/res/toolbar/ED_Bold.gif" align="bottom" value="" onClick="EditorBold()">	</titledbutton>
	    <titledbutton src="resource:/res/toolbar/ED_Underline.gif" align="bottom" value="" onClick="EditorUndo()">	</titledbutton>
	    <titledbutton src="resource:/res/toolbar/ED_Indent.gif" align="bottom" value="" onClick="EditorUndo()">	</titledbutton>
	    <titledbutton src="resource:/res/toolbar/ED_Dedent.gif" align="bottom" value="" onClick="EditorUndo()">	</titledbutton>
	    <titledbutton src="resource:/res/toolbar/ED_Bullets.gif" align="bottom" value="" onClick="EditorUndo()">	</titledbutton>
	    <titledbutton src="resource:/res/toolbar/ED_Numbers.gif" align="bottom" value="" onClick="EditorUndo()">	</titledbutton>
	    <titledbutton src="resource:/res/toolbar/ED_Left.gif" align="bottom" value="" onClick="EditorUndo()">	</titledbutton>
	    <titledbutton src="resource:/res/toolbar/ED_Center.gif" align="bottom" value="" onClick="EditorUndo()">	</titledbutton>
	    <titledbutton src="resource:/res/toolbar/ED_Right.gif" align="bottom" value="" onClick="EditorUndo()">	</titledbutton>
    </toolbar>
		-->
    
  </toolbox>
  </html:div>

  <html:div html:id="main">
     <html:iframe html:name="content" html:src="EditorInitPage.html" html:width="100%" html:height="450"></html:iframe>
  </html:div>

  <html:div html:id="footer">
     <html:iframe html:name="status" html:src="status.html" html:width="100%" html:height="34"></html:iframe>
  </html:div>

</window>


