[%# The contents of this file are subject to the Mozilla Public
  # License Version 1.1 (the "License"); you may not use this file
  # except in compliance with the License. You may obtain a copy of
  # the License at http://www.mozilla.org/MPL/
  #
  # Software distributed under the License is distributed on an "AS
  # IS" basis, WITHOUT WARRANTY OF ANY KIND, either express or
  # implied. See the License for the specific language governing
  # rights and limitations under the License.
  #
  # The Original Code is Litmus.
  #
  # The Initial Developer of the Original Code is Netscape Communications
  # Corporation. Portions created by Netscape are
  # Copyright (C) 1998 Netscape Communications Corporation. All
  # Rights Reserved.
  #
  # Contributor(s): Zach Lipton <zach@zachlipton.com>
#%]
  
[%# INTERFACE:
  # $opsys      - the selected operating system
  # @groups    - all group objects for the current product
  # %subgroups - all possible subgroups, where the key is the group 
  #            name and the value is an array of subgroups
  # $sysconfig - the system configuration
  # $defaultgroup (optional) - the default group to display
#%]

[% onload = 'showsubgroup()' %]

[% INCLUDE global/html_header.tmpl js_files=['js/SubGroup.js','js/SelectBoxes.js','js/RunTests.js'] %] 
[% INCLUDE global/litmus_header.tmpl %]

<div id="page">

[% INCLUDE sidebar/sidebar.tmpl %]

  <div id="content">

    <h1 class="firstHeading">[% title %]</h1>

<div class="section-full">
<div class="sec_head">
<table width="100%">
<tr>
<td class="l">Testing Summary</td>
<td class="r"><a href="#" onclick="divSWAP('sum'); return false;">Hide / Show Summary</a></td>
</tr>
</table>
</div>

  <div id="sum" class="summary">
  <table class="test-config">
  <tr>

   <td>
    <div class="dh">Product:</div><div class="dv">[% sysconfig.product.name FILTER html %]</div>
    <div class="t_link"><a href="run_tests.cgi">Change Configuration</a></div>
   </td>
   <td>
    <div class="dh">Platform:</div><div class="dv">[% sysconfig.platform.name FILTER html %]</div>
    <div class="dh">Opsys:</div><div class="dv">[% sysconfig.opsys.name FILTER html %]</div>
   </td>
   <td>
    <div class="dh">Branch:</div><div class="dv">[% sysconfig.branch.name FILTER html %]</div>
    <div class="dh">Build ID:</div><div class="dv">[% sysconfig.buildid FILTER html %]</div>
   </td>
  </tr>
  </table>

  </div> <!--END section-content-->

</div> <!--END section-full-->

<hr />

<div class="section-full">
  <div class="section-header">
Select Testing Group
  </div>
  <div class="section-content">

<form action="run_tests.cgi" method="post" name="form" id="form">
<ul>

[% IF defaultgroup.testgroupid=="" %]
  [% select_first_avail_group=1 %]
[% ELSE %]
  [% select_first_avail_group=0 %]
[% END %]
[% FOREACH curgroup = groups %]
    [% group_completed = curgroup.percentcompleted(sysconfig.platform, 0) %]
    [% IF group_completed != 100 AND group_completed!= 'N/A' AND (defaultgroup.testgroupid==curgroup.testgroupid OR select_first_avail_group==1) %]
      [% selected = "checked" %]
      [% select_first_avail_group=0 %]
    [% ELSE %] 
      [% selected = "" %]
    [% END %]

    <li><input [% IF group_completed == 100 OR group_completed == 'N/A' %]disabled [% END %] type="radio" name="group" value="[% curgroup.testgroupid FILTER html %]"
        onchange="showsubgroup()" [% selected %]>
         [% curgroup.name FILTER html %] - [% group_completed %][% IF group_completed != 'N/A' %]%[% END %]</li>
[% END %]
[% # for some boneheaded reason, our js breaks if there is only one group, 
   # so we create a fake dummy group if this is the case: %]
[% IF groups.size == 1 %]
    <input type="radio" name="group" value="null" style="visibility: hidden;">
[% END %]
</ul>
</p>

  </div> <!--END section-content-->

</div> <!--END section-full-->

<div class="section-full">
  <div class="section-header">
Select Subgroup
  </div>
  <div class="section-content">
<p>
[% headerrow = '<tr><th>Name</th><th>Number of Tests</th><th>% Completed</th></tr>' %]
    
<div id="divsubgroup_null" style="visibility: visible;">
<table class="run-tests">
[% headerrow %]
<tr>
<td colspan="3" class="no-results">
Please select a testing group with testcases, or that has not yet been tested in its entirety.
</td>
</tr>
</table>
</div>

[% FOREACH curgroup = subgroups.keys %]
    [% cursubgrouplist = subgroups.$curgroup %]
    <div id="divsubgroup_[% curgroup FILTER html %]" style="display: none;">
        <table class="run-tests">
            [% headerrow %]
            [% FOREACH cursubgroup = cursubgrouplist %]
            
            [% completed = cursubgroup.percentcompleted(sysconfig.platform, 0) %]
            [% IF completed == 100 OR completed == 'N/A' %]
                [% groupstyle = 'completegroup' %]
            [% ELSE %]
		[% IF not (loop.count % 2) %]
                    [% groupstyle = 'even' %]
		[% ELSE %]
                    [% groupstyle = 'odd' %]
		[% END %]
            [% END %]
            
            <tr class="[% groupstyle %]">
                <td align="left"><input [% IF completed == 100 OR completed == 'N/A' %]disabled [% END %]type="radio" name="subgroup_[% curgroup FILTER html %]" 
                    value="[% cursubgroup.id FILTER html %]">
                    [% cursubgroup.name FILTER html %]</input></td>
                <td align="center">[% counttests = cursubgroup.tests %]
                    [% IF ! counttests %] 0 
                    [% ELSIF ! counttests.testid %][% counttests.list.size %]
                    [% ELSE %]
                    1[% END %]</td>
                <td align="center">[% completed FILTER html %][% IF completed != 'N/A' %]%[% END %]</td>
            </tr>
            [% END %]
        </table>
    </div>
[% END %]
<br>
</p>

<div id="div_submit">
<input type="submit" name="Submit" value="Submit">
</div>

</form>
</p>

  </div> <!--END section-content-->

</div> <!--END section-full-->

  </div> <!--END content-->

</div> <!--END page-->

[% INCLUDE global/litmus_footer.tmpl %]
[% INCLUDE global/html_footer.tmpl %]

