<!-- 1.0@bugzilla.org -->
[%# The contents of this file are subject to the Mozilla Public
  # License Version 1.1 (the "License"); you may not use this file
  # except in compliance with the License. You may obtain a copy of
  # the License at http://www.mozilla.org/MPL/
  #
  # Software distributed under the License is distributed on an "AS
  # IS" basis, WITHOUT WARRANTY OF ANY KIND, either express or
  # implied. See the License for the specific language governing
  # rights and limitations under the License.
  #
  # The Original Code is the Bugzilla Bug Tracking System.
  #
  # The Initial Developer of the Original Code is Netscape Communications
  # Corporation. Portions created by Netscape are
  # Copyright (C) 1998 Netscape Communications Corporation. All
  # Rights Reserved.
  #
  # Contributor(s): Myk Melez <myk@mozilla.org>
  #%]

[%# INTERFACE:
  # form, mform: hashes; the form values submitted to the script, used by 
  #                   hidden-fields to generate hidden form fields replicating 
  #                   the original form
  # flags: array;  the flags the user made, including information about
  #                   potential requestees for those flags (based on
  #                   the string the user typed into the requestee fields)
  # target: record;   the bug/attachment for which the flags are being made
  #%]

[% UNLESS header_done %]
  [% title = BLOCK %]
    Verify Requests for Bug #[% target.bug.id %]
    [% IF target.attachment %], Attachment #[% target.attachment.id %][% END %]
  [% END %]

  [% h1 = BLOCK %]
    Verify Requests for <a href="show_bug.cgi?id=[% target.bug.id %]">Bug #[% target.bug.id %]</a>
    [% IF target.attachment.exists %],
      <a href="attachment.cgi?id=[% target.attachment.id %]&action=edit">Attachment #[% target.attachment.id %]</a>
    [% END %]
  [% END %]

  [% h2 = BLOCK %]
    [% target.bug.summary FILTER html %]
    [% IF target.attachment.exists %]
      : [% target.attachment.summary FILTER html %]
    [% END %]
  [% END %]

  [% PROCESS global/header.html.tmpl %]
[% END %]

<form method="post">

[% PROCESS "global/hidden-fields.html.tmpl" 
     exclude=("^(flag_type|requestee)-") %]

[% FOREACH flag = flags %]
  [% IF flag.requestees.size == 0 %]
    <p>
      Sorry, I can't find a user whose name or email address contains 
      the string <em>[% flag.requestee_str FILTER html %]</em>.  
      Double-check that the user's name or email address contains that 
      string, or try entering a shorter string.
    </p>
    <p>
      Ask <input type="text" size="20" maxlength="255"
                 name="requestee-[% flag.type.id %]" 
                 value="[% flag.requestee_str FILTER html %]">
      for [% flag.type.name FILTER html %]
      <input type="hidden" name="flag_type-[% flag.type.id %]" value="?">
    </p>
  
  [% ELSIF flag.requestees.size == 1 %]
      <input type="hidden" 
             name="requestee-[% flag.type.id %]" 
             value="[% flag.requestee.email FILTER html %]">
      <input type="hidden" name="flag_type-[% flag.type.id %]" value="?">
  
  [% ELSE %]
    <p>
      More than one user's name or email address contains the string
      <em>[% flag.requestee_str FILTER html %]</em>.  Choose the user
      you meant from the following menu or click the back button and try 
      again with a more specific string.
    </p>
    <p>
      Ask <select name="requestee-[% flag.type.id %]">
        [% FOREACH requestee = flag.requestees %]
          <option value="[% requestee.email FILTER html %]">
            [% requestee.identity FILTER html%]</option>
        [% END %]
      </select>
      for [% flag.type.name %]
      <input type="hidden" name="flag_type-[% flag.type.id %]" value="?">
    </p>
  
  [% END %]
[% END %]

<input type="submit" value="Commit">

</form>

[% PROCESS global/footer.html.tmpl %]

