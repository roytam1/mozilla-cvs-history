<!-- 1.0@bugzilla.org -->
[%# The contents of this file are subject to the Mozilla Public
  # License Version 1.1 (the "License"); you may not use this file
  # except in compliance with the License. You may obtain a copy of
  # the License at http://www.mozilla.org/MPL/
  #
  # Software distributed under the License is distributed on an "AS
  # IS" basis, WITHOUT WARRANTY OF ANY KIND, either express or
  # implied. See the License for the specific language governing
  # rights and limitations under the License.
  #
  # The Original Code is the Bugzilla Bug Tracking System.
  #
  # The Initial Developer of the Original Code is Netscape Communications
  # Corporation. Portions created by Netscape are
  # Copyright (C) 1998 Netscape Communications Corporation. All
  # Rights Reserved.
  #
  # Contributor(s): Gervase Markham <gerv@gerv.net>
  #%]

[%# INTERFACE:
  # This template has no interface. However, to use it, you need to fulfill
  # the interfaces of the templates it contains.
  #%]

[% PROCESS global/header.html.tmpl 
  title = "Generate Report"
  onload = "selectProduct(document.forms['reportform']);"
%]

[% PROCESS "global/field-descs.html.tmpl" %]

<p>
  Produce a table of bug counts by choosing one or more fields to plot against
  each other, and then refining your set of bugs using the rest of the form. If
  you choose a third axis, it will be represented by multiple tables of data.
</p>

[% button_name = "Generate Report" %]

<form method="get" action="report.cgi" name="reportform">

<table align="center">
  <tr>
    <td>
    </td>
    <td align="center">
      <b>Horizontal Axis:</b>
      [% PROCESS select sel = { name => 'x_axis_field', noop = 1 } %]
    </td>
    <td>&nbsp;&nbsp;</td>
    <td rowspan="2">
      <b>Format:</b><br>
      <input type="radio" name="ctype" value="html" checked>HTML<br>
      <input type="radio" name="ctype" value="csv">CSV
    </td>
  </tr>
  
  <tr>
    <td valign="middle" align="center">
      <b>Vertical Axis:</b><br>
      [% PROCESS select sel = { name => 'y_axis_field' } %]
    </td>
    <td width="150px" height="150px">
      <table border="1" width="100%" height="100%">
        <tr>
          <td align="center" valign="middle">
            <b>Multiple Tables:</b><br>
            [% PROCESS select sel = { name => 'z_axis_field', noop = 1 } %]
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>  

<hr>

[% PROCESS search/form.html.tmpl %]

<br>
<input type="submit" value="[% button_name %]">
<input type="hidden" name="format" value="table">
<input type="hidden" name="action" value="plot">
<hr>

[% PROCESS "search/boolean-charts.html.tmpl" %]

</form>

[% PROCESS global/footer.html.tmpl %]

[%############################################################################%]
[%# Block for SELECT fields                                                  #%]
[%############################################################################%]

[% BLOCK select %]
  [% fields = ["product", "component", "version", "rep_platform",  
               "op_sys", "bug_status", "resolution", "bug_severity", 
               "priority", "target_milestone", "keywords", "assigned_to",
               "reporter", "qa_contact", "votes" ] %]

  <select name="[% sel.name %]">
    [% IF sel.noop %]
      <option value="">&lt;none&gt;</option>
    [% END %]
    
    [% FOREACH field = fields %]
      [% NEXT IF field == "target_milestone" AND !Param('usetargetmilestone') %]
      [% NEXT IF field == "qa_contact" AND !Param('useqacontact') %]
      [% NEXT IF field == "votes" AND !Param('usevotes') %]
      
      <option value="[% field FILTER html %]" 
        [% " selected" IF default.${sel.name}.0 == field %]>
        [% field_descs.$field || field FILTER html %]</option>
    [% END %]
  </select>
[% END %]
