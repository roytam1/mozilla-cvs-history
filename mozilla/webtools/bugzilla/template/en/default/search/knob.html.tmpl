<!-- 1.0@bugzilla.org -->
[%# The contents of this file are subject to the Mozilla Public
  # License Version 1.1 (the "License"); you may not use this file
  # except in compliance with the License. You may obtain a copy of
  # the License at http://www.mozilla.org/MPL/
  #
  # Software distributed under the License is distributed on an "AS
  # IS" basis, WITHOUT WARRANTY OF ANY KIND, either express or
  # implied. See the License for the specific language governing
  # rights and limitations under the License.
  #
  # The Original Code is the Bugzilla Bug Tracking System.
  #
  # The Initial Developer of the Original Code is Netscape Communications
  # Corporation. Portions created by Netscape are
  # Copyright (C) 1998 Netscape Communications Corporation. All
  # Rights Reserved.
  #
  # Contributor(s): Gervase Markham <gerv@gerv.net>
  #                 Tobias Burnus <burnus@net-b.de>
  #                 Jouni Heikniemi <jouni@heikniemi.net>
  #%]

[%# This is not necessary for English templates, but useful for localisers. %]
[% ordersdesc = {
   "Reuse same sort as last time" => "Reuse same sort as last time",
   "Bug Number"   => "Bug Number",
   "Importance"   => "Importance",
   "Assignee"     => "Assignee",
   "Last Changed" => "Last Changed" } %]

<br>
[% IF NOT userid %]
  <input type="hidden" name="cmdtype" value="doit">
[% ELSE %]
  <script type="text/javascript"> <!--
    function remCheckboxChanged() {
      if (document.queryform.remember.checked == true) {
        document.queryform.remtype[0].disabled = false;
        document.queryform.remtype[1].disabled = false;
        remTypeChanged();
      }
      else {
        document.queryform.remtype[0].disabled = true;
        document.queryform.remtype[1].disabled = true;
        document.queryform.newqueryname.disabled = true;
        document.queryform.tofooter.disabled = true;
      }
    }

    function remTypeChanged() {
      if (document.queryform.remtype[0].checked == true) {
        document.queryform.newqueryname.disabled = false;
        document.queryform.tofooter.disabled = false;
      }
      else {
        document.queryform.newqueryname.disabled = true;
        document.queryform.tofooter.disabled = true;
      }
    }

    function selectDoRem() {
      document.queryform.cmdtype[1].checked = true;
    }
    // -->
  </script>

  <table>
    [% IF namedqueries.size > 0 %]
      <tr>
        <td>
          <input type="radio" id="cmdtype-doit"
                 name="cmdtype" value="doit" checked="checked">
          <label for="cmdtype-doit">Run this search</label>
        </td>
        <td>&nbsp;</td>
      </tr>
    [% END %]
    <tr>
      <td valign="top">
        [% IF namedqueries.size > 0 %]
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        [% END %]
        <input type="checkbox" id="remember" name="remember" value="1" 
               onclick="remCheckboxChanged()">
        [% IF namedqueries.size > 0 %]
          <label for="remember">and remember it</label>
        [% ELSE %]
          <label for="remember">Remember this search</label>
          <input type="hidden" id="cmdtype-doit"
                 name="cmdtype" value="doit">
        [% END %]
      </td>
      <td>
        <input type="radio" id="remtype-asnamed"
               name="remtype" value="asnamed" checked="checked"
               onclick="remTypeChanged()">
        <label for="remtype-asnamed">with this name:</label>
        <input type="text" name="newqueryname"><br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <input type="checkbox" id="tofooter" name="tofooter" value="1">
          <label for="tofooter">and put it in my page footer</label><br>
        <input type="radio" id="remtype-asdefault"
               name="remtype" value="asdefault"
               onclick="remTypeChanged()">
        <label for="remtype-asdefault">
          as my default options for this page
        </label><br>
      </td>
    </tr>
  
    <tr>
      <td colspan="2">
        [% IF namedqueries.size > 0 %]
          <input type="radio" id="cmdtype-dorem" name="cmdtype" value="dorem">
          <select name="remaction" onclick="selectDoRem()">
            <option value="run">Run</option>
            <option value="load">Load</option>
            <option value="forget">Forget</option>
          </select>
          <label for="cmdtype-dorem">my remembered search:</label>
          <select name="namedcmd" onclick="selectDoRem()">
            [% FOREACH query = namedqueries %]
              <option value="[% query FILTER html %]">
                [% query FILTER html %]</option>
            [% END %]
          </select>        
        [% END %]
      </td>
    </tr>
  </table>
  
  <script type="text/javascript"> <!--
    remCheckboxChanged();
    // -->
  </script>
[% END %]

<p>
  Sort results by:
  <select name="order">
  [% FOREACH order = orders %]
    <option value="[% order FILTER html %]"
      [% " selected" IF default.order.0 == order %]>
         [% ordersdesc.$order FILTER html %]</option> 
  [% END %]
  </select>

  <input type="submit" value="[% button_name %]">
  
  [% IF userdefaultquery %]
     <p>
       <a href="query.cgi?nukedefaultquery=1">
         Set my default query back to the system default</a>.
     </p>
  [% END %]
</p>

