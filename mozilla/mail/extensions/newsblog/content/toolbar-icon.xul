<?xml version="1.0"?>
<?xml-stylesheet href="chrome://messenger-newsblog/skin/newsBlogOverlay.css" type="text/css"?> 

<!DOCTYPE overlay SYSTEM "chrome://messenger-newsblog/locale/newsblog.dtd">

<overlay xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">

<script type="application/x-javascript">
  function openSubscriptionsDialog(aRSSServer) {

    //check for an existing subscriptions window and focus it.
    const kWindowMediatorContractID = "@mozilla.org/appshell/window-mediator;1";
    const kWindowMediatorIID = Components.interfaces.nsIWindowMediator;
    const kWindowMediator = Components.classes[kWindowMediatorContractID].getService(kWindowMediatorIID);
    var lastSubscriptionWindow = kWindowMediator.getMostRecentWindow("Mail:News-BlogSubscriptions");
  
    if (lastSubscriptionWindow)
      lastSubscriptionWindow.focus();
    else 
      window.openDialog("chrome://messenger-newsblog/content/subscriptions.xul", "",
                        "centerscreen,resizable=yes", { server: aRSSServer});
  }

  function openSubscriptionsDialogFromFolderPane()
  {
    // get the incoming server for the seleted folder
    var selectedFolders = GetSelectedMsgFolders();
    openSubscriptionsDialog(selectedFolders[0].server);
  }
</script>

<!-- Overlay into the folder pane context menu. If you change the id for the menu item, please
     update mailContextMenus.js 
--> 
<popup id="folderPaneContext">
  <menuitem id="folderPaneContext-rssSubscribe"
    insertafter="folderPaneContext-subscribe"
    label="&folderContextRSSSubscribe.label;"
    accesskey="&folderContextRSSSubscribe.accesskey;"
    oncommand="openSubscriptionsDialogFromFolderPane();"/>
</popup>

</overlay>

