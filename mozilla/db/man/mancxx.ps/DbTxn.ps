%!PS-Adobe-3.0
%%Creator: groff version 1.11
%%CreationDate: Sun May 31 22:58:37 1998
%%DocumentNeededResources: font Times-Bold
%%+ font Times-Roman
%%+ font Times-Italic
%%DocumentSuppliedResources: procset grops 1.11 0
%%Pages: 3
%%PageOrder: Ascend
%%Orientation: Portrait
%%EndComments
%%BeginProlog
%%BeginResource: procset grops 1.11 0
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/MF{
findfont
[5 2 roll
0 3 1 roll
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}bind def
/DA{
newpath arcn stroke
}bind def
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
/DL{
SN
moveto
SN
lineto stroke
}bind def
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
/FL{
currentgray exch setgray fill setgray
}bind def
/BL/fill load def
/LW/setlinewidth load def
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
}bind def
/PEND{
clear
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%IncludeResource: font Times-Bold
%%IncludeResource: font Times-Roman
%%IncludeResource: font Times-Italic
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Times-Italic@0 ENC0/Times-Italic RE/Times-Roman@0 ENC0/Times-Roman RE
/Times-Bold@0 ENC0/Times-Bold RE
%%EndProlog
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Bold@0 SF -.18(NA)72 28.8 S(ME).18 E/F1 10/Times-Roman@0 SF
(DbTxn \255 Db transaction management)108 40.8 Q F0(SYNOPSIS)72 57.6 Q
/F2 10/Times-Bold@0 SF(#include <db_cxx.h>)108 69.6 Q(int)108 93.6 Q
(DbTxn::pr)108 105.6 Q(epar)-.18 E(e\(\);)-.18 E(int)108 129.6 Q
(DbTxn::commit\(\);)108 141.6 Q(int)108 165.6 Q(DbTxn::abort\(\);)108
177.6 Q(u_int32_t)108 201.6 Q(DbTxn::id\(\);)108 213.6 Q F0(DESCRIPTION)
72 230.4 Q F1 1.02(The DB library is a f)108 242.4 R 1.019
(amily of classes that pro)-.1 F 1.019
(vides a modular programming interf)-.15 F 1.019
(ace to transactions and)-.1 F 1.377(record-oriented \214le access.)108
254.4 R 1.378(The library includes support for transactions, locking, logging and \214le page)
6.377 F .443(caching, as well as v)108 266.4 R .443(arious inde)-.25 F
-.15(xe)-.15 G 2.943(da).15 G .442(ccess methods.)-2.943 F(Man)5.442 E
2.942(yo)-.15 G 2.942(ft)-2.942 G .442
(he classes \(e.g., the \214le page caching class\))-2.942 F .4(are useful independent of the other DB classes, although some classes are e)
108 278.4 R .4(xplicitly based on other classes)-.15 F
(\(e.g., transactions and logging\).)108 290.4 Q -.15(Fo)5 G 2.5(rag).15
G(eneral description of the DB package, see)-2.5 E/F3 10/Times-Italic@0
SF(db_intr)2.5 E(o)-.45 E F1(\(3\).).18 E .563(This manual page describes the speci\214c details of the Db transaction support.)
108 307.2 R .562(The DbTxn class is used in)5.562 F .358
(conjunction with)108 319.2 R F3(DbTxnMgr)2.858 E F1 .358(\(3\) to pro)
.73 F .358(vide transaction semantics.)-.15 F .359
(Full transaction support is pro)5.358 F .359(vided by a)-.15 F .262
(collection of modules that pro)108 331.2 R .262(vide interf)-.15 F .261
(aces to the services required for transaction processing.)-.1 F .261
(These ser)5.261 F(-)-.2 E .585(vices are reco)108 343.2 R -.15(ve)-.15
G .585(ry \(see).15 F F3(DbLo)3.085 E(g)-.1 E F1 .585
(\(3\)\), concurrenc).22 F 3.085(yc)-.15 G .585(ontrol \(see)-3.085 F F3
(DbLoc)3.085 E(k)-.2 E F1 .586(\(3\) and).67 F F3(DbLoc)3.086 E(kT)-.2 E
(ab)-.92 E F1 .586(\(3\)\), and the man-).23 F .961
(agement of shared data \(see)108 355.2 R F3(DbMpool)3.461 E F1 .961
(\(3\) and).51 F F3(DbMpoolF)3.461 E(ile)-.45 E F1 3.461(\(3\)\). T).18
F .96(ransaction semantics can be applied to)-.35 F
(the access methods described in)108 367.2 Q F3(Db)2.5 E F1
(\(3\) through method call parameters.).23 E .891(The model intended for transactional use \(and the one that is used by the access methods\) is write-ahead)
108 384 R .508(logging pro)108 396 R .508(vided by)-.15 F F3(DbLo)3.008
E(g)-.1 E F1 .508(\(3\) to record both before- and after).22 F 3.008
(-images. Locking)-.2 F(follo)3.008 E .508(ws a tw)-.25 F .507
(o-phase pro-)-.1 F
(tocol, with all locks being released at transaction commit.)108 408 Q
F3(DbTxn::pr)92 424.8 Q(epar)-.37 E(e)-.37 E F1(The)108 436.8 Q F3
(DbTxn::pr)3.762 E(epar)-.37 E(e)-.37 E F1 1.263
(method initiates the be)3.762 F 1.263(ginning of a tw)-.15 F 3.763(op)
-.1 G 1.263(hase commit.)-3.763 F 1.263(In a distrib)6.263 F 1.263
(uted transaction)-.2 F(en)108 448.8 Q(vironment,)-.4 E F3(db)3.189 E F1
.688(can be used as a local transaction manager)3.189 F 5.688(.I)-.55 G
3.188(nt)-5.688 G .688(his case, the distrib)-3.188 F .688
(uted transaction man-)-.2 F .2(ager must send)108 460.8 R F3(pr)2.7 E
(epar)-.37 E(e)-.37 E F1 .2(messages to each local manager)2.7 F 5.2(.T)
-.55 G .2(he local manager must then issue a)-5.2 F F3(DbTxn::pr)2.7 E
(e-)-.37 E(par)108 472.8 Q(e)-.37 E F1 .027(and a)2.527 F -.1(wa)-.15 G
.027(it its successful return before responding to the distrib).1 F .026
(uted transaction manager)-.2 F 5.026(.O)-.55 G .026(nly after the)
-5.026 F(distrib)108 484.8 Q 1.394(uted transaction manager recei)-.2 F
-.15(ve)-.25 G 3.894(ss).15 G 1.395(uccessful responses from all of its)
-3.894 F F3(pr)3.895 E(epar)-.37 E(e)-.37 E F1 1.395(messages should it)
3.895 F(issue an)108 496.8 Q(y)-.15 E F3(commit)2.5 E F1(messages.)2.5 E
(The)108 513.6 Q F3(DbTxn::pr)2.574 E(epar)-.37 E(e)-.37 E F1 .074
(method thro)2.574 F .074(ws a)-.25 F F3(DbException)2.574 E F1 .074
(\(3\) or returns the v).24 F .073(alue of)-.25 F F3(errno)2.573 E F1
.073(on f)2.573 F .073(ailure and 0 on suc-)-.1 F(cess.)108 525.6 Q F3
(DbTxn::commit)92 542.4 Q F1(The)108 554.4 Q F3(DbTxn::commit)3.05 E F1
.551(method ends the transaction associated with the DbTxn.)3.05 F .551
(If DB_TXN_NOSYNC w)5.551 F(as)-.1 E .019(not speci\214ed, a commit log record is written and \215ushed to disk, as are all pre)
108 566.4 R .019(viously written log records.)-.25 F(If)5.018 E .842(the transaction is nested, its locks are acquired by the parent transaction, otherwise its locks are released.)
108 578.4 R(An)108 590.4 Q 2.545(ya)-.15 G .045
(pplications that require strict tw)-2.545 F .045
(o-phase locking must not release an)-.1 F 2.544(yl)-.15 G .044(ocks e)
-2.544 F(xplicitly)-.15 E 2.544(,l)-.65 G(ea)-2.544 E .044
(ving them all)-.2 F(to be released by)108 602.4 Q F3(DbTxn::commit)2.5
E F1(.).68 E(The)108 619.2 Q F3(DbTxn::commit)2.66 E F1 .16(method thro)
2.66 F .16(ws a)-.25 F F3(DbException)2.66 E F1 .16
(\(3\) or returns the v).24 F .161(alue of)-.25 F F3(errno)2.661 E F1
.161(on f)2.661 F .161(ailure and 0 on suc-)-.1 F(cess.)108 631.2 Q F3
(DbTxn::abort)92 648 Q F1(The)108 660 Q F3(DbTxn::abort)2.695 E F1 .195
(method causes an abnormal termination of the transaction.)2.695 F .195
(The log is played backw)5.195 F(ards)-.1 E 2.56(and an)108 672 R 5.06
(yn)-.15 G 2.56(ecessary reco)-5.06 F -.15(ve)-.15 G 2.561
(ry operations are initiated through the).15 F F3 -.37(re)5.061 G(co).37
E(ver)-.1 E F1 2.561(method speci\214ed to)5.061 F F3(DbTxn-)5.061 E
(Mgr::open)108 684 Q F1 5.362(.A).24 G .362(fter reco)-5.362 F -.15(ve)
-.15 G .361(ry is completed, all locks held by the transaction are acquired by the parent trans-)
.15 F .355(action in the case of a nested transaction or released in the case of a non-nested transaction.)
108 696 R .356(As is the case)5.356 F(for)108 708 Q F3(DbTxn::commit)
4.261 E F1 4.261(,a).68 G 1.761(pplications that require strict tw)
-4.261 F 4.261(op)-.1 G 1.761(hase locking should not e)-4.261 F 1.76
(xplicitly release an)-.15 F(y)-.15 E(locks.)108 720 Q(1)535 768 Q EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 385.52(DbTxn\(3\) DbTxn\(3\))72 48 R(The)108 84
Q/F1 10/Times-Italic@0 SF(DbTxn::abort)3.117 E F0 .617(method thro)3.117
F .617(ws a)-.25 F F1(DbException)3.117 E F0 .618
(\(3\) or returns the v).24 F .618(alue of)-.25 F F1(errno)3.118 E F0
.618(on f)3.118 F .618(ailure and 0 on suc-)-.1 F(cess.)108 96 Q F1
(DbTxn::id)92 112.8 Q F0(The)108 124.8 Q F1(DbTxn::id)2.851 E F0 .351(method returns the unique transaction id associated with the speci\214ed transaction.)
2.851 F(Locking)5.35 E .094
(calls made on behalf of this transaction should use the v)108 136.8 R
.095(alue returned from)-.25 F F1(DbTxn::id)2.595 E F0 .095(as the lock)
2.595 F .095(er parame-)-.1 F(ter to the)108 148.8 Q F1(DbLoc)2.5 E(kT)
-.2 E(ab::g)-.92 E(et)-.1 E F0(or)2.5 E F1(DbLoc)2.5 E(kT)-.2 E(ab::vec)
-.92 E F0(calls.)2.5 E/F2 9/Times-Bold@0 SF(TRANSA)72 170.4 Q(CTIONS)
-.495 E F0 .866(Creating transaction protected applications using the Db access methods requires little system customiza-)
108 182.4 R 3.254(tion. In)108 194.4 R .754(most cases, the def)3.254 F
.754(ault parameters to the locking, logging, memory pool, and transaction subsys-)
-.1 F 1.411(tems will suf)108 206.4 R 3.911(\214ce. Applications)-.25 F
1.411(can use)3.911 F F1(DbEn)3.911 E(v::appinit)-.4 E F0(\(see)3.911 E
F1(DbEn)3.911 E(v)-.4 E F0 1.41
(\(3\)\) to perform this initialization, or).32 F(the)108 218.4 Q 2.5
(ym)-.15 G(ay do it e)-2.5 E(xplicitly)-.15 E(.)-.65 E 2.075
(Each database operation \(i.e., an)108 235.2 R 4.575(yc)-.15 G 2.075
(all to a method underlying the handles returned by)-4.575 F F1
(Db::open)4.576 E F0(and)4.576 E F1(Db::cur)108 247.2 Q(sor)-.1 E F0
1.031(described in)3.531 F F1(Db)3.531 E F0 1.031
(\(3\)\) is normally performed on behalf of a unique lock).23 F(er)-.1 E
6.03(.I)-.55 G 3.53(fm)-6.03 G 1.03(ultiple calls on)-3.53 F
(behalf of the same lock)108 259.2 Q
(er are desired, then transactions must be used.)-.1 E .684(Once the application has initialized the Db subsystems that it is using, it may open the Db access method)
108 276 R 3.032(databases. F)108 288 R .532(or applications performing transactions, the databases must be opened after subsystem initial-)
-.15 F .533(ization, and cannot be opened as part of a transaction.)108
300 R .533(Once the databases are opened, the application can)5.533 F
2.081(group sets of operations into transactions, by surrounding the operations with the appropriate)
108 312 R F1(DbTxn-)4.58 E(Mgr::be)108 324 Q(gin)-.4 E F0(,).24 E F1
(DbTxn::commit)4.284 E F0(and)4.284 E F1(DbTxn::abort)4.284 E F0 4.284
(calls. Databases)4.284 F 1.784(accessed by a transaction must not be)
4.284 F .386(closed during the transaction.)108 336 R .386(Note, it is not necessary to transaction protect read-only transactions, unless)
5.386 F(those transactions require repeatable reads.)108 348 Q .583
(The Db access methods will mak)108 364.8 R 3.083(et)-.1 G .584
(he appropriate calls into the lock, log and memory pool subsystems in)
-3.083 F 1.164
(order to guarantee that transaction semantics are applied.)108 376.8 R
1.164(When the application is ready to e)6.164 F 1.163(xit, all out-)
-.15 F 1.138(standing transactions should ha)108 388.8 R 1.438 -.15
(ve b)-.2 H 1.138(een committed or aborted.).15 F 1.138
(At this point, all open Db \214les should be)6.138 F 3.039
(closed. Once)108 400.8 R .539(the Db database \214les are closed, the Db subsystems should be closed, either e)
3.039 F .538(xplicitly or by)-.15 F(destro)108 412.8 Q(ying the)-.1 E F1
(DbEn)2.5 E(v)-.4 E F0(\(3\) object.).32 E 1.716(It is also possible to use the locking, logging and transaction subsystems of Db to pro)
108 429.6 R 1.716(vide transaction)-.15 F .703(semantics to objects other than those described by the Db access methods.)
108 441.6 R .702(In these cases, the application)5.702 F 1.081
(will need more e)108 453.6 R 1.081
(xplicit customization of the subsystems as well as the de)-.15 F -.15
(ve)-.25 G 1.082(lopment of appropriate data-).15 F
(structure-speci\214c reco)108 465.6 Q -.15(ve)-.15 G(ry functions.).15
E -.15(Fo)108 482.4 S 2.89(re).15 G .39
(xample, consider an application that pro)-3.04 F .389
(vides transaction semantics to data stored in plain UNIX \214les)-.15 F
1.098(accessed using the)108 494.4 R F1 -.37(re)3.598 G(ad).37 E F0
1.098(\(2\) and).77 F F1(write)3.598 E F0 1.098(\(2\) system calls.).18
F 1.099(The operations for which transaction protection is)6.099 F
(desired are brack)108 506.4 Q(eted by calls to)-.1 E F1(DbTxnMgr::be)
2.5 E(gin)-.4 E F0(and)2.5 E F1(DbTxn::commit)2.5 E F0(.).68 E .444
(Before data are referenced, the application must mak)108 523.2 R 2.944
(eac)-.1 G .444(all to the lock manager)-2.944 F(,)-.4 E F1(DbLoc)2.944
E(k)-.2 E F0 .444(\(3\), for a lock of).67 F .157
(the appropriate type \(e.g., read\) on the object being lock)108 535.2
R 2.657(ed. The)-.1 F .157
(object might be a page in the \214le, a byte, a)2.657 F .041
(range of bytes, or some k)108 547.2 R -.15(ey)-.1 G 5.041(.I)-.5 G
2.541(ti)-5.041 G 2.541(su)-2.541 G 2.541(pt)-2.541 G 2.541(ot)-2.541 G
.04(he application to ensure that appropriate locks are acquired.)-2.541
F(Before)5.04 E 3.357(aw)108 559.2 S .858(rite is performed, the application should acquire a write lock on the object, by making an appropriate)
-3.357 F .339(call to the lock manager)108 571.2 R(,)-.4 E F1(DbLoc)
2.839 E(k)-.2 E F0(\(3\)).67 E F1(.).23 E F0 .339
(Then, the application should mak)5.339 F 2.839(eac)-.1 G .339
(all to the log manager)-2.839 F(,)-.4 E F1(DbLo)2.838 E(g)-.1 E F0(,)
.22 E .059
(to record enough information to redo the operation in case of f)108
583.2 R .06(ailure after commit and to undo the operation)-.1 F .877
(in case of abort.)108 595.2 R .877(As discussed in the)5.877 F F1(DbLo)
3.377 E(g)-.1 E F0 .877
(\(3\) manual page, the application is responsible for pro).22 F(viding)
-.15 E(an)108 607.2 Q 3.439(yn)-.15 G .939
(ecessary structure to the log record.)-3.439 F -.15(Fo)5.939 G 3.439
(re).15 G .94(xample, the application must understand what part of the)
-3.589 F .578(log record is an operation code, what part identi\214es the \214le being modi\214ed, what part is redo information,)
108 619.2 R(and what part is undo information.)108 631.2 Q 1.298(After the log message is written, the application may issue the write system call.)
108 648 R 1.299(After all requests are)6.299 F 1.229
(issued, the application may call)108 660 R F1(DbTxn::commit)3.728 E F0
6.228(.W).68 G(hen)-6.228 E F1(DbTxn::commit)3.728 E F0 1.228
(returns, the caller is guaranteed)3.728 F
(that all necessary log writes ha)108 672 Q .3 -.15(ve b)-.2 H
(een written to disk.).15 E .101(At an)108 688.8 R 2.601(yt)-.15 G .101
(ime, the application may call)-2.601 F F1(DbTxn::abort)2.601 E F0 2.601
(,w).68 G .101(hich will result in the appropriate calls to the)-2.601 F
F1 -.37(re)2.602 G(co).37 E(ver)-.1 E F0 .069(method to restore the `)
108 700.8 R(`database')-.74 E 2.569('t)-.74 G 2.569(oac)-2.569 G .069
(onsistent pre-transaction state.)-2.569 F .069(\(The reco)5.069 F -.15
(ve)-.15 G 2.569(rm).15 G .068(ethod must be able to)-2.569 F
(either re-apply or undo the update depending on the conte)108 712.8 Q
(xt, for each dif)-.15 E(ferent type of log record.\))-.25 E .746
(If the application should crash, the reco)108 729.6 R -.15(ve)-.15 G
.746(ry process uses the).15 F F1(DbLo)3.246 E(g)-.1 E F0(interf)3.246 E
.746(ace to read the log and call the)-.1 F(May 3, 1998)280.585 768 Q(2)
203.585 E EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 385.52(DbTxn\(3\) DbTxn\(3\))72 48 R/F1 10
/Times-Italic@0 SF -.37(re)108 84 S(co).37 E(ver)-.1 E F0
(method to restore the database to a consistent state.)2.5 E(The)108
100.8 Q F1(DbTxn::pr)3.773 E(epar)-.37 E(e)-.37 E F0 1.273(method pro)
3.773 F 1.273(vides the core functionality to implement distrib)-.15 F
1.272(uted transactions, b)-.2 F 1.272(ut it)-.2 F .637
(does not manage the noti\214cation of distrib)108 112.8 R .637
(uted transaction managers.)-.2 F .637
(The caller is responsible for issuing)5.637 F F1(DbTxn::pr)108 124.8 Q
(epar)-.37 E(e)-.37 E F0 .253
(calls to all sites participating in the transaction.)2.754 F .253
(If all responses are positi)5.253 F -.15(ve)-.25 G 2.753(,t).15 G .253
(he caller can)-2.753 F .943(issue a)108 136.8 R F1(DbTxn::commit)3.443
E F0 5.943(.I).68 G 3.443(fa)-5.943 G 1.243 -.15(ny o)-3.443 H 3.443(ft)
.15 G .943(he responses are ne)-3.443 F -.05(ga)-.15 G(ti).05 E -.15(ve)
-.25 G 3.443(,t).15 G .943(he caller should issue a)-3.443 F F1
(DbTxn::abort)3.444 E F0 5.944(.I).68 G(n)-5.944 E(general, the)108
148.8 Q F1(DbTxn::pr)2.5 E(epar)-.37 E(e)-.37 E F0
(call requires that the transaction log be \215ushed to disk.)2.5 E/F2 9
/Times-Bold@0 SF(TRANSA)72 165.6 Q(CTION ID LIMITS)-.495 E F0 .165
(The transaction ID space in Berk)108 177.6 R(ele)-.1 E 2.665(yD)-.15 G
2.665(Bi)-2.665 G 2.665(s2)-2.665 G .165(^31, or 2 billion entries.)
-2.665 F .165(It is possible that some en)5.165 F(vironments)-.4 E .422
(may need to be a)108 189.6 R -.1(wa)-.15 G .422(re of this limitation.)
.1 F .423
(Consider an application performing 600 transactions a second for)5.422
F(15 hours a day)108 201.6 Q 5(.T)-.65 G
(he transaction ID space will run out in roughly 66 days:)-5 E
(2^31 / \(600 * 15 * 60 * 60\) = 66)144 218.4 Q
(Doing only 100 transactions a second e)108 235.2 Q
(xhausts the transaction ID space in roughly one year)-.15 E(.)-.55 E
1.049(The transaction ID space is reset each time reco)108 252 R -.15
(ve)-.15 G 1.048(ry is run.).15 F 1.048
(If you reach the end of your transaction ID)6.048 F 1.262
(space, shut do)108 264 R 1.263
(wn your applications and restart them after running reco)-.25 F -.15
(ve)-.15 G 1.263(ry \(see).15 F F1(db_r)3.763 E(eco)-.37 E(ver)-.1 E F0
1.263(\(1\) for more).73 F 2.823(information\). The)108 276 R .323
(most recently allocated transaction ID is the)2.823 F F1(st_last_txnid)
2.823 E F0 -.25(va)2.823 G .323(lue in the transaction statis-).25 F
(tics information, and is displayed by the)108 288 Q F1(db_stat)2.5 E F0
(\(1\) utility).68 E(.)-.65 E F2(ERR)72 304.8 Q(ORS)-.27 E F0 .049
(Methods mark)108 316.8 R .049(ed as returning)-.1 F F1(errno)2.549 E F0
.049(will, by def)2.549 F .049(ault, thro)-.1 F 2.549(wa)-.25 G 2.549
(ne)-2.549 G .05(xception that encapsulates the error informa-)-2.699 F
2.5(tion. The)108 328.8 R(def)2.5 E(ault error beha)-.1 E
(vior can be changed, see)-.2 E F1(DbException)2.5 E F0(\(3\).).24 E
(The)108 345.6 Q F1(DbTxn::pr)2.5 E(epar)-.37 E(e)-.37 E F0
(method may f)2.5 E(ail and thro)-.1 E 2.5(wa)-.25 G F1(DbException)A F0
(\(3\)).24 E(or return)108 369.6 Q F1(errno)2.5 E F0(for an)2.5 E 2.5
(yo)-.15 G 2.5(ft)-2.5 G(he errors speci\214ed for the follo)-2.5 E
(wing DB and library functions: DbLog::\215ush\(3\),)-.25 E
(fcntl\(2\), f)108 381.6 Q(\215ush\(3\), and strerror\(3\).)-.25 E(The)
108 398.4 Q F1(DbTxn::commit)2.5 E F0(method may f)2.5 E(ail and thro)
-.1 E 2.5(wa)-.25 G F1(DbException)A F0(\(3\)).24 E(or return)108 422.4
Q F1(errno)2.5 E F0(for an)2.5 E 2.5(yo)-.15 G 2.5(ft)-2.5 G
(he errors speci\214ed for the follo)-2.5 E
(wing DB and library functions: DbLock-)-.25 E -.8(Ta)108 434.4 S(b::v)
.8 E(ec\(3\), DbLog::put\(3\), fcntl\(2\), f)-.15 E
(\215ush\(3\), malloc\(3\), memcp)-.25 E(y\(3\), and strerror\(3\).)-.1
E .849(In addition, the)108 451.2 R F1(DbTxn::commit)3.349 E F0 .849
(method may f)3.349 F .849(ail and thro)-.1 F 3.349(wa)-.25 G F1
(DbException)A F0 .849(\(3\) or return).24 F F1(errno)3.348 E F0 .848
(for the fol-)3.348 F(lo)108 463.2 Q(wing conditions:)-.25 E([EINV)108
480 Q(AL])-1.35 E(The transaction w)133 492 Q(as aborted.)-.1 E(The)108
508.8 Q F1(DbTxn::abort)2.5 E F0(method may f)2.5 E(ail and thro)-.1 E
2.5(wa)-.25 G F1(DbException)A F0(\(3\)).24 E(or return)108 532.8 Q F1
(errno)2.5 E F0(for an)2.5 E 2.5(yo)-.15 G 2.5(ft)-2.5 G
(he errors speci\214ed for the follo)-2.5 E
(wing DB and library functions:)-.25 E(DBen)108 544.8 Q(v->tx_reco)-.4 E
-.15(ve)-.15 G(r\(3\), DbLockT).15 E(ab::v)-.8 E
(ec\(3\), DbLog::get\(3\), fcntl\(2\), f)-.15 E
(\215ush\(3\), memset\(3\), and strerror\(3\).)-.25 E([EINV)108 561.6 Q
(AL])-1.35 E(The transaction w)133 573.6 Q(as already aborted.)-.1 E F2
(SEE ALSO)72 590.4 Q F1 .904(LIBTP: P)108 602.4 R(ortable)-.8 E 3.404
(,M)-.1 G .904(odular T)-3.404 F -.15(ra)-.55 G .904(nsactions for UNIX)
.15 F F0 3.404(,M).94 G(ar)-3.404 E .904(go Seltzer)-.18 F 3.403(,M)-.4
G .903(ichael Olson, USENIX proceedings,)-3.403 F -.4(Wi)108 614.4 S
(nter 1992.).4 E F2 -.09(BU)72 631.2 S(GS).09 E F0
(Nested transactions are not yet implemented.)108 643.2 Q F1(db_ar)108
667.2 Q -.15(ch)-.37 G(ive).15 E F0(\(1\),).18 E F1(db_c)2.5 E(hec)-.15
E(kpoint)-.2 E F0(\(1\),).68 E F1(db_deadloc)2.5 E(k)-.2 E F0(\(1\),).67
E F1(db_dump)2.5 E F0(\(1\),).19 E F1(db_load)2.5 E F0(\(1\),).77 E F1
(db_r)2.5 E(eco)-.37 E(ver)-.1 E F0(\(1\),).73 E F1(db_stat)2.5 E F0
(\(1\),).68 E F1(db_intr)108 679.2 Q(o)-.45 E F0(\(3\),).18 E F1
(db_internal)2.5 E F0(\(3\),).51 E F1(db_thr)2.5 E(ead)-.37 E F0(\(3\),)
.77 E F1(Db)2.5 E F0(\(3\),).23 E F1(Dbc)2.5 E F0(\(3\),).31 E F1(DbEn)
2.5 E(v)-.4 E F0(\(3\),).32 E F1(DbException)2.5 E F0(\(3\),).24 E F1
(DbInfo)2.5 E F0(\(3\),).18 E F1(DbLoc)108 691.2 Q(k)-.2 E F0(\(3\),).67
E F1(DbLoc)2.5 E(kT)-.2 E(ab)-.92 E F0(\(3\),).23 E F1(DbLo)2.5 E(g)-.1
E F0(\(3\),).22 E F1(DbLsn)2.5 E F0(\(3\),).24 E F1(DbMpool)2.5 E F0
(\(3\),).51 E F1(DbMpoolF)2.5 E(ile)-.45 E F0(\(3\),).18 E F1(Dbt)2.5 E
F0(\(3\),).68 E F1(DbTxn)2.5 E F0(\(3\),).24 E F1(DbTxnMgr)108 703.2 Q
F0(\(3\)).73 E(May 3, 1998)280.585 768 Q(3)203.585 E EP
%%Trailer
end
%%EOF
