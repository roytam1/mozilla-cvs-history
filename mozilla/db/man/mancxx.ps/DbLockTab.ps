%!PS-Adobe-3.0
%%Creator: groff version 1.11
%%CreationDate: Sun May 31 22:58:35 1998
%%DocumentNeededResources: font Times-Bold
%%+ font Times-Roman
%%+ font Times-Italic
%%DocumentSuppliedResources: procset grops 1.11 0
%%Pages: 7
%%PageOrder: Ascend
%%Orientation: Portrait
%%EndComments
%%BeginProlog
%%BeginResource: procset grops 1.11 0
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/MF{
findfont
[5 2 roll
0 3 1 roll
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}bind def
/DA{
newpath arcn stroke
}bind def
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
/DL{
SN
moveto
SN
lineto stroke
}bind def
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
/FL{
currentgray exch setgray fill setgray
}bind def
/BL/fill load def
/LW/setlinewidth load def
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
}bind def
/PEND{
clear
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%IncludeResource: font Times-Bold
%%IncludeResource: font Times-Roman
%%IncludeResource: font Times-Italic
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Times-Italic@0 ENC0/Times-Italic RE/Times-Roman@0 ENC0/Times-Roman RE
/Times-Bold@0 ENC0/Times-Bold RE
%%EndProlog
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Bold@0 SF -.18(NA)72 28.8 S(ME).18 E/F1 10/Times-Roman@0 SF
(DbLockT)108 40.8 Q(ab \255 lock manager)-.8 E F0(SYNOPSIS)72 57.6 Q/F2
10/Times-Bold@0 SF(#include <db_cxx.h>)108 69.6 Q(static int)108 93.6 Q
(DbLockT)108 105.6 Q(ab::open\(const char *dir)-.92 E(,)-.92 E
(u_int32_t \215ags, int mode, DbEn)158 117.6 Q 2.5(v*)-.4 G(dben)-2.5 E
1.1 -.55(v, D)-.4 H(bLockT).55 E(ab **r)-.92 E(egionp\);)-.18 E(int)108
141.6 Q(DbLockT)108 153.6 Q(ab::id\(u_int32_t *idp\);)-.92 E(int)108
177.6 Q(DbLockT)108 189.6 Q(ab::v)-.92 E(ec\(u_int32_t lock)-.1 E(er)-.1
E 2.5(,u)-.92 G(_int32_t \215ags,)-2.5 E
(DB_LOCKREQ list[], int nlist, DB_LOCKREQ **elistp\);)158 201.6 Q(int)
108 225.6 Q(DbLockT)108 237.6 Q(ab::get\(u_int32_t lock)-.92 E(er)-.1 E
2.5(,u)-.92 G(_int32_t \215ags,)-2.5 E
(const Dbt *obj, const db_lockmode_t lock_mode, DB_LOCK *lock\);)158
249.6 Q(int)108 273.6 Q(DbLockT)108 285.6 Q(ab::close\(\);)-.92 E
(static int)108 309.6 Q(DbLockT)108 321.6 Q(ab::unlink\(const char *dir)
-.92 E 2.5(,i)-.92 G(nt f)-2.5 E(or)-.25 E(ce, DbEn)-.18 E 2.5(v*)-.4 G
(dben)-2.5 E(v\);)-.4 E(int)108 345.6 Q(DbLockT)108 357.6 Q
(ab::detect\(u_int32_t \215ags, u_int32_t atype\);)-.92 E F0
(DESCRIPTION)72 374.4 Q F1 1.02(The DB library is a f)108 386.4 R 1.019
(amily of classes that pro)-.1 F 1.019
(vides a modular programming interf)-.15 F 1.019
(ace to transactions and)-.1 F 1.377(record-oriented \214le access.)108
398.4 R 1.378(The library includes support for transactions, locking, logging and \214le page)
6.377 F .443(caching, as well as v)108 410.4 R .443(arious inde)-.25 F
-.15(xe)-.15 G 2.943(da).15 G .442(ccess methods.)-2.943 F(Man)5.442 E
2.942(yo)-.15 G 2.942(ft)-2.942 G .442
(he classes \(e.g., the \214le page caching class\))-2.942 F .4(are useful independent of the other DB classes, although some classes are e)
108 422.4 R .4(xplicitly based on other classes)-.15 F
(\(e.g., transactions and logging\).)108 434.4 Q -.15(Fo)5 G 2.5(rag).15
G(eneral description of the DB package, see)-2.5 E/F3 10/Times-Italic@0
SF(db_intr)2.5 E(o)-.45 E F1(\(3\).).18 E(This manual page describes the speci\214c details of the locking interf)
108 451.2 Q(ace.)-.1 E(The)108 468 Q F3(DbLoc)3.856 E(kT)-.2 E(ab)-.92 E
F1 1.356(class is intended to pro)3.856 F 1.356
(vide general-purpose locking.)-.15 F 1.355(While designed to w)6.356 F
1.355(ork with the)-.1 F .352(other Db classes, this class is also useful for more general locking purposes.)
108 480 R .352(Locks can be shared between)5.352 F 4.483(processes. In)
108 492 R 1.983(most cases, when multiple treads or processes are using locking, the deadlock detector)
4.483 F(,)-.4 E F3(db_deadloc)108 504 Q(k)-.2 E F1
(\(1\), should be run.).67 E F3(DbLoc)92 520.8 Q(kT)-.2 E(ab::open)-.92
E F1(The)108 532.8 Q F3(DbLoc)3.452 E(kT)-.2 E(ab::open)-.92 E F1 .952
(method copies a pointer)3.452 F 3.452(,t)-.4 G 3.452(ot)-3.452 G .953
(he lock table identi\214ed by the)-3.452 F F2(dir)3.453 E(ectory)-.18 E
F3(dir)3.453 E F1 3.453(,i).73 G .953(nto the)-3.453 F
(memory location referenced by)108 544.8 Q F3 -.37(re)2.5 G(gionp)-.03 E
F1(.).19 E 2.07(If the)108 561.6 R F3(dben)4.57 E(v)-.4 E F1(ar)4.57 E
2.07(gument to)-.18 F F3(DbLoc)4.57 E(kT)-.2 E(ab::open)-.92 E F1 -.1
(wa)4.57 G 4.57(si).1 G 2.07(nitialized using)-4.57 F F3(DbEn)4.57 E
(v::appinit)-.4 E F1(,).68 E F3(dir)4.57 E F1 2.07(is interpreted as)
4.57 F(described by)108 573.6 Q F3(DbEn)2.5 E(v)-.4 E F1(\(3\).).32 E
.667(Otherwise, if)108 590.4 R F3(dir)3.167 E F1 .668
(is not NULL, it is interpreted relati)3.167 F .968 -.15(ve t)-.25 H
3.168(ot).15 G .668(he current w)-3.168 F .668
(orking directory of the process.)-.1 F(If)5.668 E F3(dir)108 602.4 Q F1
2.388(is NULL, the follo)4.888 F 2.388(wing en)-.25 F 2.388(vironment v)
-.4 F 2.388(ariables are check)-.25 F 2.387(ed in order: `)-.1 F
(`TMPDIR')-.74 E 2.387(', `)-.74 F(`TEMP')-.74 E 2.387(', and)-.74 F
-.74(``)108 614.4 S(TMP').74 E 3.268('. If)-.74 F .768
(one of them is set, lock table \214les are created relati)3.268 F 1.068
-.15(ve t)-.25 H 3.268(ot).15 G .768(he directory it speci\214es.)-3.268
F .768(If none of)5.768 F 1.501
(them are set, the \214rst possible one of the follo)108 626.4 R 1.5
(wing directories is used:)-.25 F F3(/var/tmp)4 E F1(,).19 E F3
(/usr/tmp)4 E F1(,).19 E F3(/temp)4 E F1(,).19 E F3(/tmp)4 E F1(,).19 E
F3(C:/temp)108 638.4 Q F1(and)2.5 E F3(C:/tmp)2.5 E F1(.).19 E .316(All \214les associated with the lock table are created in this directory)
108 655.2 R 5.316(.T)-.65 G .316(his directory must already e)-5.316 F
.316(xist when)-.15 F(DbLockT)108 667.2 Q .645(ab::open is called.)-.8 F
.645(If the lock table already e)5.645 F .645
(xists, the process must ha)-.15 F .945 -.15(ve p)-.2 H .645
(ermission to read and).15 F(write the e)108 679.2 Q(xisting \214les.)
-.15 E(If the lock table does not already e)5 E
(xist, it is optionally created and initialized.)-.15 E(The)108 696 Q F3
<8d61>3.76 E(gs)-.1 E F1(and)3.76 E F3(mode)3.76 E F1(ar)3.76 E 1.26
(guments specify ho)-.18 F 3.761<778c>-.25 G 1.261
(les will be opened and/or created when the)-3.761 F 3.761(yd)-.15 G
(on')-3.761 E 3.761(ta)-.18 G(lready)-3.761 E -.15(ex)108 708 S 2.5
(ist. The).15 F(\215ags v)2.5 E(alue is speci\214ed by)-.25 E F2(or)2.5
E F1('ing together one or more of the follo)A(wing v)-.25 E(alues:)-.25
E(1)535 768 Q EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(DbLockT)72 48 Q 347.14(ab\(3\) DbLockT)-.8 F
(ab\(3\))-.8 E(DB_CREA)108 84 Q(TE)-1.11 E .484(Create an)133 96 R 2.984
(yu)-.15 G .483(nderlying \214les, as necessary)-2.984 F 5.483(.I)-.65 G
2.983(ft)-5.483 G .483(he \214les do not already e)-2.983 F .483
(xist and the DB_CREA)-.15 F .483(TE \215ag)-1.11 F
(is not speci\214ed, the call will f)133 108 Q(ail.)-.1 E(DB_THREAD)108
136.8 Q 1.182(Cause the DbLockT)133 148.8 R 1.182
(ab handle returned by the)-.8 F/F1 10/Times-Italic@0 SF(DbLoc)3.682 E
(kT)-.2 E(ab::open)-.92 E F0 1.183(method to be useable by multiple)
3.682 F(threads within a single address space, i.e., to be `)133 160.8 Q
(`free-threaded')-.74 E('.)-.74 E .528
(All \214les created by the lock subsystem are created with mode)108
177.6 R F1(mode)3.028 E F0 .527(\(as described in)3.027 F F1 -.15(ch)
3.027 G(mod).15 E F0 .527(\(2\)\) and modi-).77 F .816
(\214ed by the process' umask v)108 189.6 R .816
(alue at the time of creation \(see)-.25 F F1(umask)3.317 E F0 3.317
(\(2\)\). The).67 F .817(group o)3.317 F .817(wnership of created)-.25 F
(\214les is based on the system and directory def)108 201.6 Q
(aults, and is not further speci\214ed by DB.)-.1 E .2
(The locking subsystem is con\214gured based on which set methods ha)108
218.4 R .499 -.15(ve b)-.2 H .199(een used.).15 F .199(It is e)5.199 F
.199(xpected that appli-)-.15 F .913(cations will use a single DbEn)108
230.4 R 3.413(vo)-.4 G .913(bject as the ar)-3.413 F .913
(gument to all of the subsystems in the DB package.)-.18 F(The)5.914 E
1.346(\214elds of the DbEn)108 242.4 R 3.846(vo)-.4 G 1.346
(bject used by)-3.846 F F1(DbLoc)3.846 E(kT)-.2 E(ab::open)-.92 E F0
1.346(are described belo)3.846 F 5.146 -.65(w. A)-.25 H 3.846(sr).65 G
1.346(eferences to the DbEn)-3.846 F(v)-.4 E .343
(object may be maintained by)108 254.4 R F1(DbLoc)2.844 E(kT)-.2 E
(ab::open)-.92 E F0 2.844(,i).24 G 2.844(ti)-2.844 G 2.844(sn)-2.844 G
.344(ecessary that the DbEn)-2.844 F 2.844(vo)-.4 G .344
(bject and memory it refer)-2.844 F(-)-.2 E .446(ences be v)108 266.4 R
.446(alid until the object is destro)-.25 F 2.946(yed. An)-.1 F 2.946
(yo)-.15 G 2.946(ft)-2.946 G .446(he DbEn)-2.946 F 2.946<768c>-.4 G .446
(elds that are not e)-2.946 F .445(xplicitly set will def)-.15 F(ault)
-.1 E(to appropriate v)108 278.4 Q(alues.)-.25 E .516(The follo)108
295.2 R .516(wing \214elds in the DbEn)-.25 F 3.016(vo)-.4 G .516(bject may be initialized, using the appropriate set method, before call-)
-3.016 F(ing)108 307.2 Q F1(DbLoc)2.5 E(kT)-.2 E(ab::open)-.92 E F0(:)
.24 E -.2(vo)108 336 S(id *\(*db_errcall\)\(char *db_errpfx, char *b).2
E(uf)-.2 E(fer\);)-.25 E(FILE *db_err\214le;)108 348 Q
(const char *db_errpfx;)108 360 Q(class ostream *db_error_stream;)108
372 Q(int db_v)108 384 Q(erbose;)-.15 E(The error \214elds of the DbEn)
133 396 Q 2.5(vb)-.4 G(eha)-2.5 E .3 -.15(ve a)-.2 H 2.5(sd).15 G
(escribed for)-2.5 E F1(DbEn)2.5 E(v)-.4 E F0(\(3\).).32 E
(const u_int8_t lk_con\215icts[][];)108 412.8 Q(A)133 424.8 Q F1
(lk_modes)2.5 E F0(by)2.5 E F1(lk_modes)2.5 E F0(array)2.5 E 5(.A)-.65 G
(non-0 v)-2.5 E(alue for the array element:)-.25 E
(lk_con\215icts[requested_mode][held_mode])183 448.8 Q 1.915
(indicates that requested_mode and held_mode con\215ict.)133 472.8 R
1.914(The `)6.915 F(`not-granted')-.74 E 4.414('m)-.74 G 1.914
(ode must be repre-)-4.414 F 1.618(sented by 0.)133 484.8 R(If)6.618 E
F1(lk_con\215icts)4.118 E F0 1.618(is NULL, the con\215icts array)4.118
F F1(db_rw_con\215icts)4.118 E F0 1.618(is used; see the section)4.118 F
(belo)133 496.8 Q 2.5(we)-.25 G(ntitled `)-2.5 E(`ST)-.74 E(AND)-.93 E
(ARD LOCK MODES')-.4 E 2.5('f)-.74 G(or a description of that array)-2.5
E(.)-.65 E(u_int32_t lk_detect;)108 513.6 Q 1.111
(If non-0, speci\214es that the deadlock detector be run whene)133 525.6
R -.15(ve)-.25 G 3.611(ra).15 G 1.11
(lock con\215ict occurs, and speci\214es)-.001 F .269
(which transaction should be aborted in the case of a deadlock.)133
537.6 R(The)5.27 E F1(lk_detect)2.77 E F0 .27
(\214eld must be set to one)2.77 F(of the follo)133 549.6 Q(wing v)-.25
E(alues.)-.25 E(DB_LOCK_DEF)133 578.4 Q -.55(AU)-.74 G -.92(LT).55 G
(Use the def)158 590.4 Q(ault polic)-.1 E 2.5(ya)-.15 G 2.5(ss)-2.5 G
(peci\214ed in the)-2.5 E F1(db_deadloc)2.5 E(k)-.2 E F0
(\(1\) man page.).67 E(DB_LOCK_OLDEST)133 619.2 Q
(Abort the oldest transaction.)158 631.2 Q(DB_LOCK_RANDOM)133 660 Q
(Abort a random transaction in)158 672 Q -.2(vo)-.4 G(lv).2 E
(ed in the deadlock.)-.15 E(DB_LOCK_Y)133 700.8 Q(OUNGEST)-.3 E
(Abort the youngest transaction.)158 712.8 Q(April 10, 1998)276.695 768
Q(2)199.695 E EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(DbLockT)72 48 Q 347.14(ab\(3\) DbLockT)-.8 F
(ab\(3\))-.8 E(u_int32_t lk_max;)108 84 Q .633
(The maximum number of locks to be held or requested in the table.)133
96 R .633(This v)5.633 F .632(alue is used by)-.25 F/F1 10
/Times-Italic@0 SF(DbLoc)3.132 E(k-)-.2 E -.92(Ta)133 108 S(b::open).92
E F0 .252(to estimate ho)2.752 F 2.752(wm)-.25 G .252
(uch space to allocate for v)-2.752 F .252
(arious lock-table data structures.)-.25 F(If)5.252 E F1(lk_max)2.752 E
F0(is)2.752 E(not e)133 120 Q(xplicitly set, a def)-.15 E(ault v)-.1 E
(alue is used.)-.25 E(u_int32_t lk_modes;)108 136.8 Q(The number of lock modes to be recognized by the lock table \(including)
108 153.6 Q 1.122(the `)133 165.6 R(`not-granted')-.74 E 3.622('m)-.74 G
3.622(ode\). If)-3.622 F F1(lk_modes)3.622 E F0 1.122(is 0, the v)3.622
F 1.122(alue DB_LOCK_R)-.25 F 1.122(W_N is used; see belo)-.55 F 3.622
(wf)-.25 G 1.122(or a)-3.622 F(description of that v)133 177.6 Q(alue.)
-.25 E(The)108 194.4 Q F1(DbLoc)3.313 E(kT)-.2 E(ab::open)-.92 E F0 .813
(method thro)3.313 F .813(ws a)-.25 F F1(DbException)3.313 E F0 .813
(\(3\) or returns the v).24 F .813(alue of)-.25 F F1(errno)3.313 E F0
.813(on f)3.313 F .814(ailure and 0 on)-.1 F(success.)108 206.4 Q F1
(DbLoc)92 223.2 Q(kT)-.2 E(ab::id)-.92 E F0(The)108 235.2 Q F1(DbLoc)
2.58 E(kT)-.2 E(ab::id)-.92 E F0 .08(method copies a lock)2.58 F .079
(er ID, which is guaranteed to be unique in the speci\214ed lock table,)
-.1 F(into the memory location referenced by)108 247.2 Q F1(idp)2.5 E F0
(.).19 E .434(The access methods \(see)108 264 R F1(Db::open)2.934 E F0
(in)2.934 E F1(Db)2.934 E F0 .434(\(3\)\), generate a unique lock).23 F
.435(er ID for each \214le that is opened with)-.1 F 2.729
(locking. During)108 276 R .229(Db access method operation, this lock)
2.729 F .229(er ID will be used for all lock calls unless a transac-)-.1
F(tion identi\214er w)108 288 Q(as speci\214ed for the call, in which case the transaction ID speci\214ed is used for locking.)
-.1 E(The)108 304.8 Q F1(DbLoc)2.824 E(kT)-.2 E(ab::id)-.92 E F0 .324
(method thro)2.824 F .324(ws a)-.25 F F1(DbException)2.824 E F0 .324
(\(3\) or returns the v).24 F .324(alue of)-.25 F F1(errno)2.824 E F0
.324(on f)2.824 F .324(ailure and 0 on suc-)-.1 F(cess.)108 316.8 Q F1
(DbLoc)92 345.6 Q(kT)-.2 E(ab::vec)-.92 E F0(The)108 357.6 Q F1(DbLoc)
3.543 E(kT)-.2 E(ab::vec)-.92 E F0 1.042(method atomically obtains and releases one or more locks from the speci\214ed table.)
3.543 F(The)108 369.6 Q F1(DbLoc)2.914 E(kT)-.2 E(ab::vec)-.92 E F0 .415
(method is intended to support acquisition or trading of multiple locks under one lock)
2.914 F(table semaphore, as is needed for lock coupling or in multigranularity locking for lock escalation.)
108 381.6 Q(The)108 398.4 Q F1(loc)3.217 E -.1(ke)-.2 G(r).1 E F0(ar)
3.217 E .717(gument speci\214ed to)-.18 F F1(DbLoc)3.217 E(kT)-.2 E
(ab::vec)-.92 E F0 .716(is an unsigned 32-bit inte)3.217 F .716
(ger quantity)-.15 F 5.716(.I)-.65 G 3.216(tr)-5.716 G .716
(epresents the)-3.216 F(entity requesting or releasing the lock.)108
410.4 Q(The)108 427.2 Q F1<8d61>2.5 E(gs)-.1 E F0 -.25(va)2.5 G
(lue must be set to 0 or the follo).25 E(wing v)-.25 E(alue:)-.25 E
(DB_LOCK_NO)108 456 Q -1.2(WA)-.35 G(IT)1.2 E .191(If a lock cannot be granted because the requested lock con\215icts with an e)
133 468 R .192(xisting lock, return immedi-)-.15 F(ately instead of w)
133 480 Q(aiting for the lock to become a)-.1 E -.25(va)-.2 G(ilable.)
.25 E(The)108 496.8 Q F1(list)2.868 E F0 .368(array pro)2.868 F .368
(vided to)-.15 F F1(DbLoc)2.868 E(kT)-.2 E(ab::vec)-.92 E F0 .368
(is typedef)2.868 F 1.368 -.5('d i).55 H 2.868(n<).5 G .367
(db_cxx.h> as DB_LOCKREQ.)-2.868 F 2.867(AD)5.367 G(B_LOCK-)-2.867 E
(REQ structure has at least the follo)108 508.8 Q
(wing \214elds, which must be initialized before calling)-.25 E F1
(DbLoc)2.5 E(kT)-.2 E(ab::vec)-.92 E F0(:).31 E(lock)108 525.6 Q
(op_t op;)-.1 E
(The operation to be performed, which must be set to one of the follo)
133 537.6 Q(wing v)-.25 E(alues:)-.25 E(DB_LOCK_GET)133 566.4 Q 1.717
(Get a lock, as de\214ned by the v)158 578.4 R 1.717(alues of)-.25 F F1
(loc)4.217 E -.1(ke)-.2 G(r).1 E F0(,).73 E F1(obj)4.217 E F0(and)4.217
E F1(mode)4.217 E F0 6.717(.U).18 G 1.717(pon return from)-6.717 F F1
(DbLoc)4.217 E(k-)-.2 E -.92(Ta)158 590.4 S(b::vec).92 E F0 2.96(,i).31
G 2.96(ft)-2.96 G(he)-2.96 E F1(loc)2.96 E(k)-.2 E F0 .459
(\214eld is non-NULL, a reference to the acquired lock is stored there.)
2.96 F(\(This)5.459 E .623(reference is in)158 602.4 R -.25(va)-.4 G
.624(lidated by an).25 F 3.124(yc)-.15 G .624(all to)-3.124 F F1(DbLoc)
3.124 E(kT)-.2 E(ab::vec)-.92 E F0(or)3.124 E F1(DbLoc)3.124 E(k::put)
-.2 E F0 .624(that releases the lock.\))3.124 F(See)158 614.4 Q F1
(DbLoc)2.5 E(k)-.2 E F0(\(3\).).67 E(DB_LOCK_PUT)133 643.2 Q
(The lock referenced by the contents of the)158 655.2 Q F1(loc)2.5 E(k)
-.2 E F0(\214eld is released.)2.5 E(DB_LOCK_PUT_ALL)133 684 Q .759
(All locks held by the)158 696 R F1(loc)3.259 E -.1(ke)-.2 G(r).1 E F0
.759(are released.)3.259 F(\(An)5.759 E 3.259(yl)-.15 G .759
(ocks acquired as a part of the current call to)-3.259 F F1(DbLoc)158
708 Q(kT)-.2 E(ab::vec)-.92 E F0 .62(that appear after the DB_LOCK_PUT_ALL entry are not considered for this)
3.12 F(operation\).)158 720 Q(April 10, 1998)276.695 768 Q(3)199.695 E
EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(DbLockT)72 48 Q 347.14(ab\(3\) DbLockT)-.8 F
(ab\(3\))-.8 E(DB_LOCK_PUT_OBJ)133 84 Q 1.41(All locks held by the)158
96 R/F1 10/Times-Italic@0 SF(loc)3.91 E -.1(ke)-.2 G(r).1 E F0 3.91(,o)
.73 G 3.909(nt)-3.91 G 1.409(he object)-3.909 F F1(obj)3.909 E F0 3.909
(,w).48 G 1.409(ith the mode speci\214ed by)-3.909 F F1(loc)3.909 E
(k_mode)-.2 E F0 3.909(,a).18 G(re)-3.909 E 4.276(released. A)158 108 R
F1(loc)4.276 E(k_mode)-.2 E F0 1.776
(of DB_LOCK_NG indicates that all locks on the object should be)4.276 F
3.966(released. Note)158 120 R 1.466(that an)3.966 F 3.966(yl)-.15 G
1.465(ocks acquired as a part of the current call to)-3.966 F F1(DbLoc)
3.965 E(kT)-.2 E(ab::vec)-.92 E F0(that)3.965 E 1.082(occur before the DB_LOCK_PUT_OBJ will also be released; those acquired afterw)
158 132 R 1.082(ards will)-.1 F(not be released.)158 144 Q
(const Dbt obj;)108 160.8 Q
(An untyped byte string that speci\214es the object to be lock)133 172.8
Q(ed or released.)-.1 E(const lockmode_t mode;)108 189.6 Q
(The lock mode, used as an inde)133 201.6 Q 2.5(xi)-.15 G(nto object')
-2.5 E 2.5(sc)-.55 G(on\215ict array)-2.5 E(.)-.65 E(DB_LOCK lock;)108
218.4 Q 2.5(Al)133 230.4 S(ock reference.)-2.5 E(The)108 247.2 Q F1
(nlist)2.5 E F0(ar)2.5 E
(gument speci\214es the number of elements in the)-.18 E F1(list)2.5 E
F0(array)2.5 E(.)-.65 E .51(If an)108 264 R 3.01(yo)-.15 G 3.01(ft)-3.01
G .51(he requested locks cannot be acquired, or an)-3.01 F 3.01(yo)-.15
G 3.01(ft)-3.01 G .51(he locks to be released cannot be released, the)
-3.01 F .291(operations before the f)108 276 R .292
(ailing operation are guaranteed to ha)-.1 F .592 -.15(ve c)-.2 H .292
(ompleted successfully).15 F 2.792(,a)-.65 G(nd)-2.792 E F1(DbLoc)2.792
E(kT)-.2 E(ab::vec)-.92 E F0 .632(returns a non-zero v)108 288 R 3.132
(alue. In)-.25 F .632(addition, if)3.132 F F1(elistp)3.132 E F0 .631
(is not NULL, it is set to point to the DB_LOCKREQ entry)3.132 F(that w)
108 300 Q(as being processed when the error occurred.)-.1 E
(In the case of an error)108 316.8 Q(,)-.4 E F1(DbLoc)2.5 E(kT)-.2 E
(ab::vec)-.92 E F0(may return one of the follo)2.5 E(wing v)-.25 E
(alues:)-.25 E(DB_LOCK_DEADLOCK)108 345.6 Q(The speci\214ed)133 357.6 Q
F1(loc)2.5 E -.1(ke)-.2 G(r).1 E F0 -.1(wa)2.5 G 2.5(ss).1 G
(elected as a victim in order to resolv)-2.5 E 2.5(ead)-.15 G(eadlock.)
-2.5 E(DB_LOCK_NO)108 386.4 Q(THELD)-.4 E
(The lock cannot be released, as it w)133 398.4 Q(as not held by the)-.1
E F1(loc)2.5 E -.1(ke)-.2 G(r).1 E F0(.).73 E(DB_LOCK_NO)108 427.2 Q
(TGRANTED)-.4 E 8.232(Al)133 439.2 S 5.732(ock w)-8.232 F 5.732
(as requested that could not be granted and the)-.1 F F1<8d61>8.232 E(g)
-.1 E F0 5.732(parameter w)8.232 F 5.732(as set to)-.1 F(DB_LOCK_NO)133
451.2 Q -1.2(WA)-.35 G(IT)1.2 E 5(.I)-.74 G 2.5(nt)-5 G
(his case, if non-NULL,)-2.5 E F1(elistp)2.5 E F0
(identi\214es the request that w)2.5 E(as granted.)-.1 E .95
(Otherwise, the)108 468 R F1(DbLoc)3.45 E(kT)-.2 E(ab::vec)-.92 E F0 .95
(method thro)3.45 F .95(ws a)-.25 F F1(DbException)3.45 E F0 .95
(\(3\) or returns the v).24 F .95(alue of)-.25 F F1(errno)3.45 E F0 .95
(on f)3.45 F(ailure)-.1 E(and 0 on success.)108 480 Q F1(DbLoc)92 508.8
Q(kT)-.2 E(ab::g)-.92 E(et)-.1 E F0(The)108 520.8 Q F1(DbLoc)2.5 E(kT)
-.2 E(ab::g)-.92 E(et)-.1 E F0(method is a simple interf)2.5 E
(ace to the)-.1 E F1(DbLoc)108 544.8 Q(kT)-.2 E(ab::vec)-.92 E F0
(functionality)2.5 E 2.5(,a)-.65 G(nd is equi)-2.5 E -.25(va)-.25 G
(lent to calling the).25 E F1(DbLoc)108 568.8 Q(kT)-.2 E(ab::vec)-.92 E
F0 .71(method with the)3.21 F F1(loc)3.21 E -.1(ke)-.2 G(r).1 E F0(ar)
3.211 E(gument,)-.18 E F1(elistp)3.211 E F0(and)3.211 E F1(con\215ict)
3.211 E F0(ar)3.211 E .711(guments, and a single element)-.18 F F1(list)
3.211 E F0(array)108 580.8 Q 2.831(,f)-.65 G .331(or which the)-2.831 F
F1(op)2.831 E F0 .331(\214eld is DB_LOCK_GET)2.831 F 2.831(,a)-.74 G
.331(nd the)-2.831 F F1(obj)2.831 E F0(,).48 E F1(loc)2.83 E(k_mode)-.2
E F0(and)2.83 E F1(loc)2.83 E(k)-.2 E F0 .33
(\214elds are represented by)2.83 F 1.16(the ar)108 592.8 R 1.16
(guments of the same name.)-.18 F 1.161(Note that the type of the)6.16 F
F1(obj)3.661 E F0(ar)3.661 E 1.161(gument to)-.18 F F1(DbLoc)3.661 E(kT)
-.2 E(ab::g)-.92 E(et)-.1 E F0 1.161(is dif)3.661 F(ferent)-.25 E .445
(from the)108 604.8 R F1(obj)2.945 E F0 .445
(element found in the DB_LOCKREQ structure.)2.945 F(The)5.444 E F1
(DbLoc)2.944 E(kT)-.2 E(ab::g)-.92 E(et)-.1 E F0 .444
(method returns success)2.944 F(and f)108 616.8 Q
(ailure as described for the)-.1 E F1(DbLoc)108 640.8 Q(kT)-.2 E
(ab::vec)-.92 E F0(method.)2.5 E F1(DbLoc)92 657.6 Q(kT)-.2 E(ab::close)
-.92 E F0(The)108 669.6 Q F1(DbLoc)2.806 E(kT)-.2 E(ab::close)-.92 E F0
.306(method disassociates the calling process from the lock table.)2.806
F .307(The object should not)5.307 F .045
(be used after a call to close.)108 681.6 R .044(Note that)5.044 F F1
(DbLoc)2.544 E(kT)-.2 E(ab::close)-.92 E F0 .044(does not release an)
2.544 F 2.544(yl)-.15 G .044(ocks still held by the closing)-2.544 F 2.5
(process. \(This)108 693.6 R(pro)2.5 E(vides functionality for long-li)
-.15 E -.15(ve)-.25 G 2.5(dl).15 G(ocks.\))-2.5 E .985
(Processes that wish to ha)108 717.6 R 1.285 -.15(ve a)-.2 H .986
(ll their locks released can do so by issuing the appropriate).15 F F1
(DbLoc)3.486 E(kT)-.2 E(ab::vec)-.92 E F0(call.)108 729.6 Q
(April 10, 1998)276.695 768 Q(4)199.695 E EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(DbLockT)72 48 Q 347.14(ab\(3\) DbLockT)-.8 F
(ab\(3\))-.8 E 2.226(In addition, if the)108 84 R/F1 10/Times-Italic@0
SF(dir)4.726 E F0(ar)4.726 E 2.226(gument to)-.18 F F1(DbLoc)4.726 E(kT)
-.2 E(ab::open)-.92 E F0 -.1(wa)4.726 G 4.726(sN).1 G 2.226(ULL and)
-4.726 F F1(dben)4.726 E(v)-.4 E F0 -.1(wa)4.726 G 4.726(sn).1 G 2.226
(ot initialized using)-4.726 F F1(DbEn)108 96 Q(v::appinit)-.4 E F0
4.248(,a).68 G 1.748(ll \214les created for this shared re)-4.248 F
1.749(gion will be remo)-.15 F -.15(ve)-.15 G 1.749(d, as if).15 F F1
(DbLoc)4.249 E(kT)-.2 E(ab::unlink)-.92 E F0(were)4.249 E(called.)108
108 Q 1.532(When multiple threads are using the DbLockT)108 124.8 R
1.531(ab object concurrently)-.8 F 4.031(,o)-.65 G 1.531
(nly a single thread may call the)-4.031 F F1(DbLoc)108 136.8 Q(kT)-.2 E
(ab::close)-.92 E F0(method.)2.5 E(The)108 153.6 Q F1(DbLoc)3.243 E(kT)
-.2 E(ab::close)-.92 E F0 .743(method thro)3.243 F .743(ws a)-.25 F F1
(DbException)3.244 E F0 .744(\(3\) or returns the v).24 F .744(alue of)
-.25 F F1(errno)3.244 E F0 .744(on f)3.244 F .744(ailure and 0 on)-.1 F
(success.)108 165.6 Q F1(DbLoc)92 194.4 Q(kT)-.2 E(ab::unlink)-.92 E F0
(The)108 206.4 Q F1(DbLoc)3.624 E(kT)-.2 E(ab::unlink)-.92 E F0 1.124
(method destro)3.624 F 1.124
(ys the lock table identi\214ed by the directory)-.1 F F1(dir)3.623 E F0
3.623(,r).73 G(emo)-3.623 E 1.123(ving all \214les)-.15 F .029
(used to implement the lock table.)108 218.4 R .029(\(The directory)
5.029 F F1(dir)2.529 E F0 .029(is not remo)2.529 F -.15(ve)-.15 G 2.529
(d.\) If).15 F .029(there are processes that ha)2.529 F .329 -.15(ve c)
-.2 H(alled).15 E F1(DbLoc)108 230.4 Q(kT)-.2 E(ab::open)-.92 E F0 2.312
(without calling)4.812 F F1(DbLoc)4.812 E(kT)-.2 E(ab::close)-.92 E F0
2.312(\(i.e., there are processes currently using the lock)4.812 F
(table\),)108 242.4 Q F1(DbLoc)4.866 E(kT)-.2 E(ab::unlink)-.92 E F0
2.366(will f)4.866 F 2.367(ail without further action, unless the force \215ag is set, in which case)
-.1 F F1(DbLoc)108 254.4 Q(kT)-.2 E(ab::unlink)-.92 E F0 1.199
(will attempt to remo)3.699 F 1.499 -.15(ve t)-.15 H 1.199
(he lock table \214les re).15 F -.05(ga)-.15 G 1.199(rdless of an).05 F
3.698(yp)-.15 G 1.198(rocesses still using the)-3.698 F(lock table.)108
266.4 Q .766(The result of attempting to forcibly destro)108 283.2 R
3.266(yt)-.1 G .766(he re)-3.266 F .766(gion when a process has the re)
-.15 F .766(gion open is unspeci\214ed.)-.15 F 1.232
(Processes using a shared memory re)108 295.2 R 1.232
(gion maintain an open \214le descriptor for it.)-.15 F 1.231
(On UNIX systems, the)6.232 F(re)108 307.2 Q .473(gion remo)-.15 F -.25
(va)-.15 G 2.973(ls).25 G .473(hould succeed and processes that ha)
-2.973 F .773 -.15(ve a)-.2 H .473(lready joined the re).15 F .473
(gion should continue to run in)-.15 F .338(the re)108 319.2 R .337
(gion without change, ho)-.15 F(we)-.25 E -.15(ve)-.25 G 2.837(rp).15 G
.337(rocesses attempting to join the lock table will either f)-2.837 F
.337(ail or attempt to)-.1 F .449(create a ne)108 331.2 R 2.949(wr)-.25
G -.15(eg)-2.949 G 2.949(ion. On).15 F .449(other systems, e.g., WNT)
2.949 F 2.949(,w)-.74 G .449(here the)-2.949 F F1(unlink)2.95 E F0 .45
(\(2\) system call will f).67 F .45(ail if an)-.1 F 2.95(yp)-.15 G
(rocess)-2.95 E(has an open \214le descriptor for the \214le, the re)108
343.2 Q(gion remo)-.15 E -.25(va)-.15 G 2.5(lw).25 G(ill f)-2.5 E(ail.)
-.1 E .93(In the case of catastrophic or system f)108 360 R .929
(ailure, database reco)-.1 F -.15(ve)-.15 G .929
(ry must be performed \(see).15 F F1(db_r)3.429 E(eco)-.37 E(ver)-.1 E
F0 .929(\(1\) or).73 F .439(the DB_RECO)108 372 R .439(VER and DB_RECO)
-.5 F(VER_F)-.5 E -1.21 -1.11(AT A)-.74 H 2.939<4c8d>1.11 G .439(ags to)
-2.939 F F1(DbEn)2.939 E(v::appinit)-.4 E F0 2.939(\(3\)\). Alternati)
.68 F -.15(ve)-.25 G(ly).15 E 2.939(,i)-.65 G 2.939(fr)-2.939 G(eco)
-2.939 E -.15(ve)-.15 G .439(ry is).15 F .027
(not required because no database state is maintained across f)108 384 R
.027(ailures, it is possible to clean up a lock table by)-.1 F(remo)108
396 Q .816(ving all of the \214les in the directory speci\214ed to the)
-.15 F F1(DbLoc)3.317 E(kT)-.2 E(ab::open)-.92 E F0 .817
(method, as lock table \214les are)3.317 F(ne)108 408 Q -.15(ve)-.25 G
3.379(rc).15 G .879(reated in an)-3.379 F 3.379(yd)-.15 G .879
(irectory other than the one speci\214ed to)-3.379 F F1(DbLoc)3.378 E
(kT)-.2 E(ab::open)-.92 E F0 5.878(.N).24 G .878(ote, ho)-5.878 F(we)
-.25 E -.15(ve)-.25 G 1.678 -.4(r, t).15 H .878(hat this).4 F
(has the potential to remo)108 420 Q .3 -.15(ve \214)-.15 H
(les created by the other DB subsystems in this database en).15 E
(vironment.)-.4 E(The)108 436.8 Q F1(DbLoc)2.965 E(kT)-.2 E(ab::unlink)
-.92 E F0 .465(method thro)2.965 F .465(ws a)-.25 F F1(DbException)2.965
E F0 .466(\(3\) or returns the v).24 F .466(alue of)-.25 F F1(errno)
2.966 E F0 .466(on f)2.966 F .466(ailure and 0 on)-.1 F(success.)108
448.8 Q F1(DbLoc)92 465.6 Q(kT)-.2 E(ab::detect)-.92 E F0(The)108 477.6
Q F1(DbLoc)3.214 E(kT)-.2 E(ab::detect)-.92 E F0 .714(method runs one iteration of the deadlock detector on the current lock table.)
3.214 F(The)5.714 E .078(deadlock detector tra)108 489.6 R -.15(ve)-.2 G
.078(rses the lock table, detects deadlocks, and if it \214nds one, marks one of the participat-)
.15 F(ing transactions for abort and then returns.)108 501.6 Q
(The \215ags v)108 518.4 Q(alue is speci\214ed by)-.25 E/F2 10
/Times-Bold@0 SF(or)2.5 E F0('ing together one or more of the follo)A
(wing v)-.25 E(alues:)-.25 E(DB_LOCK_CONFLICT)108 552 Q .988(Only run the deadlock detector if a lock con\215ict has occurred since the last time that the deadlock)
133 564 R(detector w)133 576 Q(as run.)-.1 E(The)108 592.8 Q F1(atype)
3.18 E F0 .68(parameter speci\214es which transaction to abort in the case of deadlock.)
3.18 F .68(It must be set to one of)5.68 F -.25(va)108 604.8 S
(lues described abo).25 E .3 -.15(ve f)-.15 H(or the).15 E F1(lk_detect)
2.5 E F0(\214eld of the)2.5 E F1(DbEn)2.5 E(v)-.4 E F0(object.)2.5 E
(The)108 621.6 Q F1(DbLoc)3.036 E(kT)-.2 E(ab::detect)-.92 E F0 .536
(method thro)3.036 F .536(ws a)-.25 F F1(DbException)3.036 E F0 .536
(\(3\) or returns the v).24 F .536(alue of)-.25 F F1(errno)3.035 E F0
.535(on f)3.035 F .535(ailure and 0 on)-.1 F(success.)108 633.6 Q(The)
108 650.4 Q F1(DbLoc)3.594 E(kT)-.2 E(ab::detect)-.92 E F0 1.094
(method is based on the C)3.594 F F1(loc)3.594 E(k_detect)-.2 E F0 1.095
(function, which is the underlying function)3.594 F .137(used by the)108
662.4 R F1(db_deadloc)2.637 E(k)-.2 E F0 .137(\(1\) utility).67 F 5.137
(.S)-.65 G .137(ee the source code for the)-5.137 F F1(db_deadloc)2.636
E(k)-.2 E F0 .136(utility for an e)2.636 F .136(xample of using)-.15 F
F1(loc)108 674.4 Q(k_detect)-.2 E F0(in a UNIX en)2.5 E(vironment.)-.4 E
/F3 9/Times-Bold@0 SF(ENVIR)72 691.2 Q(ONMENT V)-.27 E(ARIABLES)-1.215 E
F0(The follo)108 703.2 Q(wing en)-.25 E(vironment v)-.4 E(ariables af)
-.25 E(fect the e)-.25 E -.15(xe)-.15 G(cution of).15 E F1(db_loc)2.5 E
(k)-.2 E F0(:).67 E(April 10, 1998)276.695 768 Q(5)199.695 E EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(DbLockT)72 48 Q 347.14(ab\(3\) DbLockT)-.8 F
(ab\(3\))-.8 E(DB_HOME)108 84 Q 1.035(If the)133 96 R/F1 10
/Times-Italic@0 SF(dben)3.535 E(v)-.4 E F0(ar)3.536 E 1.036(gument to)
-.18 F F1(DbLoc)3.536 E(kT)-.2 E(ab::open)-.92 E F0 -.1(wa)3.536 G 3.536
(si).1 G 1.036(nitialized using)-3.536 F F1(db_appinit)3.536 E F0 3.536
(,t).68 G 1.036(he en)-3.536 F 1.036(vironment v)-.4 F(ari-)-.25 E .342
(able DB_HOME may be used as the path of the database home for the interpretation of the)
133 108 R F1(dir)2.841 E F0(ar)2.841 E(gu-)-.18 E(ment to)133 120 Q F1
(DbLoc)2.5 E(kT)-.2 E(ab::open)-.92 E F0 2.5(,a).24 G 2.5(sd)-2.5 G
(escribed in)-2.5 E F1(db_appinit)2.5 E F0(\(3\).).68 E(TMPDIR)108 136.8
Q .592(If the)133 148.8 R F1(dben)3.092 E(v)-.4 E F0(ar)3.092 E .592
(gument to)-.18 F F1(DbLoc)3.092 E(kT)-.2 E(ab::open)-.92 E F0 -.1(wa)
3.092 G 3.092(sN).1 G .592(ULL or not initialized using)-3.092 F F1
(db_appinit)3.092 E F0 3.093(,t).68 G .593(he en)-3.093 F(vi-)-.4 E 2.42
(ronment v)133 160.8 R 2.419(ariable TMPDIR may be used as the directory in which to create the lock table, as)
-.25 F(described in the)133 172.8 Q F1(DbLoc)2.5 E(kT)-.2 E(ab::open)
-.92 E F0(section abo)2.5 E -.15(ve)-.15 G(.).15 E/F2 9/Times-Bold@0 SF
(ST)72 189.6 Q(AND)-.81 E(ARD LOCK MODES)-.315 E F0
(The include \214le <db_cxx.h> declares tw)108 201.6 Q 2.5(oc)-.1 G
(ommonly used con\215ict arrays:)-2.5 E
(const u_int8_t db_lock_rw_con\215icts[];)108 218.4 Q
(This is a con\215ict array for a simple scheme using shared and e)133
230.4 Q(xclusi)-.15 E .3 -.15(ve l)-.25 H(ock modes.).15 E
(const u_int8_t db_lock_riw_con\215icts[];)108 247.2 Q .703
(This is a con\215ict array that in)133 259.2 R -.2(vo)-.4 G(lv).2 E
.703(es v)-.15 F .703
(arious intent lock modes \(e.g., intent shared\) that are used for)-.25
F(multigranularity locking.)133 271.2 Q
(Their associated sizes are DB_LOCK_R)108 288 Q(W_N and DB_LOCK_RIW_N.)
-.55 E 1.598
(In addition, the include \214le <db_cxx.h> de\214nes the type)108 316.8
R F1(db_loc)4.097 E(kmode_t)-.2 E F0 4.097(,w).68 G 1.597
(hich is the type of the lock)-4.097 F
(modes used with the standard tables abo)108 328.8 Q -.15(ve)-.15 G(:)
.15 E(DB_LOCK_NG)144 357.6 Q(not granted \(al)169 369.6 Q -.1(wa)-.1 G
(ys 0\)).1 E(DB_LOCK_READ)144 398.4 Q(read \(shared\))169 410.4 Q
(DB_LOCK_WRITE)144 439.2 Q(write \(e)169 451.2 Q(xclusi)-.15 E -.15(ve)
-.25 G(\)).15 E F2(ERR)72 468 Q(ORS)-.27 E F0 .049(Methods mark)108 480
R .049(ed as returning)-.1 F F1(errno)2.549 E F0 .049(will, by def)2.549
F .049(ault, thro)-.1 F 2.549(wa)-.25 G 2.549(ne)-2.549 G .05
(xception that encapsulates the error informa-)-2.699 F 2.5(tion. The)
108 492 R(def)2.5 E(ault error beha)-.1 E(vior can be changed, see)-.2 E
F1(DbException)2.5 E F0(\(3\).).24 E(The)108 508.8 Q F1(DbLoc)2.5 E(kT)
-.2 E(ab::open)-.92 E F0(method may f)2.5 E(ail and thro)-.1 E 2.5(wa)
-.25 G F1(DbException)A F0(\(3\)).24 E(or return)108 532.8 Q F1(errno)
2.5 E F0(for an)2.5 E 2.5(yo)-.15 G 2.5(ft)-2.5 G
(he errors speci\214ed for the follo)-2.5 E
(wing DB and library functions:)-.25 E
(DbLock::unlink\(3\), close\(2\), db_v)108 544.8 Q
(ersion\(3\), fcntl\(2\), f)-.15 E
(\215ush\(3\), lseek\(2\), malloc\(3\), memcp)-.25 E
(y\(3\), memset\(3\),)-.1 E(mmap\(2\), munmap\(2\), open\(2\), sig\214llset\(3\), sigprocmask\(2\), stat\(2\), strcp)
108 556.8 Q(y\(3\), strdup\(3\), strerror\(3\),)-.1 E
(strlen\(3\), unlink\(2\), and write\(2\).)108 568.8 Q .293
(In addition, the)108 585.6 R F1(DbLoc)2.793 E(kT)-.2 E(ab::open)-.92 E
F0 .294(method may f)2.793 F .294(ail and thro)-.1 F 2.794(wa)-.25 G F1
(DbException)A F0 .294(\(3\) or return).24 F F1(errno)2.794 E F0 .294
(for the fol-)2.794 F(lo)108 597.6 Q(wing conditions:)-.25 E([EA)108
614.4 Q(GAIN])-.4 E(The shared memory re)133 626.4 Q(gion w)-.15 E
(as lock)-.1 E(ed and \(repeatedly\) una)-.1 E -.25(va)-.2 G(ilable.).25
E([EINV)108 643.2 Q(AL])-1.35 E(An in)133 655.2 Q -.25(va)-.4 G
(lid \215ag v).25 E(alue or parameter w)-.25 E(as speci\214ed.)-.1 E
(The DB_THREAD \215ag w)133 679.2 Q(as speci\214ed and spinlocks are not implemented for this architecture.)
-.1 E(The)108 708 Q F1(DbLoc)2.5 E(kT)-.2 E(ab::vec)-.92 E F0
(method may f)2.5 E(ail and thro)-.1 E 2.5(wa)-.25 G F1(DbException)A F0
(\(3\)).24 E(April 10, 1998)276.695 768 Q(6)199.695 E EP
%%Page: 7 7
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(DbLockT)72 48 Q 347.14(ab\(3\) DbLockT)-.8 F
(ab\(3\))-.8 E(or return)108 84 Q/F1 10/Times-Italic@0 SF(errno)2.5 E F0
(for an)2.5 E 2.5(yo)-.15 G 2.5(ft)-2.5 G
(he errors speci\214ed for the follo)-2.5 E
(wing DB and library functions:)-.25 E
(DbLock::detect\(3\), fcntl\(2\), f)108 96 Q
(\215ush\(3\), lseek\(2\), memcp)-.25 E
(y\(3\), memset\(3\), mmap\(2\), munmap\(2\), strerror\(3\),)-.1 E
(and write\(2\).)108 108 Q .677(In addition, the)108 124.8 R F1(DbLoc)
3.177 E(kT)-.2 E(ab::vec)-.92 E F0 .676(method may f)3.177 F .676
(ail and thro)-.1 F 3.176(wa)-.25 G F1(DbException)A F0 .676
(\(3\) or return).24 F F1(errno)3.176 E F0 .676(for the fol-)3.176 F(lo)
108 136.8 Q(wing conditions:)-.25 E([EA)108 153.6 Q(CCES])-.4 E
(An attempt w)133 165.6 Q(as made to release lock held by another lock)
-.1 E(er)-.1 E(.)-.55 E([EINV)108 182.4 Q(AL])-1.35 E(An in)133 194.4 Q
-.25(va)-.4 G(lid \215ag v).25 E(alue or parameter w)-.25 E
(as speci\214ed.)-.1 E(The)108 211.2 Q F1(DbLoc)2.5 E(kT)-.2 E(ab::g)
-.92 E(et)-.1 E F0(method may f)2.5 E(ail and thro)-.1 E 2.5(wa)-.25 G
F1(DbException)A F0(\(3\)).24 E(or return)108 235.2 Q F1(errno)2.5 E F0
(for an)2.5 E 2.5(yo)-.15 G 2.5(ft)-2.5 G
(he errors speci\214ed for the follo)-2.5 E
(wing DB and library functions:)-.25 E
(DbLock::detect\(3\), fcntl\(2\), f)108 247.2 Q
(\215ush\(3\), lseek\(2\), memcp)-.25 E
(y\(3\), memset\(3\), mmap\(2\), munmap\(2\), strerror\(3\),)-.1 E
(and write\(2\).)108 259.2 Q .751(In addition, the)108 276 R F1(DbLoc)
3.251 E(kT)-.2 E(ab::g)-.92 E(et)-.1 E F0 .751(method may f)3.251 F .751
(ail and thro)-.1 F 3.251(wa)-.25 G F1(DbException)A F0 .751
(\(3\) or return).24 F F1(errno)3.252 E F0 .752(for the fol-)3.252 F(lo)
108 288 Q(wing conditions:)-.25 E([EINV)108 304.8 Q(AL])-1.35 E(An in)
133 316.8 Q -.25(va)-.4 G(lid \215ag v).25 E(alue or parameter w)-.25 E
(as speci\214ed.)-.1 E(The)108 333.6 Q F1(DbLoc)2.5 E(kT)-.2 E
(ab::close)-.92 E F0(method may f)2.5 E(ail and thro)-.1 E 2.5(wa)-.25 G
F1(DbException)A F0(\(3\)).24 E(or return)108 357.6 Q F1(errno)2.5 E F0
(for an)2.5 E 2.5(yo)-.15 G 2.5(ft)-2.5 G
(he errors speci\214ed for the follo)-2.5 E
(wing DB and library functions: close\(2\), fcntl\(2\),)-.25 E -.25
<668d>108 369.6 S(ush\(3\), munmap\(2\), and strerror\(3\).).25 E(The)
108 386.4 Q F1(DbLoc)2.5 E(kT)-.2 E(ab::unlink)-.92 E F0(method may f)
2.5 E(ail and thro)-.1 E 2.5(wa)-.25 G F1(DbException)A F0(\(3\)).24 E
(or return)108 410.4 Q F1(errno)2.5 E F0(for an)2.5 E 2.5(yo)-.15 G 2.5
(ft)-2.5 G(he errors speci\214ed for the follo)-2.5 E
(wing DB and library functions: close\(2\), fcntl\(2\),)-.25 E -.25
<668d>108 422.4 S(ush\(3\), malloc\(3\), memcp).25 E(y\(3\), memset\(3\), mmap\(2\), munmap\(2\), open\(2\), sig\214llset\(3\), sigprocmask\(2\),)
-.1 E(stat\(2\), strcp)108 434.4 Q
(y\(3\), strdup\(3\), strerror\(3\), strlen\(3\), and unlink\(2\).)-.1 E
1.072(In addition, the)108 451.2 R F1(DbLoc)3.572 E(kT)-.2 E(ab::unlink)
-.92 E F0 1.072(method may f)3.572 F 1.072(ail and thro)-.1 F 3.572(wa)
-.25 G F1(DbException)A F0 1.072(\(3\) or return).24 F F1(errno)3.572 E
F0 1.072(for the)3.572 F(follo)108 463.2 Q(wing conditions:)-.25 E([EB)
108 480 Q(USY])-.1 E(The shared memory re)133 492 Q(gion w)-.15 E
(as in use and the force \215ag w)-.1 E(as not set.)-.1 E(The)108 508.8
Q F1(DbLoc)2.5 E(kT)-.2 E(ab::detect)-.92 E F0(method may f)2.5 E
(ail and thro)-.1 E 2.5(wa)-.25 G F1(DbException)A F0(\(3\)).24 E
(or return)108 532.8 Q F1(errno)2.5 E F0(for an)2.5 E 2.5(yo)-.15 G 2.5
(ft)-2.5 G(he errors speci\214ed for the follo)-2.5 E
(wing DB and library functions: calloc\(3\), fcntl\(2\),)-.25 E -.25
<668d>108 544.8 S(ush\(3\), lseek\(2\), malloc\(3\), memcp).25 E(y\(3\), memset\(3\), mmap\(2\), munmap\(2\), strerror\(3\), and write\(2\).)
-.1 E/F2 9/Times-Bold@0 SF -.09(BU)72 561.6 S(GS).09 E F0 .342
(If a process dies while holding locks, those locks remain held and are)
108 573.6 R/F3 10/Times-Bold@0 SF(ne)2.843 E -.1(ve)-.15 G(r).1 E F0
2.843(released. In)2.843 F .343(this case, all pro-)2.843 F
(cesses should e)108 585.6 Q(xit as quickly as possible, so that)-.15 E
F1(db_r)2.5 E(eco)-.37 E(ver)-.1 E F0(can be run.)2.5 E F2(SEE ALSO)72
602.4 Q F1(db_ar)108 614.4 Q -.15(ch)-.37 G(ive).15 E F0(\(1\),).18 E F1
(db_c)2.5 E(hec)-.15 E(kpoint)-.2 E F0(\(1\),).68 E F1(db_deadloc)2.5 E
(k)-.2 E F0(\(1\),).67 E F1(db_dump)2.5 E F0(\(1\),).19 E F1(db_load)2.5
E F0(\(1\),).77 E F1(db_r)2.5 E(eco)-.37 E(ver)-.1 E F0(\(1\),).73 E F1
(db_stat)2.5 E F0(\(1\),).68 E F1(db_intr)108 626.4 Q(o)-.45 E F0
(\(3\),).18 E F1(db_internal)2.5 E F0(\(3\),).51 E F1(db_thr)2.5 E(ead)
-.37 E F0(\(3\),).77 E F1(Db)2.5 E F0(\(3\),).23 E F1(Dbc)2.5 E F0
(\(3\),).31 E F1(DbEn)2.5 E(v)-.4 E F0(\(3\),).32 E F1(DbException)2.5 E
F0(\(3\),).24 E F1(DbInfo)2.5 E F0(\(3\),).18 E F1(DbLoc)108 638.4 Q(k)
-.2 E F0(\(3\),).67 E F1(DbLoc)2.5 E(kT)-.2 E(ab)-.92 E F0(\(3\),).23 E
F1(DbLo)2.5 E(g)-.1 E F0(\(3\),).22 E F1(DbLsn)2.5 E F0(\(3\),).24 E F1
(DbMpool)2.5 E F0(\(3\),).51 E F1(DbMpoolF)2.5 E(ile)-.45 E F0(\(3\),)
.18 E F1(Dbt)2.5 E F0(\(3\),).68 E F1(DbTxn)2.5 E F0(\(3\),).24 E F1
(DbTxnMgr)108 650.4 Q F0(\(3\)).73 E(April 10, 1998)276.695 768 Q(7)
199.695 E EP
%%Trailer
end
%%EOF
