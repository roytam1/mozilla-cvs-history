%!PS-Adobe-3.0
%%Creator: groff version 1.11
%%CreationDate: Sun May 31 22:58:22 1998
%%DocumentNeededResources: font Times-Bold
%%+ font Times-Roman
%%+ font Times-Italic
%%DocumentSuppliedResources: procset grops 1.11 0
%%Pages: 8
%%PageOrder: Ascend
%%Orientation: Portrait
%%EndComments
%%BeginProlog
%%BeginResource: procset grops 1.11 0
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/MF{
findfont
[5 2 roll
0 3 1 roll
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}bind def
/DA{
newpath arcn stroke
}bind def
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
/DL{
SN
moveto
SN
lineto stroke
}bind def
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
/FL{
currentgray exch setgray fill setgray
}bind def
/BL/fill load def
/LW/setlinewidth load def
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
}bind def
/PEND{
clear
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%IncludeResource: font Times-Bold
%%IncludeResource: font Times-Roman
%%IncludeResource: font Times-Italic
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Times-Italic@0 ENC0/Times-Italic RE/Times-Roman@0 ENC0/Times-Roman RE
/Times-Bold@0 ENC0/Times-Bold RE
%%EndProlog
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Bold@0 SF -.18(NA)72 28.8 S(ME).18 E/F1 10/Times-Roman@0 SF
(db_lock \255 lock manager)108 40.8 Q F0(SYNOPSIS)72 57.6 Q/F2 10
/Times-Bold@0 SF(#include <db)108 69.6 Q(.h>)-.4 E(int)108 93.6 Q
(lock_open\(const char *dir)108 105.6 Q(,)-.92 E
(u_int32_t \215ags, int mode, DB_ENV *dben)158 117.6 Q 1.1 -.55(v, D)-.4
H(B_LOCKT).55 E(AB **r)-.9 E(egionp\);)-.18 E(int)108 141.6 Q
(lock_id\(DB_LOCKT)108 153.6 Q(AB *lt, u_int32_t *idp\);)-.9 E(int)108
177.6 Q(lock_v)108 189.6 Q(ec\(DB_LOCKT)-.1 E(AB *lt, u_int32_t lock)-.9
E(er)-.1 E 2.5(,u)-.92 G(_int32_t \215ags,)-2.5 E
(DB_LOCKREQ list[], int nlist, DB_LOCKREQ **elistp\);)158 201.6 Q(int)
108 225.6 Q(lock_get\(DB_LOCKT)108 237.6 Q(AB *lt, u_int32_t lock)-.9 E
(er)-.1 E 2.5(,u)-.92 G(_int32_t \215ags,)-2.5 E
(const DBT *obj, const db_lockmode_t lock_mode, DB_LOCK *lock\);)158
249.6 Q(int)108 273.6 Q(lock_put\(DB_LOCKT)108 285.6 Q
(AB *lt, DB_LOCK lock\);)-.9 E(int)108 309.6 Q(lock_close\(DB_LOCKT)108
321.6 Q(AB *lt\);)-.9 E(int)108 345.6 Q(lock_unlink\(const char *dir)108
357.6 Q 2.5(,i)-.92 G(nt f)-2.5 E(or)-.25 E(ce, DB_ENV *dben)-.18 E
(v\);)-.4 E(int)108 381.6 Q(lock_detect\(DB_LOCKT)108 393.6 Q
(AB *lt, u_int32_t \215ags, u_int32_t atype\);)-.9 E(int)108 417.6 Q
(lock_stat\(DB_LOCKT)108 429.6 Q(AB *lt,)-.9 E(DB_LOCK_ST)158 441.6 Q
1.9 -.95(AT *)-.9 H(*spp, v).95 E(oid *\(*db_malloc\)\(size_t\)\);)-.1 E
F0(DESCRIPTION)72 458.4 Q F1 .486(The DB library is a f)108 470.4 R .485
(amily of groups of functions that pro)-.1 F .485
(vides a modular programming interf)-.15 F .485(ace to trans-)-.1 F .523
(actions and record-oriented \214le access.)108 482.4 R .523
(The library includes support for transactions, locking, logging and)
5.523 F .507(\214le page caching, as well as v)108 494.4 R .507
(arious inde)-.25 F -.15(xe)-.15 G 3.007(da).15 G .506(ccess methods.)
-3.007 F(Man)5.506 E 3.006(yo)-.15 G 3.006(ft)-3.006 G .506
(he functional groups \(e.g., the \214le)-3.006 F .168(page caching functions\) are useful independent of the other DB functions, although some functional groups)
108 506.4 R .122(are e)108 518.4 R .121(xplicitly based on other functional groups \(e.g., transactions and logging\).)
-.15 F -.15(Fo)5.121 G 2.621(rag).15 G .121(eneral description of)-2.621
F(the DB package, see)108 530.4 Q/F3 10/Times-Italic@0 SF(db_intr)2.5 E
(o)-.45 E F1(\(3\).).18 E(This manual page describes the speci\214c details of the locking interf)
108 547.2 Q(ace.)-.1 E(The)108 564 Q F3(db_loc)5.443 E(k)-.2 E F1 2.943
(functions are the library interf)5.443 F 2.943(ace intended to pro)-.1
F 2.944(vide general-purpose locking.)-.15 F(While)7.944 E .173
(designed to w)108 576 R .172(ork with the other DB functions, these functions are also useful for more general locking pur)
-.1 F(-)-.2 E 4.01(poses. Locks)108 588 R 1.51
(can be shared between processes.)4.01 F 1.511
(In most cases, when multiple threads or processes are)6.511 F
(using locking, the deadlock detector)108 600 Q(,)-.4 E F3(db_deadloc)
2.5 E(k)-.2 E F1(\(1\), should be run.).67 E F3(loc)92 616.8 Q(k_open)
-.2 E F1(The)108 628.8 Q F3(loc)2.935 E(k_open)-.2 E F1 .434
(function copies a pointer)2.935 F 2.934(,t)-.4 G 2.934(ot)-2.934 G .434
(he lock table identi\214ed by the)-2.934 F F2(dir)2.934 E(ectory)-.18 E
F3(dir)2.934 E F1 2.934(,i).73 G .434(nto the memory)-2.934 F
(location referenced by)108 640.8 Q F3 -.37(re)2.5 G(gionp)-.03 E F1(.)
.19 E 1.594(If the)108 657.6 R F3(dben)4.094 E(v)-.4 E F1(ar)4.094 E
1.594(gument to)-.18 F F3(loc)4.094 E(k_open)-.2 E F1 -.1(wa)4.095 G
4.095(si).1 G 1.595(nitialized using)-4.095 F F3(db_appinit)4.095 E F1
(,).68 E F3(dir)4.095 E F1 1.595(is interpreted as described by)4.095 F
F3(db_appinit)108 669.6 Q F1(\(3\).).68 E .668(Otherwise, if)108 686.4 R
F3(dir)3.168 E F1 .668(is not NULL, it is interpreted relati)3.168 F
.968 -.15(ve t)-.25 H 3.168(ot).15 G .668(he current w)-3.168 F .667
(orking directory of the process.)-.1 F(If)5.667 E F3(dir)108 698.4 Q F1
2.387(is NULL, the follo)4.887 F 2.388(wing en)-.25 F 2.388(vironment v)
-.4 F 2.388(ariables are check)-.25 F 2.388(ed in order: `)-.1 F
(`TMPDIR')-.74 E 2.388(', `)-.74 F(`TEMP')-.74 E 2.388(', and)-.74 F
-.74(``)108 710.4 S(TMP').74 E 3.268('. If)-.74 F .768
(one of them is set, lock table \214les are created relati)3.268 F 1.068
-.15(ve t)-.25 H 3.268(ot).15 G .768(he directory it speci\214es.)-3.268
F .768(If none of)5.768 F 1.5
(them are set, the \214rst possible one of the follo)108 722.4 R 1.501
(wing directories is used:)-.25 F F3(/var/tmp)4.001 E F1(,).19 E F3
(/usr/tmp)4.001 E F1(,).19 E F3(/temp)4.001 E F1(,).19 E F3(/tmp)4.001 E
F1(,).19 E(1)535 768 Q EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 349.96(DB_LOCK\(3\) DB_LOCK\(3\))72 48 R/F1 10
/Times-Italic@0 SF(C:/temp)108 84 Q F0(and)2.5 E F1(C:/tmp)2.5 E F0(.)
.19 E(All \214les associated with the lock table are created in this directory)
108 100.8 Q 5(.T)-.65 G(his directory must already e)-5 E(xist when)-.15
E 1.132(lock table_open is called.)108 124.8 R 1.132
(If the lock table already e)6.132 F 1.132(xists, the process must ha)
-.15 F 1.431 -.15(ve p)-.2 H 1.131(ermission to read and).15 F
(write the e)108 136.8 Q(xisting \214les.)-.15 E
(If the lock table does not already e)5 E
(xist, it is optionally created and initialized.)-.15 E(The)108 153.6 Q
F1<8d61>3.76 E(gs)-.1 E F0(and)3.76 E F1(mode)3.76 E F0(ar)3.76 E 1.26
(guments specify ho)-.18 F 3.761<778c>-.25 G 1.261
(les will be opened and/or created when the)-3.761 F 3.761(yd)-.15 G
(on')-3.761 E 3.761(ta)-.18 G(lready)-3.761 E -.15(ex)108 165.6 S 2.5
(ist. The).15 F(\215ags v)2.5 E(alue is speci\214ed by)-.25 E/F2 10
/Times-Bold@0 SF(or)2.5 E F0('ing together one or more of the follo)A
(wing v)-.25 E(alues:)-.25 E(DB_CREA)108 182.4 Q(TE)-1.11 E .484
(Create an)133 194.4 R 2.984(yu)-.15 G .483
(nderlying \214les, as necessary)-2.984 F 5.483(.I)-.65 G 2.983(ft)
-5.483 G .483(he \214les do not already e)-2.983 F .483
(xist and the DB_CREA)-.15 F .483(TE \215ag)-1.11 F
(is not speci\214ed, the call will f)133 206.4 Q(ail.)-.1 E(DB_THREAD)
108 235.2 Q 1.975(Cause the DB_LOCKT)133 247.2 R 1.975
(AB handle returned by the)-.93 F F1(loc)4.475 E(k_open)-.2 E F0 1.976
(function to be useable by multiple)4.475 F
(threads within a single address space, i.e., to be `)133 259.2 Q
(`free-threaded')-.74 E('.)-.74 E .528
(All \214les created by the lock subsystem are created with mode)108 276
R F1(mode)3.028 E F0 .527(\(as described in)3.027 F F1 -.15(ch)3.027 G
(mod).15 E F0 .527(\(2\)\) and modi-).77 F .816
(\214ed by the process' umask v)108 288 R .816
(alue at the time of creation \(see)-.25 F F1(umask)3.317 E F0 3.317
(\(2\)\). The).67 F .817(group o)3.317 F .817(wnership of created)-.25 F
(\214les is based on the system and directory def)108 300 Q
(aults, and is not further speci\214ed by DB.)-.1 E 1.133
(The locking subsystem is con\214gured based on the)108 316.8 R F1(dben)
3.633 E(v)-.4 E F0(ar)3.633 E 1.133(gument to)-.18 F F1(loc)3.633 E
(k_open)-.2 E F0 3.633(,w).24 G 1.133(hich is a pointer to a)-3.633 F
1.923(structure of type DB_ENV \(typedef)108 328.8 R 2.924 -.5('d i).55
H 4.424(n<).5 G(db)-4.424 E 4.424(.h>\). Applications)-.4 F 1.924
(will normally use the same DB_ENV)4.424 F(structure \(initialized by)
108 340.8 Q F1(db_appinit)2.5 E F0(\(3\)\), as an ar).68 E
(gument to all of the subsystems in the DB package.)-.18 E .439(References to the DB_ENV structure are maintained by DB, so it may not be discarded until the last close)
108 357.6 R .286
(function, corresponding to an open function for which it w)108 369.6 R
.287(as an ar)-.1 F .287(gument, has returned.)-.18 F .287
(In order to ensure)5.287 F 1.578(compatibility with future releases of DB, all \214elds of the DB_ENV structure that are not e)
108 381.6 R 1.578(xplicitly set)-.15 F .17(should be initialized to 0 before the \214rst time the structure is used.)
108 393.6 R .171(Do this by declaring the structure e)5.171 F(xter)-.15
E(-)-.2 E(nal or static, or by calling the C library routine)108 405.6 Q
F1(bzer)2.5 E(o)-.45 E F0(\(3\) or).18 E F1(memset)2.5 E F0(\(3\).).68 E
.007(The \214elds of the DB_ENV structure used by)108 422.4 R F1(loc)
2.507 E(k_open)-.2 E F0 .007(are described belo)2.507 F 3.807 -.65(w. I)
-.25 H(f).65 E F1(dben)2.507 E(v)-.4 E F0 .007(is NULL or an)2.507 F
2.506(yo)-.15 G 2.506(fi)-2.506 G(ts)-2.506 E
(\214elds are set to 0, def)108 434.4 Q
(aults appropriate for the system are used where possible.)-.1 E
(The follo)108 451.2 Q(wing \214elds in the DB_ENV structure may be initialized before calling)
-.25 E F1(loc)2.5 E(k_open)-.2 E F0(:).24 E -.2(vo)108 468 S
(id *\(*db_errcall\)\(char *db_errpfx, char *b).2 E(uf)-.2 E(fer\);)-.25
E(FILE *db_err\214le;)108 480 Q(const char *db_errpfx;)108 492 Q
(int db_v)108 504 Q(erbose;)-.15 E
(The error \214elds of the DB_ENV beha)133 516 Q .3 -.15(ve a)-.2 H 2.5
(sd).15 G(escribed for)-2.5 E F1(db_appinit)2.5 E F0(\(3\).).68 E
(const u_int8_t lk_con\215icts[][];)108 556.8 Q(A)133 568.8 Q F1
(lk_modes)2.5 E F0(by)2.5 E F1(lk_modes)2.5 E F0(array)2.5 E 5(.A)-.65 G
(non-0 v)-2.5 E(alue for the array element:)-.25 E
(lk_con\215icts[requested_mode][held_mode])183 592.8 Q 1.914
(indicates that requested_mode and held_mode con\215ict.)133 616.8 R
1.915(The `)6.915 F(`not-granted')-.74 E 4.415('m)-.74 G 1.915
(ode must be repre-)-4.415 F 1.618(sented by 0.)133 628.8 R(If)6.618 E
F1(lk_con\215icts)4.118 E F0 1.618(is NULL, the con\215icts array)4.118
F F1(db_rw_con\215icts)4.118 E F0 1.618(is used; see the section)4.118 F
(belo)133 640.8 Q 2.5(we)-.25 G(ntitled `)-2.5 E(`ST)-.74 E(AND)-.93 E
(ARD LOCK MODES')-.4 E 2.5('f)-.74 G(or a description of that array)-2.5
E(.)-.65 E(db_detect_t lk_detect;)108 657.6 Q 1.11
(If non-0, speci\214es that the deadlock detector be run whene)133 669.6
R -.15(ve)-.25 G 3.611(ral).15 G 1.111
(ock con\215ict occurs, and speci\214es)-3.611 F .27
(which transaction should be aborted in the case of a deadlock.)133
681.6 R(The)5.269 E F1(lk_detect)2.769 E F0 .269
(\214eld must be set to one)2.769 F(of the follo)133 693.6 Q(wing v)-.25
E(alues.)-.25 E(May 10, 1998)278.085 768 Q(2)201.085 E EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 349.96(DB_LOCK\(3\) DB_LOCK\(3\))72 48 R
(DB_LOCK_DEF)133 84 Q -.55(AU)-.74 G -.92(LT).55 G(Use the def)158 96 Q
(ault polic)-.1 E 2.5(ya)-.15 G 2.5(ss)-2.5 G(peci\214ed in the)-2.5 E
/F1 10/Times-Italic@0 SF(db_deadloc)2.5 E(k)-.2 E F0(\(1\) man page.).67
E(DB_LOCK_OLDEST)133 112.8 Q(Abort the oldest transaction.)158 124.8 Q
(DB_LOCK_RANDOM)133 141.6 Q(Abort a random transaction in)158 153.6 Q
-.2(vo)-.4 G(lv).2 E(ed in the deadlock.)-.15 E(DB_LOCK_Y)133 170.4 Q
(OUNGEST)-.3 E(Abort the youngest transaction.)158 182.4 Q
(u_int32_t lk_max;)108 199.2 Q .293
(The maximum number of locks to be held or requested in the table.)133
211.2 R .294(This v)5.294 F .294(alue is used by)-.25 F F1(loc)2.794 E
(k_open)-.2 E F0 1.88(to estimate ho)133 223.2 R 4.38(wm)-.25 G 1.88
(uch space to allocate for v)-4.38 F 1.88
(arious lock-table data structures.)-.25 F(If)6.88 E F1(lk_max)4.38 E F0
1.88(is 0, a)4.38 F(def)133 235.2 Q(ault v)-.1 E(alue is used.)-.25 E
(u_int32_t lk_modes;)108 252 Q .049(The number of lock modes to be recognized by the lock table \(including the `)
133 264 R(`not-granted')-.74 E 2.55('m)-.74 G 2.55(ode\). If)-2.55 F F1
(lk_modes)133 276 Q F0(is 0, the v)2.5 E(alue DB_LOCK_R)-.25 E
(W_N is used; see belo)-.55 E 2.5(wf)-.25 G(or a description of that v)
-2.5 E(alue.)-.25 E(The)108 292.8 Q F1(loc)2.5 E(k_open)-.2 E F0
(function returns the v)2.5 E(alue of)-.25 E F1(errno)2.5 E F0(on f)2.5
E(ailure and 0 on success.)-.1 E F1(loc)92 309.6 Q(k_id)-.2 E F0(The)108
321.6 Q F1(loc)3.126 E(k_id)-.2 E F0 .626(function copies a lock)3.126 F
.625(er ID, which is guaranteed to be unique in the speci\214ed lock table, into)
-.1 F(the memory location referenced by)108 333.6 Q F1(idp)2.5 E F0(.)
.19 E .099(The access methods \(see)108 350.4 R F1(db_open)2.599 E F0
.099(\(3\)\), generate a unique lock).24 F .1
(er ID for each \214le that is opened with locking.)-.1 F .26
(During DB access method operation, this lock)108 362.4 R .259
(er ID will be used for all lock calls unless a transaction iden-)-.1 F
(ti\214er w)108 374.4 Q(as speci\214ed for the call, in which case the transaction ID speci\214ed is used for locking.)
-.1 E(The)108 391.2 Q F1(loc)2.5 E(k_id)-.2 E F0(function returns the v)
2.5 E(alue of)-.25 E F1(errno)2.5 E F0(on f)2.5 E
(ailure and 0 on success.)-.1 E F1(loc)92 408 Q(k_vec)-.2 E F0(The)108
420 Q F1(loc)3.173 E(k_vec)-.2 E F0 .673(function atomically obtains and releases one or more locks from the speci\214ed table,)
3.173 F F1(lt)3.174 E F0 5.674(.T).68 G(he)-5.674 E F1(loc)108 432 Q
(k_vec)-.2 E F0 2.02(function is intended to support acquisition or trading of multiple locks under one lock table)
4.52 F(semaphore, as is needed for lock coupling or in multigranularity locking for lock escalation.)
108 444 Q(The)108 460.8 Q F1(loc)3.57 E -.1(ke)-.2 G(r).1 E F0(ar)3.57 E
1.07(gument speci\214ed to)-.18 F F1(loc)3.57 E(k_vec)-.2 E F0 1.07
(is an unsigned 32-bit inte)3.57 F 1.07(ger quantity)-.15 F 6.07(.I)-.65
G 3.57(tr)-6.07 G 1.07(epresents the entity)-3.57 F
(requesting or releasing the lock.)108 472.8 Q(The)108 489.6 Q F1<8d61>
2.5 E(gs)-.1 E F0 -.25(va)2.5 G(lue must be set to 0 or the follo).25 E
(wing v)-.25 E(alue:)-.25 E(DB_LOCK_NO)108 506.4 Q -1.2(WA)-.35 G(IT)1.2
E .191(If a lock cannot be granted because the requested lock con\215icts with an e)
133 518.4 R .191(xisting lock, return immedi-)-.15 F(ately instead of w)
133 530.4 Q(aiting for the lock to become a)-.1 E -.25(va)-.2 G(ilable.)
.25 E(The)108 547.2 Q F1(list)2.625 E F0 .125(array pro)2.625 F .125
(vided to)-.15 F F1(loc)2.626 E(k_vec)-.2 E F0 .126(is typedef)2.626 F
1.126 -.5('d i).55 H 2.626(n<).5 G(db)-2.626 E .126(.h> as DB_LOCKREQ.)
-.4 F 2.626(AD)5.126 G .126(B_LOCKREQ structure)-2.626 F
(has at least the follo)108 559.2 Q
(wing \214elds, which must be initialized before calling)-.25 E F1(loc)
2.5 E(k_vec)-.2 E F0(:).31 E(lock)108 576 Q(op_t op;)-.1 E
(The operation to be performed, which must be set to one of the follo)
133 588 Q(wing v)-.25 E(alues:)-.25 E(DB_LOCK_GET)133 604.8 Q .075
(Get a lock, as de\214ned by the v)158 616.8 R .075(alues of)-.25 F F1
(loc)2.574 E -.1(ke)-.2 G(r).1 E F0(,).73 E F1(obj)2.574 E F0(and)2.574
E F1(mode)2.574 E F0 5.074(.U).18 G .074(pon return from)-5.074 F F1
(loc)2.574 E(k_vec)-.2 E F0 2.574(,i).31 G 2.574(ft)-2.574 G(he)-2.574 E
F1(loc)158 628.8 Q(k)-.2 E F0 1.45
(\214eld is non-NULL, a reference to the acquired lock is stored there.)
3.95 F 1.45(\(This reference is)6.45 F(in)158 640.8 Q -.25(va)-.4 G
(lidated by an).25 E 2.5(yc)-.15 G(all to)-2.5 E F1(loc)2.5 E(k_vec)-.2
E F0(or)2.5 E F1(loc)2.5 E(k_put)-.2 E F0(that releases the lock.\))2.5
E(DB_LOCK_PUT)133 657.6 Q(The lock referenced by the contents of the)158
669.6 Q F1(loc)2.5 E(k)-.2 E F0(\214eld is released.)2.5 E
(DB_LOCK_PUT_ALL)133 686.4 Q .759(All locks held by the)158 698.4 R F1
(loc)3.259 E -.1(ke)-.2 G(r).1 E F0 .759(are released.)3.259 F(\(An)
5.759 E 3.259(yl)-.15 G .759
(ocks acquired as a part of the current call to)-3.259 F F1(loc)158
710.4 Q(k_vec)-.2 E F0 .84(that appear after the DB_LOCK_PUT_ALL entry are not considered for this opera-)
3.34 F(tion\).)158 722.4 Q(May 10, 1998)278.085 768 Q(3)201.085 E EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 349.96(DB_LOCK\(3\) DB_LOCK\(3\))72 48 R
(DB_LOCK_PUT_OBJ)133 84 Q 1.41(All locks held by the)158 96 R/F1 10
/Times-Italic@0 SF(loc)3.91 E -.1(ke)-.2 G(r).1 E F0 3.91(,o).73 G 3.909
(nt)-3.91 G 1.409(he object)-3.909 F F1(obj)3.909 E F0 3.909(,w).48 G
1.409(ith the mode speci\214ed by)-3.909 F F1(loc)3.909 E(k_mode)-.2 E
F0 3.909(,a).18 G(re)-3.909 E 4.276(released. A)158 108 R F1(loc)4.276 E
(k_mode)-.2 E F0 1.776
(of DB_LOCK_NG indicates that all locks on the object should be)4.276 F
2.532(released. Note)158 120 R .032(that an)2.532 F 2.531(yl)-.15 G .031
(ocks acquired as a part of the current call to)-2.531 F F1(loc)2.531 E
(k_vec)-.2 E F0 .031(that occur before)2.531 F 3.403
(the DB_LOCK_PUT_OBJ will also be released; those acquired afterw)158
132 R 3.403(ards will not be)-.1 F(released.)158 144 Q(const DBT obj;)
108 160.8 Q
(An untyped byte string that speci\214es the object to be lock)133 172.8
Q(ed or released.)-.1 E(const lockmode_t mode;)108 189.6 Q
(The lock mode, used as an inde)133 201.6 Q 2.5(xi)-.15 G(nto)-2.5 E F1
(lt)2.5 E F0 1.1 -.55('s c).68 H(on\215ict array).55 E(.)-.65 E
(DB_LOCK lock;)108 218.4 Q 2.5(Al)133 230.4 S(ock reference.)-2.5 E(The)
108 247.2 Q F1(nlist)2.5 E F0(ar)2.5 E
(gument speci\214es the number of elements in the)-.18 E F1(list)2.5 E
F0(array)2.5 E(.)-.65 E .51(If an)108 264 R 3.01(yo)-.15 G 3.01(ft)-3.01
G .51(he requested locks cannot be acquired, or an)-3.01 F 3.01(yo)-.15
G 3.01(ft)-3.01 G .51(he locks to be released cannot be released, the)
-3.01 F .348(operations before the f)108 276 R .348
(ailing operation are guaranteed to ha)-.1 F .649 -.15(ve c)-.2 H .349
(ompleted successfully).15 F 2.849(,a)-.65 G(nd)-2.849 E F1(loc)2.849 E
(k_vec)-.2 E F0(returns)2.849 E 2.841(an)108 288 S .341(on-zero v)-2.841
F 2.841(alue. In)-.25 F .341(addition, if)2.841 F F1(elistp)2.841 E F0
.341(is not NULL, it is set to point to the DB_LOCKREQ entry that w)
2.841 F(as)-.1 E(being processed when the error occurred.)108 300 Q
(In the case of an error)108 316.8 Q(,)-.4 E F1(loc)2.5 E(k_vec)-.2 E F0
(may return one of the follo)2.5 E(wing v)-.25 E(alues:)-.25 E
(DB_LOCK_DEADLOCK)108 333.6 Q(The speci\214ed)133 345.6 Q F1(loc)2.5 E
-.1(ke)-.2 G(r).1 E F0 -.1(wa)2.5 G 2.5(ss).1 G
(elected as a victim in order to resolv)-2.5 E 2.5(ead)-.15 G(eadlock.)
-2.5 E(DB_LOCK_NO)108 362.4 Q(THELD)-.4 E
(The lock cannot be released, as it w)133 374.4 Q(as not held by the)-.1
E F1(loc)2.5 E -.1(ke)-.2 G(r).1 E F0(.).73 E(DB_LOCK_NO)108 391.2 Q
(TGRANTED)-.4 E 8.232(Al)133 403.2 S 5.732(ock w)-8.232 F 5.732
(as requested that could not be granted and the)-.1 F F1<8d61>8.232 E(g)
-.1 E F0 5.732(parameter w)8.232 F 5.732(as set to)-.1 F(DB_LOCK_NO)133
415.2 Q -1.2(WA)-.35 G(IT)1.2 E 5(.I)-.74 G 2.5(nt)-5 G
(his case, if non-NULL,)-2.5 E F1(elistp)2.5 E F0
(identi\214es the request that w)2.5 E(as granted.)-.1 E(Otherwise, the)
108 432 Q F1(loc)2.5 E(k_vec)-.2 E F0(function returns the v)2.5 E
(alue of)-.25 E F1(errno)2.5 E F0(on f)2.5 E(ailure and 0 on success.)
-.1 E F1(loc)92 448.8 Q(k_g)-.2 E(et)-.1 E F0(The)108 460.8 Q F1(loc)
3.729 E(k_g)-.2 E(et)-.1 E F0 1.228(function is a simple interf)3.729 F
1.228(ace to the)-.1 F F1(loc)3.728 E(k_vec)-.2 E F0(functionality)3.728
E 3.728(,a)-.65 G 1.228(nd is equi)-3.728 F -.25(va)-.25 G 1.228
(lent to calling the).25 F F1(loc)108 472.8 Q(k_vec)-.2 E F0 .564
(function with the)3.064 F F1(lt)3.064 E F0(and)3.064 E F1(loc)3.064 E
-.1(ke)-.2 G(r).1 E F0(ar)3.064 E(guments,)-.18 E F1(elistp)3.064 E F0
(and)3.064 E F1(con\215ict)3.064 E F0(ar)3.065 E .565
(guments, and a single element)-.18 F F1(list)3.065 E F0(array)108 484.8
Q 2.831(,f)-.65 G .331(or which the)-2.831 F F1(op)2.831 E F0 .331
(\214eld is DB_LOCK_GET)2.831 F 2.831(,a)-.74 G .331(nd the)-2.831 F F1
(obj)2.831 E F0(,).48 E F1(loc)2.83 E(k_mode)-.2 E F0(and)2.83 E F1(loc)
2.83 E(k)-.2 E F0 .33(\214elds are represented by)2.83 F .756(the ar)108
496.8 R .756(guments of the same name.)-.18 F .756
(Note that the type of the)5.756 F F1(obj)3.256 E F0(ar)3.256 E .757
(gument to)-.18 F F1(loc)3.257 E(k_g)-.2 E(et)-.1 E F0 .757(is dif)3.257
F .757(ferent from the)-.25 F F1(obj)108 508.8 Q F0 1.01
(element found in the DB_LOCKREQ structure.)3.51 F(The)6.01 E F1(loc)
3.51 E(k_g)-.2 E(et)-.1 E F0 1.01(function returns success and f)3.51 F
1.01(ailure as)-.1 F(described for the)108 520.8 Q F1(loc)2.5 E(k_vec)
-.2 E F0(function.)2.5 E F1(loc)92 537.6 Q(k_put)-.2 E F0(The)108 549.6
Q F1(loc)3.686 E(k_put)-.2 E F0 1.187(function is a simple interf)3.686
F 1.187(ace to the)-.1 F F1(loc)3.687 E(k_vec)-.2 E F0(functionality)
3.687 E 3.687(,a)-.65 G 1.187(nd is equi)-3.687 F -.25(va)-.25 G 1.187
(lent to calling the).25 F F1(loc)108 561.6 Q(k_vec)-.2 E F0 .772
(function with a single element)3.272 F F1(list)3.271 E F0(array)3.271 E
3.271(,f)-.65 G .771(or which the)-3.271 F F1(op)3.271 E F0 .771
(\214eld is DB_LOCK_PUT and the)3.271 F F1(loc)3.271 E(k)-.2 E F0 .102
(\214eld is represented by the ar)108 573.6 R .102
(gument of the same name.)-.18 F(The)5.102 E F1(loc)2.602 E(k_put)-.2 E
F0 .103(function returns success and f)2.603 F .103(ailure as)-.1 F
(described for the)108 585.6 Q F1(loc)2.5 E(k_vec)-.2 E F0(function.)2.5
E F1(loc)92 602.4 Q(k_close)-.2 E F0(The)108 614.4 Q F1(loc)3.046 E
(k_close)-.2 E F0 .545
(function disassociates the calling process from the lock table)3.046 F
F1(lt)3.045 E F0 5.545(.N).68 G .545(ote that)-5.545 F F1(loc)3.045 E
(k_close)-.2 E F0(does)3.045 E .96(not release an)108 626.4 R 3.46(yl)
-.15 G .961(ocks still held by the closing process.)-3.46 F .961
(\(This pro)5.961 F .961(vides functionality for long-li)-.15 F -.15(ve)
-.25 G 3.461(dl).15 G(ocks.\))-3.461 E(Processes that wish to ha)108
638.4 Q .3 -.15(ve a)-.2 H
(ll their locks released can do so by issuing the appropriate).15 E F1
(loc)2.5 E(k_vec)-.2 E F0(call.)2.5 E .187(In addition, if the)108 655.2
R F1(dir)2.687 E F0(ar)2.687 E .187(gument to)-.18 F F1(loc)2.687 E
(k_open)-.2 E F0 -.1(wa)2.687 G 2.686(sN).1 G .186(ULL and)-2.686 F F1
(dben)2.686 E(v)-.4 E F0 -.1(wa)2.686 G 2.686(sn).1 G .186
(ot initialized using)-2.686 F F1(db_appinit)2.686 E F0 2.686(,a).68 G
(ll)-2.686 E(\214les created for this shared re)108 667.2 Q
(gion will be remo)-.15 E -.15(ve)-.15 G(d, as if).15 E F1(loc)2.5 E
(k_unlink)-.2 E F0(were called.)2.5 E .206
(When multiple threads are using the DB_LOCKT)108 684 R .206
(AB handle concurrently)-.93 F 2.706(,o)-.65 G .206
(nly a single thread may call the)-2.706 F F1(loc)108 696 Q(k_close)-.2
E F0(function.)2.5 E(The)108 712.8 Q F1(loc)2.5 E(k_close)-.2 E F0
(function returns the v)2.5 E(alue of)-.25 E F1(errno)2.5 E F0(on f)2.5
E(ailure and 0 on success.)-.1 E(May 10, 1998)278.085 768 Q(4)201.085 E
EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 349.96(DB_LOCK\(3\) DB_LOCK\(3\))72 48 R/F1 10
/Times-Italic@0 SF(loc)92 84 Q(k_unlink)-.2 E F0(The)108 96 Q F1(loc)
3.287 E(k_unlink)-.2 E F0 .787(function destro)3.287 F .787
(ys the lock table identi\214ed by the directory)-.1 F F1(dir)3.287 E F0
3.287(,r).73 G(emo)-3.287 E .787(ving all \214les used to)-.15 F 1.976
(implement the lock table.)108 108 R 1.977(\(The directory)6.977 F F1
(dir)4.477 E F0 1.977(is not remo)4.477 F -.15(ve)-.15 G 4.477(d.\) If)
.15 F 1.977(there are processes that ha)4.477 F 2.277 -.15(ve c)-.2 H
(alled).15 E F1(loc)108 120 Q(k_open)-.2 E F0 .87(without calling)3.37 F
F1(loc)3.37 E(k_close)-.2 E F0 .869
(\(i.e., there are processes currently using the lock table\),)3.369 F
F1(loc)3.369 E(k_unlink)-.2 E F0 .085(will f)108 132 R .085(ail without further action, unless the force \215ag is set, in which case)
-.1 F F1(loc)2.586 E(k_unlink)-.2 E F0 .086(will attempt to remo)2.586 F
-.15(ve)-.15 G(the lock table \214les re)108 144 Q -.05(ga)-.15 G
(rdless of an).05 E 2.5(yp)-.15 G(rocesses still using the lock table.)
-2.5 E .766(The result of attempting to forcibly destro)108 160.8 R
3.266(yt)-.1 G .766(he re)-3.266 F .766(gion when a process has the re)
-.15 F .765(gion open is unspeci\214ed.)-.15 F 1.232
(Processes using a shared memory re)108 172.8 R 1.232
(gion maintain an open \214le descriptor for it.)-.15 F 1.232
(On UNIX systems, the)6.232 F(re)108 184.8 Q .474(gion remo)-.15 F -.25
(va)-.15 G 2.974(ls).25 G .473(hould succeed and processes that ha)
-2.974 F .773 -.15(ve a)-.2 H .473(lready joined the re).15 F .473
(gion should continue to run in)-.15 F .337(the re)108 196.8 R .337
(gion without change, ho)-.15 F(we)-.25 E -.15(ve)-.25 G 2.837(rp).15 G
.337(rocesses attempting to join the lock table will either f)-2.837 F
.337(ail or attempt to)-.1 F .45(create a ne)108 208.8 R 2.95(wr)-.25 G
-.15(eg)-2.95 G 2.95(ion. On).15 F .45(other systems, e.g., WNT)2.95 F
2.949(,w)-.74 G .449(here the)-2.949 F F1(unlink)2.949 E F0 .449
(\(2\) system call will f).67 F .449(ail if an)-.1 F 2.949(yp)-.15 G
(rocess)-2.949 E(has an open \214le descriptor for the \214le, the re)
108 220.8 Q(gion remo)-.15 E -.25(va)-.15 G 2.5(lw).25 G(ill f)-2.5 E
(ail.)-.1 E .929(In the case of catastrophic or system f)108 237.6 R
.929(ailure, database reco)-.1 F -.15(ve)-.15 G .93
(ry must be performed \(see).15 F F1(db_r)3.43 E(eco)-.37 E(ver)-.1 E F0
.93(\(1\) or).73 F .74(the DB_RECO)108 249.6 R .74(VER and DB_RECO)-.5 F
(VER_F)-.5 E -1.21 -1.11(AT A)-.74 H 3.24<4c8d>1.11 G .74(ags to)-3.24 F
F1(db_appinit)3.24 E F0 3.24(\(3\)\). Alternati).68 F -.15(ve)-.25 G(ly)
.15 E 3.24(,i)-.65 G 3.24(fr)-3.24 G(eco)-3.24 E -.15(ve)-.15 G .74
(ry is not).15 F .877
(required because no database state is maintained across f)108 261.6 R
.877(ailures, it is possible to clean up a lock table by)-.1 F(remo)108
273.6 Q .975
(ving all of the \214les in the directory speci\214ed to the)-.15 F F1
(loc)3.474 E(k_open)-.2 E F0 .974
(function, as lock table \214les are ne)3.474 F -.15(ve)-.25 G(r).15 E
.043(created in an)108 285.6 R 2.543(yd)-.15 G .043
(irectory other than the one speci\214ed to)-2.543 F F1(loc)2.544 E
(k_open)-.2 E F0 5.044(.N).24 G .044(ote, ho)-5.044 F(we)-.25 E -.15(ve)
-.25 G .844 -.4(r, t).15 H .044(hat this has the potential).4 F(to remo)
108 297.6 Q .3 -.15(ve \214)-.15 H
(les created by the other DB subsystems in this database en).15 E
(vironment.)-.4 E(The)108 314.4 Q F1(loc)2.5 E(k_unlink)-.2 E F0
(function returns the v)2.5 E(alue of)-.25 E F1(errno)2.5 E F0(on f)2.5
E(ailure and 0 on success.)-.1 E F1(loc)92 331.2 Q(k_detect)-.2 E F0
(The)108 343.2 Q F1(loc)2.584 E(k_detect)-.2 E F0 .083(function runs one iteration of the deadlock detector on the speci\214ed table,)
2.584 F F1(lt)2.583 E F0 5.083(.T).68 G .083(he deadlock)-5.083 F .306
(detector tra)108 355.2 R -.15(ve)-.2 G .306(rses the lock table, detects deadlocks, and if it \214nds one, marks one of the participating trans-)
.15 F(actions for abort and then returns.)108 367.2 Q(The \215ags v)108
384 Q(alue is speci\214ed by)-.25 E/F2 10/Times-Bold@0 SF(or)2.5 E F0
('ing together one or more of the follo)A(wing v)-.25 E(alues:)-.25 E
(DB_LOCK_CONFLICT)108 405.6 Q .988(Only run the deadlock detector if a lock con\215ict has occurred since the last time that the deadlock)
133 417.6 R(detector w)133 429.6 Q(as run.)-.1 E(The)108 446.4 Q F1
(atype)3.18 E F0 .68(parameter speci\214es which transaction to abort in the case of deadlock.)
3.18 F .68(It must be set to one of)5.68 F -.25(va)108 458.4 S
(lues described abo).25 E .3 -.15(ve f)-.15 H(or the).15 E F1(lk_detect)
2.5 E F0(\214eld of the)2.5 E F1(DB_ENV)2.5 E F0(structure.)2.5 E(The)
108 475.2 Q F1(loc)2.5 E(k_detect)-.2 E F0(function returns the v)2.5 E
(alue of)-.25 E F1(errno)2.5 E F0(on f)2.5 E(ailure and 0 on success.)
-.1 E(The)108 492 Q F1(loc)2.571 E(k_detect)-.2 E F0 .071
(function is the underlying function used by the)2.571 F F1(db_deadloc)
2.571 E(k)-.2 E F0 .07(\(1\) utility).67 F 5.07(.S)-.65 G .07
(ee the source code)-5.07 F(for the)108 504 Q F1(db_deadloc)2.5 E(k)-.2
E F0(utility for an e)2.5 E(xample of using)-.15 E F1(loc)2.5 E
(k_detect)-.2 E F0(in a UNIX en)2.5 E(vironment.)-.4 E F1(loc)92 520.8 Q
(k_stat)-.2 E F0(The)108 532.8 Q F1(loc)3.105 E(k_stat)-.2 E F0 .606(function creates a statistical structure and copies a pointer to it into the user)
3.105 F .606(-speci\214ed mem-)-.2 F(ory location.)108 544.8 Q .292
(Statistical structure are created in allocated memory)108 561.6 R 5.292
(.I)-.65 G(f)-5.292 E F1(db_malloc)2.792 E F0 .292
(is non-NULL, it is called to allocate the)2.792 F(memory)108 573.6 Q
2.829(,o)-.65 G .329(therwise, the library function)-2.829 F F1(malloc)
2.829 E F0 .329(\(3\) is used.).31 F .329(The function)5.329 F F1
(db_malloc)2.829 E F0 .33(must match the calling)2.83 F(con)108 585.6 Q
-.15(ve)-.4 G 2.031(ntions of the).15 F F1(malloc)4.531 E F0 2.031
(\(3\) library routine.).31 F(Re)7.031 E -.05(ga)-.15 G 2.031
(rdless, the caller is responsible for deallocating the).05 F .707
(returned memory)108 597.6 R 5.707(.T)-.65 G 3.207(od)-6.507 G .708
(eallocate the returned memory)-3.207 F 3.208(,f)-.65 G .708
(ree each returned memory pointer; pointers inside)-3.208 F
(the memory do not need to be indi)108 609.6 Q(vidually freed.)-.25 E
1.111(The lock re)108 626.4 R 1.111
(gion statistics are stored in a structure of type DB_LOCK_ST)-.15 F
3.33 -1.11(AT \()-.93 H -1.95(typedef ')1.11 F 3.61(di)-.5 G 3.61(n<)
-3.61 G(db)-3.61 E 3.61(.h>\). The)-.4 F(follo)108 638.4 Q
(wing DB_LOCK_ST)-.25 E 2.22 -1.11(AT \214)-.93 H
(elds will be \214lled in:)1.11 E(u_int32_t st_magic;)108 667.2 Q
(The magic number that identi\214es a \214le as a lock \214le.)133 679.2
Q(u_int32_t st_v)108 691.2 Q(ersion;)-.15 E(The v)133 703.2 Q
(ersion of the lock \214le type.)-.15 E(May 10, 1998)278.085 768 Q(5)
201.085 E EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 349.96(DB_LOCK\(3\) DB_LOCK\(3\))72 48 R
(u_int32_t st_refcnt;)108 84 Q(The number of references to the re)133 96
Q(gion.)-.15 E(u_int32_t st_re)108 108 Q(gsize;)-.15 E
(The size of the re)133 120 Q(gion.)-.15 E(u_int32_t st_maxlocks;)108
132 Q(The maximum number of locks possible.)133 144 Q
(u_int32_t st_nmodes;)108 156 Q(The number of lock modes.)133 168 Q
(u_int32_t st_numobjs;)108 180 Q(The number of unique objects lock)133
192 Q(ed.)-.1 E(u_int32_t st_nlock)108 204 Q(ers;)-.1 E
(The number of unique lock)133 216 Q(ers.)-.1 E
(u_int32_t st_ncon\215icts;)108 228 Q
(The total number of locks not immediately a)133 240 Q -.25(va)-.2 G
(ilable due to con\215icts.).25 E(u_int32_t st_nrequests;)108 252 Q
(The total number of locks requested.)133 264 Q(u_int32_t st_nreleases;)
108 276 Q(The total number of locks released.)133 288 Q
(u_int32_t st_ndeadlocks)108 300 Q(The number of deadlocks detected.)133
312 Q(u_int32_t st_re)108 324 Q(gion_w)-.15 E(ait;)-.1 E
(The number of times that a thread of control w)133 336 Q
(as forced to w)-.1 E(ait before obtaining the re)-.1 E(gion lock.)-.15
E(u_int32_t st_re)108 348 Q(gion_no)-.15 E -.1(wa)-.25 G(it;).1 E
(The number of times that a thread of control w)133 360 Q
(as able to obtain the re)-.1 E(gion lock without w)-.15 E(aiting.)-.1 E
/F1 9/Times-Bold@0 SF(ENVIR)72 376.8 Q(ONMENT V)-.27 E(ARIABLES)-1.215 E
F0(The follo)108 388.8 Q(wing en)-.25 E(vironment v)-.4 E(ariables af)
-.25 E(fect the e)-.25 E -.15(xe)-.15 G(cution of).15 E/F2 10
/Times-Italic@0 SF(db_loc)2.5 E(k)-.2 E F0(:).67 E(DB_HOME)108 405.6 Q
2.533(If the)133 417.6 R F2(dben)5.033 E(v)-.4 E F0(ar)5.033 E 2.533
(gument to)-.18 F F2(loc)5.033 E(k_open)-.2 E F0 -.1(wa)5.033 G 5.033
(si).1 G 2.533(nitialized using)-5.033 F F2(db_appinit)5.034 E F0 5.034
(,t).68 G 2.534(he en)-5.034 F 2.534(vironment v)-.4 F(ariable)-.25 E
.508(DB_HOME may be used as the path of the database home for the interpretation of the)
133 429.6 R F2(dir)3.008 E F0(ar)3.008 E(gument)-.18 E(to)133 441.6 Q F2
(loc)2.5 E(k_open)-.2 E F0 2.5(,a).24 G 2.5(sd)-2.5 G(escribed in)-2.5 E
F2(db_appinit)2.5 E F0(\(3\).).68 E(TMPDIR)108 458.4 Q .685(If the)133
470.4 R F2(dben)3.185 E(v)-.4 E F0(ar)3.185 E .685(gument to)-.18 F F2
(loc)3.185 E(k_open)-.2 E F0 -.1(wa)3.185 G 3.185(sN).1 G .685
(ULL or not initialized using)-3.185 F F2(db_appinit)3.185 E F0 3.185
(,t).68 G .685(he en)-3.185 F(vironment)-.4 E -.25(va)133 482.4 S .484(riable TMPDIR may be used as the directory in which to create the lock table, as described in the)
.25 F F2(loc)133 494.4 Q(k_open)-.2 E F0(section abo)2.5 E -.15(ve)-.15
G(.).15 E F1(ST)72 511.2 Q(AND)-.81 E(ARD LOCK MODES)-.315 E F0
(The include \214le <db)108 523.2 Q(.h> declares tw)-.4 E 2.5(oc)-.1 G
(ommonly used con\215ict arrays:)-2.5 E
(const u_int8_t db_lock_rw_con\215icts[];)108 540 Q
(This is a con\215ict array for a simple scheme using shared and e)133
552 Q(xclusi)-.15 E .3 -.15(ve l)-.25 H(ock modes.).15 E
(const u_int8_t db_lock_riw_con\215icts[];)108 568.8 Q .703
(This is a con\215ict array that in)133 580.8 R -.2(vo)-.4 G(lv).2 E
.703(es v)-.15 F .703
(arious intent lock modes \(e.g., intent shared\) that are used for)-.25
F(multigranularity locking.)133 592.8 Q
(Their associated sizes are DB_LOCK_R)108 609.6 Q
(W_N and DB_LOCK_RIW_N.)-.55 E .988(In addition, the include \214le <db)
108 626.4 R .988(.h> de\214nes the type)-.4 F F2(db_loc)3.488 E(kmode_t)
-.2 E F0 3.488(,w).68 G .987(hich is the type of the lock modes)-3.488 F
(used with the standard tables abo)108 638.4 Q -.15(ve)-.15 G(:).15 E
(DB_LOCK_NG)144 655.2 Q(not granted \(al)169 667.2 Q -.1(wa)-.1 G
(ys 0\)).1 E(DB_LOCK_READ)144 684 Q(read \(shared\))169 696 Q
(May 10, 1998)278.085 768 Q(6)201.085 E EP
%%Page: 7 7
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 349.96(DB_LOCK\(3\) DB_LOCK\(3\))72 48 R
(DB_LOCK_WRITE)144 84 Q(write \(e)169 96 Q(xclusi)-.15 E -.15(ve)-.25 G
(\)).15 E/F1 9/Times-Bold@0 SF(ERR)72 112.8 Q(ORS)-.27 E F0(The)108
124.8 Q/F2 10/Times-Italic@0 SF(loc)3.056 E(k_open)-.2 E F0 .556
(function may f)3.056 F .556(ail and return)-.1 F F2(errno)3.056 E F0
.556(for an)3.056 F 3.056(yo)-.15 G 3.056(ft)-3.056 G .556
(he errors speci\214ed for the follo)-3.056 F .557(wing DB and)-.25 F
(library functions: close\(2\), db_v)108 136.8 Q
(ersion\(3\), fcntl\(2\), f)-.15 E
(\215ush\(3\), lock_unlink\(3\), lseek\(2\), malloc\(3\), mem-)-.25 E
(cp)108 148.8 Q(y\(3\), memset\(3\), mmap\(2\), munmap\(2\), open\(2\), sig\214llset\(3\), sigprocmask\(2\), stat\(2\), strcp)
-.1 E(y\(3\),)-.1 E
(strdup\(3\), strerror\(3\), strlen\(3\), unlink\(2\), and write\(2\).)
108 160.8 Q(In addition, the)108 177.6 Q F2(loc)2.5 E(k_open)-.2 E F0
(function may f)2.5 E(ail and return)-.1 E F2(errno)2.5 E F0
(for the follo)2.5 E(wing conditions:)-.25 E([EA)108 194.4 Q(GAIN])-.4 E
(The shared memory re)133 206.4 Q(gion w)-.15 E(as lock)-.1 E
(ed and \(repeatedly\) una)-.1 E -.25(va)-.2 G(ilable.).25 E([EINV)108
223.2 Q(AL])-1.35 E(An in)133 235.2 Q -.25(va)-.4 G(lid \215ag v).25 E
(alue or parameter w)-.25 E(as speci\214ed.)-.1 E
(The DB_THREAD \215ag w)133 259.2 Q(as speci\214ed and spinlocks are not implemented for this architecture.)
-.1 E(The)108 276 Q F2(loc)3.397 E(k_vec)-.2 E F0 .896(function may f)
3.397 F .896(ail and return)-.1 F F2(errno)3.396 E F0 .896(for an)3.396
F 3.396(yo)-.15 G 3.396(ft)-3.396 G .896
(he errors speci\214ed for the follo)-3.396 F .896(wing DB and)-.25 F
(library functions: fcntl\(2\), f)108 288 Q
(\215ush\(3\), lock_detect\(3\), lseek\(2\), memcp)-.25 E
(y\(3\), memset\(3\), mmap\(2\), mun-)-.1 E
(map\(2\), strerror\(3\), and write\(2\).)108 300 Q(In addition, the)108
316.8 Q F2(loc)2.5 E(k_vec)-.2 E F0(function may f)2.5 E(ail and return)
-.1 E F2(errno)2.5 E F0(for the follo)2.5 E(wing conditions:)-.25 E([EA)
108 333.6 Q(CCES])-.4 E(An attempt w)133 345.6 Q
(as made to release lock held by another lock)-.1 E(er)-.1 E(.)-.55 E
([EINV)108 362.4 Q(AL])-1.35 E(An in)133 374.4 Q -.25(va)-.4 G
(lid \215ag v).25 E(alue or parameter w)-.25 E(as speci\214ed.)-.1 E
(The)108 391.2 Q F2(loc)3.463 E(k_g)-.2 E(et)-.1 E F0 .963
(function may f)3.463 F .963(ail and return)-.1 F F2(errno)3.463 E F0
.963(for an)3.463 F 3.463(yo)-.15 G 3.463(ft)-3.463 G .963
(he errors speci\214ed for the follo)-3.463 F .962(wing DB and)-.25 F
(library functions: fcntl\(2\), f)108 403.2 Q
(\215ush\(3\), lock_detect\(3\), lseek\(2\), memcp)-.25 E
(y\(3\), memset\(3\), mmap\(2\), mun-)-.1 E
(map\(2\), strerror\(3\), and write\(2\).)108 415.2 Q(In addition, the)
108 432 Q F2(loc)2.5 E(k_g)-.2 E(et)-.1 E F0(function may f)2.5 E
(ail and return)-.1 E F2(errno)2.5 E F0(for the follo)2.5 E
(wing conditions:)-.25 E([EINV)108 448.8 Q(AL])-1.35 E(An in)133 460.8 Q
-.25(va)-.4 G(lid \215ag v).25 E(alue or parameter w)-.25 E
(as speci\214ed.)-.1 E(The)108 477.6 Q F2(loc)3.427 E(k_put)-.2 E F0
.926(function may f)3.427 F .926(ail and return)-.1 F F2(errno)3.426 E
F0 .926(for an)3.426 F 3.426(yo)-.15 G 3.426(ft)-3.426 G .926
(he errors speci\214ed for the follo)-3.426 F .926(wing DB and)-.25 F
(library functions: fcntl\(2\), f)108 489.6 Q
(\215ush\(3\), lock_detect\(3\), lseek\(2\), memcp)-.25 E
(y\(3\), memset\(3\), mmap\(2\), mun-)-.1 E
(map\(2\), strerror\(3\), and write\(2\).)108 501.6 Q(In addition, the)
108 518.4 Q F2(loc)2.5 E(k_put)-.2 E F0(function may f)2.5 E
(ail and return)-.1 E F2(errno)2.5 E F0(for the follo)2.5 E
(wing conditions:)-.25 E([EA)108 535.2 Q(CCES])-.4 E(An attempt w)133
547.2 Q(as made to release lock held by another lock)-.1 E(er)-.1 E(.)
-.55 E([EINV)108 564 Q(AL])-1.35 E(An in)133 576 Q -.25(va)-.4 G
(lid \215ag v).25 E(alue or parameter w)-.25 E(as speci\214ed.)-.1 E
(The)108 592.8 Q F2(loc)2.995 E(k_close)-.2 E F0 .495(function may f)
2.995 F .495(ail and return)-.1 F F2(errno)2.995 E F0 .494(for an)2.995
F 2.994(yo)-.15 G 2.994(ft)-2.994 G .494
(he errors speci\214ed for the follo)-2.994 F .494(wing DB and)-.25 F
(library functions: close\(2\), fcntl\(2\), f)108 604.8 Q
(\215ush\(3\), munmap\(2\), and strerror\(3\).)-.25 E(The)108 621.6 Q F2
(loc)2.747 E(k_unlink)-.2 E F0 .247(function may f)2.747 F .247
(ail and return)-.1 F F2(errno)2.747 E F0 .247(for an)2.747 F 2.747(yo)
-.15 G 2.747(ft)-2.747 G .247(he errors speci\214ed for the follo)-2.747
F .248(wing DB and)-.25 F(library functions: close\(2\), fcntl\(2\), f)
108 633.6 Q(\215ush\(3\), malloc\(3\), memcp)-.25 E
(y\(3\), memset\(3\), mmap\(2\), munmap\(2\),)-.1 E
(open\(2\), sig\214llset\(3\), sigprocmask\(2\), stat\(2\), strcp)108
645.6 Q
(y\(3\), strdup\(3\), strerror\(3\), strlen\(3\), and unlink\(2\).)-.1 E
(In addition, the)108 662.4 Q F2(loc)2.5 E(k_unlink)-.2 E F0
(function may f)2.5 E(ail and return)-.1 E F2(errno)2.5 E F0
(for the follo)2.5 E(wing conditions:)-.25 E([EB)108 679.2 Q(USY])-.1 E
(The shared memory re)133 691.2 Q(gion w)-.15 E
(as in use and the force \215ag w)-.1 E(as not set.)-.1 E(The)108 708 Q
F2(loc)2.809 E(k_detect)-.2 E F0 .309(function may f)2.809 F .309
(ail and return)-.1 F F2(errno)2.809 E F0 .309(for an)2.809 F 2.809(yo)
-.15 G 2.81(ft)-2.809 G .31(he errors speci\214ed for the follo)-2.81 F
.31(wing DB and)-.25 F(library functions: calloc\(3\), fcntl\(2\), f)108
720 Q(\215ush\(3\), lseek\(2\), malloc\(3\), memcp)-.25 E
(y\(3\), memset\(3\), mmap\(2\),)-.1 E(May 10, 1998)278.085 768 Q(7)
201.085 E EP
%%Page: 8 8
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 349.96(DB_LOCK\(3\) DB_LOCK\(3\))72 48 R
(munmap\(2\), strerror\(3\), and write\(2\).)108 84 Q/F1 9/Times-Bold@0
SF -.09(BU)72 100.8 S(GS).09 E F0 .342
(If a process dies while holding locks, those locks remain held and are)
108 112.8 R/F2 10/Times-Bold@0 SF(ne)2.843 E -.1(ve)-.15 G(r).1 E F0
2.843(released. In)2.843 F .343(this case, all pro-)2.843 F
(cesses should e)108 124.8 Q(xit as quickly as possible, so that)-.15 E
/F3 10/Times-Italic@0 SF(db_r)2.5 E(eco)-.37 E(ver)-.1 E F0(can be run.)
2.5 E F1(SEE ALSO)72 141.6 Q F3(db_ar)108 153.6 Q -.15(ch)-.37 G(ive).15
E F0(\(1\),).18 E F3(db_c)2.5 E(hec)-.15 E(kpoint)-.2 E F0(\(1\),).68 E
F3(db_deadloc)2.5 E(k)-.2 E F0(\(1\),).67 E F3(db_dump)2.5 E F0(\(1\),)
.19 E F3(db_load)2.5 E F0(\(1\),).77 E F3(db_r)2.5 E(eco)-.37 E(ver)-.1
E F0(\(1\),).73 E F3(db_stat)2.5 E F0(\(1\),).68 E F3(db_intr)108 165.6
Q(o)-.45 E F0(\(3\),).18 E F3(db_appinit)2.5 E F0(\(3\),).68 E F3
(db_cur)2.5 E(sor)-.1 E F0(\(3\),).73 E F3(db_dbm)2.5 E F0(\(3\),).32 E
F3(db_internal)2.5 E F0(\(3\),).51 E F3(db_loc)2.5 E(k)-.2 E F0(\(3\),)
.67 E F3(db_lo)2.5 E(g)-.1 E F0(\(3\),).22 E F3(db_mpool)2.5 E F0
(\(3\),).51 E F3(db_open)108 177.6 Q F0(\(3\),).24 E F3(db_thr)2.5 E
(ead)-.37 E F0(\(3\),).77 E F3(db_txn)2.5 E F0(\(3\)).24 E(May 10, 1998)
278.085 768 Q(8)201.085 E EP
%%Trailer
end
%%EOF
