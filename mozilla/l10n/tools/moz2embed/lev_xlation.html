<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
   <meta name="author" content="Tao Cheng">
   <meta name="GENERATOR" content="Mozilla/4.79 [en]C-AOL  (Windows NT 5.0; U) [Netscape]">
   <title>How to create a localized embed.jar from existing translation</title>
<!-- ***** BEGIN LICENSE BLOCK *****
   - Version: MPL 1.1/GPL 2.0/LGPL 2.1
   -
   - The contents of this file are subject to the Mozilla Public License Version
   - 1.1 (the "License"); you may not use this file except in compliance with
   - the License. You may obtain a copy of the License at
   - http://www.mozilla.org/MPL/
   -
   - Software distributed under the License is distributed on an "AS IS" basis,
   - WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
   - for the specific language governing rights and limitations under the
   - License.
   -
   - The Original Code is Mozilla.
   -
   - The Initial Developer of the Original Code is
   - Netscape Communications Corporation.
   - Portions created by the Initial Developer are Copyright (C) 2002
   - the Initial Developer. All Rights Reserved.
   -
   - Contributor(s):
   -   Tao Cheng <tao@netscape.com>
   -
   - Alternatively, the contents of this file may be used under the terms of
   - either the GNU General Public License Version 2 or later (the "GPL"), or
   - the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
   - in which case the provisions of the GPL or the LGPL are applicable instead
   - of those above. If you wish to allow use of your version of this file only
   - under the terms of either the GPL or the LGPL, and not to allow others to
   - use your version of this file under the terms of the MPL, indicate your
   - decision by deleting the provisions above and replace them with the notice
   - and other provisions required by the LGPL or the GPL. If you do not delete
   - the provisions above, a recipient may use your version of this file under
   - the terms of any one of the MPL, the GPL or the LGPL.
   -
   - ***** END LICENSE BLOCK ***** -->
</head>
<body>

<center><b><font size=-1>How to create a localized embed.jar from existing
translation</font></b></center>

<h4>
</h4>

<h4>
History</h4>

<ul>
<li>
2002-08-02: refer to <a href="README">README</a> for updated procedure.</li>

<li>
2002-06-25: added note of <a href="#make-jars">partial automation</a></li>

<li>
2002-06-24: 1 st version</li>
</ul>

<h4>
Assumption</h4>
You have a pair of localized browser's jar files in Japanese, ja-JP.jar
and ja-win.jar, based off the N7.0 PR1 (2002-05-12) build. You would like
to create an embed.jar of the same day from it. For T-Bird, you need ja-mac.jar
instead of ja-win.jar.
<h4>
What you need</h4>
All the following jar files from the same day (2002-05-12):
<ul>
<li>
en-US.jar and en-win.jar from the English US build</li>

<li>
embed.jar and installed-chrome.txt from the embedding build off 2002-05-12's
mozilla pull.</li>
</ul>

<h4>
Procedure (I use unix cmd; current working directory is <font color="#3333FF">workspace</font>/)</h4>
<i><u>Option 1</u></i>: read README for more automated process.
<p><i><u>Option 2</u></i>: less automated approach
<p>Find out what's the difference between the English embed.jar and browser
jar files, en-US.jar and en-win.jar. Expand embed.jar into embed_jar folder
and en-US_jar.
<p>1. Find out what files are different first. Jar files are zip archives
<ul>
<li>
<font color="#3333FF">workspace</font> > unzip embed.jar -d <font color="#3333FF">embed_jar</font></li>

<li>
<font color="#3333FF">workspace </font>> unzip en-US.jar -d <font color="#3333FF">en-US_jar</font></li>

<li>
<font color="#3333FF">workspace</font> > unzip en-win.jar -d <font color="#3333FF">en-US_jar</font></li>

<li>
<font color="#3333FF">workspace</font> > unzip ja-JP.jar -d <font color="#3333FF">ja-JP_jar</font></li>

<li>
<font color="#3333FF">workspace</font> > unzip ja-win.jar -d <font color="#3333FF">ja-JP_jar</font></li>

<li>
<font color="#3333FF">workspace</font> > diff --brief <font color="#3333FF">embed_jar</font>/locale
<font color="#3333FF">en-US_jar</font>/locale > locDiff.txt</li>
</ul>
You will find some files exist in <font color="#3333FF">embed_jar </font>only
and the others exist in <font color="#3333FF">en-US_jar </font>only.
<p>2. For the files are different, find out if they need translation at
all
<p>There should be only a few files are different. Let me name those files,
"<b>en_diff</b>". The rest of exactly the same. Let me call them "<b>en_same</b>".
For PR1, I found only 5 files in "<b>en_diff</b>";&nbsp; four of them do
not need translation. I only needed to manually edit navigator.properties
to copy/paste localized resources from ja-JP directory. To automate this
process, you can write a small app or perl script to replace resource values
in the English version with those from the localized version.
<p>3. Prepare the files/directory for localized embed.jar
<p>Copy skin and content files first
<ul>
<li>
<font color="#3333FF">workspace</font> > mkdir <font color="#3333FF">embed-ja-JP</font></li>

<li>
<font color="#3333FF">workspace</font> > cp <font color="#3333FF">embed_jar</font>/{skin,content}
<font color="#3333FF">embed-ja-JP</font></li>
</ul>
Then
<ul>
<li>
copy Japanese version of "<b>en_same</b>" from <font color="#3333FF">ja-JP_jar</font>
into <font color="#3333FF">embed-ja-JP</font></li>

<li>
copy "<b>en_diff</b>" from <font color="#3333FF">embed_jar</font>/locale
into <font color="#3333FF">embed-ja-JP/</font>locale</li>
</ul>
<a NAME="make-jars"></a>Note that for this last step, you can automate
it with make-jars.pl (one of Mozilla's build tools located under mozilla/config
in the Mozilla tree) &amp; <a href="jar.mn">jar.mn</a>
<ul>
<li>
<font color="#3333FF">workspace</font> > make-jars.pl -s <font color="#3333FF">ja-JP_jar</font>
&lt; jar.mn</li>

<li>
<font color="#3333FF">workspace</font> > unzip embed.jar -d <font color="#3333FF">embed-ja-JP</font></li>

<li>
<font color="#3333FF">workspace</font> > rm embed.jar</li>
</ul>
4. In <font color="#3333FF">embed-ja-JP/</font>locale, open "navigator.properties"
to replace resource values from localized resources in "navigator.properties"
in the&nbsp; <font color="#3333FF">ja-JP_jar</font> directory. To automate
this process, you can write a small app or perl script.
<p>5. Repackage them with zip
<ul>
<li>
<font color="#3333FF">workspace</font> > cd <font color="#3333FF">embed-ja-JP</font>/</li>

<li>
<font color="#3333FF">workspace</font> > zip embed.jar -r content skin
locale</li>
</ul>
6. Replace all "en-US" strings in installed-chrome.txt with the new language
code, "ja-JP". You are done!
<br>&nbsp;
<h4>
Questions</h4>
Feel free to <a href="mailto:tao@netscape.com?subject=Q:%20embed.jar">contact
me</a> for questions.
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
</body>
</html>
